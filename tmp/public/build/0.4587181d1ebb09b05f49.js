webpackJsonp([0],{1304:function(t,e,n){var r,a;r=[n(1395),n(1542),n(1316),n(1402),n(1412),n(1363),n(1543),n(1549),n(1551),n(1558)],void 0!==(a=function(){}.apply(e,r))&&(t.exports=a)},1305:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1313),a=n(1427),i=n(1327),o=n(1429),s=n(1317);n.d(e,"PanelCtrl",function(){return r.a}),n.d(e,"MetricsPanelCtrl",function(){return a.a}),n.d(e,"QueryCtrl",function(){return i.QueryCtrl}),n.d(e,"alertTab",function(){return o.a}),n.d(e,"loadPluginCss",function(){return s.loadPluginCss})},1306:function(t,e,n){"use strict";function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=t[t.length-1],r=t[0]||"",i=1;i<t.length-1;i++)r+=" "+t[i]||"";return n=a.default.regexEscape(n),null!==new RegExp("\\$("+n+")(?:\\W|$)|\\[\\[("+n+")\\]\\]","g").exec(r)}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"variableTypes",function(){return o}),e.containsVariable=r;var a=n(464),i=n(477);n.d(e,"assignModelProperties",function(){return i.a});var o={}},1307:function(t,e,n){"use strict";function r(t){var e=new u.b({type:t.type,defaultParams:[]});return new u.a(t,e)}function a(t){switch(t){case"ok":return{text:"OK",iconClass:"icon-gf icon-gf-ok1",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"icon-gf fa-question1",stateClass:"alert-state-critical"};case"no_data":return{text:"NO DATA",iconClass:"fa icon-gf-critical1",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"fa fa-pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"fa fa-exclamation",stateClass:"alert-state-warning"}}throw{message:"Unknown alert state"}}function i(t,e){return l.a.reduce(t,function(t,e){return void 0!==e.metric&&void 0!==e.value&&t.push(e.metric+"="+e.value),void 0!==e.Metric&&void 0!==e.Value&&t.push(e.Metric+"="+e.Value),t},[]).join(e)}function o(t){return l.a.isArray(t.data)?i(t.data,", "):l.a.isArray(t.data.evalMatches)?i(t.data.evalMatches,", "):t.data.error?"Error: "+t.data.error:t.data.noData||t.data.no_data?"No Data":""}var s=n(7),l=n.n(s),u=n(1308),c=new u.b({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["1s","10s","1m","5m","10m","15m","1h","24h","48h"]},{name:"to",type:"string",options:["now"]}],defaultParams:["#A","15m","now","avg"]}),p=[{text:"Query",value:"query"}],h={alerting:1,no_data:2,pending:3,ok:4,paused:5},d=[{text:"IS ABOVE",value:"gt"},{text:"IS BELOW",value:"lt"},{text:"IS OUTSIDE RANGE",value:"outside_range"},{text:"IS WITHIN RANGE",value:"within_range"},{text:"HAS NO VALUE",value:"no_value"}],f=[{text:"OR",value:"or"},{text:"AND",value:"and"}],m=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"percent_diff()",value:"percent_diff"},{text:"count_non_null()",value:"count_non_null"}],g=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],v=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];e.a={alertQueryDef:c,getStateDisplayModel:a,conditionTypes:p,evalFunctions:d,evalOperators:f,noDataModes:g,executionErrorModes:v,reducerTypes:m,createReducerPart:r,getAlertAnnotationInfo:o,alertStateSortScore:h}},1308:function(t,e,n){"use strict";function r(t,e){var n=t.def.type+"(",r=o.a.map(t.params,function(e,n){var r=t.def.params[n];return"time"===r.type&&"auto"===e&&(e="$__interval"),"single"===r.quote?"'"+e+"'":"double"===r.quote?'"'+e+'"':e});return e&&r.unshift(e),n+r.join(", ")+")"}function a(t,e){return e+" "+t.params[0]}n.d(e,"b",function(){return s}),n.d(e,"a",function(){return l}),e.c=r,e.d=a;var i=n(7),o=n.n(i),s=function(){function t(t){this.type=t.type,this.params=t.params,this.defaultParams=t.defaultParams,this.renderer=t.renderer,this.category=t.category,this.addStrategy=t.addStrategy}return t}(),l=function(){function t(t,e){if(this.part=t,this.def=e,!this.def)throw{message:"Could not find query part "+t.type};t.params=t.params||o.a.clone(this.def.defaultParams),this.params=t.params,this.updateText()}return t.prototype.render=function(t){return this.def.renderer(this,t)},t.prototype.hasMultipleParamsInString=function(t,e){return-1!==t.indexOf(",")&&(this.def.params[e+1]&&this.def.params[e+1].optional)},t.prototype.updateParam=function(t,e){var n=this;if(this.hasMultipleParamsInString(t,e))return void o.a.each(t.split(","),function(t,e){n.updateParam(t.trim(),e)});""===t&&this.def.params[e].optional?this.params.splice(e,1):this.params[e]=t,this.part.params=this.params,this.updateText()},t.prototype.updateText=function(){if(0===this.params.length)return void(this.text=this.def.type+"()");var t=this.def.type+"(";t+=this.params.join(", "),t+=")",this.text=t},t}()},1309:function(t,e,n){"use strict";function r(t,e){if(!t)return!1;if("/"===t[0]){var n=i.default.stringToJsRegex(t);return null!=e.match(n)}return t===e}function a(t){return 0===t?.001:t/10}var i=n(464),o=n(7),s=n.n(o),l=function(){function t(t){this.datapoints=t.datapoints,this.label=t.alias,this.id=t.alias,this.alias=t.alias,this.aliasEscaped=s.a.escape(t.alias),this.color=t.color,this.valueFormater=i.default.valueFormats.none,this.stats={},this.legend=!0,this.unit=t.unit,this.hasMsResolution=this.isMsResolutionNeeded()}return t.prototype.applySeriesOverrides=function(t){this.lines={},this.dashes={dashLength:[]},this.points={},this.bars={},this.yaxis=1,this.zindex=0,this.nullPointMode=null,delete this.stack;for(var e=0;e<t.length;e++){var n=t[e];r(n.alias,this.alias)&&(void 0!==n.lines&&(this.lines.show=n.lines),void 0!==n.dashes&&(this.dashes.show=n.dashes,this.lines.lineWidth=0),void 0!==n.points&&(this.points.show=n.points),void 0!==n.bars&&(this.bars.show=n.bars),void 0!==n.fill&&(this.lines.fill=a(n.fill)),void 0!==n.stack&&(this.stack=n.stack),void 0!==n.linewidth&&(this.lines.lineWidth=this.dashes.show?0:n.linewidth,this.dashes.lineWidth=n.linewidth),void 0!==n.dashLength&&(this.dashes.dashLength[0]=n.dashLength),void 0!==n.spaceLength&&(this.dashes.dashLength[1]=n.spaceLength),void 0!==n.nullPointMode&&(this.nullPointMode=n.nullPointMode),void 0!==n.pointradius&&(this.points.radius=n.pointradius),void 0!==n.steppedLine&&(this.lines.steps=n.steppedLine),void 0!==n.zindex&&(this.zindex=n.zindex),void 0!==n.fillBelowTo&&(this.fillBelowTo=n.fillBelowTo),void 0!==n.color&&(this.color=n.color),void 0!==n.transform&&(this.transform=n.transform),void 0!==n.legend&&(this.legend=n.legend),void 0!==n.yaxis&&(this.yaxis=n.yaxis))}},t.prototype.getFlotPairs=function(t){var e=[];this.stats.total=0,this.stats.max=-Number.MAX_VALUE,this.stats.min=Number.MAX_VALUE,this.stats.logmin=Number.MAX_VALUE,this.stats.avg=null,this.stats.current=null,this.stats.first=null,this.stats.delta=0,this.stats.diff=null,this.stats.range=null,this.stats.timeStep=Number.MAX_VALUE,this.allIsNull=!0,this.allIsZero=!0;for(var n,r,a,i="connected"===t,o="null as zero"===t,l=0,u=0,c=!0,p=0;p<this.datapoints.length;p++){if(r=this.datapoints[p][0],n=this.datapoints[p][1],void 0!==a){var h=n-a;h<this.stats.timeStep&&(this.stats.timeStep=h)}if(a=n,null===r){if(i)continue;o&&(r=0)}null!==r&&(s.a.isNumber(r)&&(this.stats.total+=r,this.allIsNull=!1,l++),r>this.stats.max&&(this.stats.max=r),r<this.stats.min&&(this.stats.min=r),null===this.stats.first?this.stats.first=r:u>r?(c=!1,p===this.datapoints.length-1&&(this.stats.delta+=r)):(this.stats.delta+=c?r-u:r,c=!0),u=r,r<this.stats.logmin&&r>0&&(this.stats.logmin=r),0!==r&&(this.allIsZero=!1)),e.push([n,r])}return this.stats.max===-Number.MAX_VALUE&&(this.stats.max=null),this.stats.min===Number.MAX_VALUE&&(this.stats.min=null),e.length&&!this.allIsNull&&(this.stats.avg=this.stats.total/l,this.stats.current=e[e.length-1][1],null===this.stats.current&&e.length>1&&(this.stats.current=e[e.length-2][1])),null!==this.stats.max&&null!==this.stats.min&&(this.stats.range=this.stats.max-this.stats.min),null!==this.stats.current&&null!==this.stats.first&&(this.stats.diff=this.stats.current-this.stats.first),this.stats.count=e.length,e},t.prototype.updateLegendValues=function(t,e,n){this.valueFormater=t,this.decimals=e,this.scaledDecimals=n},t.prototype.formatValue=function(t){return s.a.isFinite(t)||(t=null),this.valueFormater(t,this.decimals,this.scaledDecimals)},t.prototype.isMsResolutionNeeded=function(){for(var t=0;t<this.datapoints.length;t++)if(null!==this.datapoints[t][1]){var e=this.datapoints[t][1].toString();if(13===e.length&&e%1e3!=0)return!0}return!1},t.prototype.hideFromLegend=function(t){return!(!t.hideEmpty||!this.allIsNull)||(!this.legend||!(!t.hideZero||!this.allIsZero))},t}();e.a=l},1310:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){this.columns=[],this.columnMap={},this.rows=[],this.type="table"}return t.prototype.sort=function(t){null===t.col||this.columns.length<=t.col||(this.rows.sort(function(e,n){return e=e[t.col],n=n[t.col],e<n?-1:e>n?1:0}),this.columns[t.col].sort=!0,t.desc?(this.rows.reverse(),this.columns[t.col].desc=!0):this.columns[t.col].desc=!1)},t.prototype.addColumn=function(t){this.columnMap[t.text]||(this.columns.push(t),this.columnMap[t.text]=t)},t}();e.default=r},1311:function(t,e,n){"use strict";function r(t){return d.a.filter(f,function(e){return!e.minVersion||e.minVersion<=t})}function a(t){return i(t.type)?w[t.type]:[]}function i(t){if(t){var e=w[t];return null!==e&&void 0!==e}return!1}function o(t){var e=[];return d.a.each(t.metrics,function(t){i(t.type)||e.push({text:c(t),value:t.id})}),e}function s(t,e){var n=[];return e?(d.a.each(k[t],function(t){t.isCheckbox||n.push(t)}),n):k[t]}function l(t){var e=[];return d.a.each(t.metrics,function(t){"count"!==t.type&&e.push({text:c(t),value:t.id})}),g.concat(e)}function u(t){return d.a.find(v,{value:t}).text}function c(t){return d.a.find(f,{value:t.type}).text+" "+t.field}function p(t,e){var n=d.a.find(g,{value:t});if(n)return n.text;var r=d.a.find(e.metrics,{id:t});return r?c(r):"metric not found"}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"metricAggTypes",function(){return f}),n.d(e,"bucketAggTypes",function(){return m}),n.d(e,"orderByOptions",function(){return g}),n.d(e,"orderOptions",function(){return v}),n.d(e,"sizeOptions",function(){return y}),n.d(e,"extendedStats",function(){return b}),n.d(e,"intervalOptions",function(){return x}),n.d(e,"movingAvgModelOptions",function(){return S}),n.d(e,"pipelineOptions",function(){return w}),n.d(e,"movingAvgModelSettings",function(){return k}),e.getMetricAggTypes=r,e.getPipelineOptions=a,e.isPipelineAgg=i,e.getPipelineAggOptions=o,e.getMovingAvgSettings=s,e.getOrderByOptions=l,e.describeOrder=u,e.describeMetric=c,e.describeOrderBy=p;var h=n(7),d=n.n(h),f=[{text:"Count",value:"count",requiresField:!1},{text:"Average",value:"avg",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Sum",value:"sum",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Max",value:"max",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Min",value:"min",requiresField:!0,supportsInlineScript:!0,supportsMissing:!0},{text:"Extended Stats",value:"extended_stats",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0},{text:"Percentiles",value:"percentiles",requiresField:!0,supportsMissing:!0,supportsInlineScript:!0},{text:"Unique Count",value:"cardinality",requiresField:!0,supportsMissing:!0},{text:"Moving Average",value:"moving_avg",requiresField:!1,isPipelineAgg:!0,minVersion:2},{text:"Derivative",value:"derivative",requiresField:!1,isPipelineAgg:!0,minVersion:2},{text:"Raw Document",value:"raw_document",requiresField:!1}],m=[{text:"Terms",value:"terms",requiresField:!0},{text:"Filters",value:"filters"},{text:"Geo Hash Grid",value:"geohash_grid",requiresField:!0},{text:"Date Histogram",value:"date_histogram",requiresField:!0},{text:"Histogram",value:"histogram",requiresField:!0}],g=[{text:"Doc Count",value:"_count"},{text:"Term value",value:"_term"}],v=[{text:"Top",value:"desc"},{text:"Bottom",value:"asc"}],y=[{text:"No limit",value:"0"},{text:"1",value:"1"},{text:"2",value:"2"},{text:"3",value:"3"},{text:"5",value:"5"},{text:"10",value:"10"},{text:"15",value:"15"},{text:"20",value:"20"}],b=[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Sum",value:"sum"},{text:"Count",value:"count"},{text:"Std Dev",value:"std_deviation"},{text:"Std Dev Upper",value:"std_deviation_bounds_upper"},{text:"Std Dev Lower",value:"std_deviation_bounds_lower"}],x=[{text:"auto",value:"auto"},{text:"10s",value:"10s"},{text:"1m",value:"1m"},{text:"5m",value:"5m"},{text:"10m",value:"10m"},{text:"20m",value:"20m"},{text:"1h",value:"1h"},{text:"1d",value:"1d"}],S=[{text:"Simple",value:"simple"},{text:"Linear",value:"linear"},{text:"Exponentially Weighted",value:"ewma"},{text:"Holt Linear",value:"holt"},{text:"Holt Winters",value:"holt_winters"}],w={moving_avg:[{text:"window",default:5},{text:"model",default:"simple"},{text:"predict",default:void 0},{text:"minimize",default:!1}],derivative:[{text:"unit",default:void 0}]},k={simple:[],linear:[],ewma:[{text:"Alpha",value:"alpha",default:void 0}],holt:[{text:"Alpha",value:"alpha",default:void 0},{text:"Beta",value:"beta",default:void 0}],holt_winters:[{text:"Alpha",value:"alpha",default:void 0},{text:"Beta",value:"beta",default:void 0},{text:"Gamma",value:"gamma",default:void 0},{text:"Period",value:"period",default:void 0},{text:"Pad",value:"pad",default:void 0,isCheckbox:!0}]}},1312:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ImpressionsStore",function(){return s}),n.d(e,"impressions",function(){return l});var r=n(206),a=n(7),i=n.n(a),o=n(27),s=function(){function t(){}return t.prototype.addDashboardImpression=function(t){var e=this.impressionKey(o.default),n=[];r.a.exists(e)&&(n=JSON.parse(r.a.get(e)),i.a.isArray(n)||(n=[])),n=n.filter(function(e){return t!==e}),n.unshift(t),n.length>50&&n.pop(),r.a.set(e,JSON.stringify(n))},t.prototype.getDashboardOpened=function(){var t=r.a.get(this.impressionKey(o.default))||"[]";return t=JSON.parse(t),t=i.a.filter(t,function(t){return i.a.isNumber(t)})},t.prototype.impressionKey=function(t){return"dashboard_impressions-"+t.bootData.user.orgId},t}(),l=new s},1313:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(27),a=n(7),i=n.n(a),o=n(13),s=n.n(o),l=n(475),u=n(469),c=n.n(u),p=n(465),h=function(){function t(t,e){var n=this;this.$injector=e,this.$scope=t,this.$timeout=e.get("$timeout"),this.editorTabIndex=0,this.events=new p.Emitter,this.timing={};var a=r.default.panels[this.panel.type];a&&(this.pluginId=a.id,this.pluginName=a.name),t.$on("refresh",function(){return n.refresh()}),t.$on("render",function(){return n.render()}),t.$on("$destroy",function(){n.events.emit("panel-teardown"),n.events.removeAllListeners()}),this.panel.isNew&&delete this.panel.isNew}return t.prototype.init=function(){this.calculatePanelHeight(),this.publishAppEvent("panel-initialized",{scope:this.$scope}),this.events.emit("panel-initialized")},t.prototype.renderingCompleted=function(){l.a.renderingCompleted(this.panel.id,this.timing)},t.prototype.refresh=function(){this.events.emit("refresh",null)},t.prototype.publishAppEvent=function(t,e){this.$scope.$root.appEvent(t,e)},t.prototype.changeView=function(t,e){this.publishAppEvent("panel-change-view",{fullscreen:t,edit:e,panelId:this.panel.id})},t.prototype.viewPanel=function(){this.changeView(!0,!1)},t.prototype.editPanel=function(){this.changeView(!0,!0)},t.prototype.exitFullscreen=function(){this.changeView(!1,!1)},t.prototype.initEditMode=function(){var t=this;this.editorTabs=[],this.addEditorTab("General","public/app/partials/panelgeneral.html"),this.editModeInitiated=!0,this.events.emit("init-edit-mode",null);var e=(this.$injector.get("$routeParams").tab||"").toLowerCase();e&&this.editorTabs.forEach(function(n,r){n.title.toLowerCase()===e&&(t.editorTabIndex=r)})},t.prototype.changeTab=function(t){this.editorTabIndex=t;var e=this.$injector.get("$route");e.current.params.tab=this.editorTabs[t].title.toLowerCase(),e.updateParams()},t.prototype.addEditorTab=function(t,e,n){var r={title:t,directiveFn:e};i.a.isString(e)&&(r.directiveFn=function(){return{templateUrl:e}}),n?this.editorTabs.splice(n,0,r):this.editorTabs.push(r)},t.prototype.getMenu=function(){var t=[];return t.push({text:"View",click:"ctrl.viewPanel(); dismiss();"}),t.push({text:"Edit",click:"ctrl.editPanel(); dismiss();",role:"Editor"}),this.fullscreen||t.push({text:"Duplicate",click:"ctrl.duplicate()",role:"Editor"}),t.push({text:"Share",click:"ctrl.sharePanel(); dismiss();"}),t},t.prototype.getExtendedMenu=function(){var t=[{text:"Panel JSON",click:"ctrl.editPanelJson(); dismiss();"}];return this.events.emit("init-panel-actions",t),t},t.prototype.otherPanelInFullscreenMode=function(){return this.dashboard.meta.fullscreen&&!this.fullscreen},t.prototype.calculatePanelHeight=function(){if(this.fullscreen){var t=s()(window).height(),e=Math.floor(.4*t),n=Math.floor(.8*t);this.containerHeight=this.editMode?e:n}else this.containerHeight=this.panel.height||this.row.height,i.a.isString(this.containerHeight)&&(this.containerHeight=parseInt(this.containerHeight.replace("px",""),10));this.height=this.containerHeight-(7+(this.panel.title?25:9))},t.prototype.render=function(t){this.otherPanelInFullscreenMode()||(this.calculatePanelHeight(),this.timing.renderStart=(new Date).getTime(),this.events.emit("render",t))},t.prototype.duplicate=function(){var t=this;this.dashboard.duplicatePanel(this.panel,this.row),this.$timeout(function(){t.$scope.$root.$broadcast("render")})},t.prototype.updateColumnSpan=function(t){var e=this;this.panel.span=Math.min(Math.max(Math.floor(this.panel.span+t),1),12),this.row.panelSpanChanged(),this.$timeout(function(){e.render()})},t.prototype.removePanel=function(){this.row.removePanel(this.panel)},t.prototype.editPanelJson=function(){this.publishAppEvent("show-json-editor",{object:this.panel,updateHandler:this.replacePanel.bind(this)})},t.prototype.replacePanel=function(t,e){var n=this,r=i.a.indexOf(this.row.panels,e);this.row.panels.splice(r,1),this.$timeout(function(){t.id=e.id,t.span=e.span,n.row.panels.splice(r,0,t)})},t.prototype.sharePanel=function(){var t=this.$scope.$new();t.panel=this.panel,t.dashboard=this.dashboard,this.publishAppEvent("show-modal",{src:"public/app/features/dashboard/partials/shareModal.html",scope:t})},t.prototype.getInfoMode=function(){return this.error?"error":this.panel.description?"info":this.panel.links&&this.panel.links.length?"links":""},t.prototype.getInfoContent=function(t){var e=this.panel.description;"tooltip"===t.mode&&(e=this.error||this.panel.description);var n=this.$injector.get("linkSrv"),r=this.$injector.get("templateSrv"),a=r.replace(e,this.panel.scopedVars),i='<div class="markdown-html">';if(i+=(new c.a).render(a),this.panel.links&&this.panel.links.length>0){i+="<ul>";for(var o=0,s=this.panel.links;o<s.length;o++){var l=s[o],u=n.getPanelLinkAnchorInfo(l,this.panel.scopedVars);i+='<li><a class="panel-menu-link" href="'+u.href+'" target="'+u.target+'">'+u.title+"</a></li>"}i+="</ul>"}return i+"</div>"},t.prototype.openInspector=function(){var t=this.$scope.$new();t.panel=this.panel,t.dashboard=this.dashboard,t.panelInfoHtml=this.getInfoContent({mode:"inspector"}),t.inspector=s.a.extend(!0,{},this.inspector),this.publishAppEvent("show-modal",{src:"public/app/features/dashboard/partials/inspector.html",scope:t})},t}()},1314:function(t,e,n){"use strict";function r(t,e,n){var r=Math.sqrt(50),a=Math.sqrt(10),i=Math.sqrt(2),o=Math.abs(e-t)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(o)/Math.LN10)),l=o/s;return l>=r?s*=10:l>=a?s*=5:l>=i&&(s*=2),e<t?-s:s}function a(t,e){return t-Math.floor(Math.log(e)/Math.LN10)}function i(t,e,n,r){var a,i=(e-t)/n,o=-Math.floor(Math.log(i)/Math.LN10),s=r,l=Math.pow(10,-o),u=i/l;return u<1.5?a=1:u<3?(a=2,u>2.25&&(null==s||o+1<=s)&&(a=2.5,++o)):a=u<7.5?5:10,a*=l}Object.defineProperty(e,"__esModule",{value:!0}),e.tickStep=r,e.getScaledDecimals=a,e.getFlotTickSize=i},1315:function(t,e){!function(t){t.color={},t.color.make=function(e,n,r,a){var i={};return i.r=e||0,i.g=n||0,i.b=r||0,i.a=null!=a?a:1,i.add=function(t,e){for(var n=0;n<t.length;++n)i[t.charAt(n)]+=e;return i.normalize()},i.scale=function(t,e){for(var n=0;n<t.length;++n)i[t.charAt(n)]*=e;return i.normalize()},i.toString=function(){return i.a>=1?"rgb("+[i.r,i.g,i.b].join(",")+")":"rgba("+[i.r,i.g,i.b,i.a].join(",")+")"},i.normalize=function(){function t(t,e,n){return e<t?t:e>n?n:e}return i.r=t(0,parseInt(i.r),255),i.g=t(0,parseInt(i.g),255),i.b=t(0,parseInt(i.b),255),i.a=t(0,i.a,1),i},i.clone=function(){return t.color.make(i.r,i.b,i.g,i.a)},i.normalize()},t.color.extract=function(e,n){var r;do{if(""!=(r=e.css(n).toLowerCase())&&"transparent"!=r)break;e=e.parent()}while(e.length&&!t.nodeName(e.get(0),"body"));return"rgba(0, 0, 0, 0)"==r&&(r="transparent"),t.color.parse(r)},t.color.parse=function(n){var r,a=t.color.make;if(r=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n))return a(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10));if(r=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return a(parseInt(r[1],10),parseInt(r[2],10),parseInt(r[3],10),parseFloat(r[4]));if(r=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n))return a(2.55*parseFloat(r[1]),2.55*parseFloat(r[2]),2.55*parseFloat(r[3]));if(r=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))return a(2.55*parseFloat(r[1]),2.55*parseFloat(r[2]),2.55*parseFloat(r[3]),parseFloat(r[4]));if(r=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n))return a(parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16));if(r=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n))return a(parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16),parseInt(r[3]+r[3],16));var i=t.trim(n).toLowerCase();return"transparent"==i?a(255,255,255,0):(r=e[i]||[0,0,0],a(r[0],r[1],r[2]))};var e={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}}(jQuery),function(t){function e(e,n){var r=n.children("."+e)[0];if(null==r&&(r=document.createElement("canvas"),r.className=e,t(r).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(n),!r.getContext)){if(!window.G_vmlCanvasManager)throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");r=window.G_vmlCanvasManager.initElement(r)}this.element=r;var a=this.context=r.getContext("2d"),i=window.devicePixelRatio||1,o=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;this.pixelRatio=i/o,this.resize(n.width(),n.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}function n(n,a,i,o){function s(t,e){e=[ht].concat(e);for(var n=0;n<t.length;++n)t[n].apply(this,e)}function l(t){Z=u(t),m(),g()}function u(e){for(var n=[],r=0;r<e.length;++r){var a=t.extend(!0,{},tt.series);null!=e[r].data?(a.data=e[r].data,delete e[r].data,t.extend(!0,a,e[r]),e[r].data=a.data):a.data=e[r],n.push(a)}return n}function c(t,e){var n=t[e+"axis"];return"object"==typeof n&&(n=n.n),"number"!=typeof n&&(n=1),n}function p(){return t.grep(ot.concat(st),function(t){return t})}function h(t){var e,n,r={};for(e=0;e<ot.length;++e)(n=ot[e])&&n.used&&(r["x"+n.n]=n.c2p(t.left));for(e=0;e<st.length;++e)(n=st[e])&&n.used&&(r["y"+n.n]=n.c2p(t.top));return void 0!==r.x1&&(r.x=r.x1),void 0!==r.y1&&(r.y=r.y1),r}function d(t){var e,n,r,a={};for(e=0;e<ot.length;++e)if((n=ot[e])&&n.used&&(r="x"+n.n,null==t[r]&&1==n.n&&(r="x"),null!=t[r])){a.left=n.p2c(t[r]);break}for(e=0;e<st.length;++e)if((n=st[e])&&n.used&&(r="y"+n.n,null==t[r]&&1==n.n&&(r="y"),null!=t[r])){a.top=n.p2c(t[r]);break}return a}function f(e,n){return e[n-1]||(e[n-1]={n:n,direction:e==ot?"x":"y",options:t.extend(!0,{},e==ot?tt.xaxis:tt.yaxis)}),e[n-1]}function m(){var e,n=Z.length,r=-1;for(e=0;e<Z.length;++e){var a=Z[e].color;null!=a&&(n--,"number"==typeof a&&a>r&&(r=a))}n<=r&&(n=r+1);var i,o=[],s=tt.colors,l=s.length,u=0;for(e=0;e<n;e++)i=t.color.parse(s[e%l]||"#666"),e%l==0&&e&&(u=u>=0?u<.5?-u-.2:0:-u),o[e]=i.scale("rgb",1+u);var p,h=0;for(e=0;e<Z.length;++e){if(p=Z[e],null==p.color?(p.color=o[h].toString(),++h):"number"==typeof p.color&&(p.color=o[p.color].toString()),null==p.lines.show){var d,m=!0;for(d in p)if(p[d]&&p[d].show){m=!1;break}m&&(p.lines.show=!0)}null==p.lines.zero&&(p.lines.zero=!!p.lines.fill),p.xaxis=f(ot,c(p,"x")),p.yaxis=f(st,c(p,"y"))}}function g(){function e(t,e,n){e<t.datamin&&e!=-y&&(t.datamin=e),n>t.datamax&&n!=y&&(t.datamax=n)}var n,r,a,i,o,l,u,c,h,d,f,m,g=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,y=Number.MAX_VALUE;for(t.each(p(),function(t,e){e.datamin=g,e.datamax=v,e.used=!1}),n=0;n<Z.length;++n)o=Z[n],o.datapoints={points:[]},s(pt.processRawData,[o,o.data,o.datapoints]);for(n=0;n<Z.length;++n){if(o=Z[n],f=o.data,!(m=o.datapoints.format)){if(m=[],m.push({x:!0,number:!0,required:!0}),m.push({y:!0,number:!0,required:!0}),o.bars.show||o.lines.show&&o.lines.fill){var b=!!(o.bars.show&&o.bars.zero||o.lines.show&&o.lines.zero);m.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:b}),o.bars.horizontal&&(delete m[m.length-1].y,m[m.length-1].x=!0)}o.datapoints.format=m}if(null==o.datapoints.pointsize){o.datapoints.pointsize=m.length,u=o.datapoints.pointsize,l=o.datapoints.points;var x=o.lines.show&&o.lines.steps;for(o.xaxis.used=o.yaxis.used=!0,r=a=0;r<f.length;++r,a+=u){d=f[r];var S=null==d;if(!S)for(i=0;i<u;++i)c=d[i],h=m[i],h&&(h.number&&null!=c&&(c=+c,isNaN(c)?c=null:c==1/0?c=y:c==-1/0&&(c=-y)),null==c&&(h.required&&(S=!0),null!=h.defaultValue&&(c=h.defaultValue))),l[a+i]=c;if(S)for(i=0;i<u;++i)c=l[a+i],null!=c&&(h=m[i],!1!==h.autoscale&&(h.x&&e(o.xaxis,c,c),h.y&&e(o.yaxis,c,c))),l[a+i]=null;if(x&&a>0&&(!S||null!=l[a-u])){for(i=0;i<u;++i)l[a+u+i]=l[a+i];l[a+1]=l[a-u+1]||0,S&&(l[a]=d[0]),a+=u}}}}for(n=0;n<Z.length;++n){if(o=Z[n],l=o.datapoints.points,u=o.datapoints.pointsize,"negative-Y"===o.transform)for(r=0;r<l.length;r+=u)null!=l[r]&&(c=l[r+1],l[r+1]=-c);s(pt.processDatapoints,[o,o.datapoints])}for(n=0;n<Z.length;++n){o=Z[n],l=o.datapoints.points,u=o.datapoints.pointsize,m=o.datapoints.format;var w=g,k=g,_=v,M=v;for(r=0;r<l.length;r+=u)if(null!=l[r])for(i=0;i<u;++i)c=l[r+i],(h=m[i])&&!1!==h.autoscale&&c!=y&&c!=-y&&(h.x&&(c<w&&(w=c),c>_&&(_=c)),h.y&&(c<k&&(k=c),c>M&&(M=c)));if(o.bars.show){var T;switch(o.bars.align){case"left":T=0;break;case"right":T=-o.bars.barWidth;break;default:T=-o.bars.barWidth/2}o.bars.horizontal?(k+=T,M+=T+o.bars.barWidth):(w+=T,_+=T+o.bars.barWidth)}e(o.xaxis,w,_),e(o.yaxis,k,M)}t.each(p(),function(t,e){e.datamin==g&&(e.datamin=null),e.datamax==v&&(e.datamax=null)})}function v(){ft&&clearTimeout(ft),rt.unbind("mousemove",V),rt.unbind("mouseleave",U),rt.unbind("click",B),s(pt.shutdown,[rt])}function y(t){function e(t){return t}var n,r,a=t.options.transform||e,i=t.options.inverseTransform;"x"==t.direction?(n=t.scale=ut/Math.abs(a(t.max)-a(t.min)),r=Math.min(a(t.max),a(t.min))):(n=t.scale=ct/Math.abs(a(t.max)-a(t.min)),n=-n,r=Math.max(a(t.max),a(t.min))),t.p2c=a==e?function(t){return(t-r)*n}:function(t){return(a(t)-r)*n},t.c2p=i?function(t){return i(r+t/n)}:function(t){return r+t/n}}function b(t){for(var e=t.options,n=t.ticks||[],r=e.labelWidth||0,a=e.labelHeight||0,i=r||("x"==t.direction?Math.floor(et.width/(n.length||1)):null),o=t.direction+"Axis "+t.direction+t.n+"Axis",s="flot-"+t.direction+"-axis flot-"+t.direction+t.n+"-axis "+o,l=e.font||"flot-tick-label tickLabel",u=0;u<n.length;++u){var c=n[u];if(c.label){var p=et.getTextInfo(s,c.label,l,null,i);r=Math.max(r,p.width+1),a=Math.max(a,p.height)}}t.labelWidth=e.labelWidth||r,t.labelHeight=e.labelHeight||a}function x(e){var n=e.labelWidth,r=e.labelHeight,a=e.options.position,i="x"===e.direction,o=e.options.tickLength,s=tt.grid.axisMargin,l=tt.grid.labelMargin,u=tt.grid.eventSectionHeight,c=!0,p=!0,h=!0,d=!1;t.each(i?ot:st,function(t,n){n&&(n.show||n.reserveSpace)&&(n===e?d=!0:n.options.position===a&&(d?p=!1:c=!1),d||(h=!1))}),p&&(s=0),null==o&&(o=h?"full":5),isNaN(+o)||(l+=+o),i?(r+=l,r+=u,"bottom"==a?(lt.bottom+=r+s,e.box={top:et.height-lt.bottom,height:r}):(e.box={top:lt.top+s,height:r},lt.top+=r+s)):(n+=l,"left"==a?(e.box={left:lt.left+s,width:n},lt.left+=n+s):(lt.right+=n+s,e.box={left:et.width-lt.right,width:n})),e.position=a,e.tickLength=o,e.box.padding=l,e.box.eventSectionPadding=u,e.innermost=c}function S(t){"x"==t.direction?(t.box.left=lt.left-t.labelWidth/2,t.box.width=et.width-lt.left-lt.right+t.labelWidth):(t.box.top=lt.top-t.labelHeight/2,t.box.height=et.height-lt.bottom-lt.top+t.labelHeight)}function w(){var e,n=tt.grid.minBorderMargin;if(null==n)for(n=0,e=0;e<Z.length;++e)n=Math.max(n,2*(Z[e].points.radius+Z[e].points.lineWidth/2));var r={left:n,right:n,top:n,bottom:n};t.each(p(),function(t,e){e.reserveSpace&&e.ticks&&e.ticks.length&&("x"===e.direction?(r.left=Math.max(r.left,e.labelWidth/2),r.right=Math.max(r.right,e.labelWidth/2)):(r.bottom=Math.max(r.bottom,e.labelHeight/2),r.top=Math.max(r.top,e.labelHeight/2)))}),lt.left=Math.ceil(Math.max(r.left,lt.left)),lt.right=Math.ceil(Math.max(r.right,lt.right)),lt.top=Math.ceil(Math.max(r.top,lt.top)),lt.bottom=Math.ceil(Math.max(r.bottom,lt.bottom))}function k(){var e,n=p(),r=tt.grid.show;for(var a in lt){var i=tt.grid.margin||0;lt[a]="number"==typeof i?i:i[a]||0}s(pt.processOffset,[lt]);for(var a in lt)"object"==typeof tt.grid.borderWidth?lt[a]+=r?tt.grid.borderWidth[a]:0:lt[a]+=r?tt.grid.borderWidth:0;if(t.each(n,function(t,e){var n=e.options;e.show=null==n.show?e.used:n.show,e.reserveSpace=null==n.reserveSpace?e.show:n.reserveSpace,_(e)}),r){var o=t.grep(n,function(t){return t.show||t.reserveSpace});for(t.each(o,function(t,e){M(e),T(e),C(e,e.ticks),b(e)}),e=o.length-1;e>=0;--e)x(o[e]);w(),t.each(o,function(t,e){S(e)})}ut=et.width-lt.left-lt.right,ct=et.height-lt.bottom-lt.top,t.each(n,function(t,e){y(e)}),r&&D(),L()}function _(t){var e=t.options,n=+(null!=e.min?e.min:t.datamin),r=+(null!=e.max?e.max:t.datamax),a=r-n;if(0==a){var i=Math.abs(0==r?1:.25*r);null==e.min&&(n-=i),null!=e.max&&null==e.min||(r+=i)}else{var o=e.autoscaleMargin;null!=o&&(null==e.min&&(n-=a*o)<0&&null!=t.datamin&&t.datamin>=0&&(n=0),null==e.max&&(r+=a*o)>0&&null!=t.datamax&&t.datamax<=0&&(r=0))}t.min=n,t.max=r}function M(e){var n,a=e.options;n="number"==typeof a.ticks&&a.ticks>0?a.ticks:.3*Math.sqrt("x"==e.direction?et.width:et.height);var i=(e.max-e.min)/n,o=-Math.floor(Math.log(i)/Math.LN10),s=a.tickDecimals;null!=s&&o>s&&(o=s);var l,u=Math.pow(10,-o),c=i/u;if(c<1.5?l=1:c<3?(l=2,c>2.25&&(null==s||o+1<=s)&&(l=2.5,++o)):l=c<7.5?5:10,l*=u,null!=a.minTickSize&&l<a.minTickSize&&(l=a.minTickSize),e.delta=i,e.tickDecimals=Math.max(0,null!=s?s:o),e.tickSize=a.tickSize||l,e.scaledDecimals=e.tickDecimals-Math.floor(Math.log(e.tickSize)/Math.LN10),"time"==a.mode&&!e.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(e.tickGenerator||(e.tickGenerator=function(t){var e,n=[],a=r(t.min,t.tickSize),i=0,o=Number.NaN;do{e=o,o=a+i*t.tickSize,n.push(o),++i}while(o<t.max&&o!=e);return n},e.tickFormatter=function(t,e){var n=e.tickDecimals?Math.pow(10,e.tickDecimals):1,r=""+Math.round(t*n)/n;if(null!=e.tickDecimals){var a=r.indexOf("."),i=-1==a?0:r.length-a-1;if(i<e.tickDecimals)return(i?r:r+".")+(""+n).substr(1,e.tickDecimals-i)}return r}),t.isFunction(a.tickFormatter)&&(e.tickFormatter=function(t,e){return""+a.tickFormatter(t,e)}),null!=a.alignTicksWithAxis){var p=("x"==e.direction?ot:st)[a.alignTicksWithAxis-1];if(p&&p.used&&p!=e){var h=e.tickGenerator(e);if(h.length>0&&(null==a.min&&(e.min=Math.min(e.min,h[0])),null==a.max&&h.length>1&&(e.max=Math.max(e.max,h[h.length-1]))),e.tickGenerator=function(t){var e,n,r=[];for(n=0;n<p.ticks.length;++n)e=(p.ticks[n].v-p.min)/(p.max-p.min),e=t.min+e*(t.max-t.min),r.push(e);return r},!e.mode&&null==a.tickDecimals){var d=Math.max(0,1-Math.floor(Math.log(e.delta)/Math.LN10)),f=e.tickGenerator(e);f.length>1&&/\..*0$/.test((f[1]-f[0]).toFixed(d))||(e.tickDecimals=d)}}}}function T(e){var n=e.options.ticks,r=[];null==n||"number"==typeof n&&n>0?r=e.tickGenerator(e):n&&(r=t.isFunction(n)?n(e):n);var a,i;for(e.ticks=[],a=0;a<r.length;++a){var o=null,s=r[a];"object"==typeof s?(i=+s[0],s.length>1&&(o=s[1])):i=+s,null==o&&(o=e.tickFormatter(i,e)),isNaN(i)||e.ticks.push({v:i,label:o})}}function C(t,e){t.options.autoscaleMargin&&e.length>0&&(null==t.options.min&&(t.min=Math.min(t.min,e[0].v)),null==t.options.max&&e.length>1&&(t.max=Math.max(t.max,e[e.length-1].v)))}function P(){et.clear(),s(pt.drawBackground,[at]);var t=tt.grid;t.show&&t.backgroundColor&&A(),t.show&&!t.aboveData&&E();for(var e=0;e<Z.length;++e)s(pt.drawSeries,[at,Z[e]]),$(Z[e]);s(pt.draw,[at]),t.show&&t.aboveData&&E(),et.render(),Q()}function O(t,e){for(var n,r,a,i,o=p(),s=0;s<o.length;++s)if(n=o[s],n.direction==e&&(i=e+n.n+"axis",t[i]||1!=n.n||(i=e+"axis"),t[i])){r=t[i].from,a=t[i].to;break}if(t[i]||(n="x"==e?ot[0]:st[0],r=t[e+"1"],a=t[e+"2"]),null!=r&&null!=a&&r>a){var l=r;r=a,a=l}return{from:r,to:a,axis:n}}function A(){at.save(),at.translate(lt.left,lt.top),at.fillStyle=X(tt.grid.backgroundColor,ct,0,"rgba(255, 255, 255, 0)"),at.fillRect(0,0,ut,ct),at.restore()}function E(){var e,n,r,a;at.save(),at.translate(lt.left,lt.top);var i=tt.grid.markings;if(i)for(t.isFunction(i)&&(n=ht.getAxes(),n.xmin=n.xaxis.min,n.xmax=n.xaxis.max,n.ymin=n.yaxis.min,n.ymax=n.yaxis.max,i=i(n)),e=0;e<i.length;++e){var o=i[e],s=O(o,"x"),l=O(o,"y");if(null==s.from&&(s.from=s.axis.min),null==s.to&&(s.to=s.axis.max),null==l.from&&(l.from=l.axis.min),null==l.to&&(l.to=l.axis.max),!(s.to<s.axis.min||s.from>s.axis.max||l.to<l.axis.min||l.from>l.axis.max)){s.from=Math.max(s.from,s.axis.min),s.to=Math.min(s.to,s.axis.max),l.from=Math.max(l.from,l.axis.min),l.to=Math.min(l.to,l.axis.max);var u=s.from===s.to,c=l.from===l.to;if(!u||!c)if(s.from=Math.floor(s.axis.p2c(s.from)),s.to=Math.floor(s.axis.p2c(s.to)),l.from=Math.floor(l.axis.p2c(l.from)),l.to=Math.floor(l.axis.p2c(l.to)),u||c){var h=o.lineWidth||tt.grid.markingsLineWidth,d=h%2?.5:0;at.beginPath(),at.strokeStyle=o.color||tt.grid.markingsColor,at.lineWidth=h,u?(at.moveTo(s.to+d,l.from),at.lineTo(s.to+d,l.to)):(at.moveTo(s.from,l.to+d),at.lineTo(s.to,l.to+d)),at.stroke()}else at.fillStyle=o.color||tt.grid.markingsColor,at.fillRect(s.from,l.to,s.to-s.from,l.from-l.to)}}n=p(),r=tt.grid.borderWidth;for(var f=0;f<n.length;++f){var m,g,v,y,b=n[f],x=b.box,S=b.tickLength;if(b.show&&0!=b.ticks.length){for(at.lineWidth=1,"x"==b.direction?(m=0,g="full"==S?"top"==b.position?0:ct:x.top-lt.top+("top"==b.position?x.height:0)):(g=0,m="full"==S?"left"==b.position?0:ut:x.left-lt.left+("left"==b.position?x.width:0)),b.innermost||(at.strokeStyle=b.options.color,at.beginPath(),v=y=0,"x"==b.direction?v=ut+1:y=ct+1,1==at.lineWidth&&("x"==b.direction?g=Math.floor(g)+.5:m=Math.floor(m)+.5),at.moveTo(m,g),at.lineTo(m+v,g+y),at.stroke()),at.strokeStyle=b.options.tickColor,at.beginPath(),e=0;e<b.ticks.length;++e){var w=b.ticks[e].v;v=y=0,isNaN(w)||w<b.min||w>b.max||"full"==S&&("object"==typeof r&&r[b.position]>0||r>0)&&(w==b.min||w==b.max)||("x"==b.direction?(m=b.p2c(w),y="full"==S?-ct:S,"top"==b.position&&(y=-y)):(g=b.p2c(w),v="full"==S?-ut:S,"left"==b.position&&(v=-v)),1==at.lineWidth&&("x"==b.direction?m=Math.floor(m)+.5:g=Math.floor(g)+.5),at.moveTo(m,g),at.lineTo(m+v,g+y))}at.stroke()}}r&&(a=tt.grid.borderColor,"object"==typeof r||"object"==typeof a?("object"!=typeof r&&(r={top:r,right:r,bottom:r,left:r}),"object"!=typeof a&&(a={top:a,right:a,bottom:a,left:a}),r.top>0&&(at.strokeStyle=a.top,at.lineWidth=r.top,at.beginPath(),at.moveTo(0-r.left,0-r.top/2),at.lineTo(ut,0-r.top/2),at.stroke()),r.right>0&&(at.strokeStyle=a.right,at.lineWidth=r.right,at.beginPath(),at.moveTo(ut+r.right/2,0-r.top),at.lineTo(ut+r.right/2,ct),at.stroke()),r.bottom>0&&(at.strokeStyle=a.bottom,at.lineWidth=r.bottom,at.beginPath(),at.moveTo(ut+r.right,ct+r.bottom/2),at.lineTo(0,ct+r.bottom/2),at.stroke()),r.left>0&&(at.strokeStyle=a.left,at.lineWidth=r.left,at.beginPath(),at.moveTo(0-r.left/2,ct+r.bottom),at.lineTo(0-r.left/2,0),at.stroke())):(at.lineWidth=r,at.strokeStyle=tt.grid.borderColor,at.strokeRect(-r/2,-r/2,ut+r,ct+r))),at.restore()}function D(){t.each(p(),function(t,e){var n,r,a,i,o,s=e.box,l=e.direction+"Axis "+e.direction+e.n+"Axis",u="flot-"+e.direction+"-axis flot-"+e.direction+e.n+"-axis "+l,c=e.options.font||"flot-tick-label tickLabel";if(et.removeText(u),e.show&&0!=e.ticks.length)for(var p=0;p<e.ticks.length;++p)n=e.ticks[p],!n.label||n.v<e.min||n.v>e.max||("x"==e.direction?(i="center",r=lt.left+e.p2c(n.v),"bottom"==e.position?a=s.top+s.padding+s.eventSectionPadding:(a=s.top+s.height-s.padding,o="bottom")):(o="middle",a=lt.top+e.p2c(n.v),"left"==e.position?(r=s.left+s.width-s.padding,i="right"):r=s.left+s.padding),et.addText(u,r,a,n.label,c,null,null,i,o))})}function $(t){t.lines.show&&I(t),t.bars.show&&q(t),t.points.show&&F(t)}function I(t){function e(t,e,n,r,a){var i=t.points,o=t.pointsize,s=null,l=null;at.beginPath();for(var u=o;u<i.length;u+=o){var c=i[u-o],p=i[u-o+1],h=i[u],d=i[u+1];if(null!=c&&null!=h){if(p<=d&&p<a.min){if(d<a.min)continue;c=(a.min-p)/(d-p)*(h-c)+c,p=a.min}else if(d<=p&&d<a.min){if(p<a.min)continue;h=(a.min-p)/(d-p)*(h-c)+c,d=a.min}if(p>=d&&p>a.max){if(d>a.max)continue;c=(a.max-p)/(d-p)*(h-c)+c,p=a.max}else if(d>=p&&d>a.max){if(p>a.max)continue;h=(a.max-p)/(d-p)*(h-c)+c,d=a.max}if(c<=h&&c<r.min){if(h<r.min)continue;p=(r.min-c)/(h-c)*(d-p)+p,c=r.min}else if(h<=c&&h<r.min){if(c<r.min)continue;d=(r.min-c)/(h-c)*(d-p)+p,h=r.min}if(c>=h&&c>r.max){if(h>r.max)continue;p=(r.max-c)/(h-c)*(d-p)+p,c=r.max}else if(h>=c&&h>r.max){if(c>r.max)continue;d=(r.max-c)/(h-c)*(d-p)+p,h=r.max}c==s&&p==l||at.moveTo(r.p2c(c)+e,a.p2c(p)+n),s=h,l=d,at.lineTo(r.p2c(h)+e,a.p2c(d)+n)}}at.stroke()}at.save(),at.translate(lt.left,lt.top),at.lineJoin="round";var n=t.lines.lineWidth,r=t.shadowSize;if(n>0&&r>0){at.lineWidth=r,at.strokeStyle="rgba(0,0,0,0.1)";var a=Math.PI/18;e(t.datapoints,Math.sin(a)*(n/2+r/2),Math.cos(a)*(n/2+r/2),t.xaxis,t.yaxis),at.lineWidth=r/2,e(t.datapoints,Math.sin(a)*(n/2+r/4),Math.cos(a)*(n/2+r/4),t.xaxis,t.yaxis)}at.lineWidth=n,at.strokeStyle=t.color;var i=j(t.lines,t.color,0,ct);i&&(at.fillStyle=i,function(t,e,n){for(var r=t.points,a=t.pointsize,i=Math.min(Math.max(0,n.min),n.max),o=0,s=!1,l=1,u=0,c=0;!(a>0&&o>r.length+a);){o+=a;var p=r[o-a],h=r[o-a+l],d=r[o],f=r[o+l];if(s){if(a>0&&null!=p&&null==d){c=o,a=-a,l=2;continue}if(a<0&&o==u+a){at.fill(),s=!1,a=-a,l=1,o=u=c+a;continue}}if(null!=p&&null!=d){if(p<=d&&p<e.min){if(d<e.min)continue;h=(e.min-p)/(d-p)*(f-h)+h,p=e.min}else if(d<=p&&d<e.min){if(p<e.min)continue;f=(e.min-p)/(d-p)*(f-h)+h,d=e.min}if(p>=d&&p>e.max){if(d>e.max)continue;h=(e.max-p)/(d-p)*(f-h)+h,p=e.max}else if(d>=p&&d>e.max){if(p>e.max)continue;f=(e.max-p)/(d-p)*(f-h)+h,d=e.max}if(s||(at.beginPath(),at.moveTo(e.p2c(p),n.p2c(i)),s=!0),h>=n.max&&f>=n.max)at.lineTo(e.p2c(p),n.p2c(n.max)),at.lineTo(e.p2c(d),n.p2c(n.max));else if(h<=n.min&&f<=n.min)at.lineTo(e.p2c(p),n.p2c(n.min)),at.lineTo(e.p2c(d),n.p2c(n.min));else{var m=p,g=d;h<=f&&h<n.min&&f>=n.min?(p=(n.min-h)/(f-h)*(d-p)+p,h=n.min):f<=h&&f<n.min&&h>=n.min&&(d=(n.min-h)/(f-h)*(d-p)+p,f=n.min),h>=f&&h>n.max&&f<=n.max?(p=(n.max-h)/(f-h)*(d-p)+p,h=n.max):f>=h&&f>n.max&&h<=n.max&&(d=(n.max-h)/(f-h)*(d-p)+p,f=n.max),p!=m&&at.lineTo(e.p2c(m),n.p2c(h)),at.lineTo(e.p2c(p),n.p2c(h)),at.lineTo(e.p2c(d),n.p2c(f)),d!=g&&(at.lineTo(e.p2c(d),n.p2c(f)),at.lineTo(e.p2c(g),n.p2c(f)))}}}}(t.datapoints,t.xaxis,t.yaxis)),n>0&&e(t.datapoints,0,0,t.xaxis,t.yaxis),at.restore()}function F(t){function e(t,e,n,r,a,i,o,s){for(var l=t.points,u=t.pointsize,c=0;c<l.length;c+=u){var p=l[c],h=l[c+1];null==p||p<i.min||p>i.max||h<o.min||h>o.max||(at.beginPath(),p=i.p2c(p),h=o.p2c(h)+r,"circle"==s?at.arc(p,h,e,0,a?Math.PI:2*Math.PI,!1):s(at,p,h,e,a),at.closePath(),n&&(at.fillStyle=n,at.fill()),at.stroke())}}at.save(),at.translate(lt.left,lt.top);var n=t.points.lineWidth,r=t.shadowSize,a=t.points.radius,i=t.points.symbol;if(0==n&&(n=1e-4),n>0&&r>0){var o=r/2;at.lineWidth=o,at.strokeStyle="rgba(0,0,0,0.1)",e(t.datapoints,a,null,o+o/2,!0,t.xaxis,t.yaxis,i),at.strokeStyle="rgba(0,0,0,0.2)",e(t.datapoints,a,null,o/2,!0,t.xaxis,t.yaxis,i)}at.lineWidth=n,at.strokeStyle=t.color,e(t.datapoints,a,j(t.points,t.color),0,!1,t.xaxis,t.yaxis,i),at.restore()}function R(t,e,n,r,a,i,o,s,l,u,c){var p,h,d,f,m,g,v,y,b;u?(y=g=v=!0,m=!1,p=n,h=t,f=e+r,d=e+a,h<p&&(b=h,h=p,p=b,m=!0,g=!1)):(m=g=v=!0,y=!1,p=t+r,h=t+a,d=n,(f=e)<d&&(b=f,f=d,d=b,y=!0,v=!1)),h<o.min||p>o.max||f<s.min||d>s.max||(p<o.min&&(p=o.min,m=!1),h>o.max&&(h=o.max,g=!1),d<s.min&&(d=s.min,y=!1),f>s.max&&(f=s.max,v=!1),p=o.p2c(p),d=s.p2c(d),h=o.p2c(h),f=s.p2c(f),i&&(l.fillStyle=i(d,f),l.fillRect(p,f,h-p,d-f)),c>0&&(m||g||v||y)&&(l.beginPath(),l.moveTo(p,d),m?l.lineTo(p,f):l.moveTo(p,f),v?l.lineTo(h,f):l.moveTo(h,f),g?l.lineTo(h,d):l.moveTo(h,d),y?l.lineTo(p,d):l.moveTo(p,d),l.stroke()))}function q(t){at.save(),at.translate(lt.left,lt.top),at.lineWidth=t.bars.lineWidth,at.strokeStyle=t.color;var e;switch(t.bars.align){case"left":e=0;break;case"right":e=-t.bars.barWidth;break;default:e=-t.bars.barWidth/2}var n=t.bars.fill?function(e,n){return j(t.bars,t.color,e,n)}:null;!function(e,n,r,a,i,o){for(var s=e.points,l=e.pointsize,u=0;u<s.length;u+=l)null!=s[u]&&R(s[u],s[u+1],s[u+2],n,r,a,i,o,at,t.bars.horizontal,t.bars.lineWidth)}(t.datapoints,e,e+t.bars.barWidth,n,t.xaxis,t.yaxis),at.restore()}function j(e,n,r,a){var i=e.fill;if(!i)return null;if(e.fillColor)return X(e.fillColor,r,a,n);var o=t.color.parse(n);return o.a="number"==typeof i?i:.4,o.normalize(),o.toString()}function L(){if(null!=tt.legend.container?t(tt.legend.container).html(""):n.find(".legend").remove(),tt.legend.show){for(var e,r,a=[],i=[],o=!1,s=tt.legend.labelFormatter,l=0;l<Z.length;++l)e=Z[l],e.label&&(r=s?s(e.label,e):e.label)&&i.push({label:r,color:e.color});if(tt.legend.sorted)if(t.isFunction(tt.legend.sorted))i.sort(tt.legend.sorted);else if("reverse"==tt.legend.sorted)i.reverse();else{var u="descending"!=tt.legend.sorted;i.sort(function(t,e){return t.label==e.label?0:t.label<e.label!=u?1:-1})}for(var l=0;l<i.length;++l){var c=i[l];l%tt.legend.noColumns==0&&(o&&a.push("</tr>"),a.push("<tr>"),o=!0),a.push('<td class="legendColorBox"><div style="border:1px solid '+tt.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+c.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+c.label+"</td>")}if(o&&a.push("</tr>"),0!=a.length){var p='<table style="font-size:smaller;color:'+tt.grid.color+'">'+a.join("")+"</table>";if(null!=tt.legend.container)t(tt.legend.container).html(p);else{var h="",d=tt.legend.position,f=tt.legend.margin;null==f[0]&&(f=[f,f]),"n"==d.charAt(0)?h+="top:"+(f[1]+lt.top)+"px;":"s"==d.charAt(0)&&(h+="bottom:"+(f[1]+lt.bottom)+"px;"),"e"==d.charAt(1)?h+="right:"+(f[0]+lt.right)+"px;":"w"==d.charAt(1)&&(h+="left:"+(f[0]+lt.left)+"px;");var m=t('<div class="legend">'+p.replace('style="','style="position:absolute;'+h+";")+"</div>").appendTo(n);if(0!=tt.legend.backgroundOpacity){var g=tt.legend.backgroundColor;null==g&&(g=tt.grid.backgroundColor,g=g&&"string"==typeof g?t.color.parse(g):t.color.extract(m,"background-color"),g.a=1,g=g.toString());var v=m.children();t('<div style="position:absolute;width:'+v.width()+"px;height:"+v.height()+"px;"+h+"background-color:"+g+';"> </div>').prependTo(m).css("opacity",tt.legend.backgroundOpacity)}}}}}function N(t,e,n){var r,a,i,o=tt.grid.mouseActiveRadius,s=o*o+1,l=null;for(r=Z.length-1;r>=0;--r)if(n(Z[r])){var u=Z[r],c=u.xaxis,p=u.yaxis,h=u.datapoints.points,d=c.c2p(t),f=p.c2p(e),m=o/c.scale,g=o/p.scale;if(i=u.datapoints.pointsize,c.options.inverseTransform&&(m=Number.MAX_VALUE),p.options.inverseTransform&&(g=Number.MAX_VALUE),u.lines.show||u.points.show)for(a=0;a<h.length;a+=i){var v=h[a],y=h[a+1];if(null!=v&&!(v-d>m||v-d<-m||y-f>g||y-f<-g)){var b=Math.abs(c.p2c(v)-t),x=Math.abs(p.p2c(y)-e),S=b*b+x*x;S<s&&(s=S,l=[r,a/i])}}if(u.bars.show&&!l){var w,k;switch(u.bars.align){case"left":w=0;break;case"right":w=-u.bars.barWidth;break;default:w=-u.bars.barWidth/2}for(k=w+u.bars.barWidth,a=0;a<h.length;a+=i){var v=h[a],y=h[a+1],_=h[a+2];null!=v&&((Z[r].bars.horizontal?d<=Math.max(_,v)&&d>=Math.min(_,v)&&f>=y+w&&f<=y+k:d>=v+w&&d<=v+k&&f>=Math.min(_,y)&&f<=Math.max(_,y))&&(l=[r,a/i]))}}}return l?(r=l[0],a=l[1],i=Z[r].datapoints.pointsize,{datapoint:Z[r].datapoints.points.slice(a*i,(a+1)*i),dataIndex:a,series:Z[r],seriesIndex:r}):null}function V(t){tt.grid.hoverable&&z("plothover",t,function(t){return 0!=t.hoverable})}function U(t){tt.grid.hoverable&&z("plothover",t,function(t){return!1})}function B(t){ht.isSelecting||z("plotclick",t,function(t){return 0!=t.clickable})}function z(t,e,r){var a=rt.offset(),i=e.pageX-a.left-lt.left,o=e.pageY-a.top-lt.top,s=h({left:i,top:o});s.pageX=e.pageX,s.pageY=e.pageY,s.ctrlKey=e.ctrlKey,s.metaKey=e.metaKey;var l=N(i,o,r);if(l&&(l.pageX=parseInt(l.series.xaxis.p2c(l.datapoint[0])+a.left+lt.left,10),l.pageY=parseInt(l.series.yaxis.p2c(l.datapoint[1])+a.top+lt.top,10)),tt.grid.autoHighlight){for(var u=0;u<dt.length;++u){var c=dt[u];c.auto!=t||l&&c.series==l.series&&c.point[0]==l.datapoint[0]&&c.point[1]==l.datapoint[1]||W(c.series,c.point)}l&&Y(l.series,l.datapoint,t)}n.trigger(t,[s,l])}function Q(){var t=tt.interaction.redrawOverlayInterval;if(-1==t)return void H();ft||(ft=setTimeout(H,t))}function H(){ft=null,it.save(),nt.clear(),it.translate(lt.left,lt.top);var t,e;for(t=0;t<dt.length;++t)e=dt[t],e.series.bars.show?J(e.series,e.point):K(e.series,e.point);it.restore(),s(pt.drawOverlay,[it])}function Y(t,e,n){if("number"==typeof t&&(t=Z[t]),"number"==typeof e){var r=t.datapoints.pointsize;e=t.datapoints.points.slice(r*e,r*(e+1))}var a=G(t,e);-1==a?(dt.push({series:t,point:e,auto:n}),Q()):n||(dt[a].auto=!1)}function W(t,e){if(null==t&&null==e)return dt=[],void Q();if("number"==typeof t&&(t=Z[t]),"number"==typeof e){var n=t.datapoints.pointsize;e=t.datapoints.points.slice(n*e,n*(e+1))}var r=G(t,e);-1!=r&&(dt.splice(r,1),Q())}function G(t,e){for(var n=0;n<dt.length;++n){var r=dt[n];if(r.series==t&&r.point[0]==e[0]&&r.point[1]==e[1])return n}return-1}function K(e,n){var r=n[0],a=n[1],i=e.xaxis,o=e.yaxis,s="string"==typeof e.highlightColor?e.highlightColor:t.color.parse(e.color).scale("a",.5).toString();if(!(r<i.min||r>i.max||a<o.min||a>o.max)){var l=e.points.radius+e.points.lineWidth/2;it.lineWidth=l,it.strokeStyle=s;var u=1.5*l;r=i.p2c(r),a=o.p2c(a),it.beginPath(),"circle"==e.points.symbol?it.arc(r,a,u,0,2*Math.PI,!1):e.points.symbol(it,r,a,u,!1),it.closePath(),it.stroke()}}function J(e,n){var r,a="string"==typeof e.highlightColor?e.highlightColor:t.color.parse(e.color).scale("a",.5).toString(),i=a;switch(e.bars.align){case"left":r=0;break;case"right":r=-e.bars.barWidth;break;default:r=-e.bars.barWidth/2}it.lineWidth=e.bars.lineWidth,it.strokeStyle=a,R(n[0],n[1],n[2]||0,r,r+e.bars.barWidth,function(){return i},e.xaxis,e.yaxis,it,e.bars.horizontal,e.bars.lineWidth)}function X(e,n,r,a){if("string"==typeof e)return e;for(var i=at.createLinearGradient(0,r,0,n),o=0,s=e.colors.length;o<s;++o){var l=e.colors[o];if("string"!=typeof l){var u=t.color.parse(a);null!=l.brightness&&(u=u.scale("rgb",l.brightness)),null!=l.opacity&&(u.a*=l.opacity),l=u.toString()}i.addColorStop(o/(s-1),l)}return i}var Z=[],tt={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:1e3/60},hooks:{}},et=null,nt=null,rt=null,at=null,it=null,ot=[],st=[],lt={left:0,right:0,top:0,bottom:0},ut=0,ct=0,pt={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},ht=this;ht.setData=l,ht.setupGrid=k,ht.draw=P,ht.getPlaceholder=function(){return n},ht.getCanvas=function(){return et.element},ht.getPlotOffset=function(){return lt},ht.width=function(){return ut},ht.height=function(){return ct},ht.offset=function(){var t=rt.offset();return t.left+=lt.left,t.top+=lt.top,t},ht.getData=function(){return Z},ht.getAxes=function(){var e={};return t.each(ot.concat(st),function(t,n){n&&(e[n.direction+(1!=n.n?n.n:"")+"axis"]=n)}),e},ht.getXAxes=function(){return ot},ht.getYAxes=function(){return st},ht.c2p=h,ht.p2c=d,ht.getOptions=function(){return tt},ht.highlight=Y,ht.unhighlight=W,ht.triggerRedrawOverlay=Q,ht.pointOffset=function(t){return{left:parseInt(ot[c(t,"x")-1].p2c(+t.x)+lt.left,10),top:parseInt(st[c(t,"y")-1].p2c(+t.y)+lt.top,10)}},ht.shutdown=v,ht.destroy=function(){v(),n.removeData("plot").empty(),Z=[],tt=null,et=null,nt=null,rt=null,at=null,it=null,ot=[],st=[],pt=null,dt=[],ht=null},ht.resize=function(){var t=n.width(),e=n.height();et.resize(t,e),nt.resize(t,e)},ht.hooks=pt,function(){for(var n={Canvas:e},r=0;r<o.length;++r){var a=o[r];a.init(ht,n),a.options&&t.extend(!0,tt,a.options)}}(),function(e){t.extend(!0,tt,e),e&&e.colors&&(tt.colors=e.colors),null==tt.xaxis.color&&(tt.xaxis.color=t.color.parse(tt.grid.color).scale("a",.22).toString()),null==tt.yaxis.color&&(tt.yaxis.color=t.color.parse(tt.grid.color).scale("a",.22).toString()),null==tt.xaxis.tickColor&&(tt.xaxis.tickColor=tt.grid.tickColor||tt.xaxis.color),null==tt.yaxis.tickColor&&(tt.yaxis.tickColor=tt.grid.tickColor||tt.yaxis.color),null==tt.grid.borderColor&&(tt.grid.borderColor=tt.grid.color),null==tt.grid.tickColor&&(tt.grid.tickColor=t.color.parse(tt.grid.color).scale("a",.22).toString());var r,a,i,o=n.css("font-size"),l=o?+o.replace("px",""):13,u={style:n.css("font-style"),size:Math.round(.8*l),variant:n.css("font-variant"),weight:n.css("font-weight"),family:n.css("font-family")};for(i=tt.xaxes.length||1,r=0;r<i;++r)a=tt.xaxes[r],a&&!a.tickColor&&(a.tickColor=a.color),a=t.extend(!0,{},tt.xaxis,a),tt.xaxes[r]=a,a.font&&(a.font=t.extend({},u,a.font),a.font.color||(a.font.color=a.color),a.font.lineHeight||(a.font.lineHeight=Math.round(1.15*a.font.size)));for(i=tt.yaxes.length||1,r=0;r<i;++r)a=tt.yaxes[r],a&&!a.tickColor&&(a.tickColor=a.color),a=t.extend(!0,{},tt.yaxis,a),tt.yaxes[r]=a,a.font&&(a.font=t.extend({},u,a.font),a.font.color||(a.font.color=a.color),a.font.lineHeight||(a.font.lineHeight=Math.round(1.15*a.font.size)));for(tt.xaxis.noTicks&&null==tt.xaxis.ticks&&(tt.xaxis.ticks=tt.xaxis.noTicks),tt.yaxis.noTicks&&null==tt.yaxis.ticks&&(tt.yaxis.ticks=tt.yaxis.noTicks),tt.x2axis&&(tt.xaxes[1]=t.extend(!0,{},tt.xaxis,tt.x2axis),tt.xaxes[1].position="top",null==tt.x2axis.min&&(tt.xaxes[1].min=null),null==tt.x2axis.max&&(tt.xaxes[1].max=null)),tt.y2axis&&(tt.yaxes[1]=t.extend(!0,{},tt.yaxis,tt.y2axis),tt.yaxes[1].position="right",null==tt.y2axis.min&&(tt.yaxes[1].min=null),null==tt.y2axis.max&&(tt.yaxes[1].max=null)),tt.grid.coloredAreas&&(tt.grid.markings=tt.grid.coloredAreas),tt.grid.coloredAreasColor&&(tt.grid.markingsColor=tt.grid.coloredAreasColor),tt.lines&&t.extend(!0,tt.series.lines,tt.lines),tt.points&&t.extend(!0,tt.series.points,tt.points),tt.bars&&t.extend(!0,tt.series.bars,tt.bars),null!=tt.shadowSize&&(tt.series.shadowSize=tt.shadowSize),null!=tt.highlightColor&&(tt.series.highlightColor=tt.highlightColor),r=0;r<tt.xaxes.length;++r)f(ot,r+1).options=tt.xaxes[r];for(r=0;r<tt.yaxes.length;++r)f(st,r+1).options=tt.yaxes[r];for(var c in pt)tt.hooks[c]&&tt.hooks[c].length&&(pt[c]=pt[c].concat(tt.hooks[c]));s(pt.processOptions,[tt])}(i),function(){n.find(".flot-temp-elem").remove(),"static"==n.css("position")&&n.css("position","relative"),et=new e("flot-base",n),nt=new e("flot-overlay",n),at=et.context,it=nt.context,rt=t(nt.element).unbind();var r=n.data("plot");r&&(r.shutdown(),nt.clear()),n.data("plot",ht)}(),l(a),k(),P(),function(){tt.grid.hoverable&&(rt.mousemove(V),rt.bind("mouseleave",U)),tt.grid.clickable&&rt.click(B),s(pt.bindEvents,[rt])}();var dt=[],ft=null}function r(t,e){return e*Math.floor(t/e)}var a=Object.prototype.hasOwnProperty;t.fn.detach||(t.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})}),e.prototype.resize=function(t,e){if(t<=0||e<=0)throw new Error("Invalid dimensions for plot, width = "+t+", height = "+e);var n=this.element,r=this.context,a=this.pixelRatio;this.width!=t&&(n.width=t*a,n.style.width=t+"px",this.width=t),this.height!=e&&(n.height=e*a,n.style.height=e+"px",this.height=e),r.restore(),r.save(),r.scale(a,a)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var t=this._textCache;for(var e in t)if(a.call(t,e)){var n=this.getTextLayer(e),r=t[e];n.hide();for(var i in r)if(a.call(r,i)){var o=r[i];for(var s in o)if(a.call(o,s)){for(var l,u=o[s].positions,c=0;l=u[c];c++)l.active?l.rendered||(n.append(l.element),l.rendered=!0):(u.splice(c--,1),l.rendered&&l.element.detach());0==u.length&&delete o[s]}}n.show()}},e.prototype.getTextLayer=function(e){var n=this.text[e];return null==n&&(null==this.textContainer&&(this.textContainer=t("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),n=this.text[e]=t("<div></div>").addClass(e).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),n},e.prototype.getTextInfo=function(e,n,r,a,i){var o,s,l,u;if(n=""+n,o="object"==typeof r?r.style+" "+r.variant+" "+r.weight+" "+r.size+"px/"+r.lineHeight+"px "+r.family:r,s=this._textCache[e],null==s&&(s=this._textCache[e]={}),l=s[o],null==l&&(l=s[o]={}),null==(u=l[n])){var c=t("<div></div>").html(n).css({position:"absolute","max-width":i,top:-9999}).appendTo(this.getTextLayer(e));"object"==typeof r?c.css({font:o,color:r.color}):"string"==typeof r&&c.addClass(r),u=l[n]={element:c,positions:[]};var p=this._textSizeCache[n];p?(u.width=p.width,u.height=p.height):(u.width=c.outerWidth(!0),u.height=c.outerHeight(!0),this._textSizeCache[n]={width:u.width,height:u.height}),c.detach()}return u},e.prototype.addText=function(t,e,n,r,a,i,o,s,l){var u=this.getTextInfo(t,r,a,i,o),c=u.positions;"center"==s?e-=u.width/2:"right"==s&&(e-=u.width),"middle"==l?n-=u.height/2:"bottom"==l&&(n-=u.height);for(var p,h=0;p=c[h];h++)if(p.x==e&&p.y==n)return void(p.active=!0);p={active:!0,rendered:!1,element:c.length?u.element.clone():u.element,x:e,y:n},c.push(p),p.element.css({top:Math.round(n),left:Math.round(e),"text-align":s})},e.prototype.removeText=function(t,e,n,r,i,o){if(null==r){var s=this._textCache[t];if(null!=s)for(var l in s)if(a.call(s,l)){var u=s[l];for(var c in u)if(a.call(u,c))for(var p,h=u[c].positions,d=0;p=h[d];d++)p.active=!1}}else for(var p,h=this.getTextInfo(t,r,i,o).positions,d=0;p=h[d];d++)p.x==e&&p.y==n&&(p.active=!1)},t.plot=function(e,r,a){return new n(t(e),r,a,t.plot.plugins)},t.plot.version="0.8.3",t.plot.plugins=[],t.fn.plot=function(e,n){return this.each(function(){t.plot(this,e,n)})}}(jQuery)},1316:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1396),a=n(1399),i=n(1400),o=n(1326),s=n(1401);n.d(e,"AnnotationsSrv",function(){return r.a}),n.d(e,"eventEditor",function(){return a.a}),n.d(e,"EventManager",function(){return i.a}),n.d(e,"AnnotationEvent",function(){return o.a}),n.d(e,"annotationTooltipDirective",function(){return s.a})},1317:function(t,e,n){"use strict";function r(t,e){s.a.registerDynamic(t,[],!0,function(t,n,r){r.exports=e})}function a(t){var e=C.a[t];return e?Promise.resolve(e):s.a.import(t)}function i(t){y.default.bootData.user.lightTheme?s.a.import(t.light+"!css"):s.a.import(t.dark+"!css")}Object.defineProperty(e,"__esModule",{value:!0}),e.importPluginModule=a,e.loadPluginCss=i;var o=n(1420),s=n.n(o),l=n(7),u=n.n(l),c=n(1305),p=n(464),h=n(1),d=n.n(h),f=n(12),m=n.n(f),g=n(13),v=n.n(g),y=n(27),b=n(1309),x=n(1310),S=n(465),w=n(467),k=n(1324),_=n(1328),M=n(1314),T=n(1312),C=n(1431),P=n(470),O=n(466),A=(n.n(O),n(1515)),E=(n.n(A),n(1518)),D=(n.n(E),n(1520)),$=(n.n(D),n(1529)),I=(n.n($),n(1532)),F=(n.n(I),n(1316)),R=n(1341),q=n(1315),j=(n.n(q),n(1334)),L=(n.n(j),n(1335)),N=(n.n(L),n(1336)),V=(n.n(N),n(1539)),U=(n.n(V),n(1337)),B=(n.n(U),n(1338)),z=(n.n(B),n(1339)),Q=(n.n(z),n(1340));n.n(Q);s.a.config({baseURL:"public",defaultExtension:"js",packages:{plugins:{defaultExtension:"js"}},map:{text:"vendor/plugin-text/text.js",css:"vendor/plugin-css/css.js"},meta:{"*":{esModule:!0,authorization:!0}}});var H=s.a.locate;s.a.cacheBust="?bust="+Date.now(),s.a.locate=function(t){var e=this;return Promise.resolve(H.call(this,t)).then(function(t){return t+e.cacheBust})},r("lodash",u.a),r("moment",d.a),r("jquery",v.a),r("angular",m.a),r("d3",P),r("rxjs/Subject",A.Subject),r("rxjs/Observable",O.Observable),r("vendor/npm/rxjs/Rx",{Subject:A.Subject,Observable:O.Observable}),r("app/features/dashboard/impression_store",{impressions:T.impressions,__esModule:!0}),r("app/features/annotations/all",F.EventManager),r("app/plugins/panel/graph/graph",{name:1}),r("app/plugins/panel/graph/legend",{name:2}),r("app/plugins/panel/graph/data_processor",R.a),r("app/plugins/sdk",c),r("app/core/utils/datemath",w),r("app/core/utils/file_export",k),r("app/core/utils/flatten",_),r("app/core/utils/kbn",p.default),r("app/core/utils/ticks",M),r("app/core/config",y.default),r("app/core/time_series",b.a),r("app/core/time_series2",b.a),r("app/core/table_model",x.default),r("app/core/app_events",S.appEvents),r("app/core/core_module",S.coreModule),r("app/core/core",{coreModule:S.coreModule,appEvents:S.appEvents,contextSrv:S.contextSrv,__esModule:!0});for(var Y=["jquery.flot","jquery.flot.pie","jquery.flot.time","jquery.flot.fillbelow","jquery.flot.crosshair","jquery.flot.stack","jquery.flot.selection","jquery.flot.stackpercent","jquery.flot.events"],W=0,G=Y;W<G.length;W++){r(G[W],{fakeDep:1})}},1318:function(t,e,n){"use strict";function r(t){t.params=t.params||[],t.defaultParams=t.defaultParams||[],t.category&&t.category.push(t),c[t.name]=t,c[t.shortName||t.name]=t}function a(t,e){this.def=t,this.params=[],e&&e.withDefaultParams&&(this.params=t.defaultParams.slice(0)),this.updateText()}function i(t){return!isNaN(parseFloat(t))&&isFinite(t)}function o(t,e){return Object(u.b)(e,t.version)||!t.version}Object.defineProperty(e,"__esModule",{value:!0});var s=n(7),l=n.n(s),u=n(1329),c=[],p={Combine:[],Transform:[],Calculate:[],Filter:[],Special:[]},h=[{name:"other",type:"value_or_series",optional:!0},{name:"other",type:"value_or_series",optional:!0},{name:"other",type:"value_or_series",optional:!0},{name:"other",type:"value_or_series",optional:!0},{name:"other",type:"value_or_series",optional:!0}];r({name:"scaleToSeconds",category:p.Transform,params:[{name:"seconds",type:"int"}],defaultParams:[1]}),r({name:"perSecond",category:p.Transform,params:[{name:"max value",type:"int",optional:!0}],defaultParams:[]}),r({name:"holtWintersForecast",category:p.Calculate}),r({name:"holtWintersConfidenceBands",category:p.Calculate,params:[{name:"delta",type:"int"}],defaultParams:[3]}),r({name:"holtWintersAberration",category:p.Calculate,params:[{name:"delta",type:"int"}],defaultParams:[3]}),r({name:"nPercentile",category:p.Calculate,params:[{name:"Nth percentile",type:"int"}],defaultParams:[95]}),r({name:"diffSeries",params:h,defaultParams:["#A"],category:p.Calculate}),r({name:"stddevSeries",params:h,defaultParams:[""],category:p.Calculate}),r({name:"divideSeries",params:h,defaultParams:["#A"],category:p.Calculate}),r({name:"multiplySeries",params:h,defaultParams:["#A"],category:p.Calculate}),r({name:"asPercent",params:h,defaultParams:["#A"],category:p.Calculate}),r({name:"group",params:h,defaultParams:["#A","#B"],category:p.Combine}),r({name:"sumSeries",shortName:"sum",category:p.Combine,params:h,defaultParams:[""]}),r({name:"averageSeries",shortName:"avg",category:p.Combine,params:h,defaultParams:[""]}),r({name:"rangeOfSeries",category:p.Combine}),r({name:"percentileOfSeries",category:p.Combine,params:[{name:"n",type:"int"},{name:"interpolate",type:"boolean",options:["true","false"]}],defaultParams:[95,"false"]}),r({name:"sumSeriesWithWildcards",category:p.Combine,params:[{name:"node",type:"int"},{name:"node",type:"int",optional:!0},{name:"node",type:"int",optional:!0},{name:"node",type:"int",optional:!0}],defaultParams:[3]}),r({name:"maxSeries",shortName:"max",category:p.Combine}),r({name:"minSeries",shortName:"min",category:p.Combine}),r({name:"averageSeriesWithWildcards",category:p.Combine,params:[{name:"node",type:"int"},{name:"node",type:"int",optional:!0}],defaultParams:[3]}),r({name:"alias",category:p.Special,params:[{name:"alias",type:"string"}],defaultParams:["alias"]}),r({name:"aliasSub",category:p.Special,params:[{name:"search",type:"string"},{name:"replace",type:"string"}],defaultParams:["","\\1"]}),r({name:"stacked",category:p.Special,params:[{name:"stack",type:"string"}],defaultParams:["stacked"]}),r({name:"consolidateBy",category:p.Special,params:[{name:"function",type:"string",options:["sum","average","min","max"]}],defaultParams:["max"]}),r({name:"cumulative",category:p.Special,params:[],defaultParams:[]}),r({name:"groupByNode",category:p.Special,params:[{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]},{name:"function",type:"string",options:["sum","avg","maxSeries"]}],defaultParams:[3,"sum"]}),r({name:"aliasByNode",category:p.Special,params:[{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0}],defaultParams:[3]}),r({name:"substr",category:p.Special,params:[{name:"start",type:"int",options:[-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,12]},{name:"stop",type:"int",options:[-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9,10,12]}],defaultParams:[0,0]}),r({name:"sortByName",category:p.Special,params:[{name:"natural",type:"boolean",options:["true","false"],optional:!0}],defaultParams:["false"]}),r({name:"sortByMaxima",category:p.Special}),r({name:"sortByMinima",category:p.Special}),r({name:"sortByTotal",category:p.Special}),r({name:"aliasByMetric",category:p.Special}),r({name:"randomWalk",fake:!0,category:p.Special,params:[{name:"name",type:"string"}],defaultParams:["randomWalk"]}),r({name:"countSeries",category:p.Special}),r({name:"constantLine",category:p.Special,params:[{name:"value",type:"int"}],defaultParams:[10]}),r({name:"cactiStyle",category:p.Special}),r({name:"keepLastValue",category:p.Special,params:[{name:"n",type:"int"}],defaultParams:[100]}),r({name:"changed",category:p.Special,params:[],defaultParams:[]}),r({name:"scale",category:p.Transform,params:[{name:"factor",type:"int"}],defaultParams:[1]}),r({name:"offset",category:p.Transform,params:[{name:"amount",type:"int"}],defaultParams:[10]}),r({name:"transformNull",category:p.Transform,params:[{name:"amount",type:"int"}],defaultParams:[0]}),r({name:"integral",category:p.Transform}),r({name:"derivative",category:p.Transform}),r({name:"nonNegativeDerivative",category:p.Transform,params:[{name:"max value or 0",type:"int",optional:!0}],defaultParams:[""]}),r({name:"timeShift",category:p.Transform,params:[{name:"amount",type:"select",options:["1h","6h","12h","1d","2d","7d","14d","30d"]}],defaultParams:["1d"]}),r({name:"timeStack",category:p.Transform,params:[{name:"timeShiftUnit",type:"select",options:["1h","6h","12h","1d","2d","7d","14d","30d"]},{name:"timeShiftStart",type:"int"},{name:"timeShiftEnd",type:"int"}],defaultParams:["1d",0,7]}),r({name:"summarize",category:p.Transform,params:[{name:"interval",type:"string"},{name:"func",type:"select",options:["sum","avg","min","max","last"]},{name:"alignToFrom",type:"boolean",optional:!0,options:["false","true"]}],defaultParams:["1h","sum","false"]}),r({name:"smartSummarize",category:p.Transform,params:[{name:"interval",type:"string"},{name:"func",type:"select",options:["sum","avg","min","max","last"]}],defaultParams:["1h","sum"]}),r({name:"absolute",category:p.Transform}),r({name:"hitcount",category:p.Transform,params:[{name:"interval",type:"string"}],defaultParams:["10s"]}),r({name:"log",category:p.Transform,params:[{name:"base",type:"int"}],defaultParams:["10"]}),r({name:"averageAbove",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[25]}),r({name:"averageBelow",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[25]}),r({name:"currentAbove",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[25]}),r({name:"currentBelow",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[25]}),r({name:"maximumAbove",category:p.Filter,params:[{name:"value",type:"int"}],defaultParams:[0]}),r({name:"maximumBelow",category:p.Filter,params:[{name:"value",type:"int"}],defaultParams:[0]}),r({name:"minimumAbove",category:p.Filter,params:[{name:"value",type:"int"}],defaultParams:[0]}),r({name:"minimumBelow",category:p.Filter,params:[{name:"value",type:"int"}],defaultParams:[0]}),r({name:"limit",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),r({name:"mostDeviant",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[10]}),r({name:"exclude",category:p.Filter,params:[{name:"exclude",type:"string"}],defaultParams:["exclude"]}),r({name:"highestCurrent",category:p.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),r({name:"highestMax",category:p.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),r({name:"lowestCurrent",category:p.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),r({name:"movingAverage",category:p.Filter,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10]}),r({name:"movingMedian",category:p.Filter,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:["5"]}),r({name:"stdev",category:p.Filter,params:[{name:"n",type:"int"},{name:"tolerance",type:"int"}],defaultParams:[5,.1]}),r({name:"highestAverage",category:p.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),r({name:"lowestAverage",category:p.Filter,params:[{name:"count",type:"int"}],defaultParams:[5]}),r({name:"removeAbovePercentile",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),r({name:"removeAboveValue",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),r({name:"removeBelowPercentile",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),r({name:"removeBelowValue",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[5]}),r({name:"useSeriesAbove",category:p.Filter,params:[{name:"value",type:"int"},{name:"search",type:"string"},{name:"replace",type:"string"}],defaultParams:[0,"search","replace"]}),r({name:"aggregateLine",category:p.Combine,params:[{name:"func",type:"select",options:["sum","avg","min","max","last"]}],defaultParams:["avg"],version:"1.0"}),r({name:"averageOutsidePercentile",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[95],version:"1.0"}),r({name:"delay",category:p.Transform,params:[{name:"steps",type:"int"}],defaultParams:[1],version:"1.0"}),r({name:"exponentialMovingAverage",category:p.Calculate,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),r({name:"fallbackSeries",category:p.Special,params:[{name:"fallback",type:"string"}],defaultParams:["constantLine(0)"],version:"1.0"}),r({name:"grep",category:p.Filter,params:[{name:"grep",type:"string"}],defaultParams:["grep"],version:"1.0"}),r({name:"groupByNodes",category:p.Special,params:[{name:"function",type:"string",options:["sum","avg","maxSeries"]},{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"node",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0}],defaultParams:["sum",3],version:"1.0"}),r({name:"integralByInterval",category:p.Transform,params:[{name:"intervalUnit",type:"select",options:["1h","6h","12h","1d","2d","7d","14d","30d"]}],defaultParams:["1d"],version:"1.0"}),r({name:"interpolate",category:p.Transform,params:[{name:"limit",type:"int",optional:!0}],defaultParams:[],version:"1.0"}),r({name:"invert",category:p.Transform,version:"1.0"}),r({name:"isNonNull",category:p.Combine,version:"1.0"}),r({name:"linearRegression",category:p.Calculate,params:[{name:"startSourceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"],optional:!0},{name:"endSourceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"],optional:!0}],defaultParams:[],version:"1.0"}),r({name:"mapSeries",shortName:"map",params:[{name:"node",type:"int"}],defaultParams:[3],category:p.Combine,version:"1.0"}),r({name:"movingMin",category:p.Calculate,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),r({name:"movingMax",category:p.Calculate,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),r({name:"movingSum",category:p.Calculate,params:[{name:"windowSize",type:"int_or_interval",options:["5","7","10","5min","10min","30min","1hour"]}],defaultParams:[10],version:"1.0"}),r({name:"multiplySeriesWithWildcards",category:p.Calculate,params:[{name:"position",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]},{name:"position",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"position",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0},{name:"position",type:"int",options:[0,-1,-2,-3,-4,-5,-6,-7],optional:!0}],defaultParams:[2],version:"1.0"}),r({name:"offsetToZero",category:p.Transform,version:"1.0"}),r({name:"pow",category:p.Transform,params:[{name:"factor",type:"int"}],defaultParams:[10],version:"1.0"}),r({name:"powSeries",category:p.Transform,params:h,defaultParams:[""],version:"1.0"}),r({name:"reduceSeries",shortName:"reduce",params:[{name:"function",type:"string",options:["asPercent","diffSeries","divideSeries"]},{name:"reduceNode",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,11,12,13]},{name:"reduceMatchers",type:"string"},{name:"reduceMatchers",type:"string"}],defaultParams:["asPercent",2,"used_bytes","total_bytes"],category:p.Combine,version:"1.0"}),r({name:"removeBetweenPercentile",category:p.Filter,params:[{name:"n",type:"int"}],defaultParams:[95],version:"1.0"}),r({name:"removeEmptySeries",category:p.Filter,version:"1.0"}),r({name:"squareRoot",category:p.Transform,version:"1.0"}),r({name:"timeSlice",category:p.Transform,params:[{name:"startSliceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"]},{name:"endSliceAt",type:"select",options:["-1h","-6h","-12h","-1d","-2d","-7d","-14d","-30d"],optional:!0}],defaultParams:["-1h"],version:"1.0"}),r({name:"weightedAverage",category:p.Filter,params:[{name:"other",type:"value_or_series",optional:!0},{name:"node",type:"int",options:[0,1,2,3,4,5,6,7,8,9,10,12]}],defaultParams:["#A",4],version:"1.0"}),r({name:"seriesByTag",category:p.Special,params:[{name:"tagExpression",type:"string"},{name:"tagExpression",type:"string",optional:!0},{name:"tagExpression",type:"string",optional:!0},{name:"tagExpression",type:"string",optional:!0}],version:"1.1"}),r({name:"groupByTags",category:p.Special,params:[{name:"function",type:"string",options:["sum","avg","maxSeries"]},{name:"tag",type:"string"},{name:"tag",type:"string",optional:!0},{name:"tag",type:"string",optional:!0},{name:"tag",type:"string",optional:!0}],defaultParams:["sum","tag"],version:"1.1"}),r({name:"aliasByTags",category:p.Special,params:[{name:"tag",type:"string"},{name:"tag",type:"string",optional:!0},{name:"tag",type:"string",optional:!0},{name:"tag",type:"string",optional:!0}],defaultParams:["tag"],version:"1.1"}),l.a.each(p,function(t,e){p[e]=l.a.sortBy(t,"name")}),a.prototype.render=function(t){var e=this.def.name+"(",n=l.a.map(this.params,function(t,e){var n=this.def.params[e].type;return"int"===n||"value_or_series"===n||"boolean"===n?t:"int_or_interval"===n&&i(t)?t:"'"+t+"'"}.bind(this));return t&&n.unshift(t),e+n.join(", ")+")"},a.prototype._hasMultipleParamsInString=function(t,e){return-1!==t.indexOf(",")&&(this.def.params[e+1]&&this.def.params[e+1].optional)},a.prototype.updateParam=function(t,e){if(this._hasMultipleParamsInString(t,e))return void l.a.each(t.split(","),function(t,n){this.updateParam(t.trim(),e+n)}.bind(this));""===t&&this.def.params[e].optional?this.params.splice(e,1):this.params[e]=t,this.updateText()},a.prototype.updateText=function(){if(0===this.params.length)return void(this.text=this.def.name+"()");var t=this.def.name+"(";t+=this.params.join(", "),t+=")",this.text=t},e.default={createFuncInstance:function(t,e){if(l.a.isString(t)){if(!c[t])throw{message:"Method not found "+name};t=c[t]}return new a(t,e)},getFuncDef:function(t){return c[t]},getCategories:function(t){var e={};return l.a.each(p,function(n,r){var a=l.a.filter(n,function(e){return o(e,t)});a.length&&(e[r]=a)}),e}}},1319:function(t,e,n){"use strict";function r(t){for(var e={},n=0,r=t;n<r.length;n++){var a=r[n],i=Number(a.alias);if(isNaN(i))return e;for(var o=0,s=a.datapoints;o<s.length;o++){var l=s[o],u=l[S],c=l[w];if(x.a.isNumber(u)){var p=e[c];p||(p=e[c]={x:c,buckets:{}}),p.buckets[i]={y:i,count:u,values:[],points:[]}}}}return e}function a(t){var e=0,n=0,r=[];return x.a.forEach(t,function(t){x.a.forEach(t.buckets,function(a){var i={x:t.x,y:a.y,yBounds:a.bounds,values:a.values,count:a.count};r.push(i),1===r.length&&(e=a.count,n=a.count),e=a.count<e?a.count:e,n=a.count>n?a.count:n})}),{cards:r,cardStats:{min:e,max:n}}}function i(t,e){return x.a.forEach(t,function(t){var n=t.buckets,r={bounds:{bottom:0,top:0},values:[],points:[],count:0},a=n[0]||r,i=n[e]||r,o={y:0,bounds:{bottom:e,top:i.bounds.top||e},values:[],points:[],count:0};o.points=a.points.concat(i.points),o.values=a.values.concat(i.values),o.count=o.values.length,0!==o.count&&(delete n[e],n[0]=o)}),t}function o(t,e,n,r){void 0===r&&(r=1);for(var a={},i=0,o=t;i<o.length;i++){var l=o[i];!function(t){var e=t.datapoints,r=t.label;x.a.forEach(e,function(t){var e=p(t[w],n);s(a,t,e,r)})}(l)}return x.a.forEach(a,function(t){t.buckets=1!==r?m(t,e,r):h(t,e)}),a}function s(t,e,n,r){var a=e[S];if(null!==a&&void 0!==a&&!isNaN(a)){var i=x.a.concat(e,r);t[n]&&t[n].values?(t[n].values.push(a),t[n].points.push(i)):t[n]={x:n,values:[a],points:[i]}}}function l(t,e,n,r,a){var i=1;r.length>3&&(i=parseInt(r[2])),t[e]?(t[e].values.push(n),t[e].points.push(r),t[e].count+=i):t[e]={y:e,bounds:a,values:[n],points:[r],count:i}}function u(t,e,n){return 1===n?p(t,e):f(t,e,n)}function c(t,e){var n,r;return n=Math.floor(t/e)*e,r=(Math.floor(t/e)+1)*e,{bottom:n,top:r}}function p(t,e){return c(t,e).bottom}function h(t,e){var n=t.values,r=t.points,a={};return x.a.forEach(n,function(t,n){var i=c(t,e),o=i.bottom;l(a,o,t,r[n],i)}),a}function d(t,e,n){var r,a;if(0===t)return{bottom:0,top:0};var i,o,s=g(t,n);if(1!==e&&e){var l=1/e,u=s-Math.floor(s);u=Math.floor(u/l)*l,i=Math.floor(s)+u,o=i+l}else i=Math.floor(s),o=i+1;return a=Math.pow(n,i),r=Math.pow(n,o),{bottom:a,top:r}}function f(t,e,n){return d(t,e,n).bottom}function m(t,e,n){var r=t.values,a=t.points,i={};return x.a.forEach(r,function(t,r){var o=d(t,e,n),s=o.bottom;l(i,s,t,a[r],o)}),i}function g(t,e){return Math.log(t)/Math.log(e)}function v(t,e){void 0===e&&(e=1);var n=1/0;if(0===t.length)return 0;if(1===t.length)return t[0];t=x.a.sortBy(t);for(var r=1;r<t.length;r++){var a=y(t[r],t[r-1],e);n=a<n?a:n}return n}function y(t,e,n){return void 0===n&&(n=1),1===n?Math.abs(e-t):g(Math.max(t,e)/Math.min(t,e),n)}n.d(e,"c",function(){return o}),n.d(e,"d",function(){return r}),n.d(e,"b",function(){return a}),n.d(e,"f",function(){return i}),n.d(e,"e",function(){return u}),n.d(e,"a",function(){return v});var b=n(7),x=n.n(b),S=0,w=1},1320:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(466),i=function(t){function e(e){t.call(this),this.scheduler=e}return r(e,t),e.create=function(t){return new e(t)},e.dispatch=function(t){t.subscriber.complete()},e.prototype._subscribe=function(t){var n=this.scheduler;if(n)return n.schedule(e.dispatch,0,{subscriber:t});t.complete()},e}(a.Observable);e.EmptyObservable=i},1321:function(t,e,n){"use strict";function r(t){var e=t.Symbol;if("function"==typeof e)return e.iterator||(e.iterator=e("iterator polyfill")),e.iterator;var n=t.Set;if(n&&"function"==typeof(new n)["@@iterator"])return"@@iterator";var r=t.Map;if(r)for(var a=Object.getOwnPropertyNames(r.prototype),i=0;i<a.length;++i){var o=a[i];if("entries"!==o&&"size"!==o&&r.prototype[o]===r.prototype.entries)return o}return"@@iterator"}var a=n(127);e.symbolIteratorPonyfill=r,e.iterator=r(a.root),e.$$iterator=e.iterator},1323:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(7),a=n.n(r),i=n(465),o=function(){function t(t){this.model=t,this.defaults={title:"Dashboard Row",panels:[],showTitle:!1,titleSize:"h6",height:250,isNew:!1,repeat:null,repeatRowId:null,repeatIteration:null,collapse:!1},Object(i.assignModelProperties)(this,t,this.defaults),this.events=new i.Emitter,this.updateRowSpan()}return t.prototype.getSaveModel=function(){return this.model={},Object(i.assignModelProperties)(this.model,this,this.defaults),delete this.model.isNew,this.model},t.prototype.updateRowSpan=function(){this.span=0;for(var t=0,e=this.panels;t<e.length;t++){var n=e[t];this.span+=n.span}},t.prototype.panelSpanChanged=function(t){var e=this.span;this.updateRowSpan(),(t||e!==this.span)&&this.events.emit("span-changed")},t.prototype.addPanel=function(t){var e=this.span,n=this.panels.length;12-e-t.span<=0&&(1===n?(this.panels[0].span=6,t.span=6):2===n?(this.panels[0].span=4,this.panels[1].span=4,t.span=4):3===n&&(this.panels[0].span=3,this.panels[1].span=3,this.panels[2].span=3,t.span=3)),this.panels.push(t),this.events.emit("panel-added",t),this.panelSpanChanged()},t.prototype.removePanel=function(t,e){var n=this;if(!1!==e){var r,o;return t.alert&&(r="Panel includes an alert rule, removing panel will also remove alert rule",o="YES"),void i.appEvents.emit("confirm-modal",{title:"Remove Panel",text:"Are you sure you want to remove this panel?",text2:r,icon:"fa-trash",confirmText:o,yesText:"Remove",onConfirm:function(){n.removePanel(t,!1)}})}var s=a.a.indexOf(this.panels,t);this.panels.splice(s,1),this.events.emit("panel-removed",t),this.panelSpanChanged()},t.prototype.movePanel=function(t,e){this.panels.splice(e,0,this.panels.splice(t,1)[0])},t.prototype.destroy=function(){this.events.removeAllListeners()},t.prototype.copyPropertiesFromRowSource=function(t){this.height=t.height,this.title=t.title,this.showTitle=t.showTitle,this.titleSize=t.titleSize},t.prototype.toggleCollapse=function(){this.collapse=!this.collapse},t}()},1324:function(t,e,n){"use strict";function r(t,e,n){void 0===e&&(e=h),void 0===n&&(n=!1);var r=(n?"sep=;\n":"")+"Series;Time;Value\n";l.a.each(t,function(t){l.a.each(t.datapoints,function(n){r+=t.alias+";"+c()(n[1]).format(e)+";"+n[0]+"\n"})}),o(r,"grafana_data_export.csv")}function a(t,e,n){void 0===e&&(e=h),void 0===n&&(n=!1);var r=(n?"sep=;\n":"")+"Time;";l.a.each(t,function(t){r+=t.alias+";"}),r=r.substring(0,r.length-1),r+="\n";var a=[[]],i=1;l.a.each(t,function(t){var n=0;a.push([]),l.a.each(t.datapoints,function(t){a[0][n]=c()(t[1]).format(e),a[i][n]=t[0],n++}),i++});for(var s=0;s<a[0].length;s++){r+=a[0][s]+";";for(var u=1;u<a.length;u++)r+=a[u][s]+";";r=r.substring(0,r.length-1),r+="\n"}o(r,"grafana_data_export.csv")}function i(t,e){void 0===e&&(e=!1);var n=e?"sep=;\n":"";l.a.each(t.columns,function(t){n+=(t.title||t.text)+";"}),n+="\n",l.a.each(t.rows,function(t){l.a.each(t,function(t){n+=t+";"}),n+="\n"}),o(n,"grafana_data_export.csv")}function o(t,e){var n=new Blob([t],{type:"text/csv;charset=utf-8"});Object(p.saveAs)(n,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.exportSeriesListToCsv=r,e.exportSeriesListToCsvColumns=a,e.exportTableDataToCsv=i,e.saveSaveBlob=o;var s=n(7),l=n.n(s),u=n(1),c=n.n(u),p=n(203),h=(n.n(p),"YYYY-MM-DDTHH:mm:ssZ")},1325:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"LinkSrv",function(){return l});var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=n(464),l=function(){function t(t,e){this.templateSrv=t,this.timeSrv=e}return t.$inject=["templateSrv","timeSrv"],t.prototype.getLinkUrl=function(t){var e=this.templateSrv.replace(t.url||""),n={};if(t.keepTime){var r=this.timeSrv.timeRangeForUrl();n.from=r.from,n.to=r.to}return t.includeVars&&this.templateSrv.fillVariableValuesForUrl(n),this.addParamsToUrl(e,n)},t.prototype.addParamsToUrl=function(t,e){var n=[];return o.a.each(e,function(t,e){null!==t&&(!0===t?n.push(e):o.a.isArray(t)?o.a.each(t,function(t){n.push(e+"="+encodeURIComponent(t))}):n.push(e+"="+encodeURIComponent(t)))}),0===n.length?t:this.appendToQueryString(t,n.join("&"))},t.prototype.appendToQueryString=function(t,e){if(!o.a.isUndefined(e)&&null!==e&&""!==e){var n=t.indexOf("?");-1!==n?t.length-n>1&&(t+="&"):t+="?",t+=e}return t},t.prototype.getAnchorInfo=function(t){var e={};return e.href=this.getLinkUrl(t),e.title=this.templateSrv.replace(t.title||""),e},t.prototype.getPanelLinkAnchorInfo=function(t,e){var n={};if("absolute"===t.type)n.target=t.targetBlank?"_blank":"_self",n.href=this.templateSrv.replace(t.url||"",e),n.title=this.templateSrv.replace(t.title||"",e);else if(t.dashUri)n.href="dashboard/"+t.dashUri+"?",n.title=this.templateSrv.replace(t.title||"",e),n.target=t.targetBlank?"_blank":"";else{n.title=this.templateSrv.replace(t.title||"",e);var r=s.default.slugifyForUrl(t.dashboard||"");n.href="dashboard/db/"+r+"?"}var a={};if(t.keepTime){var i=this.timeSrv.timeRangeForUrl();a.from=i.from,a.to=i.to}return t.includeVars&&this.templateSrv.fillVariableValuesForUrl(a,e),n.href=this.addParamsToUrl(n.href,a),t.params&&(n.href=this.appendToQueryString(n.href,this.templateSrv.replace(t.params,e))),n},t}();a.a.module("grafana.services").service("linkSrv",l)},1326:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(){}return t}()},1327:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryCtrl",function(){return i});var r=n(7),a=n.n(r),i=function(){function t(t,e){this.$scope=t,this.$injector=e,this.panel=this.panelCtrl.panel,this.isLastQuery=a.a.indexOf(this.panel.targets,this.target)===this.panel.targets.length-1}return t.prototype.refresh=function(){this.panelCtrl.refresh()},t}()},1328:function(t,e,n){"use strict";function r(t,e){function n(t,s){Object.keys(t).forEach(function(l){var u=t[l],c=e.safe&&Array.isArray(u),p=Object.prototype.toString.call(u),h="[object Object]"===p,d=s?s+r+l:l;if(e.maxDepth||(a=i+1),!c&&h&&Object.keys(u).length&&i<a)return++i,n(u,d);o[d]=u})}e=e||{};var r=e.delimiter||".",a=e.maxDepth||3,i=1,o={};return n(t,null),o}Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},1329:function(t,e,n){"use strict";function r(t,e){return new s(t).isGtOrEq(e)}n.d(e,"a",function(){return s}),e.b=r;var a=n(7),i=n.n(a),o=/^(\d+)(?:\.(\d+))?(?:\.(\d+))?(?:-([0-9A-Za-z\.]+))?/,s=function(){function t(t){var e=o.exec(t);e&&(this.major=Number(e[1]),this.minor=Number(e[2]||0),this.patch=Number(e[3]||0),this.meta=e[4])}return t.prototype.isGtOrEq=function(e){var n=new t(e);return!(this.major<n.major||this.minor<n.minor||this.patch<n.patch)},t.prototype.isValid=function(){return i.a.isNumber(this.major)},t}()},1330:function(t,e,n){(function(t){var r,a;r=[n(12),n(7)],void 0!==(a=function(t,e){"use strict";var n=t.module("grafana.controllers");n.directive("cloudwatchQueryParameter",function(){return{templateUrl:"public/app/plugins/datasource/cloudwatch/partials/query.parameter.html",controller:"CloudWatchQueryParameterCtrl",restrict:"E",scope:{target:"=",datasource:"=",onChange:"&"}}}),n.controller("CloudWatchQueryParameterCtrl",["$scope","templateSrv","uiSegmentSrv","datasourceSrv","$q",function(n,r,a,i,o){n.init=function(){var t=n.target;t.namespace=t.namespace||"",t.metricName=t.metricName||"",t.statistics=t.statistics||["Average"],t.dimensions=t.dimensions||{},t.period=t.period||"",t.region=t.region||"",n.regionSegment=a.getSegmentForValue(n.target.region,"select region"),n.namespaceSegment=a.getSegmentForValue(n.target.namespace,"select namespace"),n.metricSegment=a.getSegmentForValue(n.target.metricName,"select metric"),n.dimSegments=e.reduce(n.target.dimensions,function(t,e,n){return t.push(a.newKey(n)),t.push(a.newOperator("=")),t.push(a.newKeyValue(e)),t},[]),n.statSegments=e.map(n.target.statistics,function(t){return a.getSegmentForValue(t)}),n.ensurePlusButton(n.statSegments),n.ensurePlusButton(n.dimSegments),n.removeDimSegment=a.newSegment({fake:!0,value:"-- remove dimension --"}),n.removeStatSegment=a.newSegment({fake:!0,value:"-- remove stat --"}),e.isEmpty(n.target.region)&&(n.target.region=n.datasource.getDefaultRegion()),n.onChange||(n.onChange=function(){})},n.getStatSegments=function(){return o.when(e.flatten([t.copy(n.removeStatSegment),e.map(n.datasource.standardStatistics,function(t){return a.getSegmentForValue(t)}),a.getSegmentForValue("pNN.NN")]))},n.statSegmentChanged=function(t,r){t.value===n.removeStatSegment.value?n.statSegments.splice(r,1):t.type="value",n.target.statistics=e.reduce(n.statSegments,function(t,e){return e.fake||t.push(e.value),t},[]),n.ensurePlusButton(n.statSegments),n.onChange()},n.ensurePlusButton=function(t){var e=t.length,n=t[Math.max(e-1,0)];n&&"plus-button"===n.type||t.push(a.newPlusButton())},n.getDimSegments=function(e,r){if("operator"===e.type)return o.when([]);var a=n.target,i=o.when([]);if("key"===e.type||"plus-button"===e.type)i=n.datasource.getDimensionKeys(n.target.namespace,n.target.region);else if("value"===e.type){var s=n.dimSegments[r-2].value;i=n.datasource.getDimensionValues(a.region,a.namespace,a.metricName,s,a.dimensions)}return i.then(n.transformToSegments(!0)).then(function(r){return"key"===e.type&&r.splice(0,0,t.copy(n.removeDimSegment)),r})},n.dimSegmentChanged=function(t,e){n.dimSegments[e]=t,t.value===n.removeDimSegment.value?n.dimSegments.splice(e,3):"plus-button"===t.type&&(n.dimSegments.push(a.newOperator("=")),n.dimSegments.push(a.newFake("select dimension value","value","query-segment-value")),t.type="key",t.cssClass="query-segment-key"),n.syncDimSegmentsWithModel(),n.ensurePlusButton(n.dimSegments),n.onChange()},n.syncDimSegmentsWithModel=function(){for(var t={},e=n.dimSegments.length,r=0;r<e-2;r+=3){var a=n.dimSegments[r],i=n.dimSegments[r+2];i.fake||(t[a.value]=i.value)}n.target.dimensions=t},n.getRegions=function(){return n.datasource.metricFindQuery("regions()").then(n.transformToSegments(!0))},n.getNamespaces=function(){return n.datasource.metricFindQuery("namespaces()").then(n.transformToSegments(!0))},n.getMetrics=function(){return n.datasource.metricFindQuery("metrics("+n.target.namespace+","+n.target.region+")").then(n.transformToSegments(!0))},n.regionChanged=function(){n.target.region=n.regionSegment.value,n.onChange()},n.namespaceChanged=function(){n.target.namespace=n.namespaceSegment.value,n.onChange()},n.metricChanged=function(){n.target.metricName=n.metricSegment.value,n.onChange()},n.transformToSegments=function(t){return function(n){var i=e.map(n,function(t){return a.newSegment({value:t.text,expandable:t.expandable})});return t&&e.each(r.variables,function(t){i.unshift(a.newSegment({type:"template",value:"$"+t.name,expandable:!0}))}),i}},n.init()}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1331:function(t,e,n){"use strict";var r=n(7),a=n.n(r),i=n(1332),o=n(464),s=function(){function t(t,e,n){this.target=t,this.templateSrv=e,this.scopedVars=n,t.policy=t.policy||"default",t.dsType="influxdb",t.resultFormat=t.resultFormat||"time_series",t.orderByTime=t.orderByTime||"ASC",t.tags=t.tags||[],t.groupBy=t.groupBy||[{type:"time",params:["$__interval"]},{type:"fill",params:["null"]}],t.select=t.select||[[{type:"field",params:["value"]},{type:"mean",params:[]}]],this.updateProjection()}return t.$inject=["target","templateSrv","scopedVars"],t.prototype.updateProjection=function(){this.selectModels=a.a.map(this.target.select,function(t){return a.a.map(t,i.a.create)}),this.groupByParts=a.a.map(this.target.groupBy,i.a.create)},t.prototype.updatePersistedParts=function(){this.target.select=a.a.map(this.selectModels,function(t){return a.a.map(t,function(t){return{type:t.def.type,params:t.params}})})},t.prototype.hasGroupByTime=function(){return a.a.find(this.target.groupBy,function(t){return"time"===t.type})},t.prototype.hasFill=function(){return a.a.find(this.target.groupBy,function(t){return"fill"===t.type})},t.prototype.addGroupBy=function(t){var e=t.match(/^(\w+)\((.*)\)$/),n=e[1],r=e[2],a=i.a.create({type:n,params:[r]}),o=this.target.groupBy.length;0===o?this.target.groupBy.push(a.part):"time"===n?this.target.groupBy.splice(0,0,a.part):"tag"===n&&"fill"===this.target.groupBy[o-1].type?this.target.groupBy.splice(o-1,0,a.part):this.target.groupBy.push(a.part),this.updateProjection()},t.prototype.removeGroupByPart=function(t,e){var n=i.a.getCategories();"time"===t.def.type&&(this.target.groupBy=a.a.filter(this.target.groupBy,function(t){return"fill"!==t.type}),this.target.select=a.a.map(this.target.select,function(t){return a.a.filter(t,function(t){var e=i.a.create(t);return e.def.category!==n.Aggregations&&e.def.category!==n.Selectors})})),this.target.groupBy.splice(e,1),this.updateProjection()},t.prototype.removeSelect=function(t){this.target.select.splice(t,1),this.updateProjection()},t.prototype.removeSelectPart=function(t,e){if("field"===e.def.type){if(this.selectModels.length>1){var n=a.a.indexOf(this.selectModels,t);this.selectModels.splice(n,1)}}else{var r=a.a.indexOf(t,e);t.splice(r,1)}this.updatePersistedParts()},t.prototype.addSelectPart=function(t,e){var n=i.a.create({type:e});n.def.addStrategy(t,n,this),this.updatePersistedParts()},t.prototype.renderTagCondition=function(t,e,n){var r="",a=t.operator,i=t.value;return e>0&&(r=(t.condition||"AND")+" "),a||(a=/^\/.*\/$/.test(i)?"=~":"="),"=~"!==a&&"!~"!==a?(n&&(i=this.templateSrv.replace(i,this.scopedVars)),">"!==a&&"<"!==a&&(i="'"+i.replace(/\\/g,"\\\\")+"'")):n&&(i=this.templateSrv.replace(i,this.scopedVars,"regex")),r+'"'+t.key+'" '+a+" "+i},t.prototype.getMeasurementAndPolicy=function(t){var e=this.target.policy,n=this.target.measurement||"measurement";return n.match("^/.*/$")?t&&(n=this.templateSrv.replace(n,this.scopedVars,"regex")):n='"'+n+'"',(e="default"!==e?'"'+this.target.policy+'".':"")+n},t.prototype.interpolateQueryStr=function(t,e,n){return e.multi||e.includeAll?"string"==typeof t?o.default.regexEscape(t):"("+a.a.map(t,o.default.regexEscape).join("|")+")":t},t.prototype.render=function(t){var e=this,n=this.target;if(n.rawQuery)return t?this.templateSrv.replace(n.query,this.scopedVars,this.interpolateQueryStr):n.query;var r,i,o="SELECT ";for(r=0;r<this.selectModels.length;r++){var s=this.selectModels[r],l="";for(i=0;i<s.length;i++){l=s[i].render(l)}r>0&&(o+=", "),o+=l}o+=" FROM "+this.getMeasurementAndPolicy(t)+" WHERE ";var u=a.a.map(n.tags,function(n,r){return e.renderTagCondition(n,r,t)});u.length>0&&(o+="("+u.join(" ")+") AND "),o+="$timeFilter";var c="";for(r=0;r<this.groupByParts.length;r++){var p=this.groupByParts[r];r>0&&(c+="fill"===p.def.type?" ":", "),c+=p.render("")}return c.length&&(o+=" GROUP BY "+c),n.fill&&(o+=" fill("+n.fill+")"),"DESC"===n.orderByTime&&(o+=" ORDER BY time DESC"),n.limit&&(o+=" LIMIT "+n.limit),n.slimit&&(o+=" SLIMIT "+n.slimit),o},t.prototype.renderAdhocFilters=function(t){var e=this;return a.a.map(t,function(t,n){return e.renderTagCondition(t,n,!1)}).join(" ")},t}();e.a=s},1332:function(t,e,n){"use strict";function r(t){var e=m[t.type];if(!e)throw{message:"Could not find query part "+t.type};return new f.a(t,e)}function a(t){m[t.type]=new f.b(t),t.category.push(m[t.type])}function i(t,e){return e+' AS "'+t.params[0]+'"'}function o(t,e){return"*"===t.params[0]?"*":'"'+t.params[0]+'"'}function s(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.def.category===g.Aggregations)return void(t[n]=e);if(r.def.category===g.Selectors)return void(t[n]=e)}t.splice(1,0,e)}function l(t,e){var n;for(n=0;n<t.length;n++){var r=t[n];if(r.def.category===g.Math||r.def.category===g.Aliasing)break}t.splice(n,0,e)}function u(t,e){var n=t.length;if(n>0){if("math"===t[n-1].def.type)return void(t[n-1]=e);if(n>1&&"math"===t[n-2].def.type)return void(t[n-2]=e);if("alias"===t[n-1].def.type)return void t.splice(n-1,0,e)}t.push(e)}function c(t,e){var n=t.length;if(n>0&&"alias"===t[n-1].def.type)return void(t[n-1]=e);t.push(e)}function p(t,e,n){var a=d.a.map(t,function(t){return r({type:t.def.type,params:d.a.clone(t.params)})});n.selectModels.push(a)}var h=n(7),d=n.n(h),f=n(1308),m=[],g={Aggregations:[],Selectors:[],Transformations:[],Predictors:[],Math:[],Aliasing:[],Fields:[]},v=[];a({type:"field",addStrategy:p,category:g.Fields,params:[{type:"field",dynamicLookup:!0}],defaultParams:["value"],renderer:o}),a({type:"count",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:f.c}),a({type:"distinct",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:f.c}),a({type:"integral",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:f.c}),a({type:"mean",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:f.c}),a({type:"median",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:f.c}),a({type:"mode",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:f.c}),a({type:"sum",addStrategy:s,category:g.Aggregations,params:[],defaultParams:[],renderer:f.c}),a({type:"derivative",addStrategy:l,category:g.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:f.c}),a({type:"spread",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:f.c}),a({type:"non_negative_derivative",addStrategy:l,category:g.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:f.c}),a({type:"difference",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:f.c}),a({type:"non_negative_difference",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:f.c}),a({type:"moving_average",addStrategy:l,category:g.Transformations,params:[{name:"window",type:"int",options:[5,10,20,30,40]}],defaultParams:[10],renderer:f.c}),a({type:"cumulative_sum",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:f.c}),a({type:"stddev",addStrategy:l,category:g.Transformations,params:[],defaultParams:[],renderer:f.c}),a({type:"time",category:v,params:[{name:"interval",type:"time",options:["$__interval","1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["$__interval"],renderer:f.c}),a({type:"fill",category:v,params:[{name:"fill",type:"string",options:["none","null","0","previous","linear"]}],defaultParams:["null"],renderer:f.c}),a({type:"elapsed",addStrategy:l,category:g.Transformations,params:[{name:"duration",type:"interval",options:["1s","10s","1m","5m","10m","15m","1h"]}],defaultParams:["10s"],renderer:f.c}),a({type:"holt_winters",addStrategy:l,category:g.Predictors,params:[{name:"number",type:"int",options:[5,10,20,30,40]},{name:"season",type:"int",options:[0,1,2,5,10]}],defaultParams:[10,2],renderer:f.c}),a({type:"holt_winters_with_fit",addStrategy:l,category:g.Predictors,params:[{name:"number",type:"int",options:[5,10,20,30,40]},{name:"season",type:"int",options:[0,1,2,5,10]}],defaultParams:[10,2],renderer:f.c}),a({type:"bottom",addStrategy:s,category:g.Selectors,params:[{name:"count",type:"int"}],defaultParams:[3],renderer:f.c}),a({type:"first",addStrategy:s,category:g.Selectors,params:[],defaultParams:[],renderer:f.c}),a({type:"last",addStrategy:s,category:g.Selectors,params:[],defaultParams:[],renderer:f.c}),a({type:"max",addStrategy:s,category:g.Selectors,params:[],defaultParams:[],renderer:f.c}),a({type:"min",addStrategy:s,category:g.Selectors,params:[],defaultParams:[],renderer:f.c}),a({type:"percentile",addStrategy:s,category:g.Selectors,params:[{name:"nth",type:"int"}],defaultParams:[95],renderer:f.c}),a({type:"top",addStrategy:s,category:g.Selectors,params:[{name:"count",type:"int"}],defaultParams:[3],renderer:f.c}),a({type:"tag",category:v,params:[{name:"tag",type:"string",dynamicLookup:!0}],defaultParams:["tag"],renderer:o}),a({type:"math",addStrategy:u,category:g.Math,params:[{name:"expr",type:"string"}],defaultParams:[" / 100"],renderer:f.d}),a({type:"alias",addStrategy:c,category:g.Aliasing,params:[{name:"name",type:"string",quote:"double"}],defaultParams:["alias"],renderMode:"suffix",renderer:i}),e.a={create:r,getCategories:function(){return g}}},1333:function(t,e,n){"use strict";function r(t,e){var n="",r=t.operator,a=t.value;return e>0&&(n=(t.condition||"AND")+" "),r||(r=/^\/.*\/$/.test(t.value)?"=~":"="),"=~"!==r&&"!~"!==r&&isNaN(+a)&&(a="'"+a+"'"),n+'"'+t.key+'" '+r+" "+a}n.d(e,"a",function(){return o});var a=n(7),i=n.n(a),o=function(){function t(t,e){this.target=t,this.database=e}return t.prototype.buildExploreQuery=function(t,e,n){var a,o,s;if("TAG_KEYS"===t)a="SHOW TAG KEYS",o=this.target.measurement,s=this.target.policy;else if("TAG_VALUES"===t)a="SHOW TAG VALUES",o=this.target.measurement,s=this.target.policy;else if("MEASUREMENTS"===t)a="SHOW MEASUREMENTS",n&&(a+=" WITH MEASUREMENT =~ /"+n+"/");else{if("FIELDS"===t)return o=this.target.measurement,s=this.target.policy,o.match("^/.*/")||(o='"'+o+'"',s&&"default"!==s&&(s='"'+s+'"',o=s+"."+o)),"SHOW FIELD KEYS FROM "+o;if("RETENTION POLICIES"===t)return a='SHOW RETENTION POLICIES on "'+this.database+'"'}if(o&&(o.match("^/.*/")||o.match(/^merge\(.*\)/)||(o='"'+o+'"'),s&&"default"!==s&&(s='"'+s+'"',o=s+"."+o),a+=" FROM "+o),e&&(a+=' WITH KEY = "'+e+'"'),this.target.tags&&this.target.tags.length>0){var l=i.a.reduce(this.target.tags,function(t,n){return n.key===e?t:(t.push(r(n,t.length)),t)},[]);l.length>0&&(a+=" WHERE "+l.join(" "))}return"MEASUREMENTS"===t&&(a+=" LIMIT 100"),a},t}()},1334:function(t,e){!function(t){function e(e){function n(t){f.active&&(u(t),e.getPlaceholder().trigger("plotselecting",[i()]))}function r(e){1==e.which&&(document.body.focus(),void 0!==document.onselectstart&&null==m.onselectstart&&(m.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),void 0!==document.ondrag&&null==m.ondrag&&(m.ondrag=document.ondrag,document.ondrag=function(){return!1}),l(f.first,e),f.active=!0,g=function(t){a(t)},t(document).one("mouseup",g))}function a(t){return g=null,void 0!==document.onselectstart&&(document.onselectstart=m.onselectstart),void 0!==document.ondrag&&(document.ondrag=m.ondrag),f.active=!1,u(t),d()?o(t):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function i(){if(!d())return null;if(!f.show)return null;var n={},r=f.first,a=f.second,i=e.getAxes();return t.each(i,function(t,e){e.used&&(anyUsed=!1)}),t.each(i,function(t,e){if(e.used,!0){var i=e.c2p(r[e.direction]),o=e.c2p(a[e.direction]);n[t]={from:Math.min(i,o),to:Math.max(i,o)}}}),n}function o(t){var n=i();n.ctrlKey=t.ctrlKey,n.metaKey=t.metaKey,e.getPlaceholder().trigger("plotselected",[n]),n.xaxis&&n.yaxis&&e.getPlaceholder().trigger("selected",[{x1:n.xaxis.from,y1:n.yaxis.from,x2:n.xaxis.to,y2:n.yaxis.to}])}function s(t,e,n){return e<t?t:e>n?n:e}function l(t,n){var r=e.getOptions(),a=e.getPlaceholder().offset(),i=e.getPlotOffset();t.x=s(0,n.pageX-a.left-i.left,e.width()),t.y=s(0,n.pageY-a.top-i.top,e.height()),"y"==r.selection.mode&&(t.x=t==f.first?0:e.width()),"x"==r.selection.mode&&(t.y=t==f.first?0:e.height())}function u(t){null!=t.pageX&&(l(f.second,t),d()?(e.isSelecting=!0,f.show=!0,e.triggerRedrawOverlay()):c(!0))}function c(t){f.show&&(f.show=!1,e.triggerRedrawOverlay(),t||e.getPlaceholder().trigger("plotunselected",[]))}function p(t,n){var r,a,i,o,s=e.getAxes();for(var l in s)if(r=s[l],r.direction==n&&(o=n+r.n+"axis",t[o]||1!=r.n||(o=n+"axis"),t[o])){a=t[o].from,i=t[o].to;break}if(t[o]||(r="x"==n?e.getXAxes()[0]:e.getYAxes()[0],a=t[n+"1"],i=t[n+"2"]),null!=a&&null!=i&&a>i){var u=a;a=i,i=u}return{from:a,to:i,axis:r}}function h(t,n){var r,a=e.getOptions();"y"==a.selection.mode?(f.first.x=0,f.second.x=e.width()):(r=p(t,"x"),f.first.x=r.axis.p2c(r.from),f.second.x=r.axis.p2c(r.to)),"x"==a.selection.mode?(f.first.y=0,f.second.y=e.height()):(r=p(t,"y"),f.first.y=r.axis.p2c(r.from),f.second.y=r.axis.p2c(r.to)),f.show=!0,e.triggerRedrawOverlay(),!n&&d()&&o()}function d(){var t=e.getOptions().selection.minSize;return Math.abs(f.second.x-f.first.x)>=t&&Math.abs(f.second.y-f.first.y)>=t}var f={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},m={},g=null;e.clearSelection=c,e.setSelection=h,e.getSelection=i,e.hooks.bindEvents.push(function(t,e){null!=t.getOptions().selection.mode&&(e.mousemove(n),e.mousedown(r))}),e.hooks.drawOverlay.push(function(e,n){if(f.show&&d()){var r=e.getPlotOffset(),a=e.getOptions();n.save(),n.translate(r.left,r.top);var i=t.color.parse(a.selection.color);n.strokeStyle=i.scale("a",.8).toString(),n.lineWidth=1,n.lineJoin=a.selection.shape,n.fillStyle=i.scale("a",.4).toString();var o=Math.min(f.first.x,f.second.x)+.5,s=Math.min(f.first.y,f.second.y)+.5,l=Math.abs(f.second.x-f.first.x)-1,u=Math.abs(f.second.y-f.first.y)-1;n.fillRect(o,s,l,u),n.strokeRect(o,s,l,u),n.restore()}}),e.hooks.shutdown.push(function(e,a){a.unbind("mousemove",n),a.unbind("mousedown",r),g&&t(document).unbind("mouseup",g)})}t.plot.plugins.push({init:e,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})}(jQuery)},1335:function(t,e){!function(t){function e(t,e){return e*Math.floor(t/e)}function n(t,e,n,r){if("function"==typeof t.strftime)return t.strftime(e);var a=function(t,e){return t=""+t,e=""+(null==e?"0":e),1==t.length?e+t:t},i=[],o=!1,s=t.getHours(),l=s<12;null==n&&(n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),null==r&&(r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var u;u=s>12?s-12:0==s?12:s;for(var c=0;c<e.length;++c){var p=e.charAt(c);if(o){switch(p){case"a":p=""+r[t.getDay()];break;case"b":p=""+n[t.getMonth()];break;case"d":p=a(t.getDate(),"");break;case"e":p=a(t.getDate()," ");break;case"h":case"H":p=a(s);break;case"I":p=a(u);break;case"l":p=a(u," ");break;case"m":p=a(t.getMonth()+1,"");break;case"M":p=a(t.getMinutes());break;case"q":p=""+(Math.floor(t.getMonth()/3)+1);break;case"S":p=a(t.getSeconds());break;case"y":p=a(t.getFullYear()%100);break;case"Y":p=""+t.getFullYear();break;case"p":p=l?"am":"pm";break;case"P":p=l?"AM":"PM";break;case"w":p=""+t.getDay()}i.push(p),o=!1}else"%"==p?o=!0:i.push(p)}return i.join("")}function r(t){function e(t,e,n,r){t[e]=function(){return n[r].apply(n,arguments)}}var n={date:t};void 0!=t.strftime&&e(n,"strftime",t,"strftime"),e(n,"getTime",t,"getTime"),e(n,"setTime",t,"setTime");for(var r=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],a=0;a<r.length;a++)e(n,"get"+r[a],t,"getUTC"+r[a]),e(n,"set"+r[a],t,"setUTC"+r[a]);return n}function a(t,e){if("browser"==e.timezone)return new Date(t);if(e.timezone&&"utc"!=e.timezone){if("undefined"!=typeof timezoneJS&&void 0!==timezoneJS.Date){var n=new timezoneJS.Date;return n.setTimezone(e.timezone),n.setTime(t),n}return r(new Date(t))}return r(new Date(t))}function i(r){r.hooks.processOptions.push(function(r,i){t.each(r.getAxes(),function(t,r){var i=r.options;"time"==i.mode&&(r.tickGenerator=function(t){var n=[],r=a(t.min,i),o=0,l=i.tickSize&&"quarter"===i.tickSize[1]||i.minTickSize&&"quarter"===i.minTickSize[1]?c:u;null!=i.minTickSize&&(o="number"==typeof i.tickSize?i.tickSize:i.minTickSize[0]*s[i.minTickSize[1]]);for(var p=0;p<l.length-1&&!(t.delta<(l[p][0]*s[l[p][1]]+l[p+1][0]*s[l[p+1][1]])/2&&l[p][0]*s[l[p][1]]>=o);++p);var h=l[p][0],d=l[p][1];if("year"==d){if(null!=i.minTickSize&&"year"==i.minTickSize[1])h=Math.floor(i.minTickSize[0]);else{var f=Math.pow(10,Math.floor(Math.log(t.delta/s.year)/Math.LN10)),m=t.delta/s.year/f;h=m<1.5?1:m<3?2:m<7.5?5:10,h*=f}h<1&&(h=1)}t.tickSize=i.tickSize||[h,d];var g=t.tickSize[0];d=t.tickSize[1];var v=g*s[d];"second"==d?r.setSeconds(e(r.getSeconds(),g)):"minute"==d?r.setMinutes(e(r.getMinutes(),g)):"hour"==d?r.setHours(e(r.getHours(),g)):"month"==d?r.setMonth(e(r.getMonth(),g)):"quarter"==d?r.setMonth(3*e(r.getMonth()/3,g)):"year"==d&&r.setFullYear(e(r.getFullYear(),g)),r.setMilliseconds(0),v>=s.minute&&r.setSeconds(0),v>=s.hour&&r.setMinutes(0),v>=s.day&&r.setHours(0),v>=4*s.day&&r.setDate(1),v>=2*s.month&&r.setMonth(e(r.getMonth(),3)),v>=2*s.quarter&&r.setMonth(e(r.getMonth(),6)),v>=s.year&&r.setMonth(0);var y,b=0,x=Number.NaN;do{if(y=x,x=r.getTime(),n.push(x),"month"==d||"quarter"==d)if(g<1){r.setDate(1);var S=r.getTime();r.setMonth(r.getMonth()+("quarter"==d?3:1));var w=r.getTime();r.setTime(x+b*s.hour+(w-S)*g),b=r.getHours(),r.setHours(0)}else r.setMonth(r.getMonth()+g*("quarter"==d?3:1));else"year"==d?r.setFullYear(r.getFullYear()+g):r.setTime(x+v)}while(x<t.max&&x!=y);return n},r.tickFormatter=function(t,e){var r=a(t,e.options);if(null!=i.timeformat)return n(r,i.timeformat,i.monthNames,i.dayNames);var o,l=e.options.tickSize&&"quarter"==e.options.tickSize[1]||e.options.minTickSize&&"quarter"==e.options.minTickSize[1],u=e.tickSize[0]*s[e.tickSize[1]],c=e.max-e.min,p=i.twelveHourClock?" %p":"",h=i.twelveHourClock?"%I":"%H";return o=u<s.minute?h+":%M:%S"+p:u<s.day?c<2*s.day?h+":%M"+p:"%b %d "+h+":%M"+p:u<s.month?"%b %d":l&&u<s.quarter||!l&&u<s.year?c<s.year?"%b":"%b %Y":l&&u<s.year?c<s.year?"Q%q":"Q%q %Y":"%Y",n(r,o,i.monthNames,i.dayNames)})})})}var o={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}},s={second:1e3,minute:6e4,hour:36e5,day:864e5,month:2592e6,quarter:7776e6,year:525949.2*60*1e3},l=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],u=l.concat([[3,"month"],[6,"month"],[1,"year"]]),c=l.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);t.plot.plugins.push({init:i,options:o,name:"time",version:"1.0"}),t.plot.formatDate=n}(jQuery)},1336:function(t,e){!function(t){function e(t){function e(t,e){for(var n=null,r=0;r<e.length&&t!=e[r];++r)e[r].stack==t.stack&&(n=e[r]);return n}function n(t,n,r){if(null!=n.stack&&!1!==n.stack){var a=e(n,t.getData());if(a){for(var i,o,s,l,u,c,p,h,d=r.pointsize,f=r.points,m=a.datapoints.pointsize,g=a.datapoints.points,v=[],y=n.lines.show,b=n.bars.horizontal,x=d>2&&(b?r.format[2].x:r.format[2].y),S=y&&n.lines.steps,w=b?1:0,k=b?0:1,_=0,M=0;;){if(_>=f.length&&M>=g.length)break;if(p=v.length,_<f.length&&null==f[_]){for(h=0;h<d;++h)v.push(f[_+h]);_+=d}else if(_>=f.length){for(h=0;h<d;++h)v.push(g[M+h]);x&&(v[p+2]=g[M+k]),M+=m}else if(M>=g.length){for(h=0;h<d;++h)v.push(f[_+h]);_+=d}else if(M<g.length&&null==g[M])M+=m;else{if(i=f[_+w],o=f[_+k],l=g[M+w],u=g[M+k],c=0,i==l){for(h=0;h<d;++h)v.push(f[_+h]);v[p+k]+=u,c=u,_+=d,M+=m}else if(i>l){if(0==_){for(h=0;h<d;++h)v.push(g[M+h]);c=u}if(_>0&&null!=f[_-d]){for(s=o+(f[_-d+k]-o)*(l-i)/(f[_-d+w]-i),v.push(l),v.push(s+u),h=2;h<d;++h)v.push(f[_+h]);c=u}M+=m}else{for(h=0;h<d;++h)v.push(f[_+h]);M>0&&null!=g[M-m]&&(c=u+(g[M-m+k]-u)*(i-l)/(g[M-m+w]-l)),v[p+k]+=c,_+=d}fromgap=!1,p!=v.length&&x&&(v[p+2]=c)}if(S&&p!=v.length&&p>0&&null!=v[p]&&v[p]!=v[p-d]&&v[p+1]!=v[p-d+1]){for(h=0;h<d;++h)v[p+d+h]=v[p+h];v[p+1]=v[p-d+1]}}r.points=v}}}t.hooks.processDatapoints.push(n)}var n={series:{stack:null}};t.plot.plugins.push({init:e,options:n,name:"stack",version:"1.2"})}(jQuery)},1337:function(t,e){!function(t){function e(t){function e(t,e,r,a){if(i||(i=!0,o=n(t.getData())),1==e.stackpercent){var s=r.length;e.percents=[];var l=0,u=1;e.bars&&e.bars.horizontal&&!0===e.bars.horizontal&&(l=1,u=0);for(var c=0;c<s;c++){var p=o[r[c][l]+""];p>0?e.percents.push(100*r[c][u]/p):e.percents.push(0)}}}function n(t){var e=t.length,n={};if(e>0)for(var r=0;r<e;r++)if(t[r].stackpercent){var a=0,i=1;t[r].bars&&t[r].bars.horizontal&&!0===t[r].bars.horizontal&&(a=1,i=0);for(var o=t[r].data.length,s=0;s<o;s++){var l=0;null!=t[r].data[s][1]&&(l=t[r].data[s][i]),n[t[r].data[s][a]+""]?n[t[r].data[s][a]+""]+=l:n[t[r].data[s][a]+""]=l}}return n}function r(t,e,r){if(e.stackpercent){i||(o=n(t.getData()));var s=[],l=0,u=1;e.bars&&e.bars.horizontal&&!0===e.bars.horizontal&&(l=1,u=0);for(var c=0;c<r.points.length;c+=3)a[r.points[c+l]]||(a[r.points[c+l]]=0),s[c+l]=r.points[c+l],s[c+u]=r.points[c+u]+a[r.points[c+l]],s[c+2]=a[r.points[c+l]],a[r.points[c+l]]+=r.points[c+u],o[s[c+l]+""]>0?(s[c+u]=100*s[c+u]/o[s[c+l]+""],s[c+2]=100*s[c+2]/o[s[c+l]+""]):(s[c+u]=0,s[c+2]=0);r.points=s}}var a={},i=!1,o={};t.hooks.processRawData.push(e),t.hooks.processDatapoints.push(r)}var n={series:{stackpercent:null}};t.plot.plugins.push({init:e,options:n,name:"stackpercent",version:"0.1"})}(jQuery)},1338:function(t,e){!function(t){"use strict";function e(e){function n(t,e){var n;for(n=0;n<e.length;++n)if(e[n].id===t.fillBelowTo)return e[n];return null}function r(t,e,n,r,a,i,o,s){var l,u,c,p,h,d;return l=n-t,u=r-e,c=o-a,p=s-i,h=(-u*(t-a)+l*(e-i))/(-c*u+l*p),d=(c*(e-i)-p*(t-a))/(-c*u+l*p),h>=0&&h<=1&&d>=0&&d<=1?[t+d*l,e+d*u]:null}function a(e,a,i){function o(t,e){a.beginPath(),a.moveTo(i.xaxis.p2c(t)+v.left,i.yaxis.p2c(e)+v.top)}function s(){a.closePath(),a.fill()}function l(t,e){console.assert(e>t,"expects the end index to be greater than the start index");var n,r,a=0===t||null===f[t-1]||null===g[t-1],i=!1;for(n=t;n<e;n++)if(null===f[n*d+1]||null===g[n*d+1])i=!1,a=!0;else if(f[n*d+1]===g[n*m+1])i=!0,a=!1;else{if(f[n*d+1]>g[n*m+1])return a?o(f[n*d],f[n*d+1]):i?o(f[(n-1)*d],f[(n-1)*d+1]):(r=u(n),o(r[0],r[1])),void p(n,e);a=!1,i=!1}}function u(t){console.assert(t>0,"expects the second point in the series line segment");var e,n;for(e=1;e<g.length/m;e++)if(null!==(n=r(f[(t-1)*d],f[(t-1)*d+1],f[t*d],f[t*d+1],g[(e-1)*m],g[(e-1)*m+1],g[e*m],g[e*m+1])))return n;console.error("intersectionPoint() should only be called when an intersection happens")}function c(t,e){console.assert(t>=e,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var n;for(n=t;n>=e;n--)a.lineTo(h.xaxis.p2c(g[n*m])+v.left,h.yaxis.p2c(g[n*m+1])+v.top);s()}function p(t,e){console.assert(t<=e,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var n,r;for(n=t;n<e;n++){if(null===f[n*d+1]&&n>t)return c(n-1,t),void l(n,e);if(f[n*d+1]===g[n*m+1])return c(n,t),void l(n,e);if(f[n*d+1]<g[n*m+1])return r=u(n),a.lineTo(i.xaxis.p2c(r[0])+v.left,i.yaxis.p2c(r[1])+v.top),c(n,t),void l(n,e);a.lineTo(i.xaxis.p2c(f[n*d])+v.left,i.yaxis.p2c(f[n*d+1])+v.top)}c(e,t)}if(null!==i.fillBelowTo){var h,d,f,m,g,v,y;h=n(i,e.getData()),h&&(d=i.datapoints.pointsize,f=i.datapoints.points,m=h.datapoints.pointsize,g=h.datapoints.points,v=e.getPlotOffset(),function(){if(f.length/d!=g.length/m)return console.error("Refusing to graph inconsistent number of points"),!1;var t;for(t=0;t<f.length/d;t++)if(null!==f[t*d]&&null!==g[t*m]&&f[t*d]!==g[t*m])return console.error("Refusing to graph points without matching value"),!1;return!0}()&&(y=t.color.parse(i.color),y.a=.4,y.normalize(),a.fillStyle=y.toString(),l(0,f.length/d)))}}e.hooks.drawSeries.push(a)}var n={series:{fillBelowTo:null}};t.plot.plugins.push({init:e,options:n,name:"fillbelow",version:"0.1.0"})}(jQuery)},1339:function(t,e){!function(t){function e(t){function e(e){r.locked||-1!=r.x&&(r.x=-1,t.triggerRedrawOverlay())}function n(e){if(!r.locked){if(t.getSelection&&t.getSelection())return void(r.x=-1);var n=t.offset();r.x=Math.max(0,Math.min(e.pageX-n.left,t.width())),r.y=Math.max(0,Math.min(e.pageY-n.top,t.height())),t.triggerRedrawOverlay()}}var r={x:-1,y:-1,locked:!1};t.setCrosshair=function(e){if(e){var n=t.p2c(e);r.x=Math.max(0,Math.min(n.left,t.width())),r.y=Math.max(0,Math.min(n.top,t.height()))}else r.x=-1;t.triggerRedrawOverlay()},t.clearCrosshair=t.setCrosshair,t.lockCrosshair=function(e){e&&t.setCrosshair(e),r.locked=!0},t.unlockCrosshair=function(){r.locked=!1},t.hooks.bindEvents.push(function(t,r){t.getOptions().crosshair.mode&&(r.mouseout(e),r.mousemove(n))}),t.hooks.drawOverlay.push(function(t,e){var n=t.getOptions().crosshair;if(n.mode){var a=t.getPlotOffset();if(e.save(),e.translate(a.left,a.top),-1!=r.x){var i=t.getOptions().crosshair.lineWidth%2?.5:0;if(e.strokeStyle=n.color,e.lineWidth=n.lineWidth,e.lineJoin="round",e.beginPath(),-1!=n.mode.indexOf("x")){var o=Math.floor(r.x)+i;e.moveTo(o,0),e.lineTo(o,t.height())}if(-1!=n.mode.indexOf("y")){var s=Math.floor(r.y)+i;e.moveTo(0,s),e.lineTo(t.width(),s)}e.stroke()}e.restore()}}),t.hooks.shutdown.push(function(t,r){r.unbind("mouseout",e),r.unbind("mousemove",n)})}var n={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};t.plot.plugins.push({init:e,options:n,name:"crosshair",version:"1.0"})}(jQuery)},1340:function(t,e){!function(t){function e(t){t.hooks.processDatapoints.push(function(t,e,n){e.dashes.show&&t.hooks.draw.push(function(t,r){function a(t,a){var i,l,u=n.points,c=n.pointsize,p=null,h=null,d=0,f=!0;e.dashes.dashLength[0]?(i=e.dashes.dashLength[0],l=e.dashes.dashLength[1]?e.dashes.dashLength[1]:i):l=i=e.dashes.dashLength,r.beginPath();for(var m=c;m<u.length;m+=c){var g=u[m-c],v=u[m-c+1],y=u[m],b=u[m+1];if(null!=g&&null!=y){if(v<=b&&v<s.min){if(b<s.min)continue;g=(s.min-v)/(b-v)*(y-g)+g,v=s.min}else if(b<=v&&b<s.min){if(v<s.min)continue;y=(s.min-v)/(b-v)*(y-g)+g,b=s.min}if(v>=b&&v>s.max){if(b>s.max)continue;g=(s.max-v)/(b-v)*(y-g)+g,v=s.max}else if(b>=v&&b>s.max){if(v>s.max)continue;y=(s.max-v)/(b-v)*(y-g)+g,b=s.max}if(g<=y&&g<o.min){if(y<o.min)continue;v=(o.min-g)/(y-g)*(b-v)+v,g=o.min}else if(y<=g&&y<o.min){if(g<o.min)continue;b=(o.min-g)/(y-g)*(b-v)+v,y=o.min}if(g>=y&&g>o.max){if(y>o.max)continue;v=(o.max-g)/(y-g)*(b-v)+v,g=o.max}else if(y>=g&&y>o.max){if(g>o.max)continue;b=(o.max-g)/(y-g)*(b-v)+v,y=o.max}g==p&&v==h||r.moveTo(o.p2c(g)+t,s.p2c(v)+a);var x,S=o.p2c(g)+t,w=s.p2c(v)+a,k=o.p2c(y)+t,_=s.p2c(b)+a;do{x=function(t){var e=Math.sqrt(Math.pow(k-S,2)+Math.pow(_-w,2));if(e<=t)return{deltaX:k-S,deltaY:_-w,distance:e,remainder:t-e};var n=k>S?1:-1,r=_>w?1:-1;return{deltaX:n*Math.sqrt(Math.pow(t,2)/(1+Math.pow((_-w)/(k-S),2))),deltaY:r*Math.sqrt(Math.pow(t,2)-Math.pow(t,2)/(1+Math.pow((_-w)/(k-S),2))),distance:t,remainder:0}}(d>0?d:f?i:l),0==x.deltaX&&0==x.deltaY||(f?r.lineTo(S+x.deltaX,w+x.deltaY):r.moveTo(S+x.deltaX,w+x.deltaY)),f=!f,d=x.remainder,S+=x.deltaX,w+=x.deltaY}while(x.distance>0);p=y,h=b}}r.stroke()}var i=t.getPlotOffset(),o=e.xaxis,s=e.yaxis;r.save(),r.translate(i.left,i.top),r.lineJoin="round";var l=e.dashes.lineWidth,u=e.shadowSize;if(l>0&&u>0){r.lineWidth=u,r.strokeStyle="rgba(0,0,0,0.1)";var c=Math.PI/18;a(Math.sin(c)*(l/2+u/2),Math.cos(c)*(l/2+u/2)),r.lineWidth=u/2,a(Math.sin(c)*(l/2+u/4),Math.cos(c)*(l/2+u/4))}r.lineWidth=l,r.strokeStyle=e.color,l>0&&a(0,0),r.restore()})})}t.plot.plugins.push({init:e,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})}(jQuery)},1341:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(7),a=n.n(r),i=n(1309),o=n(202),s=function(){function t(t){this.panel=t}return t.prototype.getSeriesList=function(t){var e=this;if(!t.dataList||0===t.dataList.length)return[];var n;if(t.dataList&&t.dataList.length>0){n=t.dataList[0];var r=this.getAutoDetectXAxisMode(n);this.panel.xaxis.mode!==r&&(this.panel.xaxis.mode=r,this.setPanelDefaultsForNewXAxisMode())}switch(this.panel.xaxis.mode){case"series":case"time":return t.dataList.map(function(n,r){return e.timeSeriesHandler(n,r,t)});case"histogram":return[{target:"count",datapoints:a.a.concat([],a.a.flatten(a.a.map(t.dataList,"datapoints")))}].map(function(n,r){return e.timeSeriesHandler(n,r,t)});case"field":return this.customHandler(n)}},t.prototype.getAutoDetectXAxisMode=function(t){switch(t.type){case"docs":case"table":return"field";default:return"series"===this.panel.xaxis.mode?"series":"histogram"===this.panel.xaxis.mode?"histogram":"time"}},t.prototype.setPanelDefaultsForNewXAxisMode=function(){switch(this.panel.xaxis.mode){case"time":this.panel.bars=!1,this.panel.lines=!0,this.panel.points=!1,this.panel.legend.show=!0,this.panel.tooltip.shared=!0,this.panel.xaxis.values=[];break;case"series":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1,this.panel.xaxis.values=["total"];break;case"histogram":this.panel.bars=!0,this.panel.lines=!1,this.panel.points=!1,this.panel.stack=!1,this.panel.legend.show=!1,this.panel.tooltip.shared=!1}},t.prototype.timeSeriesHandler=function(t,e,n){var r=t.datapoints||[],a=t.target,s=e%o.f.length,l=this.panel.aliasColors[a]||o.f[s],u=new i.a({datapoints:r,alias:a,color:l,unit:t.unit});if(r&&r.length>0){r[r.length-1][1]-n.range.from<-1e4&&(u.isOutsideRange=!0)}return u},t.prototype.customHandler=function(t){if(!this.panel.xaxis.name)throw{message:"No field name specified to use for x-axis, check your axes settings"};return[]},t.prototype.validateXAxisSeriesValue=function(){switch(this.panel.xaxis.mode){case"series":if(0===this.panel.xaxis.values.length)return void(this.panel.xaxis.values=["total"]);var t=this.getXAxisValueOptions({});return void(a.a.find(t,{value:this.panel.xaxis.values[0]})||(this.panel.xaxis.values=["total"]))}},t.prototype.getDataFieldNames=function(t,e){function n(t){a.a.forEach(t,function(t,i){if(a.a.isObject(t))o.push(i),n(t);else if(!e||a.a.isNumber(t)){var s=o.concat(i).join(".");r.push(s)}}),o.pop()}if(0===t.length)return[];var r=[],i=t[0],o=[];if("docs"===i.type){if(0===i.datapoints.length)return[];n(i.datapoints[0])}return r},t.prototype.getXAxisValueOptions=function(t){switch(this.panel.xaxis.mode){case"series":return[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"}]}return[]},t.prototype.pluckDeep=function(t,e){for(var n=e.split("."),r=t,a=0;a<n.length;++a){if(!r[n[a]])return;r=r[n[a]]}return r},t}()},1342:function(t,e,n){"use strict";function r(t,e,n,r){void 0===r&&(r=0);var a=o[t.value],s="always"===t.invert||"dark"===t.invert&&!e,l=s?n:r,u=s?r:n;return i.scaleSequential(a).domain([l,u])}function a(t,e,n){void 0===n&&(n=0);var r;return"linear"===t.colorScale?r=i.scaleLinear().domain([n,e]).range([0,1]):"sqrt"===t.colorScale&&(r=i.scalePow().exponent(t.exponent).domain([n,e]).range([0,1])),r}e.a=r,e.b=a;var i=n(470),o=n(478)},1343:function(t,e,n){"use strict";function r(t,e){var n=new l.default;if(!t||0===t.length)return n;var r=u[e.transform];if(!r)throw{message:"Transformer "+e.transform+" not found"};return r.transform(t,e,n),n}n.d(e,"b",function(){return u}),n.d(e,"a",function(){return r});var a=n(7),i=n.n(a),o=n(1328),s=n(1309),l=n(1310),u={};u.timeseries_to_rows={description:"Time series to rows",getColumns:function(){return[]},transform:function(t,e,n){n.columns=[{text:"Time",type:"date"},{text:"Metric"},{text:"Value"}];for(var r=0;r<t.length;r++)for(var a=t[r],i=0;i<a.datapoints.length;i++){var o=a.datapoints[i];n.rows.push([o[1],a.target,o[0]])}}},u.timeseries_to_columns={description:"Time series to columns",getColumns:function(){return[]},transform:function(t,e,n){n.columns.push({text:"Time",type:"date"});for(var r={},a=0;a<t.length;a++){var i=t[a];n.columns.push({text:i.target});for(var o=0;o<i.datapoints.length;o++){var s=i.datapoints[o],l=s[1].toString();r[l]?r[l][a]=s[0]:(r[l]={time:s[1]},r[l][a]=s[0])}}for(var u in r){for(var c=r[u],p=[c.time],a=0;a<t.length;a++){var h=c[a];p.push(h)}n.rows.push(p)}}},u.timeseries_aggregations={description:"Time series aggregations",getColumns:function(){return[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Current",value:"current"},{text:"Count",value:"count"}]},transform:function(t,e,n){var r,a;for(n.columns.push({text:"Metric"}),r=0;r<e.columns.length;r++)n.columns.push({text:e.columns[r].text});for(r=0;r<t.length;r++){var i=new s.a({datapoints:t[r].datapoints,alias:t[r].target});i.getFlotPairs("connected");var o=[i.alias];for(a=0;a<e.columns.length;a++)o.push(i.stats[e.columns[a].value]);n.rows.push(o)}}},u.annotations={description:"Annotations",getColumns:function(){return[]},transform:function(t,e,n){if(n.columns.push({text:"Time",type:"date"}),n.columns.push({text:"Title"}),n.columns.push({text:"Text"}),n.columns.push({text:"Tags"}),t&&t.annotations&&0!==t.annotations.length)for(var r=0;r<t.annotations.length;r++){var a=t.annotations[r];n.rows.push([a.min,a.title,a.text,a.tags])}}},u.table={description:"Table",getColumns:function(t){return t&&0!==t.length?t[0].columns:[]},transform:function(t,e,n){if(t&&0!==t.length){if("table"!==t[0].type)throw{message:"Query result is not in table format, try using another transform."};n.columns=t[0].columns,n.rows=t[0].rows}}},u.json={description:"JSON Data",getColumns:function(t){if(!t||0===t.length)return[];for(var e={},n=0;n<t.length;n++){var r=t[n];if("docs"===r.type)for(var a=Math.min(r.datapoints.length,100),s=0;s<a;s++){var l=r.datapoints[s],u=Object(o.default)(l,null);for(var c in u)e[c]=!0}}return i.a.map(e,function(t,e){return{text:e,value:e}})},transform:function(t,e,n){for(var r,a,s,l=0,u=e.columns;l<u.length;l++){var c=u[l],p={text:c.text};t.length>0&&t[0].filterable&&(p.filterable=!0),n.columns.push(p)}for(0===n.columns.length&&n.columns.push({text:"JSON"}),r=0;r<t.length;r++){var h=t[r];for(a=0;a<h.datapoints.length;a++){var d=h.datapoints[a],f=[];if(i.a.isObject(d)&&e.columns.length>0){var m=Object(o.default)(d,null);for(s=0;s<e.columns.length;s++)f.push(m[e.columns[s].value])}else f.push(JSON.stringify(d));n.rows.push(f)}}}}},1344:function(t,e,n){"use strict";e.isArrayLike=function(t){return t&&"number"==typeof t.length}},1345:function(t,e,n){"use strict";function r(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}e.isPromise=r},1346:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(466),i=n(1347),o=n(1320),s=n(1525),l=function(t){function e(e,n){t.call(this),this.array=e,this.scheduler=n,n||1!==e.length||(this._isScalar=!0,this.value=e[0])}return r(e,t),e.create=function(t,n){return new e(t,n)},e.of=function(){for(var t=[],n=0;n<arguments.length;n++)t[n-0]=arguments[n];var r=t[t.length-1];s.isScheduler(r)?t.pop():r=null;var a=t.length;return a>1?new e(t,r):1===a?new i.ScalarObservable(t[0],r):new o.EmptyObservable(r)},e.dispatch=function(t){var e=t.array,n=t.index,r=t.count,a=t.subscriber;if(n>=r)return void a.complete();a.next(e[n]),a.closed||(t.index=n+1,this.schedule(t))},e.prototype._subscribe=function(t){var n=this.array,r=n.length,a=this.scheduler;if(a)return a.schedule(e.dispatch,0,{array:n,index:0,count:r,subscriber:t});for(var i=0;i<r&&!t.closed;i++)t.next(n[i]);t.complete()},e}(a.Observable);e.ArrayObservable=l},1347:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(466),i=function(t){function e(e,n){t.call(this),this.value=e,this.scheduler=n,this._isScalar=!0,n&&(this._isScalar=!1)}return r(e,t),e.create=function(t,n){return new e(t,n)},e.dispatch=function(t){var e=t.done,n=t.value,r=t.subscriber;if(e)return void r.complete();r.next(n),r.closed||(t.done=!0,this.schedule(t))},e.prototype._subscribe=function(t){var n=this.value,r=this.scheduler;if(r)return r.schedule(e.dispatch,0,{done:!1,value:n,subscriber:t});t.next(n),t.closed||t.complete()},e}(a.Observable);e.ScalarObservable=i},1363:function(t,e,n){var r,a;r=[n(1365),n(1379),n(1366),n(1368),n(1369),n(1370),n(1371),n(1372),n(1373),n(1374),n(1375),n(1378),n(1364),n(1380),n(1381),n(1382),n(1312),n(1384),n(1385),n(1386),n(1389),n(1390),n(1391),n(1394)],void 0!==(a=function(){}.apply(e,r))&&(t.exports=a)},1364:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),a=n.n(r),i=n(7),o=n.n(i),s=n(2),l=n(464),u=n(467),c=function(){function t(t,e,n,r,a){var i=this;this.$rootScope=t,this.$timeout=e,this.$location=n,this.timer=r,this.contextSrv=a,this.time={from:"6h",to:"now"},t.$on("zoom-out",this.zoomOut.bind(this)),t.$on("$routeUpdate",this.routeUpdated.bind(this)),document.addEventListener("visibilitychange",function(){i.autoRefreshBlocked&&"visible"===document.visibilityState&&(i.autoRefreshBlocked=!1,i.refreshDashboard())})}return t.$inject=["$rootScope","$timeout","$location","timer","contextSrv"],t.prototype.init=function(t){this.timer.cancelAll(),this.dashboard=t,this.time=t.time,this.refresh=t.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=o.a.cloneDeep(this.time),this.refresh&&this.setAutoRefresh(this.refresh)},t.prototype.parseTime=function(){o.a.isString(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=a()(this.time.from).utc()),o.a.isString(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=a()(this.time.to).utc())},t.prototype.parseUrlParam=function(t){if(-1!==t.indexOf("now"))return t;if(8===t.length)return a.a.utc(t,"YYYYMMDD");if(15===t.length)return a.a.utc(t,"YYYYMMDDTHHmmss");if(!isNaN(t)){var e=parseInt(t);return a.a.utc(e)}return null},t.prototype.initTimeFromUrl=function(){var t=this.$location.search();t.from&&(this.time.from=this.parseUrlParam(t.from)||this.time.from),t.to&&(this.time.to=this.parseUrlParam(t.to)||this.time.to),t.refresh&&(this.refresh=t.refresh||this.refresh)},t.prototype.routeUpdated=function(){var t=this.$location.search(),e=this.timeRangeForUrl();t.from&&t.to?t.from===e.from&&t.to===e.to||(this.initTimeFromUrl(),this.setTime(this.time,!0)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)},t.prototype.timeHasChangedSinceLoad=function(){return this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to},t.prototype.setAutoRefresh=function(t){var e=this;if(this.dashboard.refresh=t,this.cancelNextRefresh(),t){var n=l.default.interval_to_ms(t);this.refreshTimer=this.timer.register(this.$timeout(function(){e.startNextRefreshTimer(n),e.refreshDashboard()},n))}var r=this.$location.search();t?(r.refresh=t,this.$location.search(r)):r.refresh&&(delete r.refresh,this.$location.search(r))},t.prototype.refreshDashboard=function(){this.$rootScope.$broadcast("refresh")},t.prototype.startNextRefreshTimer=function(t){var e=this;this.cancelNextRefresh(),this.refreshTimer=this.timer.register(this.$timeout(function(){e.startNextRefreshTimer(t),e.contextSrv.isGrafanaVisible()?e.refreshDashboard():e.autoRefreshBlocked=!0},t))},t.prototype.cancelNextRefresh=function(){this.timer.cancel(this.refreshTimer)},t.prototype.setTime=function(t,e){if(o.a.extend(this.time,t),a.a.isMoment(t.to)?(this.oldRefresh=this.dashboard.refresh||this.oldRefresh,this.setAutoRefresh(!1)):this.oldRefresh&&this.oldRefresh!==this.dashboard.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=null),!0!==e){var n=this.timeRangeForUrl(),r=this.$location.search();r.from=n.from,r.to=n.to,this.$location.search(r)}this.$rootScope.appEvent("time-range-changed",this.time),this.$timeout(this.refreshDashboard.bind(this),0)},t.prototype.timeRangeForUrl=function(){var t=this.timeRange().raw;return a.a.isMoment(t.from)&&(t.from=t.from.valueOf().toString()),a.a.isMoment(t.to)&&(t.to=t.to.valueOf().toString()),t},t.prototype.timeRange=function(){var t={from:a.a.isMoment(this.time.from)?a()(this.time.from):this.time.from,to:a.a.isMoment(this.time.to)?a()(this.time.to):this.time.to},e=this.dashboard&&this.dashboard.getTimezone();return{from:u.parse(t.from,!1,e),to:u.parse(t.to,!0,e),raw:t}},t.prototype.zoomOut=function(t,e){var n=this.timeRange(),r=n.to.valueOf()-n.from.valueOf(),i=n.to.valueOf()-r/2,o=i+r*e/2,s=i-r*e/2;if(o>Date.now()&&n.to<=Date.now()){s-=o-Date.now(),o=Date.now()}this.setTime({from:a.a.utc(s),to:a.a.utc(o)})},t}();s.default.service("timeSrv",c)},1365:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashboardCtrl",function(){return s});var r=n(27),a=n(12),i=n.n(a),o=n(2),s=function(){function t(t,e,n,a,o,s,l,u,c,p,h,d,f,m){this.$scope=t,t.editor={index:0},t.playlistSrv=d;var g;t.setupDashboard=function(e){try{t.setupDashboardInternal(e)}catch(e){t.onInitFailed(e,"Dashboard init failed",!0)}},t.setupDashboardInternal=function(e){var r=l.create(e.dashboard,e.meta);l.setCurrent(r),a.init(r),s.init(r,e.alerts),o.init(r).catch(t.onInitFailed.bind(this,"Templating init failed",!1)).finally(function(){c.init(r),c.process(),u.init(r,t),t.dashboard=r,t.dashboardMeta=r.meta,t.dashboardViewState=p.create(t),n.setupDashboardBindings(t,r),t.dashboard.updateSubmenuVisibility(),t.setWindowTitleAndTheme(),t.appEvent("dashboard-initialized",t.dashboard)}).catch(t.onInitFailed.bind(this,"Dashboard init failed",!0))},t.onInitFailed=function(e,n,r){console.log(e,r),r.data&&r.data.message?r.message=r.data.message:r.message||(r={message:r.toString()}),t.appEvent("alert-error",[e,r.message]),n&&!t.loadedFallbackDashboard&&(t.loadedFallbackDashboard=!0,t.setupDashboard({dashboard:{title:"Dashboard Init failed"}}))},t.templateVariableUpdated=function(){c.process()},t.setWindowTitleAndTheme=function(){window.document.title=r.default.window_title_prefix+t.dashboard.title},t.broadcastRefresh=function(){e.$broadcast("refresh")},t.addRowDefault=function(){t.dashboard.addEmptyRow()},t.showJsonEditor=function(n,r){var a=e.$new();a.object=r.object,a.updateHandler=r.updateHandler,t.appEvent("show-dash-editor",{src:"public/app/partials/edit_json.html",scope:a})},t.registerWindowResizeEvent=function(){i.a.element(window).bind("resize",function(){m.cancel(g),g=m(function(){t.$broadcast("render")},200)}),t.$on("$destroy",function(){i.a.element(window).unbind("resize"),t.dashboard.destroy()})},t.timezoneChanged=function(){e.$broadcast("refresh")}}return t.$inject=["$scope","$rootScope","keybindingSrv","timeSrv","variableSrv","alertingSrv","dashboardSrv","unsavedChangesSrv","dynamicDashboardSrv","dashboardViewStateSrv","contextSrv","playlistSrv","alertSrv","$timeout"],t.prototype.init=function(t){this.$scope.onAppEvent("show-json-editor",this.$scope.showJsonEditor),this.$scope.onAppEvent("template-variable-value-updated",this.$scope.templateVariableUpdated),this.$scope.setupDashboard(t),this.$scope.registerWindowResizeEvent()},t}();o.default.controller("DashboardCtrl",s)},1366:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/history/history.html",controller:c,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"HistoryListCtrl",function(){return c}),e.dashboardHistoryDirective=r;var a=(n(1367),n(7)),i=n.n(a),o=n(12),s=n.n(o),l=n(1),u=n.n(l),c=function(){function t(t,e,n,r,a,i){this.$route=t,this.$rootScope=e,this.$location=n,this.$q=r,this.historySrv=a,this.$scope=i,this.appending=!1,this.diff="basic",this.limit=10,this.loading=!1,this.max=2,this.mode="list",this.start=0,this.canCompare=!1,this.$rootScope.onAppEvent("dashboard-saved",this.onDashboardSaved.bind(this),i),this.resetFromSource()}return t.$inject=["$route","$rootScope","$location","$q","historySrv","$scope"],t.prototype.onDashboardSaved=function(){this.resetFromSource()},t.prototype.switchMode=function(t){this.mode=t,"list"===this.mode&&this.reset()},t.prototype.dismiss=function(){this.$rootScope.appEvent("hide-dash-editor")},t.prototype.addToLog=function(){this.start=this.start+this.limit,this.getLog(!0)},t.prototype.revisionSelectionChanged=function(){var t=i.a.filter(this.revisions,{checked:!0}).length;this.canCompare=2===t},t.prototype.formatDate=function(t){return this.dashboard.formatDate(t)},t.prototype.formatBasicDate=function(t){var e="browser"===this.dashboard.timezone?u()():u.a.utc();return("browser"===this.dashboard.timezone?u()(t):u.a.utc(t)).from(e)},t.prototype.getDiff=function(t){var e=this;if(this.diff=t,this.mode="compare",this.delta[this.diff])return this.$q.when(this.delta[this.diff]);var n=i.a.filter(this.revisions,{checked:!0});this.newInfo=n[0],this.baseInfo=n[1],this.isNewLatest=this.newInfo.version===this.dashboard.version,this.loading=!0;var r={new:{dashboardId:this.dashboard.id,version:this.newInfo.version},base:{dashboardId:this.dashboard.id,version:this.baseInfo.version},diffType:t};return this.historySrv.calculateDiff(r).then(function(t){e.delta[e.diff]=t}).catch(function(){e.mode="list"}).finally(function(){e.loading=!1})},t.prototype.getLog=function(t){var e=this;void 0===t&&(t=!1),this.loading=!t,this.appending=t;var n={limit:this.limit,start:this.start};return this.historySrv.getHistoryList(this.dashboard,n).then(function(n){for(var r=0,a=n;r<a.length;r++){var i=a[r];i.createdDateString=e.formatDate(i.created),i.ageString=e.formatBasicDate(i.created),i.checked=!1}e.revisions=t?e.revisions.concat(n):n}).catch(function(t){e.loading=!1}).finally(function(){e.loading=!1,e.appending=!1})},t.prototype.isLastPage=function(){return i.a.find(this.revisions,function(t){return 1===t.version})},t.prototype.reset=function(){this.delta={basic:"",json:""},this.diff="basic",this.mode="list",this.revisions=i.a.map(this.revisions,function(t){return i.a.extend({},t,{checked:!1})}),this.canCompare=!1,this.start=0,this.isNewLatest=!1},t.prototype.resetFromSource=function(){return this.revisions=[],this.getLog().then(this.reset.bind(this))},t.prototype.restore=function(t){this.$rootScope.appEvent("confirm-modal",{title:"Restore version",text:"",text2:"Are you sure you want to restore the dashboard to version "+t+"? All unsaved changes will be lost.",icon:"fa-history",yesText:"Yes, restore to version "+t,onConfirm:this.restoreConfirm.bind(this,t)})},t.prototype.restoreConfirm=function(t){var e=this;return this.loading=!0,this.historySrv.restoreDashboard(this.dashboard,t).then(function(n){e.$location.path("dashboard/db/"+n.slug),e.$route.reload(),e.$rootScope.appEvent("alert-success",["Dashboard restored","Restored from version "+t])}).catch(function(){e.mode="list",e.loading=!1})},t}();s.a.module("grafana.directives").directive("gfDashboardHistory",r)},1367:function(t,e,n){"use strict";var r=n(7),a=n.n(r),i=n(2),o=function(){function t(t,e){this.backendSrv=t,this.$q=e}return t.$inject=["backendSrv","$q"],t.prototype.getHistoryList=function(t,e){var n=t&&t.id?t.id:void 0;return n?this.backendSrv.get("api/dashboards/id/"+n+"/versions",e):this.$q.when([])},t.prototype.calculateDiff=function(t){return this.backendSrv.post("api/dashboards/calculate-diff",t)},t.prototype.restoreDashboard=function(t,e){var n=t&&t.id?t.id:void 0,r="api/dashboards/id/"+n+"/restore";return n&&a.a.isNumber(e)?this.backendSrv.post(r,{version:e}):this.$q.when({})},t}();i.default.service("historySrv",o)},1368:function(t,e,n){(function(t){var r,a;r=[n(12),n(1),n(7),n(13),n(464),n(467),n(1312)],void 0!==(a=function(t,e,n,r,a,i,o){"use strict";a=a.default,t.module("grafana.services").service("dashboardLoaderSrv",["backendSrv","dashboardSrv","datasourceSrv","$http","$q","$timeout","contextSrv","$routeParams","$rootScope",function(t,s,l,u,c,p,h,d,f){var m=this;this._dashboardLoadFailed=function(t,e){return e=e||!1,{meta:{canStar:!1,isSnapshot:e,canDelete:!1,canSave:!1,canEdit:!1,dashboardNotFound:!0},dashboard:{title:t}}},this.loadDashboard=function(e,n){var r;return r="script"===e?this._loadScriptedDashboard(n):"snapshot"===e?t.get("/api/snapshots/"+d.slug).catch(function(){return m._dashboardLoadFailed("Snapshot not found",!0)}):t.getDashboard(d.type,d.slug).catch(function(){return m._dashboardLoadFailed("Not found")}),r.then(function(t){return!0!==t.meta.dashboardNotFound&&o.impressions.addDashboardImpression(t.dashboard.id),t}),r},this._loadScriptedDashboard=function(t){var e="public/dashboards/"+t.replace(/\.(?!js)/,"/")+"?"+(new Date).getTime();return u({url:e,method:"GET"}).then(this._executeScript).then(function(t){return{meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:t.data}},function(t){return console.log("Script dashboard error "+t),f.appEvent("alert-error",["Script Error","Please make sure it exists and returns a valid dashboard"]),m._dashboardLoadFailed("Scripted dashboard")})},this._executeScript=function(t){var o={dashboardSrv:s,datasourceSrv:l,$q:c},u=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",t.data),h=u(d,a,i,n,e,window,document,r,r,o);if(n.isFunction(h)){var f=c.defer();return h(function(t){p(function(){f.resolve({data:t})})}),f.promise}return{data:h}}}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1369:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/dashnav/dashnav.html",controller:p,bindToController:!0,controllerAs:"ctrl",transclude:!0,scope:{dashboard:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashNavCtrl",function(){return p}),e.dashNavDirective=r;var a=n(7),i=n.n(a),o=n(1),s=n.n(o),l=n(12),u=n.n(l),c=n(465),p=function(){function t(t,e,n,r,a,i,o,l){if(this.$scope=t,this.$rootScope=e,this.dashboardSrv=n,this.$location=r,this.backendSrv=a,this.contextSrv=i,this.playlistSrv=o,this.navModel=l.getDashboardNav(this.dashboard,this),c.appEvents.on("save-dashboard",this.saveDashboard.bind(this),t),c.appEvents.on("delete-dashboard",this.deleteDashboard.bind(this),t),this.dashboard.meta.isSnapshot){var u=this.dashboard.meta;this.titleTooltip="Created: &nbsp;"+s()(u.created).calendar(),u.expires&&(this.titleTooltip+="<br>Expires: &nbsp;"+s()(u.expires).fromNow()+"<br>")}}return t.$inject=["$scope","$rootScope","dashboardSrv","$location","backendSrv","contextSrv","playlistSrv","navModelSrv"],t.prototype.toggleSideMenu=function(){this.contextSrv.toggleSideMenu()},t.prototype.openEditView=function(t){var e=i.a.extend(this.$location.search(),{editview:t});this.$location.search(e)},t.prototype.showHelpModal=function(){c.appEvents.emit("show-modal",{templateHtml:"<help-modal></help-modal>"})},t.prototype.starDashboard=function(){var t=this;this.dashboardSrv.starDashboard(this.dashboard.id,this.dashboard.meta.isStarred).then(function(e){t.dashboard.meta.isStarred=e})},t.prototype.shareDashboard=function(t){var e=this.$scope.$new();e.tabIndex=t,e.dashboard=this.dashboard,c.appEvents.emit("show-modal",{src:"public/app/features/dashboard/partials/shareModal.html",scope:e})},t.prototype.hideTooltip=function(t){u.a.element(t.currentTarget).tooltip("hide")},t.prototype.makeEditable=function(){return this.dashboard.editable=!0,this.dashboardSrv.saveDashboard({makeEditable:!0,overwrite:!1}).then(function(){window.location.href=window.location.href})},t.prototype.exitFullscreen=function(){this.$rootScope.appEvent("panel-change-view",{fullscreen:!1,edit:!1})},t.prototype.saveDashboard=function(){return this.dashboardSrv.saveDashboard()},t.prototype.deleteDashboard=function(){var t=this,e="",n=this.dashboard.title,r=this.dashboard.rows.reduce(function(t,e){return t+=e.panels.filter(function(t){return t.alert}).length},0);r>0&&(e="DELETE",n="This dashboad contains "+r+" alerts. Deleting this dashboad will also delete those alerts"),c.appEvents.emit("confirm-modal",{title:"Delete",text:"Do you want to delete this dashboard?",text2:n,icon:"fa-trash",confirmText:e,yesText:"Delete",onConfirm:function(){t.dashboard.meta.canSave=!1,t.deleteDashboardConfirmed()}})},t.prototype.deleteDashboardConfirmed=function(){var t=this;this.backendSrv.delete("/api/dashboards/db/"+this.dashboard.meta.slug).then(function(){c.appEvents.emit("alert-success",["Dashboard Deleted",t.dashboard.title+" has been deleted"]),t.$location.url("/")})},t.prototype.saveDashboardAs=function(){return this.dashboardSrv.showSaveAsModal()},t.prototype.viewJson=function(){var t=this.dashboard.getSaveModelClone();this.$rootScope.appEvent("show-json-editor",{object:t})},t.prototype.showSearch=function(){this.$rootScope.appEvent("show-dash-search")},t.prototype.navItemClicked=function(t,e){t.clickHandler&&(t.clickHandler(),e.preventDefault())},t}();u.a.module("grafana.directives").directive("dashnav",r)},1370:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/submenu/submenu.html",controller:l,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"SubmenuCtrl",function(){return l}),e.submenuDirective=r;var a=n(12),i=n.n(a),o=n(7),s=n.n(o),l=function(){function t(t,e,n){this.$rootScope=t,this.variableSrv=e,this.$location=n,this.annotations=this.dashboard.templating.list,this.variables=this.variableSrv.variables}return t.$inject=["$rootScope","variableSrv","$location"],t.prototype.annotationStateChanged=function(){this.$rootScope.$broadcast("refresh")},t.prototype.variableUpdated=function(t){this.variableSrv.variableUpdated(t,!0)},t.prototype.openEditView=function(t){var e=s.a.extend(this.$location.search(),{editview:t});this.$location.search(e)},t}();i.a.module("grafana.directives").directive("dashboardSubmenu",r)},1371:function(t,e,n){"use strict";function r(){return{restrict:"E",template:i,controller:o,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"SaveDashboardAsModalCtrl",function(){return o}),e.saveDashboardAsDirective=r;var a=n(2),i='\n<div class="modal-body">\n\t<div class="modal-header">\n\t\t<h2 class="modal-header-title">\n\t\t\t<i class="fa fa-copy"></i>\n\t\t\t<span class="p-l-1">Save As...</span>\n\t\t</h2>\n\n\t\t<a class="modal-header-close" ng-click="ctrl.dismiss();">\n\t\t\t<i class="fa fa-remove"></i>\n\t\t</a>\n\t</div>\n\n\t<form name="ctrl.saveForm" ng-submit="ctrl.save()" class="modal-content" novalidate>\n\t\t<div class="p-t-2">\n\t\t\t<div class="gf-form">\n\t\t\t\t<label class="gf-form-label">New name</label>\n\t\t\t\t<input type="text" class="gf-form-input" ng-model="ctrl.clone.title" give-focus="true" required>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="gf-form-button-row text-center">\n\t\t\t<button type="submit" class="btn btn-success" ng-disabled="ctrl.saveForm.$invalid">Save</button>\n\t\t\t<a class="btn-text" ng-click="ctrl.dismiss();">Cancel</a>\n\t\t</div>\n\t</form>\n</div>\n',o=function(){function t(t){this.dashboardSrv=t;var e=this.dashboardSrv.getCurrent();this.clone=e.getSaveModelClone(),this.clone.id=null,this.clone.title+=" Copy",this.clone.editable=!0,this.clone.hideControls=!1,e.id>0&&this.clone.rows.forEach(function(t){t.panels.forEach(function(t){"graph"===t.type&&t.alert&&delete t.thresholds,delete t.alert})}),delete this.clone.autoUpdate}return t.$inject=["dashboardSrv"],t.prototype.save=function(){return this.dashboardSrv.save(this.clone).then(this.dismiss)},t.prototype.keyDown=function(t){13===t.keyCode&&this.save()},t}();a.default.directive("saveDashboardAsModal",r)},1372:function(t,e,n){"use strict";function r(){return{restrict:"E",template:i,controller:o,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"SaveDashboardModalCtrl",function(){return o}),e.saveDashboardModalDirective=r;var a=n(2),i='\n<div class="modal-body">\n\t<div class="modal-header">\n\t\t<h2 class="modal-header-title">\n\t\t\t<i class="fa fa-save"></i>\n\t\t\t<span class="p-l-1">Save changes</span>\n\t\t</h2>\n\n\t\t<a class="modal-header-close" ng-click="ctrl.dismiss();">\n\t\t\t<i class="fa fa-remove"></i>\n\t\t</a>\n\t</div>\n\n\t<form name="ctrl.saveForm" ng-submit="ctrl.save()" class="modal-content" novalidate>\n\t\t<h6 class="text-center">Add a note to describe your changes</h6>\n\t\t<div class="p-t-2">\n\t\t\t<div class="gf-form">\n\t\t\t\t<label class="gf-form-hint">\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\tname="message"\n\t\t\t\t\t\tclass="gf-form-input"\n\t\t\t\t\t\tplaceholder="Updates to &hellip;"\n\t\t\t\t\t\tgive-focus="true"\n\t\t\t\t\t\tng-model="ctrl.message"\n\t\t\t\t\t\tng-model-options="{allowInvalid: true}"\n\t\t\t\t\t\tng-maxlength="this.max"\n\t\t\t\t\t\tautocomplete="off" />\n\t\t\t\t\t<small class="gf-form-hint-text muted" ng-cloak>\n\t\t\t\t\t\t<span ng-class="{\'text-error\': ctrl.saveForm.message.$invalid && ctrl.saveForm.message.$dirty }">\n\t\t\t\t\t\t\t{{ctrl.message.length || 0}}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t/ {{ctrl.max}} characters\n\t\t\t\t\t</small>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="gf-form-button-row text-center">\n\t\t\t<button type="submit" class="btn btn-success" ng-disabled="ctrl.saveForm.$invalid">Save</button>\n\t\t\t<button class="btn btn-inverse" ng-click="ctrl.dismiss();">Cancel</button>\n\t\t</div>\n\t</form>\n</div>\n',o=function(){function t(t){this.dashboardSrv=t,this.message="",this.max=64}return t.$inject=["dashboardSrv"],t.prototype.save=function(){if(this.saveForm.$valid){var t=this.dashboardSrv.getCurrent(),e=t.getSaveModelClone(),n={message:this.message};return this.dashboardSrv.save(e,n).then(this.dismiss)}},t}();a.default.directive("saveDashboardModal",r)},1373:function(t,e,n){(function(t){var r,a;r=[n(12),n(7),n(13),n(1),n(27)],void 0!==(a=function(t,e,n,r,a){"use strict";a=a.default,t.module("grafana.controllers").controller("ShareModalCtrl",["$scope","$rootScope","$location","$timeout","timeSrv","templateSrv","linkSrv",function(e,n,i,o,s,l,u){e.options={forCurrent:!0,includeTemplateVars:!0,theme:"current"},e.editor={index:e.tabIndex||0},e.init=function(){e.modeSharePanel=!!e.panel,e.tabs=[{title:"Link",src:"shareLink.html"}],e.modeSharePanel?(e.modalTitle="Share Panel",e.tabs.push({title:"Embed",src:"shareEmbed.html"})):e.modalTitle="Share",e.dashboard.meta.isSnapshot||e.tabs.push({title:"Snapshot",src:"shareSnapshot.html"}),e.dashboard.meta.isSnapshot||e.modeSharePanel||e.tabs.push({title:"Export",src:"shareExport.html"}),e.buildUrl()},e.buildUrl=function(){var n=i.absUrl(),o=n.indexOf("?");-1!==o&&(n=n.substring(0,o));var c=t.copy(i.search()),p=s.timeRange();c.from=p.from.valueOf(),c.to=p.to.valueOf(),c.orgId=a.bootData.user.orgId,e.options.includeTemplateVars&&l.fillVariableValuesForUrl(c),e.options.forCurrent||(delete c.from,delete c.to),"current"!==e.options.theme&&(c.theme=e.options.theme),e.modeSharePanel?(c.panelId=e.panel.id,c.fullscreen=!0):(delete c.panelId,delete c.fullscreen),e.shareUrl=u.addParamsToUrl(n,c);var h=n.replace(a.appSubUrl+"/dashboard/",a.appSubUrl+"/dashboard-solo/");delete c.fullscreen,delete c.edit,h=u.addParamsToUrl(h,c),e.iframeHtml='<iframe src="'+h+'" width="450" height="200" frameborder="0"></iframe>',e.imageUrl=h.replace(a.appSubUrl+"/dashboard-solo/",a.appSubUrl+"/render/dashboard-solo/"),e.imageUrl+="&width=1000",e.imageUrl+="&height=500",e.imageUrl+="&tz=UTC"+encodeURIComponent(r().format("Z"))},e.getShareUrl=function(){return e.shareUrl}}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1374:function(t,e,n){(function(t){var r,a;r=[n(12),n(7)],void 0!==(a=function(t,e){"use strict";t.module("grafana.controllers").controller("ShareSnapshotCtrl",["$scope","$rootScope","$location","backendSrv","$timeout","timeSrv",function(t,n,r,a,i,o){t.snapshot={name:t.dashboard.title,expires:0,timeoutSeconds:4},t.step=1,t.expireOptions=[{text:"1 Hour",value:3600},{text:"1 Day",value:86400},{text:"7 Days",value:604800},{text:"Never",value:0}],t.accessOptions=[{text:"Anyone with the link",value:1},{text:"Organization users",value:2},{text:"Public on the web",value:3}],t.init=function(){a.get("/api/snapshot/shared-options").then(function(e){t.externalUrl=e.externalSnapshotURL,t.sharingButtonText=e.externalSnapshotName,t.externalEnabled=e.externalEnabled})},t.apiUrl="/api/snapshots",t.createSnapshot=function(e){t.dashboard.snapshot={timestamp:new Date},e||(t.dashboard.snapshot.originalUrl=r.absUrl()),t.loading=!0,t.snapshot.external=e,n.$broadcast("refresh"),i(function(){t.saveSnapshot(e)},1e3*t.snapshot.timeoutSeconds)},t.saveSnapshot=function(e){var n=t.dashboard.getSaveModelClone();t.scrubDashboard(n);var i={dashboard:n,name:n.title,expires:t.snapshot.expires},o=e?t.externalUrl+t.apiUrl:t.apiUrl;a.post(o,i).then(function(n){if(t.loading=!1,e)t.deleteUrl=n.deleteUrl,t.snapshotUrl=n.url,t.saveExternalSnapshotRef(i,n);else{var a=r.url(),o=r.absUrl();"/"!==a&&(o=o.replace(a,"")+"/"),t.snapshotUrl=o+"dashboard/snapshot/"+n.key,t.deleteUrl=o+"api/snapshots-delete/"+n.deleteKey}t.step=2},function(){t.loading=!1})},t.getSnapshotUrl=function(){return t.snapshotUrl},t.scrubDashboard=function(n){if(n.title=t.snapshot.name,n.time=o.timeRange(),n.forEachPanel(function(t){t.targets=[],t.links=[],t.datasource=null}),n.annotations.list=e.chain(n.annotations.list).filter(function(t){return t.enable}).map(function(t){return{name:t.name,enable:t.enable,iconColor:t.iconColor,snapshotData:t.snapshotData}}).value(),e.each(n.templating.list,function(t){t.query="",t.options=t.current,t.refresh=!1}),t.modeSharePanel){var r=n.getPanelById(t.panel.id);r.span=12,n.rows=[{height:"500px",span:12,panels:[r]}]}delete t.dashboard.snapshot,t.dashboard.forEachPanel(function(t){delete t.snapshotData}),e.each(t.dashboard.annotations.list,function(t){delete t.snapshotData})},t.deleteSnapshot=function(){a.get(t.deleteUrl).then(function(){t.step=3})},t.saveExternalSnapshotRef=function(t,e){t.external=!0,t.key=e.key,t.deleteKey=e.deleteKey,a.post("/api/snapshots/",t)}}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1375:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashboardSrv",function(){return i});var r=n(2),a=n(1376),i=function(){function t(t,e,n){this.backendSrv=t,this.$rootScope=e,this.$location=n}return t.$inject=["backendSrv","$rootScope","$location"],t.prototype.create=function(t,e){return new a.a(t,e)},t.prototype.setCurrent=function(t){this.dash=t},t.prototype.getCurrent=function(){return this.dash},t.prototype.handleSaveDashboardError=function(t,e){var n=this;e.data&&"version-mismatch"===e.data.status&&(e.isHandled=!0,this.$rootScope.appEvent("confirm-modal",{title:"Conflict",text:"Someone else has updated this dashboard.",text2:"Would you still like to save this dashboard?",yesText:"Save & Overwrite",icon:"fa-warning",onConfirm:function(){n.save(t,{overwrite:!0})}})),e.data&&"name-exists"===e.data.status&&(e.isHandled=!0,this.$rootScope.appEvent("confirm-modal",{title:"Conflict",text:"Dashboard with the same name exists.",text2:"Would you still like to save this dashboard?",yesText:"Save & Overwrite",icon:"fa-warning",onConfirm:function(){n.save(t,{overwrite:!0})}})),e.data&&"plugin-dashboard"===e.data.status&&(e.isHandled=!0,this.$rootScope.appEvent("confirm-modal",{title:"Plugin Dashboard",text:e.data.message,text2:"Your changes will be lost when you update the plugin. Use Save As to create custom version.",yesText:"Overwrite",icon:"fa-warning",altActionText:"Save As",onAltAction:function(){n.showSaveAsModal()},onConfirm:function(){n.save(t,{overwrite:!0})}}))},t.prototype.postSave=function(t,e){this.dash.version=e.version;var n="/dashboard/db/"+e.slug;n!==this.$location.path()&&this.$location.url(n),this.$rootScope.appEvent("dashboard-saved",this.dash),this.$rootScope.appEvent("alert-success",["Dashboard saved"])},t.prototype.save=function(t,e){return this.backendSrv.saveDashboard(t,e).then(this.postSave.bind(this,t)).catch(this.handleSaveDashboardError.bind(this,t))},t.prototype.saveDashboard=function(t,e){return e&&this.setCurrent(this.create(e,this.dash.meta)),this.dash.meta.canSave||!0===t.makeEditable?"New dashboard"===this.dash.title?this.showSaveAsModal():this.dash.version>0?this.showSaveModal():this.save(this.dash.getSaveModelClone(),t):Promise.resolve()},t.prototype.showSaveAsModal=function(){var t=this.$rootScope.$new();t.clone=this.dash.getSaveModelClone(),t.clone.editable=!0,t.clone.hideControls=!1,this.$rootScope.appEvent("show-modal",{templateHtml:'<save-dashboard-as-modal dismiss="dismiss()"></save-dashboard-as-modal>',scope:t,modalClass:"modal--narrow"})},t.prototype.showSaveModal=function(){this.$rootScope.appEvent("show-modal",{templateHtml:'<save-dashboard-modal dismiss="dismiss()"></save-dashboard-modal>',scope:this.$rootScope.$new(),modalClass:"modal--narrow"})},t.prototype.starDashboard=function(t,e){var n,r=this;return n=e?this.backendSrv.delete("/api/user/stars/dashboard/"+t).then(function(){return!1}):this.backendSrv.post("/api/user/stars/dashboard/"+t).then(function(){return!0}),n.then(function(e){return r.dash&&r.dash.id===t&&(r.dash.meta.isStarred=e),e})},t}();r.default.service("dashboardSrv",i)},1376:function(t,e,n){"use strict";n.d(e,"a",function(){return m});var r=n(12),a=n.n(r),i=n(1),o=n.n(i),s=n(7),l=n.n(s),u=n(13),c=n.n(u),p=n(202),h=n(465),d=n(1323),f=n(1377),m=function(){function t(t,e){if(t||(t={}),this.events=new h.Emitter,this.id=t.id||null,this.revision=t.revision,this.title=t.title||"No Title",this.autoUpdate=t.autoUpdate,this.description=t.description,this.tags=t.tags||[],this.style=t.style||"dark",this.timezone=t.timezone||"",this.editable=!1!==t.editable,this.graphTooltip=t.graphTooltip||0,this.hideControls=t.hideControls||!1,this.time=t.time||{from:"now-6h",to:"now"},this.timepicker=t.timepicker||{},this.templating=this.ensureListExist(t.templating),this.annotations=this.ensureListExist(t.annotations),this.refresh=t.refresh,this.snapshot=t.snapshot,this.schemaVersion=t.schemaVersion||0,this.version=t.version||0,this.links=t.links||[],this.gnetId=t.gnetId||null,this.rows=[],t.rows)for(var n=0,r=t.rows;n<r.length;n++){var a=r[n];this.rows.push(new d.a(a))}this.addBuiltInAnnotationQuery(),this.updateSchema(t),this.initMeta(e)}return t.prototype.addBuiltInAnnotationQuery=function(){for(var t=!1,e=0,n=this.annotations.list;e<n.length;e++){if(1===n[e].builtIn){t=!0;break}}t||this.annotations.list.unshift({datasource:"-- Grafana --",name:"Annotations & Alerts",type:"dashboard",iconColor:p.b,enable:!0,hide:!0,builtIn:1})},t.prototype.initMeta=function(t){t=t||{},t.canShare=!1!==t.canShare,t.canSave=!1!==t.canSave,t.canStar=!1!==t.canStar,t.canEdit=!1!==t.canEdit,this.editable||(t.canEdit=!1,t.canDelete=!1,t.canSave=!1),this.meta=t},t.prototype.getSaveModelClone=function(){var t=this.events,e=this.meta,n=this.rows,r=this.templating.list;delete this.events,delete this.meta,this.rows=l.a.map(n,function(t){return t.getSaveModel()}),this.templating.list=l.a.map(r,function(t){return t.getSaveModel?t.getSaveModel():t});var a=c.a.extend(!0,{},this);return a=Object(f.a)(a),this.events=t,this.meta=e,this.rows=n,this.templating.list=r,a},t.prototype.addEmptyRow=function(){this.rows.push(new d.a({isNew:!0}))},t.prototype.ensureListExist=function(t){return t||(t={}),t.list||(t.list=[]),t},t.prototype.getNextPanelId=function(){var t,e,n,r,a=0;for(t=0;t<this.rows.length;t++)for(n=this.rows[t],e=0;e<n.panels.length;e++)r=n.panels[e],r.id>a&&(a=r.id);return a+1},t.prototype.forEachPanel=function(t){var e,n,r;for(e=0;e<this.rows.length;e++)for(r=this.rows[e],n=0;n<r.panels.length;n++)t(r.panels[n],n,r,e)},t.prototype.getPanelById=function(t){for(var e=0;e<this.rows.length;e++)for(var n=this.rows[e],r=0;r<n.panels.length;r++){var a=n.panels[r];if(a.id===t)return a}return null},t.prototype.addPanel=function(t,e){t.id=this.getNextPanelId(),e.addPanel(t)},t.prototype.removeRow=function(t,e){var n=this,r=l.a.indexOf(this.rows,t);if(!t.panels.length||e)return this.rows.splice(r,1),void t.destroy();h.appEvents.emit("confirm-modal",{title:"Remove Row",text:"Are you sure you want to remove this row?",icon:"fa-trash",yesText:"Delete",onConfirm:function(){n.rows.splice(r,1),t.destroy()}})},t.prototype.setPanelFocus=function(t){this.meta.focusPanelId=t},t.prototype.updateSubmenuVisibility=function(){var t=this;this.meta.submenuEnabled=function(){return t.links.length>0||(l.a.filter(t.templating.list,function(t){return 2!==t.hide}).length>0||l.a.filter(t.annotations.list,function(t){return!0!==t.hide}).length>0)}()},t.prototype.getPanelInfoById=function(t){var e={};return l.a.each(this.rows,function(n){l.a.each(n.panels,function(r,a){r.id===t&&(e.panel=r,e.row=n,e.index=a)})}),e.panel?e:null},t.prototype.duplicatePanel=function(t,e){var n=a.a.copy(t);return n.id=this.getNextPanelId(),delete n.repeat,delete n.repeatIteration,delete n.repeatPanelId,delete n.scopedVars,n.alert&&delete n.thresholds,delete n.alert,e.addPanel(n),n},t.prototype.formatDate=function(t,e){return t=o.a.isMoment(t)?t:o()(t),e=e||"YYYY-MM-DD HH:mm:ss","browser"===this.getTimezone()?o()(t).format(e):o.a.utc(t).format(e)},t.prototype.destroy=function(){this.events.removeAllListeners();for(var t=0,e=this.rows;t<e.length;t++){e[t].destroy()}},t.prototype.cycleGraphTooltip=function(){this.graphTooltip=(this.graphTooltip+1)%3},t.prototype.sharedTooltipModeEnabled=function(){return this.graphTooltip>0},t.prototype.sharedCrosshairModeOnly=function(){return 1===this.graphTooltip},t.prototype.getRelativeTime=function(t){return t=o.a.isMoment(t)?t:o()(t),"browser"===this.timezone?o()(t).fromNow():o.a.utc(t).fromNow()},t.prototype.getNextQueryLetter=function(t){return l.a.find("ABCDEFGHIJKLMNOPQRSTUVWXYZ",function(e){return l.a.every(t.targets,function(t){return t.refId!==e})})},t.prototype.isTimezoneUtc=function(){return"utc"===this.getTimezone()},t.prototype.getTimezone=function(){return this.timezone?this.timezone:h.contextSrv.user.timezone},t.prototype.updateSchema=function(t){var e,n,r,a=this.schemaVersion,i=[];if(this.schemaVersion=14,a!==this.schemaVersion){if(a<2&&(t.services&&t.services.filter&&(this.time=t.services.filter.time,this.templating.list=t.services.filter.list||[]),i.push(function(t){"graphite"===t.type&&(t.type="graph"),"graph"===t.type&&(l.a.isBoolean(t.legend)&&(t.legend={show:t.legend}),t.grid&&(t.grid.min&&(t.grid.leftMin=t.grid.min,delete t.grid.min),t.grid.max&&(t.grid.leftMax=t.grid.max,delete t.grid.max)),t.y_format&&(t.y_formats[0]=t.y_format,delete t.y_format),t.y2_format&&(t.y_formats[1]=t.y2_format,delete t.y2_format))})),a<3){var o=this.getNextPanelId();i.push(function(t){t.id||(t.id=o,o+=1)})}if(a<4&&i.push(function(t){"graph"===t.type&&(l.a.each(t.aliasYAxis,function(e,n){t.seriesOverrides=[{alias:n,yaxis:e}]}),delete t.aliasYAxis)}),a<6){var s=l.a.find(t.pulldowns,{type:"annotations"});for(s&&(this.annotations={list:s.annotations||[]}),e=0;e<this.templating.list.length;e++){var u=this.templating.list[e];void 0===u.datasource&&(u.datasource=null),"filter"===u.type&&(u.type="query"),void 0===u.type&&(u.type="query"),void 0===u.allFormat&&(u.allFormat="glob")}}if(a<7&&(t.nav&&t.nav.length&&(this.timepicker=t.nav[0]),i.push(function(t){l.a.each(t.targets,function(e){e.refId||(e.refId=this.getNextQueryLetter(t))}.bind(this))})),a<8&&i.push(function(t){l.a.each(t.targets,function(t){t.fields&&t.tags&&t.groupBy&&(t.rawQuery?(delete t.fields,delete t.fill):(t.select=l.a.map(t.fields,function(t){var e=[];return e.push({type:"field",params:[t.name]}),e.push({type:t.func,params:[]}),t.mathExpr&&e.push({type:"math",params:[t.mathExpr]}),t.asExpr&&e.push({type:"alias",params:[t.asExpr]}),e}),delete t.fields,l.a.each(t.groupBy,function(t){"time"===t.type&&t.interval&&(t.params=[t.interval],delete t.interval),"tag"===t.type&&t.key&&(t.params=[t.key],delete t.key)}),t.fill&&(t.groupBy.push({type:"fill",params:[t.fill]}),delete t.fill)))})}),a<9&&i.push(function(t){if(("singlestat"===t.type||""===t.thresholds)&&t.thresholds){var e=t.thresholds.split(",");e.length>=3&&(e.shift(),t.thresholds=e.join(","))}}),a<10&&i.push(function(t){"table"===t.type&&l.a.each(t.styles,function(t){if(t.thresholds&&t.thresholds.length>=3){var e=t.thresholds;e.shift(),t.thresholds=e}})}),a<12&&l.a.each(this.templating.list,function(t){t.refresh&&(t.refresh=1),t.refresh||(t.refresh=0),t.hideVariable?t.hide=2:t.hideLabel&&(t.hide=1)}),a<12&&i.push(function(t){"graph"===t.type&&t.grid&&(t.yaxes||(t.yaxes=[{show:t["y-axis"],min:t.grid.leftMin,max:t.grid.leftMax,logBase:t.grid.leftLogBase,format:t.y_formats[0],label:t.leftYAxisLabel},{show:t["y-axis"],min:t.grid.rightMin,max:t.grid.rightMax,logBase:t.grid.rightLogBase,format:t.y_formats[1],label:t.rightYAxisLabel}],t.xaxis={show:t["x-axis"]},delete t.grid.leftMin,delete t.grid.leftMax,delete t.grid.leftLogBase,delete t.grid.rightMin,delete t.grid.rightMax,delete t.grid.rightLogBase,delete t.y_formats,delete t.leftYAxisLabel,delete t.rightYAxisLabel,delete t["y-axis"],delete t["x-axis"]))}),a<13&&i.push(function(t){if("graph"===t.type&&t.grid){t.thresholds=[];var e={},n={};null!==t.grid.threshold1&&(e.value=t.grid.threshold1,t.grid.thresholdLine?(e.line=!0,e.lineColor=t.grid.threshold1Color,e.colorMode="custom"):(e.fill=!0,e.fillColor=t.grid.threshold1Color,e.colorMode="custom")),null!==t.grid.threshold2&&(n.value=t.grid.threshold2,t.grid.thresholdLine?(n.line=!0,n.lineColor=t.grid.threshold2Color,n.colorMode="custom"):(n.fill=!0,n.fillColor=t.grid.threshold2Color,n.colorMode="custom")),l.a.isNumber(e.value)&&(l.a.isNumber(n.value)?e.value>n.value?(e.op=n.op="lt",t.thresholds.push(e),t.thresholds.push(n)):(e.op=n.op="gt",t.thresholds.push(e),t.thresholds.push(n)):(e.op="gt",t.thresholds.push(e))),delete t.grid.threshold1,delete t.grid.threshold1Color,delete t.grid.threshold2,delete t.grid.threshold2Color,delete t.grid.thresholdLine}}),a<14&&(this.graphTooltip=t.sharedCrosshair?1:0),0!==i.length)for(e=0;e<this.rows.length;e++){var c=this.rows[e];for(n=0;n<c.panels.length;n++)for(r=0;r<i.length;r++)i[r].call(this,c.panels[n])}}},t}()},1377:function(t,e,n){"use strict";function r(t){if(i.a.isArray(t))return t.map(r);if(i.a.isPlainObject(t)){for(var e={},n=0,a=i.a.keys(t).sort();n<a.length;n++){var o=a[n];e[o]=r(t[o])}return e}return t}e.a=r;var a=n(7),i=n.n(a)},1378:function(t,e,n){(function(t){var r,a;r=[n(12),n(7),n(13),n(27)],void 0!==(a=function(t,e,n,r){"use strict";r=r.default,t.module("grafana.services").factory("dashboardViewStateSrv",["$location","$timeout",function(t,a){function i(e){var n=this;n.state={},n.panelScopes=[],n.$scope=e,n.dashboard=e.dashboard,e.onAppEvent("$routeUpdate",function(){var t=n.getQueryStringState();n.needsSync(t)&&n.update(t,!0)}),e.onAppEvent("panel-change-view",function(t,e){n.update(e)}),e.onAppEvent("panel-initialized",function(t,e){n.registerPanel(e.scope)}),t.replace(),this.update(this.getQueryStringState()),this.expandRowForPanel()}return i.prototype.expandRowForPanel=function(){if(this.state.panelId){var t=this.$scope.dashboard.getPanelInfoById(this.state.panelId);t&&(t.row.collapse=!1)}},i.prototype.needsSync=function(t){return!1===e.isEqual(this.state,t)},i.prototype.getQueryStringState=function(){var e=t.search();return e.panelId=parseInt(e.panelId)||null,e.fullscreen=!!e.fullscreen||null,e.edit="true"===e.edit||!0===e.edit||null,e.editview=e.editview||null,e.orgId=r.bootData.user.orgId,e},i.prototype.serializeToUrl=function(){var t=e.clone(this.state);return t.fullscreen=!!this.state.fullscreen||null,t.edit=!!this.state.edit||null,t},i.prototype.update=function(n,r){n.toggle&&(delete n.toggle,this.state.fullscreen&&n.fullscreen&&this.state.edit===n.edit&&(n.fullscreen=!n.fullscreen)),this.editStateChanged=n.edit!==this.state.edit,e.extend(this.state,n),this.dashboard.meta.fullscreen=this.state.fullscreen,this.state.fullscreen||(this.state.fullscreen=null,this.state.edit=null,this.dashboard.meta.soloMode||(this.state.panelId=null)),this.state.edit||delete this.state.tab,!0!==r&&t.search(this.serializeToUrl()),this.syncState()},i.prototype.syncState=function(){if(0!==this.panelScopes.length)if(this.dashboard.meta.fullscreen){var t=this.getPanelScope(this.state.panelId);if(!t)return;if(this.fullscreenPanel){if(this.fullscreenPanel===t&&!1===this.editStateChanged)return;this.leaveFullscreen(!1)}t.ctrl.editModeInitiated||t.ctrl.initEditMode(),t.ctrl.fullscreen||this.enterFullscreen(t)}else this.fullscreenPanel&&this.leaveFullscreen(!0)},i.prototype.getPanelScope=function(t){return e.find(this.panelScopes,function(e){return e.ctrl.panel.id===t})},i.prototype.leaveFullscreen=function(t){var e=this,n=e.fullscreenPanel.ctrl;if(n.editMode=!1,n.fullscreen=!1,this.$scope.appEvent("panel-fullscreen-exit",{panelId:n.panel.id}),!t)return!1;a(function(){e.oldTimeRange!==n.range?e.$scope.broadcastRefresh():e.$scope.$broadcast("render"),delete e.fullscreenPanel})},i.prototype.enterFullscreen=function(t){var e=t.ctrl;e.editMode=this.state.edit&&this.dashboard.meta.canEdit,e.fullscreen=!0,this.oldTimeRange=e.range,this.fullscreenPanel=t,n(window).scrollTop(0),this.$scope.appEvent("panel-fullscreen-enter",{panelId:e.panel.id}),a(function(){e.render()})},i.prototype.registerPanel=function(t){var n=this;n.panelScopes.push(t),n.dashboard.meta.soloMode||n.state.panelId===t.ctrl.panel.id&&(n.state.edit?t.ctrl.editPanel():t.ctrl.viewPanel());var r=t.$on("$destroy",function(){n.panelScopes=e.without(n.panelScopes,t),r()})},{create:function(t){return new i(t)}}}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1379:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AlertingSrv",function(){return a});var r=n(2),a=function(){function t(){}return t.prototype.init=function(t,e){this.dashboard=t,this.alerts=e||[]},t}();r.default.service("alertingSrv",a)},1380:function(t,e,n){(function(t){var r,a;r=[n(12),n(7)],void 0!==(a=function(t,e){"use strict";t.module("grafana.services").service("unsavedChangesSrv",["$rootScope","$q","$location","$timeout","contextSrv","dashboardSrv","$window",function(n,r,a,i,o,s,l){function u(t,e,n){var r=this;this.current=t,this.originalPath=a.path(),this.scope=e,e.onAppEvent("dashboard-saved",function(){this.original=this.current.getSaveModelClone(),this.originalPath=a.path()}.bind(this)),l.onbeforeunload=function(){if(!r.ignoreChanges())return r.hasChanges()?"There are unsaved changes to this dashboard":void 0},e.$on("$locationChangeStart",function(t,e){return r.originalPath===a.path()||!!r.ignoreChanges()||void(r.hasChanges()&&(t.preventDefault(),r.next=e,i(function(){r.open_modal()})))}),n?i(function(){r.original=t.getSaveModelClone()},n):r.original=t.getSaveModelClone()}var c=u.prototype;c.ignoreChanges=function(){if(!this.original)return!0;if(!o.isEditor)return!0;if(!this.current||!this.current.meta)return!0;var t=this.current.meta;return!t.canSave||t.fromScript||t.fromFile},c.cleanDashboardFromIgnoredChanges=function(t){t.time=0,t.refresh=0,t.schemaVersion=0,t.rows=e.filter(t.rows,function(t){return!t.repeatRowId&&(t.panels=e.filter(t.panels,function(t){return!t.repeatPanelId&&(t.scopedVars=null,t.span=null,t.legend&&(delete t.legend.sort,delete t.legend.sortDesc),!0)}),t.collapse=!1,!0)}),e.each(t.templating.list,function(t){t.current=null,t.options=null,t.filters=null})},c.hasChanges=function(){var n=this.current.getSaveModelClone(),r=this.original;this.cleanDashboardFromIgnoredChanges(n),this.cleanDashboardFromIgnoredChanges(r);var a=e.find(n.nav,{type:"timepicker"}),i=e.find(r.nav,{type:"timepicker"});return a&&i&&(a.now=i.now),t.toJson(n)!==t.toJson(r)},c.discardChanges=function(){this.original=null,this.gotoNext()},c.open_modal=function(){n.appEvent("show-modal",{templateHtml:'<unsaved-changes-modal dismiss="dismiss()"></unsaved-changes-modal>',modalClass:"modal--narrow confirm-modal"})},c.saveChanges=function(){var t=this,e=n.$on("dashboard-saved",function(){e(),i(function(){t.gotoNext()})});n.appEvent("save-dashboard")},c.gotoNext=function(){var t=a.absUrl().length-a.url().length,e=this.next.substring(t);a.url(e)},this.Tracker=u,this.init=function(t,e){return this.tracker=new u(t,e,1e3),this.tracker}}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1381:function(t,e,n){"use strict";function r(){return{restrict:"E",template:i,controller:o,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"UnsavedChangesModalCtrl",function(){return o}),e.unsavedChangesModalDirective=r;var a=n(2),i='\n<div class="modal-body">\n  <div class="modal-header">\n    <h2 class="modal-header-title">\n      <i class="fa fa-exclamation"></i>\n      <span class="p-l-1">Unsaved changes</span>\n    </h2>\n\n    <a class="modal-header-close" ng-click="ctrl.dismiss();">\n      <i class="fa fa-remove"></i>\n    </a>\n  </div>\n\n  <div class="modal-content text-center">\n\n    <div class="confirm-modal-text">\n      Do you want to save your changes?\n    </div>\n\n    <div class="confirm-modal-buttons">\n      <button type="button" class="btn btn-inverse" ng-click="ctrl.dismiss()">Cancel</button>\n      <button type="button" class="btn btn-danger" ng-click="ctrl.discard()">Discard</button>\n      <button type="button" class="btn btn-success" ng-click="ctrl.save()">Save</button>\n    </div>\n  </div>\n</div>\n',o=function(){function t(t){this.unsavedChangesSrv=t}return t.$inject=["unsavedChangesSrv"],t.prototype.discard=function(){this.dismiss(),this.unsavedChangesSrv.tracker.discardChanges()},t.prototype.save=function(){this.dismiss(),this.unsavedChangesSrv.tracker.saveChanges()},t}();a.default.directive("unsavedChangesModal",r)},1382:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/timepicker/settings.html",controller:d,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}function a(){return{restrict:"E",templateUrl:"public/app/features/dashboard/timepicker/timepicker.html",controller:d,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"TimePickerCtrl",function(){return d}),e.settingsDirective=r,e.timePickerDirective=a;var i=n(7),o=n.n(i),s=n(12),l=n.n(s),u=n(1),c=n.n(u),p=n(471),h=n(1383),d=function(){function t(e,n,r){var a=this;this.$scope=e,this.$rootScope=n,this.timeSrv=r,e.ctrl=this,n.onAppEvent("shift-time-forward",function(){return a.move(1)},e),n.onAppEvent("shift-time-backward",function(){return a.move(-1)},e),n.onAppEvent("refresh",this.onRefresh.bind(this),e),this.panel=this.dashboard.timepicker,o.a.defaults(this.panel,t.defaults),this.firstDayOfWeek=c.a.localeData().firstDayOfWeek(),this.onRefresh()}return t.$inject=["$scope","$rootScope","timeSrv"],t.prototype.onRefresh=function(){var t=l.a.copy(this.timeSrv.timeRange()),e=l.a.copy(t.raw);this.dashboard.isTimezoneUtc()?this.isUtc=!0:(t.from.local(),t.to.local(),c.a.isMoment(e.from)&&e.from.local(),c.a.isMoment(e.to)&&e.to.local(),this.isUtc=!1),this.rangeString=p.b(e),this.absolute={fromJs:t.from.toDate(),toJs:t.to.toDate()},this.tooltip=this.dashboard.formatDate(t.from)+" <br>to<br>",this.tooltip+=this.dashboard.formatDate(t.to),this.timeRaw=e},t.prototype.zoom=function(t){this.$rootScope.appEvent("zoom-out",2)},t.prototype.move=function(t){var e,n,r=this.timeSrv.timeRange(),a=(r.to.valueOf()-r.from.valueOf())/2;-1===t?(e=r.to.valueOf()-a,n=r.from.valueOf()-a):1===t?(e=r.to.valueOf()+a,n=r.from.valueOf()+a,e>Date.now()&&r.to<Date.now()&&(e=Date.now(),n=r.from.valueOf())):(e=r.to.valueOf(),n=r.from.valueOf()),this.timeSrv.setTime({from:c.a.utc(n),to:c.a.utc(e)})},t.prototype.openDropdown=function(){this.onRefresh(),this.editTimeRaw=this.timeRaw,this.timeOptions=p.c(this.panel,this.rangeString),this.refresh={value:this.dashboard.refresh,options:o.a.map(this.panel.refresh_intervals,function(t){return{text:t,value:t}})},this.refresh.options.unshift({text:"off"}),this.$rootScope.appEvent("show-dash-editor",{editview:"timepicker",scope:this.$scope,cssClass:"gf-timepicker-dropdown"})},t.prototype.applyCustom=function(){this.refresh.value!==this.dashboard.refresh&&this.timeSrv.setAutoRefresh(this.refresh.value),this.timeSrv.setTime(this.editTimeRaw),this.$rootScope.appEvent("hide-dash-editor")},t.prototype.absoluteFromChanged=function(){this.editTimeRaw.from=this.getAbsoluteMomentForTimezone(this.absolute.fromJs)},t.prototype.absoluteToChanged=function(){this.editTimeRaw.to=this.getAbsoluteMomentForTimezone(this.absolute.toJs)},t.prototype.getAbsoluteMomentForTimezone=function(t){return this.dashboard.isTimezoneUtc()?c()(t).utc():c()(t)},t.prototype.setRelativeFilter=function(t){var e={from:t.from,to:t.to};this.panel.nowDelay&&"now"===e.to&&(e.to="now-"+this.panel.nowDelay),this.timeSrv.setTime(e),this.$rootScope.appEvent("hide-dash-editor")},t.tooltipFormat="MMM D, YYYY HH:mm:ss",t.defaults={time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"],refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"]},t}();l.a.module("grafana.directives").directive("gfTimePickerSettings",r),l.a.module("grafana.directives").directive("gfTimePicker",a),l.a.module("grafana.directives").directive("inputDatetime",h.a)},1383:function(t,e,n){"use strict";function r(){return{restrict:"A",require:"ngModel",link:function(t,e,n,r){var a="YYYY-MM-DD HH:mm:ss",s=function(e){if(-1!==e.indexOf("now"))return o.isValid(e)?(r.$setValidity("error",!0),e):void r.$setValidity("error",!1);var n;return n=t.ctrl.isUtc?i.a.utc(e,a):i()(e,a),n.isValid()?(r.$setValidity("error",!0),n):void r.$setValidity("error",!1)},l=function(t){return i.a.isMoment(t)?t.format(a):t};r.$parsers.push(s),r.$formatters.push(l)}}}e.a=r;var a=n(1),i=n.n(a),o=n(467)},1384:function(t,e,n){"use strict";function r(t,e,n){return{restrict:"E",template:a,scope:{onUpload:"&"},link:function(t){function n(e){for(var n,r=e.target.files,a=0;n=r[a];a++){var i=new FileReader;i.onload=function(){return function(e){var n;try{n=JSON.parse(e.target.result)}catch(e){return console.log(e),void t.appEvent("alert-error",["Import failed","JSON -> JS Serialization failed: "+e.message])}t.$apply(function(){t.onUpload({dash:n})})}}(),i.readAsText(n)}}var r=window;r.File&&r.FileReader&&r.FileList&&r.Blob?document.getElementById("dashupload").addEventListener("change",n,!1):e.set("Oops","Sorry, the HTML5 File APIs are not fully supported in this browser.","error")}}}r.$inject=["timer","alertSrv","$location"],Object.defineProperty(e,"__esModule",{value:!0});var a='\n<input type="file" id="dashupload" name="dashupload" class="hide"/>\n<label class="btn btn-secondary" for="dashupload">\n  <i class="fa fa-upload"></i>\n  Upload .json File\n</label>\n';n(2).default.directive("dashUpload",r)},1385:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/import/dash_import.html",controller:l,bindToController:!0,controllerAs:"ctrl"}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashImportCtrl",function(){return l}),e.dashImportDirective=r;var a=n(2),i=n(27),o=n(7),s=n.n(o),l=function(){function t(t,e,n,r){this.backendSrv=t,this.$location=e,this.$scope=n,this.step=1,this.nameExists=!1,r.gnetId&&(this.gnetUrl=r.gnetId,this.checkGnetDashboard())}return t.$inject=["backendSrv","$location","$scope","$routeParams"],t.prototype.onUpload=function(t){if(this.dash=t,this.dash.id=null,this.step=2,this.inputs=[],this.dash.__inputs)for(var e=0,n=this.dash.__inputs;e<n.length;e++){var r=n[e],a={name:r.name,label:r.label,info:r.description,value:r.value,type:r.type,pluginId:r.pluginId,options:[]};"datasource"===r.type?this.setDatasourceOptions(r,a):a.info||(a.info="Specify a string constant"),this.inputs.push(a)}this.inputsValid=0===this.inputs.length,this.titleChanged()},t.prototype.setDatasourceOptions=function(t,e){var n=s.a.filter(i.default.datasources,function(e){return e.type===t.pluginId});0===n.length?e.info="No data sources of type "+t.pluginName+" found":e.info||(e.info="Select a "+t.pluginName+" data source"),e.options=n.map(function(t){return{text:t.name,value:t.name}})},t.prototype.inputValueChanged=function(){this.inputsValid=!0;for(var t=0,e=this.inputs;t<e.length;t++){e[t].value||(this.inputsValid=!1)}},t.prototype.titleChanged=function(){var t=this;this.backendSrv.search({query:this.dash.title}).then(function(e){t.nameExists=!1;for(var n=0,r=e;n<r.length;n++){var a=r[n];if(t.dash.title===a.title){t.nameExists=!0;break}}})},t.prototype.saveDashboard=function(){var t=this,e=this.inputs.map(function(t){return{name:t.name,type:t.type,pluginId:t.pluginId,value:t.value}});return this.backendSrv.post("api/dashboards/import",{dashboard:this.dash,overwrite:!0,inputs:e}).then(function(e){t.$location.url("dashboard/"+e.importedUri),t.$scope.dismiss()})},t.prototype.loadJsonText=function(){try{this.parseError="";var t=JSON.parse(this.jsonText);this.onUpload(t)}catch(t){return console.log(t),void(this.parseError=t.message)}},t.prototype.checkGnetDashboard=function(){var t=this;this.gnetError="";var e,n=/(^\d+$)|dashboards\/(\d+)/.exec(this.gnetUrl);return n&&n[1]?e=n[1]:n&&n[2]?e=n[2]:this.gnetError="Could not find dashboard",this.backendSrv.get("api/gnet/dashboards/"+e).then(function(e){t.gnetInfo=e,e.json.gnetId=e.id,t.onUpload(e.json)}).catch(function(e){e.isHandled=!0,t.gnetError=e.data.message||e})},t.prototype.back=function(){this.gnetUrl="",this.step=1,this.gnetError="",this.gnetInfo=""},t}();a.default.directive("dashImport",r)},1386:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/export/export_modal.html",controller:u,bindToController:!0,controllerAs:"ctrl",scope:{dismiss:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashExportCtrl",function(){return u}),e.dashExportDirective=r;var a=n(12),i=n.n(a),o=n(203),s=(n.n(o),n(2)),l=n(1387),u=function(){function t(t,e,n){var r=this;this.dashboardSrv=t,this.$scope=n,this.exporter=new l.a(e),this.exporter.makeExportable(this.dashboardSrv.getCurrent()).then(function(t){r.$scope.$apply(function(){r.dash=t})})}return t.$inject=["dashboardSrv","datasourceSrv","$scope"],t.prototype.save=function(){var t=new Blob([i.a.toJson(this.dash,!0)],{type:"application/json;charset=utf-8"});Object(o.saveAs)(t,this.dash.title+"-"+(new Date).getTime()+".json")},t.prototype.saveJson=function(){var t=this.dashboardSrv.getCurrent().getSaveModelClone();this.$scope.$root.appEvent("show-json-editor",{object:t}),this.dismiss()},t}();s.default.directive("dashExportModal",r)},1387:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(27),a=n(7),i=n.n(a),o=n(1388),s=function(){function t(t){this.datasourceSrv=t}return t.prototype.makeExportable=function(t){var e=this,n=new o.a;n.init(t),n.process({cleanUpOnly:!0});var a=t.getSaveModelClone();a.id=null,n.process();for(var s=[],l={},u={},c=[],p={},h=0,d=a.templating.list;h<d.length;h++){var f=d[h];p[f.name]=f}for(var m=function(t){t.datasource&&0===t.datasource.indexOf("$")&&p[t.datasource.substring(1)]||c.push(e.datasourceSrv.get(t.datasource).then(function(e){if(!e.meta.builtIn){var n="DS_"+e.name.replace(" ","_").toUpperCase();u[n]={name:n,label:e.name,description:"",type:"datasource",pluginId:e.meta.id,pluginName:e.meta.name},t.datasource="${"+n+"}",l["datasource"+e.meta.id]={type:"datasource",id:e.meta.id,name:e.meta.name,version:e.meta.info.version||"1.0.0"}}}))},g=0,v=a.rows;g<v.length;g++)for(var y=v[g],b=0,x=y.panels;b<x.length;b++){var S=x[b];if(void 0!==S.datasource&&m(S),S.targets)for(var w=0,k=S.targets;w<k.length;w++){var _=k[w];void 0!==_.datasource&&m(_)}var M=r.default.panels[S.type];M&&(l["panel"+M.id]={type:"panel",id:M.id,name:M.name,version:M.info.version})}for(var T=0,C=a.templating.list;T<C.length;T++){var f=C[T];"query"===f.type&&(m(f),f.options=[],f.current={},f.refresh=f.refresh>0?f.refresh:1)}for(var P=0,O=a.annotations.list;P<O.length;P++){m(O[P])}return l.grafana={type:"grafana",id:"grafana",name:"Grafana",version:r.default.buildInfo.version},Promise.all(c).then(function(){i.a.each(u,function(t,e){s.push(t)});for(var t=0,e=a.templating.list;t<e.length;t++){var n=e[t];if("constant"===n.type){var r="VAR_"+n.name.replace(" ","_").toUpperCase();s.push({name:r,type:"constant",label:n.label||n.name,value:n.current.value,description:""}),n.query="${"+r+"}",n.options[0]=n.current={value:n.query,text:n.query}}}var o={};return o.__inputs=s,o.__requires=i.a.sortBy(l,["id"]),i.a.defaults(o,a),o}).catch(function(t){return console.log("Export failed:",t),{error:t}})},t}()},1388:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=n(2),l=n(1323),u=function(){function t(){}return t.prototype.init=function(t){this.dashboard=t,this.variables=t.templating.list},t.prototype.process=function(t){if(!this.dashboard.snapshot&&0!==this.variables.length){this.iteration=(this.iteration||(new Date).getTime())+1,t=t||{};var e,n,r,a,i=t.cleanUpOnly;for(e=0;e<this.dashboard.rows.length;e++)for(r=this.dashboard.rows[e],delete r.scopedVars,n=0;n<r.panels.length;n++)delete r.panels[n].scopedVars;for(e=0;e<this.dashboard.rows.length;e++){if(r=this.dashboard.rows[e],r.repeat)i||this.repeatRow(r,e);else if(r.repeatRowId&&r.repeatIteration!==this.iteration){this.dashboard.removeRow(r,!0),e-=1;continue}for(n=0;n<r.panels.length;n++)a=r.panels[n],a.repeat?i||this.repeatPanel(a,r):a.repeatPanelId&&a.repeatIteration!==this.iteration&&(r.panels=o.a.without(r.panels,a),n-=1);r.panelSpanChanged()}}},t.prototype.getRowClone=function(t,e,n){if(0===e)return t;var r,i,o,s,u=n+1;for(r=0;r<this.dashboard.rows.length;r++)if(o=this.dashboard.rows[r],o.repeatRowId===u&&o.repeatIteration!==this.iteration){s=o,s.copyPropertiesFromRowSource(t);break}if(!s){var c=a.a.copy(t.getSaveModel());for(s=new l.a(c),this.dashboard.rows.splice(n+e,0,s),r=0;r<s.panels.length;r++)i=s.panels[r],i.id=this.dashboard.getNextPanelId()}return s.repeat=null,s.repeatRowId=u,s.repeatIteration=this.iteration,s},t.prototype.repeatRow=function(t,e){var n=this,r=o.a.find(this.variables,{name:t.repeat});if(r){var a,i,s,l;a="All"===r.current.text?r.options.slice(1,r.options.length):o.a.filter(r.options,{selected:!0}),o.a.each(a,function(a,o){for(i=n.getRowClone(t,o,e),i.scopedVars={},i.scopedVars[r.name]=a,s=0;s<i.panels.length;s++)l=i.panels[s],l.scopedVars={},l.scopedVars[r.name]=a})}},t.prototype.getPanelClone=function(t,e,n){if(0===n)return t;var r,i,o,s;for(r=0;r<e.panels.length;r++)if(o=e.panels[r],o.repeatIteration!==this.iteration&&o.repeatPanelId===t.id){s=o;break}return s||(s={id:this.dashboard.getNextPanelId()},e.panels.push(s)),i=s.id,a.a.copy(t,s),s.id=i,s.repeatIteration=this.iteration,s.repeatPanelId=t.id,s.repeat=null,s},t.prototype.repeatPanel=function(t,e){var n=this,r=o.a.find(this.variables,{name:t.repeat});if(r){var a;a="All"===r.current.text?r.options.slice(1,r.options.length):o.a.filter(r.options,{selected:!0}),o.a.each(a,function(i,o){var s=n.getPanelClone(t,e,o);s.span=Math.max(12/a.length,t.minSpan||4),s.scopedVars=s.scopedVars||{},s.scopedVars[r.name]=i})}},t}();s.default.service("dynamicDashboardSrv",u)},1389:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/export_data/export_data_modal.html",controller:l,controllerAs:"ctrl",scope:{panel:"<",data:"<"},bindToController:!0}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ExportDataModalCtrl",function(){return l}),e.exportDataModal=r;var a=n(12),i=n.n(a),o=n(1324),s=n(53),l=function(){function t(){this.asRows=!0,this.dateTimeFormat="YYYY-MM-DDTHH:mm:ssZ"}return t.prototype.export=function(){"table"===this.panel?o.exportTableDataToCsv(this.data,this.excel):this.asRows?o.exportSeriesListToCsv(this.data,this.dateTimeFormat,this.excel):o.exportSeriesListToCsvColumns(this.data,this.dateTimeFormat,this.excel),this.dismiss()},t.prototype.dismiss=function(){s.a.emit("hide-modal")},t}();i.a.module("grafana.directives").directive("exportDataModal",r)},1390:function(t,e,n){"use strict";function r(){return{restrict:"E",template:c,controller:u,bindToController:!0,controllerAs:"ctrl",scope:{variable:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AdHocFiltersCtrl",function(){return u}),e.adHocFiltersComponent=r;var a=n(7),i=n.n(a),o=n(12),s=n.n(o),l=n(2),u=function(){function t(t,e,n,r,a,i){this.uiSegmentSrv=t,this.datasourceSrv=e,this.$q=n,this.variableSrv=r,this.$rootScope=i,this.removeTagFilterSegment=t.newSegment({fake:!0,value:"-- remove filter --"}),this.buildSegmentModel(),this.$rootScope.onAppEvent("template-variable-value-updated",this.buildSegmentModel.bind(this),a)}return t.$inject=["uiSegmentSrv","datasourceSrv","$q","variableSrv","$scope","$rootScope"],t.prototype.buildSegmentModel=function(){this.segments=[],this.variable.value&&i.a.isArray(this.variable.value);for(var t=0,e=this.variable.filters;t<e.length;t++){var n=e[t];this.segments.length>0&&this.segments.push(this.uiSegmentSrv.newCondition("AND")),void 0!==n.key&&void 0!==n.value&&(this.segments.push(this.uiSegmentSrv.newKey(n.key)),this.segments.push(this.uiSegmentSrv.newOperator(n.operator)),this.segments.push(this.uiSegmentSrv.newKeyValue(n.value)))}this.segments.push(this.uiSegmentSrv.newPlusButton())},t.prototype.getOptions=function(t,e){var n=this;return"operator"===t.type?this.$q.when(this.uiSegmentSrv.newOperators(["=","!=","<",">","=~","!~"])):"condition"===t.type?this.$q.when([this.uiSegmentSrv.newSegment("AND")]):this.datasourceSrv.get(this.variable.datasource).then(function(r){var a={},o=null;return"value"!==t.type?o=r.getTagKeys():(a.key=n.segments[e-2].value,o=r.getTagValues(a)),o.then(function(e){return e=i.a.map(e,function(t){return n.uiSegmentSrv.newSegment({value:t.text})}),"key"===t.type&&e.splice(0,0,s.a.copy(n.removeTagFilterSegment)),e})})},t.prototype.segmentChanged=function(t,e){this.segments[e]=t,t.value===this.removeTagFilterSegment.value?(this.segments.splice(e,3),0===this.segments.length?this.segments.push(this.uiSegmentSrv.newPlusButton()):this.segments.length>2&&(this.segments.splice(Math.max(e-1,0),1),"plus-button"!==this.segments[this.segments.length-1].type&&this.segments.push(this.uiSegmentSrv.newPlusButton()))):("plus-button"===t.type&&(e>2&&this.segments.splice(e,0,this.uiSegmentSrv.newCondition("AND")),this.segments.push(this.uiSegmentSrv.newOperator("=")),this.segments.push(this.uiSegmentSrv.newFake("select tag value","value","query-segment-value")),t.type="key",t.cssClass="query-segment-key"),e+1===this.segments.length&&this.segments.push(this.uiSegmentSrv.newPlusButton())),this.updateVariableModel()},t.prototype.updateVariableModel=function(){var t=[],e=-1,n=!1;this.segments.forEach(function(r){if("value"===r.type&&r.fake)return void(n=!0);switch(r.type){case"key":t.push({key:r.value}),e+=1;break;case"value":t[e].value=r.value;break;case"operator":t[e].operator=r.value;break;case"condition":t[e].condition=r.value}}),n||(this.variable.setFilters(t),this.variableSrv.variableUpdated(this.variable,!0))},t}(),c='\n<div class="gf-form-inline">\n  <div class="gf-form" ng-repeat="segment in ctrl.segments">\n    <metric-segment segment="segment" get-options="ctrl.getOptions(segment, $index)"\n                    on-change="ctrl.segmentChanged(segment, $index)"></metric-segment>\n  </div>\n</div>\n';l.default.directive("adHocFilters",r)},1391:function(t,e,n){"use strict";function r(t){return{restrict:"E",templateUrl:"public/app/features/dashboard/row/row.html",controller:c,bindToController:!0,controllerAs:"ctrl",scope:{dashboard:"=",row:"="},link:function(e,n){e.$watchGroup(["ctrl.row.collapse","ctrl.row.height"],function(){n.toggleClass("dash-row--collapse",e.ctrl.row.collapse),n.find(".panels-wrapper").css({minHeight:e.ctrl.row.collapse?"5px":e.ctrl.row.height})}),t.onAppEvent("panel-fullscreen-enter",function(t,r){s.a.find(e.ctrl.row.panels,{id:r.panelId})||n.hide()},e),t.onAppEvent("panel-fullscreen-exit",function(){n.show()},e)}}}function a(t){return function(e,n){function r(){a||(n[0].style.width=e.panel.span/1.2*10+"%")}var a=!1;t.onAppEvent("panel-fullscreen-enter",function(t,r){a=!0,e.panel.id!==r.panelId?n.hide():n[0].style.width="100%"},e),t.onAppEvent("panel-fullscreen-exit",function(t,i){a=!1,e.panel.id!==i.panelId&&n.show(),r()},e),e.$watch("panel.span",r),a&&n.hide()}}function i(t){return function(t,e){function n(t,n){e.find(".panel-container").css("height",i.height),e[0].style.width=t/1.2*10+"%",s.text(n),e.show()}function r(){e.hide()}function a(){if(0===i.panels.length&&!1===o)return n(12,"Empty Space");var t=12-i.span;return t>0?o?n(t,"Drop Here"):n(t,"Empty Space"):!0===o&&t>1?n(t,"Drop Here"):void r()}var i=t.ctrl.row,o=!1,s=e.find(".panel-drop-zone-text");i.events.on("span-changed",a,t),t.$on("ANGULAR_DRAG_START",function(){o=!0,a()}),t.$on("ANGULAR_DRAG_END",function(){o=!1,a()}),a()}}r.$inject=["$rootScope"],a.$inject=["$rootScope"],i.$inject=["$timeout"],Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashRowCtrl",function(){return c});var o=n(7),s=n.n(o),l=n(27),u=n(465),c=(n(1392),n(1393),function(){function t(t,e,n){this.$scope=t,this.$rootScope=e,this.$timeout=n,this.row.title=this.row.title||"Row title",this.row.isNew&&(this.dropView=1)}return t.$inject=["$scope","$rootScope","$timeout"],t.prototype.onDrop=function(t,e){var n,r=this;n=s.a.isString(t)?{row:this.row,panel:{title:l.default.new_panel_title,type:t,id:this.dashboard.getNextPanelId(),isNew:!0}}:this.dashboard.getPanelInfoById(t),e?(e=this.dashboard.getPanelInfoById(e.id),n.panel.isNew?(n.panel.span=e.panel.span=e.panel.span/2,e.row.panels.splice(e.index+1,0,n.panel)):this.row===n.row?this.row.movePanel(n.index,e.index):(n.panel.span=e.panel.span=e.panel.span/2,e.row.panels.splice(e.index+1,0,n.panel),n.row.removePanel(n.panel,!1))):(n.panel.span=12-this.row.span,this.row.panels.push(n.panel),n.panel.isNew||n.row.removePanel(n.panel,!1)),this.dropView=0,this.row.panelSpanChanged(),this.$timeout(function(){r.$rootScope.$broadcast("render")})},t.prototype.setHeight=function(t){this.row.height=t,this.$scope.$broadcast("render")},t.prototype.moveRow=function(t){var e=this.dashboard.rows,n=s.a.indexOf(e,this.row),r=n+t;r>=0&&r<=e.length-1&&s.a.move(e,n,r)},t.prototype.toggleCollapse=function(){this.closeDropView(),this.row.collapse=!this.row.collapse},t.prototype.onMenuAddPanel=function(){this.dropView=1},t.prototype.onMenuRowOptions=function(){this.dropView=2},t.prototype.closeDropView=function(){this.dropView=0},t.prototype.onMenuDeleteRow=function(){this.dashboard.removeRow(this.row)},t}());u.coreModule.directive("dashRow",r),u.coreModule.directive("panelWidth",a),u.coreModule.directive("panelDropZone",i)},1392:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/row/options.html",controller:i,bindToController:!0,controllerAs:"ctrl",scope:{rowCtrl:"="}}}var a=n(465),i=function(){function t(){this.fontSizes=["h1","h2","h3","h4","h5","h6"],this.row=this.rowCtrl.row,this.dashboard=this.rowCtrl.dashboard,this.row.titleSize=this.row.titleSize||"h6"}return t}();a.coreModule.directive("dashRowOptions",r)},1393:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/dashboard/row/add_panel.html",controller:l,bindToController:!0,controllerAs:"ctrl",scope:{rowCtrl:"="}}}var a=n(7),i=n.n(a),o=n(27),s=n(465),l=function(){function t(t,e){this.$timeout=t,this.$rootScope=e,this.row=this.rowCtrl.row,this.dashboard=this.rowCtrl.dashboard,this.activeIndex=0,this.allPanels=i.a.chain(o.default.panels).filter({hideFromList:!1}).map(function(t){return t}).orderBy("sort").value(),this.panelHits=this.allPanels}return t.$inject=["$timeout","$rootScope"],t.prototype.keyDown=function(t){if(27===t.keyCode)return void(this.rowCtrl.dropView=0);if(40!==t.keyCode&&39!==t.keyCode||this.moveSelection(1),38!==t.keyCode&&37!==t.keyCode||this.moveSelection(-1),13===t.keyCode){var e=this.panelHits[this.activeIndex];e&&this.addPanel(e)}},t.prototype.moveSelection=function(t){var e=this.panelHits.length,n=this.activeIndex+t;this.activeIndex=(n%=e)<0?n+e:n},t.prototype.panelSearchChanged=function(){for(var t,e=this.allPanels.slice(),n=[],r=[],a=this.panelSearch.toLowerCase();t=e.shift();){var i=t.name.toLowerCase();0===i.indexOf(a)?n.push(t):-1!==i.indexOf(a)&&r.push(t)}this.panelHits=n.concat(r),this.activeIndex=0},t.prototype.addPanel=function(t){var e=this,n=12-this.row.span,r={id:null,title:o.default.new_panel_title,span:n<12&&n>0?n:12,type:t.id};this.rowCtrl.closeDropView(),this.dashboard.addPanel(r,this.row),this.$timeout(function(){e.$rootScope.$broadcast("render")})},t}();s.coreModule.directive("dashRowAddPanel",r)},1394:function(t,e,n){"use strict";function r(t){return{restrict:"E",template:a,scope:{model:"="},link:function(e,n){n.css({display:"block",width:"100%"}),e.variables=t.variables.map(function(t){return{text:t.name,value:t.name}}),0===e.variables.length&&e.variables.unshift({text:"No template variables found",value:null}),e.variables.unshift({text:"Disabled",value:null})}}}r.$inject=["variableSrv"],Object.defineProperty(e,"__esModule",{value:!0});var a='\n<div class="gf-form-select-wrapper max-width-13">\n<select class="gf-form-input" ng-model="model.repeat" ng-options="f.value as f.text for f in variables">\n<option value=""></option>\n</div>\n';n(465).coreModule.directive("dashRepeatOption",r)},1395:function(t,e,n){var r,a;r=[n(12),n(7),n(1325)],void 0!==(a=function(t,e){"use strict";t.module("grafana.directives").directive("panelLinksEditor",function(){return{scope:{panel:"="},restrict:"E",controller:"PanelLinksEditorCtrl",templateUrl:"public/app/features/panellinks/module.html",link:function(){}}}).controller("PanelLinksEditorCtrl",["$scope","backendSrv",function(t,n){t.panel.links=t.panel.links||[],t.addLink=function(){t.panel.links.push({type:"dashboard"})},t.searchDashboards=function(t,r){n.search({query:t}).then(function(t){var n=e.map(t,function(t){return t.title});r(n)})},t.dashboardChanged=function(t){n.search({query:t.dashboard}).then(function(n){var r=e.find(n,{title:t.dashboard});r&&(t.dashUri=r.uri,t.title=r.title)})},t.deleteLink=function(n){t.panel.links=e.without(t.panel.links,n)}}])}.apply(e,r))&&(t.exports=a)},1396:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=(n(1397),n(12)),a=n.n(r),i=n(7),o=n.n(i),s=n(2),l=n(1398),u=function(){function t(t,e,n,r,a){this.$rootScope=t,this.$q=e,this.datasourceSrv=n,this.backendSrv=r,this.timeSrv=a,t.onAppEvent("refresh",this.clearCache.bind(this),t),t.onAppEvent("dashboard-initialized",this.clearCache.bind(this),t)}return t.$inject=["$rootScope","$q","datasourceSrv","backendSrv","timeSrv"],t.prototype.clearCache=function(){this.globalAnnotationsPromise=null,this.alertStatesPromise=null},t.prototype.getAnnotations=function(t){var e=this;return this.$q.all([this.getGlobalAnnotations(t),this.getAlertStates(t)]).then(function(e){var n=o.a.flattenDeep(e[0]);return n=o.a.filter(n,function(e){return!e.panelId||"dashboard"!==e.source.type||e.panelId===t.panel.id}),n=Object(l.a)(n),n=Object(l.b)(n,t),{annotations:n,alertState:o.a.find(e[1],{panelId:t.panel.id})}}).catch(function(t){return!t.message&&t.data&&t.data.message&&(t.message=t.data.message),console.log("AnnotationSrv.query error",t),e.$rootScope.appEvent("alert-error",["Annotation Query Failed",t.message||t]),[]})},t.prototype.getAlertStates=function(t){return t.dashboard.id?t.panel&&!t.panel.alert?this.$q.when([]):"now"!==t.range.raw.to?this.$q.when([]):this.alertStatesPromise?this.alertStatesPromise:(this.alertStatesPromise=this.backendSrv.get("/api/alerts/states-for-dashboard",{dashboardId:t.dashboard.id}),this.alertStatesPromise):this.$q.when([])},t.prototype.getGlobalAnnotations=function(t){var e=this,n=t.dashboard;if(this.globalAnnotationsPromise)return this.globalAnnotationsPromise;for(var r=this.timeSrv.timeRange(),i=[],o=this,s=0,l=n.annotations.list;s<l.length;s++){var u=l[s],c=function(t){return t.enable?t.snapshotData?{value:o.translateQueryResult(t,t.snapshotData)}:void i.push(o.datasourceSrv.get(t.datasource).then(function(e){return e.annotationQuery({range:r,rangeRaw:r.raw,annotation:t,dashboard:n})}).then(function(r){return n.snapshot&&(t.snapshotData=a.a.copy(r)),e.translateQueryResult(t,r)})):"continue"}(u);if("object"==typeof c)return c.value}return this.globalAnnotationsPromise=this.$q.all(i),this.globalAnnotationsPromise},t.prototype.saveAnnotationEvent=function(t){return this.globalAnnotationsPromise=null,this.backendSrv.post("/api/annotations",t)},t.prototype.updateAnnotationEvent=function(t){return this.globalAnnotationsPromise=null,this.backendSrv.put("/api/annotations/"+t.id,t)},t.prototype.deleteAnnotationEvent=function(t){this.globalAnnotationsPromise=null;var e="/api/annotations/"+t.id;return t.isRegion&&(e="/api/annotations/region/"+t.regionId),this.backendSrv.delete(e)},t.prototype.translateQueryResult=function(t,e){t.snapshotData&&(t=a.a.copy(t),delete t.snapshotData);for(var n=0,r=e;n<r.length;n++){r[n].source=t}return e},t}();s.default.service("annotationsSrv",u)},1397:function(t,e,n){"use strict";var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=n(13),l=n.n(s),u=n(2),c=function(){function t(t,e){this.$scope=t,this.datasourceSrv=e,this.annotationDefaults={name:"",datasource:null,iconColor:"rgba(255, 96, 96, 1)",enable:!0,showIn:0,hide:!1},this.showOptions=[{text:"All Panels",value:0},{text:"Specific Panels",value:1}],t.ctrl=this,this.mode="list",this.datasources=e.getAnnotationSources(),this.annotations=t.dashboard.annotations.list,this.reset(),this.onColorChange=this.onColorChange.bind(this)}return t.$inject=["$scope","datasourceSrv"],t.prototype.datasourceChanged=function(){var t=this;return this.datasourceSrv.get(this.currentAnnotation.datasource).then(function(e){t.currentDatasource=e})},t.prototype.edit=function(t){this.currentAnnotation=t,this.currentAnnotation.showIn=this.currentAnnotation.showIn||0,this.currentIsNew=!1,this.datasourceChanged(),this.mode="edit",l()(".tooltip.in").remove()},t.prototype.reset=function(){this.currentAnnotation=a.a.copy(this.annotationDefaults),this.currentAnnotation.datasource=this.datasources[0].name,this.currentIsNew=!0,this.datasourceChanged()},t.prototype.update=function(){this.reset(),this.mode="list",this.$scope.broadcastRefresh()},t.prototype.setupNew=function(){this.mode="new",this.reset()},t.prototype.add=function(){this.annotations.push(this.currentAnnotation),this.reset(),this.mode="list",this.$scope.broadcastRefresh(),this.$scope.dashboard.updateSubmenuVisibility()},t.prototype.removeAnnotation=function(t){var e=o.a.indexOf(this.annotations,t);this.annotations.splice(e,1),this.$scope.dashboard.updateSubmenuVisibility(),this.$scope.broadcastRefresh()},t.prototype.onColorChange=function(t){this.currentAnnotation.iconColor=t},t.prototype.annotationEnabledChange=function(){this.$scope.broadcastRefresh()},t.prototype.annotationHiddenChanged=function(){this.$scope.dashboard.updateSubmenuVisibility()},t}();u.default.controller("AnnotationsEditorCtrl",c)},1398:function(t,e,n){"use strict";function r(t,e){var n=u.a.partition(t,"regionId"),r=n[0],i=n[1],o=a(r,e.range);return t=u.a.concat(o,i)}function a(t,e){var n=u.a.filter(t,function(t){return t.regionId}),r=u.a.groupBy(n,"regionId");return r=u.a.compact(u.a.map(r,function(t){var n=u.a.head(t);return t&&t.length>1?(n.timeEnd=t[1].time,n.isRegion=!0,n):t&&t.length?(n.time&&n.timeEnd||(i(n)?n.timeEnd=e.to.valueOf()-1:(n.timeEnd=n.time,n.time=e.from.valueOf()+1),n.isRegion=!0),n):void 0}))}function i(t){return t.id&&t.id===t.regionId}function o(t){var e=[],n=u.a.partition(t,"id"),r=u.a.groupBy(n[0],"id");return e=u.a.map(r,function(t){return t.length>1&&!u.a.every(t,s)?u.a.find(t,function(t){return"panel-alert"!==t.eventType}):u.a.head(t)}),e=u.a.concat(e,n[1])}function s(t){return"panel-alert"===t.eventType}e.b=r,e.a=o;var l=n(7),u=n.n(l)},1399:function(t,e,n){"use strict";function r(t){if(t&&o.a.isNumber(t)){var e=Number(t);return l()(e)}return t}function a(){return{restrict:"E",controller:c,bindToController:!0,controllerAs:"ctrl",templateUrl:"public/app/features/annotations/partials/event_editor.html",scope:{panelCtrl:"=",event:"=",close:"&"}}}e.a=a;var i=n(7),o=n.n(i),s=n(1),l=n.n(s),u=n(465),c=function(){function t(t){this.annotationsSrv=t,this.event.panelId=this.panelCtrl.panel.id,this.event.dashboardId=this.panelCtrl.dashboard.id,this.event.time=r(this.event.time),this.event.isRegion&&(this.event.timeEnd=r(this.event.timeEnd)),this.timeFormated=this.panelCtrl.dashboard.formatDate(this.event.time)}return t.$inject=["annotationsSrv"],t.prototype.save=function(){var t=this;if(this.form.$valid){var e=o.a.cloneDeep(this.event);if(e.time=e.time.valueOf(),e.timeEnd=0,e.isRegion&&(e.timeEnd=this.event.timeEnd.valueOf(),e.timeEnd<e.time))return void console.log("invalid time");e.id?this.annotationsSrv.updateAnnotationEvent(e).then(function(){t.panelCtrl.refresh(),t.close()}).catch(function(){t.panelCtrl.refresh(),t.close()}):this.annotationsSrv.saveAnnotationEvent(e).then(function(){t.panelCtrl.refresh(),t.close()}).catch(function(){t.panelCtrl.refresh(),t.close()})}},t.prototype.delete=function(){var t=this;return this.annotationsSrv.deleteAnnotationEvent(this.event).then(function(){t.panelCtrl.refresh(),t.close()}).catch(function(){t.panelCtrl.refresh(),t.close()})},t}();u.coreModule.directive("eventEditor",a)},1400:function(t,e,n){"use strict";function r(t){return s.a.filter(t,"isRegion")}function a(t,e){var n,r=e.grid.markings,a=d.b;s.a.each(t,function(t){n=t.source?t.source.iconColor||a:a,n=i(n,d.e),r.push({xaxis:{from:t.min,to:t.timeEnd},color:n})})}function i(t,e){var n=p()(t);return n.isValid()?(n.setAlpha(e),n.toRgbString()):t}n.d(e,"a",function(){return f});var o=n(7),s=n.n(o),l=n(1),u=n.n(l),c=n(128),p=n.n(c),h=n(1326),d=n(202),f=function(){function t(t){this.panelCtrl=t}return t.prototype.editorClosed=function(){this.event=null,this.editorOpen=!1,this.panelCtrl.render()},t.prototype.editorOpened=function(){this.editorOpen=!0},t.prototype.updateTime=function(t){this.event||(this.event=new h.a,this.event.dashboardId=this.panelCtrl.dashboard.id,this.event.panelId=this.panelCtrl.panel.id),this.event.time=u()(t.from),this.event.isRegion=!1,t.to&&(this.event.timeEnd=u()(t.to),this.event.isRegion=!0),this.panelCtrl.render()},t.prototype.editEvent=function(t,e){this.event=t,this.panelCtrl.render()},t.prototype.addFlotEvents=function(t,e){if(this.event||0!==t.length){var n={$__alerting:{color:d.a,position:"BOTTOM",markerSize:5},$__ok:{color:d.d,position:"BOTTOM",markerSize:5},$__no_data:{color:d.c,position:"BOTTOM",markerSize:5},$__editing:{color:d.b,position:"BOTTOM",markerSize:5}};if(this.event)t=this.event.isRegion?[{isRegion:!0,min:this.event.time.valueOf(),timeEnd:this.event.timeEnd.valueOf(),text:this.event.text,eventType:"$__editing",editModel:this.event}]:[{min:this.event.time.valueOf(),text:this.event.text,editModel:this.event,eventType:"$__editing"}];else for(var i=0;i<t.length;i++){var o=t[i];o.min=o.time,o.max=o.time,o.eventType=o.source.name,o.newState?o.eventType="$__"+o.newState:n[o.source.name]||(n[o.source.name]={color:o.source.iconColor,position:"BOTTOM",markerSize:5})}a(r(t),e);e.grid.eventSectionHeight=7,e.xaxis.eventSectionHeight=20,e.events={levels:s.a.keys(n).length+1,data:t,types:n,manager:this}}},t}()},1401:function(t,e,n){"use strict";function r(t,e,n,r,a){function o(e){try{return t(e)}catch(t){return console.log("Could not sanitize annotation string, html escaping instead"),i.a.escape(e)}}return{restrict:"E",scope:{event:"=",onEdit:"&"},link:function(t,r){var l=t.event,c=l.title,p=l.text,h=e.getCurrent(),d='<div class="graph-annotation">',f="";if(l.alertId){var m=u.a.getStateDisplayModel(l.newState);f=m.stateClass,c='<i class="icon-gf '+m.iconClass+'"></i> '+m.text,p=u.a.getAlertAnnotationInfo(l),l.text&&(p=p+"<br />"+l.text)}else c&&(p=c+"<br />"+(i.a.isString(p)?p:""),c="");var g='<div class="graph-annotation__header">';l.login&&(g+='<div class="graph-annotation__user" bs-tooltip="\'Created by '+l.login+'\'"><img src="'+l.avatarUrl+'" /></div>'),g+='\n          <span class="graph-annotation__title '+f+'">'+o(c)+'</span>\n          <span class="graph-annotation__time">'+h.formatDate(l.min)+"</span>\n      ",l.id&&n.isEditor&&(g+='\n          <span class="pointer graph-annotation__edit-icon" ng-click="onEdit()">\n            <i class="fa fa-pencil-square"></i>\n          </span>\n        '),g+="</div>",d+=g,d+='<div class="graph-annotation__body">',p&&(d+="<div>"+o(p.replace(/\n/g,"<br>"))+"</div>");var v=l.tags;v&&v.length&&(t.tags=v,d+='<span class="label label-tag small" ng-repeat="tag in tags" tag-color-from-name="tag">{{tag}}</span><br/>'),d+="</div>",d+="</div>",s()(d).appendTo(r),a(r.contents())(t)}}}r.$inject=["$sanitize","dashboardSrv","contextSrv","popoverSrv","$compile"],e.a=r;var a=n(7),i=n.n(a),o=n(13),s=n.n(o),l=n(2),u=n(1307);l.default.directive("annotationTooltip",r)},1402:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n(1403),n(2)),a=n(1404),i=n(1405),o=n(1406),s=n(1407),l=n(1408),u=n(1409),c=n(1410),p=n(1411);n.d(e,"TemplateSrv",function(){return a.a}),n.d(e,"VariableSrv",function(){return i.a}),n.d(e,"IntervalVariable",function(){return o.a}),n.d(e,"QueryVariable",function(){return s.a}),n.d(e,"DatasourceVariable",function(){return l.a}),n.d(e,"CustomVariable",function(){return u.a}),n.d(e,"ConstantVariable",function(){return c.a}),n.d(e,"AdhocVariable",function(){return p.a}),r.default.service("templateSrv",a.a)},1403:function(t,e,n){"use strict";var r=n(7),a=n.n(r),i=n(2),o=n(1306),s=function(){function t(t,e,n,r){t.variableTypes=o.variableTypes,t.ctrl={},t.namePattern=/^(?!__).*$/,t.refreshOptions=[{value:0,text:"Never"},{value:1,text:"On Dashboard Load"},{value:2,text:"On Time Range Change"}],t.sortOptions=[{value:0,text:"Disabled"},{value:1,text:"Alphabetical (asc)"},{value:2,text:"Alphabetical (desc)"},{value:3,text:"Numerical (asc)"},{value:4,text:"Numerical (desc)"}],t.hideOptions=[{value:0,text:""},{value:1,text:"Label"},{value:2,text:"Variable"}],t.init=function(){t.mode="list",t.variables=n.variables,t.reset(),t.$watch("mode",function(e){"new"===e&&t.reset()})},t.add=function(){t.isValid()&&(n.addVariable(t.current),t.update())},t.isValid=function(){if(!t.ctrl.form.$valid)return!1;if(!t.current.name.match(/^\w+$/))return t.appEvent("alert-warning",["Validation","Only word and digit characters are allowed in variable names"]),!1;var e=a.a.find(t.variables,{name:t.current.name});return e&&e!==t.current?(t.appEvent("alert-warning",["Validation","Variable with the same name already exists"]),!1):"query"!==t.current.type||!t.current.query.match(new RegExp("\\$"+t.current.name+"(/| |$)"))||(t.appEvent("alert-warning",["Validation","Query cannot contain a reference to itself. Variable: $"+t.current.name]),!1)},t.validate=function(){t.infoText="","adhoc"===t.current.type&&null!==t.current.datasource&&(t.infoText="Adhoc filters are applied automatically to all queries that target this datasource",e.get(t.current.datasource).then(function(e){e.getTagKeys||(t.infoText="This datasource does not support adhoc filters yet.")}))},t.runQuery=function(){return n.updateOptions(t.current).then(function(){},function(e){e.data&&e.data.message&&(e.message=e.data.message),t.appEvent("alert-error",["Templating","Template variables could not be initialized: "+e.message])})},t.edit=function(e){t.current=e,t.currentIsNew=!1,t.mode="edit",t.validate()},t.duplicate=function(e){var r=a.a.cloneDeep(e.getSaveModel());t.current=n.createVariableFromModel(r),t.current.name="copy_of_"+e.name,n.addVariable(t.current)},t.update=function(){t.isValid()&&t.runQuery().then(function(){t.reset(),t.mode="list",r.updateTemplateData()})},t.reset=function(){t.currentIsNew=!0,t.current=n.createVariableFromModel({type:"query"}),t.datasources=a.a.filter(e.getMetricSources(),function(t){return!t.meta.mixed&&null!==t.value}),t.datasourceTypes=a()(t.datasources).uniqBy("meta.id").map(function(t){return{text:t.meta.name,value:t.meta.id}}).value()},t.typeChanged=function(){var e=t.current;t.current=n.createVariableFromModel({type:t.current.type}),t.current.name=e.name,t.current.hide=e.hide,t.current.label=e.label;var r=a.a.indexOf(this.variables,e);-1!==r&&(this.variables[r]=t.current),t.validate()},t.removeVariable=function(t){n.removeVariable(t)}}return t.$inject=["$scope","datasourceSrv","variableSrv","templateSrv"],t}();i.default.controller("VariableEditorCtrl",s)},1404:function(t,e,n){"use strict";function r(t){return t.replace(/([\!\*\+\-\=<>\s\&\|\(\)\[\]\{\}\^\~\?\:\\\/"])/g,"\\$1")}n.d(e,"a",function(){return s});var a=n(464),i=n(7),o=n.n(i),s=function(){function t(){this.regex=/\$(\w+)|\[\[([\s\S]+?)\]\]/g,this.index={},this.grafanaVariables={},this.builtIns={},this.filters={},this.builtIns.__interval={text:"1s",value:"1s"},this.builtIns.__interval_ms={text:"100",value:"100"}}return t.prototype.init=function(t){this.variables=t,this.updateTemplateData()},t.prototype.updateTemplateData=function(){this.index={},this.filters={};for(var t=0;t<this.variables.length;t++){var e=this.variables[t];e.current&&(e.current.isNone||e.current.value)&&(this.index[e.name]=e)}},t.prototype.variableInitialized=function(t){this.index[t.name]=t},t.prototype.getAdhocFilters=function(t){for(var e=[],n=0;n<this.variables.length;n++){var r=this.variables[n];"adhoc"===r.type&&(r.datasource===t&&(e=e.concat(r.filters)),0===r.datasource.indexOf("$")&&this.replace(r.datasource)===t&&(e=e.concat(r.filters)))}return e},t.prototype.luceneFormat=function(t){return"string"==typeof t?r(t):"("+o.a.map(t,function(t){return'"'+r(t)+'"'}).join(" OR ")+")"},t.prototype.formatValue=function(t,e,n){if(n=n||{},"function"==typeof e)return e(t,n,this.formatValue);switch(e){case"regex":if("string"==typeof t)return a.default.regexEscape(t);return"("+o.a.map(t,a.default.regexEscape).join("|")+")";case"lucene":return this.luceneFormat(t);case"pipe":return"string"==typeof t?t:t.join("|");case"distributed":return"string"==typeof t?t:this.distributeVariable(t,n.name);default:return o.a.isArray(t)?"{"+t.join(",")+"}":t}},t.prototype.setGrafanaVariable=function(t,e){this.grafanaVariables[t]=e},t.prototype.getVariableName=function(t){this.regex.lastIndex=0;var e=this.regex.exec(t);return e?e[1]||e[2]:null},t.prototype.variableExists=function(t){var e=this.getVariableName(t);return e&&void 0!==this.index[e]},t.prototype.highlightVariablesAsHtml=function(t){var e=this;return t&&o.a.isString(t)?(t=o.a.escape(t),this.regex.lastIndex=0,t.replace(this.regex,function(t,n,r){return e.index[n||r]||e.builtIns[n||r]?'<span class="template-variable">'+t+"</span>":t})):t},t.prototype.getAllValue=function(t){if(t.allValue)return t.allValue;for(var e=[],n=1;n<t.options.length;n++)e.push(t.options[n].value);return e},t.prototype.replace=function(t,e,n){var r=this;if(!t)return t;var a,i,o;return this.regex.lastIndex=0,t.replace(this.regex,function(t,s,l){return a=r.index[s||l],e&&(o=e[s||l])?r.formatValue(o.value,n,a):a?(i=r.grafanaVariables[a.current.value])?r.formatValue(i,n,a):(o=a.current.value,r.isAllValue(o)&&(o=r.getAllValue(a),a.allValue)?o:r.formatValue(o,n,a)):t})},t.prototype.isAllValue=function(t){return"$__all"===t||Array.isArray(t)&&"$__all"===t[0]},t.prototype.replaceWithText=function(t,e){var n=this;if(!t)return t;var r;return this.regex.lastIndex=0,t.replace(this.regex,function(t,a,i){if(e){var o=e[a||i];if(o)return o.text}return r=n.index[a||i],r?n.grafanaVariables[r.current.value]||r.current.text:t})},t.prototype.fillVariableValuesForUrl=function(t,e){o.a.each(this.variables,function(n){e&&void 0!==e[n.name]?t["var-"+n.name]=e[n.name].value:t["var-"+n.name]=n.getValueForUrl()})},t.prototype.distributeVariable=function(t,e){return t=o.a.map(t,function(t,n){return 0!==n?e+"="+t:t}),t.join(",")},t}()},1405:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=n(2),l=n(1306),u=function(){function t(t,e,n,r,a){this.$rootScope=t,this.$q=e,this.$location=n,this.$injector=r,this.templateSrv=a,t.$on("refresh",this.onDashboardRefresh.bind(this),t),t.$on("template-variable-value-updated",this.updateUrlParamsWithCurrentVariables.bind(this),t)}return t.$inject=["$rootScope","$q","$location","$injector","templateSrv"],t.prototype.init=function(t){var e=this;this.dashboard=t,this.variables=t.templating.list=t.templating.list.map(this.createVariableFromModel.bind(this)),this.templateSrv.init(this.variables);for(var n=0,r=this.variables;n<r.length;n++){r[n].initLock=this.$q.defer()}var a=this.$location.search();return this.$q.all(this.variables.map(function(t){return e.processVariable(t,a)})).then(function(){e.templateSrv.updateTemplateData()})},t.prototype.onDashboardRefresh=function(){var t=this,e=this.variables.filter(function(t){return 2===t.refresh}).map(function(e){var n=e.options.slice();return e.updateOptions().then(function(){a.a.toJson(n)!==a.a.toJson(e.options)&&t.$rootScope.$emit("template-variable-value-updated")})});return this.$q.all(e)},t.prototype.processVariable=function(t,e){for(var n=this,r=[],a=0,i=this.variables;a<i.length;a++){var o=i[a];t.dependsOn(o)&&r.push(o.initLock.promise)}return this.$q.all(r).then(function(){var n=e["var-"+t.name];return void 0!==n?t.setValueFromUrl(n).then(t.initLock.resolve):1===t.refresh||2===t.refresh?t.updateOptions().then(t.initLock.resolve):void t.initLock.resolve()}).finally(function(){n.templateSrv.variableInitialized(t),delete t.initLock})},t.prototype.createVariableFromModel=function(t){var e=l.variableTypes[t.type].ctor;if(!e)throw{message:"Unable to find variable constructor for "+t.type};return this.$injector.instantiate(e,{model:t})},t.prototype.addVariable=function(t){this.variables.push(t),this.templateSrv.updateTemplateData(),this.dashboard.updateSubmenuVisibility()},t.prototype.removeVariable=function(t){var e=o.a.indexOf(this.variables,t);this.variables.splice(e,1),this.templateSrv.updateTemplateData(),this.dashboard.updateSubmenuVisibility()},t.prototype.updateOptions=function(t){return t.updateOptions()},t.prototype.variableUpdated=function(t,e){var n=this;if(t.initLock)return this.$q.when();var r=o.a.map(this.variables,function(e){if(e!==t)return e.dependsOn(t)?n.updateOptions(e):void 0});return this.$q.all(r).then(function(){e&&(n.$rootScope.$emit("template-variable-value-updated"),n.$rootScope.$broadcast("refresh"))})},t.prototype.selectOptionsForCurrentValue=function(t){var e,n,r,a,i=[];for(e=0;e<t.options.length;e++)if(a=t.options[e],a.selected=!1,o.a.isArray(t.current.value))for(n=0;n<t.current.value.length;n++)r=t.current.value[n],a.value===r&&(a.selected=!0,i.push(a));else a.value===t.current.value&&(a.selected=!0,i.push(a));return i},t.prototype.validateVariableSelectionState=function(t){if(t.current||(t.current={}),o.a.isArray(t.current.value)){var e=this.selectOptionsForCurrentValue(t);return e=0===e.length?t.options[0]:{value:o.a.map(e,function(t){return t.value}),text:o.a.map(e,function(t){return t.text}).join(" + ")},t.setValue(e)}var n=o.a.find(t.options,{text:t.current.text});return n?t.setValue(n):t.options.length?t.setValue(t.options[0]):Promise.resolve()},t.prototype.setOptionFromUrl=function(t,e){var n=this.$q.when();return t.refresh&&(n=t.updateOptions()),n.then(function(){var n=o.a.find(t.options,function(t){return t.text===e||t.value===e});return n=n||{text:e,value:e},t.setValue(n)})},t.prototype.setOptionAsCurrent=function(t,e){return t.current=o.a.cloneDeep(e),o.a.isArray(t.current.text)&&(t.current.text=t.current.text.join(" + ")),this.selectOptionsForCurrentValue(t),this.variableUpdated(t)},t.prototype.updateUrlParamsWithCurrentVariables=function(){var t=this.$location.search();o.a.each(t,function(e,n){0===n.indexOf("var-")&&delete t[n]}),this.templateSrv.fillVariableValuesForUrl(t),this.$location.search(t)},t.prototype.setAdhocFilter=function(t){var e=o.a.find(this.variables,{type:"adhoc",datasource:t.datasource});e||(e=this.createVariableFromModel({name:"Filters",type:"adhoc",datasource:t.datasource}),this.addVariable(e));var n=e.filters,r=o.a.find(n,{key:t.key,value:t.value});r||(r={key:t.key,value:t.value},n.push(r)),r.operator=t.operator,this.variableUpdated(e,!0)},t}();s.default.service("variableSrv",u)},1406:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(7),a=n.n(r),i=n(464),o=n(1306),s=function(){function t(t,e,n,r){this.model=t,this.timeSrv=e,this.templateSrv=n,this.variableSrv=r,this.defaults={type:"interval",name:"",hide:0,label:"",refresh:2,options:[],current:{},query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",auto:!1,auto_min:"10s",auto_count:30},Object(o.assignModelProperties)(this,t,this.defaults),this.refresh=2}return t.$inject=["model","timeSrv","templateSrv","variableSrv"],t.prototype.getSaveModel=function(){return Object(o.assignModelProperties)(this.model,this,this.defaults),this.model},t.prototype.setValue=function(t){return this.updateAutoValue(),this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateAutoValue=function(){if(this.auto){this.options.length&&"auto"!==this.options[0].text&&this.options.unshift({text:"auto",value:"$__auto_interval_"+this.name});var t=i.default.calculateInterval(this.timeSrv.timeRange(),this.auto_count,this.auto_min);this.templateSrv.setGrafanaVariable("$__auto_interval_"+this.name,t.interval),this.templateSrv.setGrafanaVariable("$__auto_interval",t.interval)}},t.prototype.updateOptions=function(){return this.options=a.a.map(this.query.match(/(["'])(.*?)\1|\w+/g),function(t){return t=t.replace(/["']+/g,""),{text:t.trim(),value:t.trim()}}),this.updateAutoValue(),this.variableSrv.validateVariableSelectionState(this)},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.updateAutoValue(),this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();o.variableTypes.interval={name:"Interval",ctor:s,description:"Define a timespan interval (ex 1m, 1h, 1d)"}},1407:function(t,e,n){"use strict";function r(){return{text:"None",value:"",isNone:!0}}n.d(e,"a",function(){return l});var a=n(7),i=n.n(a),o=n(464),s=n(1306),l=function(){function t(t,e,n,r,a,i){this.model=t,this.datasourceSrv=e,this.templateSrv=n,this.variableSrv=r,this.backendSrv=a,this.timeSrv=i,this.defaults={type:"query",label:null,query:"",regex:"",sort:0,datasource:null,refresh:0,hide:0,name:"",multi:!1,includeAll:!1,allValue:null,options:[],current:{},tags:[],useTags:!1,tagsQuery:"",tagValuesQuery:""},Object(s.assignModelProperties)(this,t,this.defaults);var o=this;a.get("http://61.164.218.158:8080/AirServer/site/findAllSites").then(function(t){o.cnData=t},function(t){console.info(t)})}return t.$inject=["model","datasourceSrv","templateSrv","variableSrv","backendSrv","timeSrv"],t.prototype.getSaveModel=function(){return Object(s.assignModelProperties)(this.model,this,this.defaults),0!==this.refresh&&(this.model.options=[]),this.model},t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return"All"===this.current.text?"All":this.current.value},t.prototype.updateOptions=function(){return this.datasourceSrv.get(this.datasource).then(this.updateOptionsFromMetricFindQuery.bind(this)).then(this.updateTags.bind(this)).then(this.variableSrv.validateVariableSelectionState.bind(this.variableSrv,this))},t.prototype.updateTags=function(t){var e=this;return this.useTags?this.metricFindQuery(t,this.tagsQuery).then(function(n){e.tags=[];for(var r=0;r<n.length;r++)e.tags.push(n[r].text);return t}):(delete this.tags,t)},t.prototype.getValuesForTag=function(t){var e=this;return this.datasourceSrv.get(this.datasource).then(function(n){var r=e.tagValuesQuery.replace("$tag",t);return e.metricFindQuery(n,r).then(function(t){return i.a.map(t,function(t){return t.text})})})},t.prototype.updateOptionsFromMetricFindQuery=function(t){var e=this;return this.metricFindQuery(t,this.query).then(function(n){return e.options=e.metricNamesToVariableValues(n),e.includeAll&&e.addAllOption(),e.options.length||e.options.push(r()),t})},t.prototype.metricFindQuery=function(t,e){var n={range:void 0,variable:this};return 2===this.refresh&&(n.range=this.timeSrv.timeRange()),t.metricFindQuery(e,n)},t.prototype.addAllOption=function(){this.options.unshift({text:"All",value:"$__all",cn:""})},t.prototype.metricNamesToVariableValues=function(t){var e,n,r,a;for(n=[],this.regex&&(e=o.default.stringToJsRegex(this.templateSrv.replace(this.regex,{},"regex"))),r=0;r<t.length;r++){var s=t[r],l=void 0===s.text||null===s.text?s.value:s.text,u=void 0===s.value||null===s.value?s.text:s.value;if(i.a.isNumber(u)&&(u=u.toString()),i.a.isNumber(l)&&(l=l.toString()),e){if(!(a=e.exec(u)))continue;a.length>1&&(u=a[1],l=a[1])}n.push({text:l,value:u,cn:s.cn})}return n=i.a.uniqBy(n,"value"),this.sortVariableValues(n,this.sort)},t.prototype.sortVariableValues=function(t,e){if(0===e)return t;var n=Math.ceil(e/2),r=e%2==0;return 1===n?t=i.a.sortBy(t,"text"):2===n&&(t=i.a.sortBy(t,function(t){var e=t.text.match(/.*?(\d+).*/);return!e||e.length<2?-1:parseInt(e[1],10)})),r&&(t=t.reverse()),t},t.prototype.dependsOn=function(t){return Object(s.containsVariable)(this.query,this.datasource,t.name)},t}();s.variableTypes.query={name:"Query",ctor:l,description:"Variable values are fetched from a datasource query",supportsMulti:!0}},1408:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(464),a=n(1306),i=function(){function t(t,e,n,r){this.model=t,this.datasourceSrv=e,this.variableSrv=n,this.templateSrv=r,this.defaults={type:"datasource",name:"",hide:0,label:"",current:{},regex:"",options:[],query:"",refresh:1},Object(a.assignModelProperties)(this,t,this.defaults),this.refresh=1}return t.$inject=["model","datasourceSrv","variableSrv","templateSrv"],t.prototype.getSaveModel=function(){return Object(a.assignModelProperties)(this.model,this,this.defaults),this.model.options=[],this.model},t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateOptions=function(){var t,e=[],n=this.datasourceSrv.getMetricSources({skipVariables:!0});this.regex&&(t=this.templateSrv.replace(this.regex,null,"regex"),t=r.default.stringToJsRegex(t));for(var a=0;a<n.length;a++){var i=n[a];i.meta.id===this.query&&(t&&!t.exec(i.name)||e.push({text:i.name,value:i.name}))}return 0===e.length&&e.push({text:"No data sources found",value:""}),this.options=e,this.variableSrv.validateVariableSelectionState(this)},t.prototype.dependsOn=function(t){return!!this.regex&&Object(a.containsVariable)(this.regex,t.name)},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();a.variableTypes.datasource={name:"Datasource",ctor:i,description:"Enabled you to dynamically switch the datasource for multiple panels"}},1409:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(7),a=n.n(r),i=n(1306),o=function(){function t(t,e){this.model=t,this.variableSrv=e,this.defaults={type:"custom",name:"",label:"",hide:0,options:[],current:{},query:"",includeAll:!1,multi:!1,allValue:null},Object(i.assignModelProperties)(this,t,this.defaults)}return t.$inject=["model","variableSrv"],t.prototype.setValue=function(t){return this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.getSaveModel=function(){return Object(i.assignModelProperties)(this.model,this,this.defaults),this.model},t.prototype.updateOptions=function(){return this.options=a.a.map(this.query.split(/[,]+/),function(t){return{text:t.trim(),value:t.trim()}}),this.includeAll&&this.addAllOption(),this.variableSrv.validateVariableSelectionState(this)},t.prototype.addAllOption=function(){this.options.unshift({text:"All",value:"$__all"})},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return"All"===this.current.text?"All":this.current.value},t}();i.variableTypes.custom={name:"Custom",ctor:o,description:"Define variable values manually",supportsMulti:!0}},1410:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(1306),a=function(){function t(t,e){this.model=t,this.variableSrv=e,this.defaults={type:"constant",name:"",hide:2,label:"",query:"",current:{},options:[]},Object(r.assignModelProperties)(this,t,this.defaults)}return t.$inject=["model","variableSrv"],t.prototype.getSaveModel=function(){return Object(r.assignModelProperties)(this.model,this,this.defaults),this.model},t.prototype.setValue=function(t){this.variableSrv.setOptionAsCurrent(this,t)},t.prototype.updateOptions=function(){return this.options=[{text:this.query.trim(),value:this.query.trim()}],this.setValue(this.options[0]),Promise.resolve()},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){return this.variableSrv.setOptionFromUrl(this,t)},t.prototype.getValueForUrl=function(){return this.current.value},t}();r.variableTypes.constant={name:"Constant",ctor:a,description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share"}},1411:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(7),a=n.n(r),i=n(1306),o=function(){function t(t){this.model=t,this.defaults={type:"adhoc",name:"",label:"",hide:0,datasource:null,filters:[]},Object(i.assignModelProperties)(this,t,this.defaults)}return t.$inject=["model"],t.prototype.setValue=function(t){return Promise.resolve()},t.prototype.getSaveModel=function(){return Object(i.assignModelProperties)(this.model,this,this.defaults),this.model},t.prototype.updateOptions=function(){return Promise.resolve()},t.prototype.dependsOn=function(t){return!1},t.prototype.setValueFromUrl=function(t){var e=this;return a.a.isArray(t)||(t=[t]),this.filters=t.map(function(t){var n=t.split("|").map(function(t){return e.unescapeDelimiter(t)});return{key:n[0],operator:n[1],value:n[2]}}),Promise.resolve()},t.prototype.getValueForUrl=function(){var t=this;return this.filters.map(function(e){return[e.key,e.operator,e.value].map(function(e){return t.escapeDelimiter(e)}).join("|")})},t.prototype.escapeDelimiter=function(t){return t.replace(/\|/g,"__gfp__")},t.prototype.unescapeDelimiter=function(t){return t.replace(/__gfp__/g,"|")},t.prototype.setFilters=function(t){this.filters=t},t}();i.variableTypes.adhoc={name:"Ad hoc filters",ctor:o,description:"Add key/value filters on the fly"}},1412:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n(1413),n(1414),n(1415),n(1416),n(1417),n(1418),n(1419));n.n(r),n(1540)},1413:function(t,e,n){"use strict";var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=n(469),l=n.n(s),u=function(){function t(t,e,n,r,a,i){this.$scope=t,this.$rootScope=e,this.backendSrv=n,this.$sce=r,this.navModel=i.getPluginsNav(),this.model={},this.pluginId=a.pluginId,this.tabIndex=0,this.tabs=["Readme"],this.preUpdateHook=function(){return Promise.resolve()},this.postUpdateHook=function(){return Promise.resolve()}}return t.$inject=["$scope","$rootScope","backendSrv","$sce","$routeParams","navModelSrv"],t.prototype.init=function(){var t=this;return this.backendSrv.get("/api/plugins/"+this.pluginId+"/settings").then(function(e){return t.model=e,t.pluginIcon=t.getPluginIcon(t.model.type),t.model.dependencies.plugins.forEach(function(e){e.icon=t.getPluginIcon(e.type)}),t.includes=o.a.map(e.includes,function(e){return e.icon=t.getPluginIcon(e.type),e}),"app"===t.model.type&&(t.hasDashboards=o.a.find(e.includes,{type:"dashboard"}),t.hasDashboards&&t.tabs.unshift("Dashboards"),t.tabs.unshift("Config"),t.tabIndex=0),t.initReadme()})},t.prototype.initReadme=function(){var t=this;return this.backendSrv.get("/api/plugins/"+this.pluginId+"/markdown/readme").then(function(e){var n=new l.a;t.readmeHtml=t.$sce.trustAsHtml(n.render(e))})},t.prototype.getPluginIcon=function(t){switch(t){case"datasource":return"icon-gf icon-gf-datasources";case"panel":return"icon-gf icon-gf-panel";case"app":return"icon-gf icon-gf-apps";case"page":return"icon-gf icon-gf-endpoint-tiny";case"dashboard":return"icon-gf icon-gf-dashboard";default:return"icon-gf icon-gf-apps"}},t.prototype.update=function(){var t=this;this.preUpdateHook().then(function(){var e=o.a.extend({enabled:t.model.enabled,pinned:t.model.pinned,jsonData:t.model.jsonData,secureJsonData:t.model.secureJsonData},{});return t.backendSrv.post("/api/plugins/"+t.pluginId+"/settings",e)}).then(this.postUpdateHook).then(function(t){window.location.href=window.location.href})},t.prototype.importDashboards=function(){return Promise.resolve()},t.prototype.setPreUpdateHook=function(t){this.preUpdateHook=t},t.prototype.setPostUpdateHook=function(t){this.postUpdateHook=t},t.prototype.updateAvailable=function(){var t=this.$scope.$new(!0);t.plugin=this.model,this.$rootScope.appEvent("show-modal",{src:"public/app/features/plugins/partials/update_instructions.html",scope:t})},t.prototype.enable=function(){this.model.enabled=!0,this.model.pinned=!0,this.update()},t.prototype.disable=function(){this.model.enabled=!1,this.model.pinned=!1,this.update()},t}();a.a.module("grafana.controllers").controller("PluginEditCtrl",u)},1414:function(t,e,n){"use strict";var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s={},l=function(){function t(t,e,n){this.backendSrv=t,this.$routeParams=e,this.$rootScope=n,this.pluginId=e.pluginId,s[this.pluginId]?this.initPage(s[this.pluginId]):this.loadPluginInfo()}return t.$inject=["backendSrv","$routeParams","$rootScope"],t.prototype.initPage=function(t){if(this.appModel=t,this.page=o.a.find(t.includes,{slug:this.$routeParams.slug}),s[this.pluginId]=t,!this.page)return this.$rootScope.appEvent("alert-error",["App Page Not Found",""]),void(this.navModel={section:{title:"Page not found",url:t.defaultNavUrl,icon:"icon-gf icon-gf-sadface"},menu:[]});for(var e=[],n=0,r=t.includes;n<r.length;n++){var a=r[n];a.addToNav&&("dashboard"===a.type&&e.push({title:a.name,url:"dashboard/db/"+a.slug,icon:"fa fa-fw fa-dot-circle-o"}),"page"===a.type&&e.push({title:a.name,url:"plugins/"+t.id+"/page/"+a.slug,icon:"fa fa-fw fa-dot-circle-o"}))}this.navModel={section:{title:t.name,url:t.defaultNavUrl,iconUrl:t.info.logos.small},menu:e}},t.prototype.loadPluginInfo=function(){var t=this;this.backendSrv.get("/api/plugins/"+this.pluginId+"/settings").then(function(e){t.initPage(e)})},t}();a.a.module("grafana.controllers").controller("AppPageCtrl",l)},1415:function(t,e,n){"use strict";var r=n(12),a=n.n(r),i=function(){function t(t,e,n){var r=this;this.backendSrv=t,this.tabIndex=0,this.navModel=n.getPluginsNav();var a=e.search().type||"panel";switch(a){case"datasource":this.tabIndex=1;break;case"app":this.tabIndex=2;break;case"panel":default:this.tabIndex=0}this.backendSrv.get("api/plugins",{embedded:0,type:a}).then(function(t){r.plugins=t})}return t.$inject=["backendSrv","$location","navModelSrv"],t}();a.a.module("grafana.controllers").controller("PluginListCtrl",i)},1416:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/plugins/import_list/import_list.html",controller:l,bindToController:!0,controllerAs:"ctrl",scope:{plugin:"=",datasource:"="}}}var a=n(7),i=n.n(a),o=n(2),s=n(53),l=function(){function t(t,e,n){var r=this;this.backendSrv=e,this.$rootScope=n,this.dashboards=[],e.get("/api/plugins/"+this.plugin.id+"/dashboards").then(function(t){r.dashboards=t}),s.a.on("dashboard-list-import-all",this.importAll.bind(this),t)}return t.$inject=["$scope","backendSrv","$rootScope"],t.prototype.importAll=function(t){return this.importNext(0).then(function(){t.resolve("All dashboards imported")}).catch(function(e){t.reject(e)})},t.prototype.importNext=function(t){var e=this;return this.import(this.dashboards[t],!0).then(function(){return t+1<e.dashboards.length?new Promise(function(n){setTimeout(function(){e.importNext(t+1).then(function(){n()})},500)}):Promise.resolve()})},t.prototype.import=function(t,e){var n=this,r={pluginId:this.plugin.id,path:t.path,overwrite:e,inputs:[]};return this.datasource&&r.inputs.push({name:"*",type:"datasource",pluginId:this.datasource.type,value:this.datasource.name}),this.backendSrv.post("/api/dashboards/import",r).then(function(e){n.$rootScope.appEvent("alert-success",["Dashboard Imported",t.title]),i.a.extend(t,e)})},t.prototype.remove=function(t){var e=this;this.backendSrv.delete("/api/dashboards/"+t.importedUri).then(function(){e.$rootScope.appEvent("alert-success",["Dashboard Deleted",t.title]),t.imported=!1})},t}();o.default.directive("dashboardImportList",r)},1417:function(t,e,n){"use strict";var r=n(7),a=n.n(r),i=n(27),o=n(465),s=[],l={name:"",type:"graphite",url:"",access:"proxy",jsonData:{},secureJsonFields:{}},u=!1,c=function(){function t(t,e,n,r,a,i){var o=this;this.$q=t,this.backendSrv=e,this.$routeParams=n,this.$location=r,this.datasourceSrv=a,this.navModelSrv=i,this.navModel=this.navModelSrv.getDatasourceNav(0),this.isNew=!0,this.datasources=[],this.tabIndex=0,this.loadDatasourceTypes().then(function(){o.$routeParams.id?o.getDatasourceById(o.$routeParams.id):o.initNewDatasourceModel()})}return t.$inject=["$q","backendSrv","$routeParams","$location","datasourceSrv","navModelSrv"],t.prototype.initNewDatasourceModel=function(){this.current=a.a.cloneDeep(l),this.$location.search().gettingstarted&&(this.gettingStarted=!0,this.current.isDefault=!0),this.typeChanged()},t.prototype.loadDatasourceTypes=function(){var t=this;return s.length>0?(this.types=s,this.$q.when(null)):this.backendSrv.get("/api/plugins",{enabled:1,type:"datasource"}).then(function(e){s=e,t.types=e})},t.prototype.getDatasourceById=function(t){var e=this;this.backendSrv.get("/api/datasources/"+t).then(function(t){return e.isNew=!1,e.current=t,u&&(u=!1,e.testDatasource()),e.typeChanged()})},t.prototype.userChangedType=function(){this.current=a.a.defaults({id:this.current.id,name:this.current.name,isDefault:this.current.isDefault,type:this.current.type},a.a.cloneDeep(l)),this.typeChanged()},t.prototype.typeChanged=function(){var t=this;return this.hasDashboards=!1,this.backendSrv.get("/api/plugins/"+this.current.type+"/settings").then(function(e){t.datasourceMeta=e,t.hasDashboards=a.a.find(e.includes,{type:"dashboard"})})},t.prototype.updateFrontendSettings=function(){var t=this;return this.backendSrv.get("/api/frontend/settings").then(function(e){i.default.datasources=e.datasources,i.default.defaultDatasource=e.defaultDatasource,t.datasourceSrv.init()})},t.prototype.testDatasource=function(){var t=this;this.datasourceSrv.get(this.current.name).then(function(e){e.testDatasource&&(t.testing={done:!1,status:"error"},t.backendSrv.withNoBackendCache(function(){return e.testDatasource().then(function(e){t.testing.message=e.message,t.testing.status=e.status}).catch(function(e){e.statusText?t.testing.message="HTTP Error "+e.statusText:t.testing.message=e.message})}).finally(function(){t.testing.done=!0}))})},t.prototype.saveChanges=function(){var t=this;if(this.editForm.$valid&&!this.current.readOnly)return this.current.id?this.backendSrv.put("/api/datasources/"+this.current.id,this.current).then(function(e){t.current=e.datasource,t.updateFrontendSettings().then(function(){t.testDatasource()})}):this.backendSrv.post("/api/datasources",this.current).then(function(e){t.current=e.datasource,t.updateFrontendSettings(),u=!0,t.$location.path("datasources/edit/"+e.id)})},t.prototype.confirmDelete=function(){var t=this;this.backendSrv.delete("/api/datasources/"+this.current.id).then(function(){t.$location.path("datasources")})},t.prototype.delete=function(t){var e=this;o.appEvents.emit("confirm-modal",{title:"Delete",text:"Are you sure you want to delete this datasource?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.confirmDelete()}})},t}();o.coreModule.controller("DataSourceEditCtrl",c),o.coreModule.directive("datasourceHttpSettings",function(){return{scope:{current:"=",suggestUrl:"@"},templateUrl:"public/app/features/plugins/partials/ds_http_settings.html",link:{pre:function(t,e,n){t.getSuggestUrls=function(){return[t.suggestUrl]}}}}})},1418:function(t,e,n){"use strict";var r=n(2),a=function(){function t(t,e,n,r){var a=this;this.$scope=t,this.backendSrv=e,this.datasourceSrv=n,this.navModelSrv=r,this.navModel=this.navModelSrv.getDatasourceNav(0),e.get("/api/datasources").then(function(t){a.datasources=t})}return t.$inject=["$scope","backendSrv","datasourceSrv","navModelSrv"],t.prototype.removeDataSourceConfirmed=function(t){var e=this;this.backendSrv.delete("/api/datasources/"+t.id).then(function(){e.$scope.appEvent("alert-success",["Datasource deleted",""])},function(){e.$scope.appEvent("alert-error",["Unable to delete datasource",""])}).then(function(){e.backendSrv.get("/api/datasources").then(function(t){e.datasources=t}),e.backendSrv.get("/api/frontend/settings").then(function(t){e.datasourceSrv.init(t.datasources)})})},t.prototype.removeDataSource=function(t){var e=this;this.$scope.appEvent("confirm-modal",{title:"Delete",text:"Are you sure you want to delete datasource "+t.name+"?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.removeDataSourceConfirmed(t)}})},t}();r.default.controller("DataSourcesCtrl",a)},1419:function(t,e,n){var r,a;r=[n(12),n(7),n(2),n(27),n(1317)],void 0!==(a=function(t,e,n,r,a){"use strict";r=r.default,n.default.service("datasourceSrv",["$q","$injector","$rootScope","templateSrv",function(t,n,i,o){var s=this;this.init=function(){this.datasources={}},this.get=function(e){return e?(e=o.replace(e),"default"===e?this.get(r.defaultDatasource):this.datasources[e]?t.when(this.datasources[e]):this.loadDatasource(e)):this.get(r.defaultDatasource)},this.loadDatasource=function(e){var o=r.datasources[e];if(!o)return t.reject({message:"Datasource named "+e+" was not found"});var l=t.defer(),u=o.meta;return a.importPluginModule(u.module).then(function(t){if(s.datasources[e])return void l.resolve(s.datasources[e]);if(!t.Datasource)throw"Plugin module is missing Datasource constructor";var r=n.instantiate(t.Datasource,{instanceSettings:o});r.meta=u,r.name=e,s.datasources[e]=r,l.resolve(r)}).catch(function(t){i.appEvent("alert-error",[o.name+" plugin failed",t.toString()])}),l.promise},this.getAll=function(){return r.datasources},this.getAnnotationSources=function(){var t=[];return this.addDataSourceVariables(t),e.each(r.datasources,function(e){e.meta&&e.meta.annotations&&t.push(e)}),t},this.getMetricSources=function(t){var n=[];return e.each(r.datasources,function(t,e){t.meta&&t.meta.metrics&&(n.push({value:e,name:e,meta:t.meta}),e===r.defaultDatasource&&n.push({value:null,name:"default",meta:t.meta}))}),t&&t.skipVariables||this.addDataSourceVariables(n),n.sort(function(t,e){return"mixed"===t.meta.id||"grafana"===t.meta.id?1:"mixed"===e.meta.id||"grafana"===e.meta.id?-1:t.name.toLowerCase()>e.name.toLowerCase()?1:t.name.toLowerCase()<e.name.toLowerCase()?-1:0}),n},this.addDataSourceVariables=function(t){for(var e=0;e<o.variables.length;e++){var n=o.variables[e];if("datasource"===n.type){var a=n.current.value;"default"===a&&(a=r.defaultDatasource);var i=r.datasources[a];i&&t.push({name:"$"+n.name,value:"$"+n.name,meta:i.meta})}}},this.init()}])}.apply(e,r))&&(t.exports=a)},1420:function(t,e,n){(function(e,r,a,i){!function(){"use strict";function o(t){return fe?Symbol():"@@"+t}function s(t,e){ce||(e=e.replace(he?/file:\/\/\//g:/file:\/\//g,""));var n,r=(t.message||t)+"\n  "+e;n=ve&&t.fileName?new Error(r,t.fileName,t.lineNumber):new Error(r);var a=t.originalErr?t.originalErr.stack:t.stack;return n.stack=pe?r+"\n  "+a:a,n.originalErr=t.originalErr||t,n}function l(t,e){throw new RangeError('Unable to resolve "'+t+'" to '+e)}function u(t,e){t=t.trim();var n=e&&e.substr(0,e.indexOf(":")+1),r=t[0],a=t[1];if("/"===r&&"/"===a)return n||l(t,e),n+t;if("."===r&&("/"===a||"."===a&&("/"===t[2]||2===t.length&&(t+="/"))||1===t.length&&(t+="/"))||"/"===r){var i,o=!n||"/"!==e[n.length];if(o?(void 0===e&&l(t,e),i=e):i="/"===e[n.length+1]?"file:"!==n?(i=e.substr(n.length+2)).substr(i.indexOf("/")+1):e.substr(8):e.substr(n.length+1),"/"===r){if(!o)return e.substr(0,e.length-i.length-1)+t;l(t,e)}for(var s=i.substr(0,i.lastIndexOf("/")+1)+t,u=[],c=-1,p=0;p<s.length;p++)if(-1===c)if("."!==s[p])c=p;else{if("."!==s[p+1]||"/"!==s[p+2]&&p+2!==s.length){if("/"!==s[p+1]&&p+1!==s.length){c=p;continue}p+=1}else u.pop(),p+=2;o&&0===u.length&&l(t,e)}else"/"===s[p]&&(u.push(s.substring(c,p+1)),c=-1);return-1!==c&&u.push(s.substr(c)),e.substr(0,e.length-i.length)+u.join("")}return-1!==t.indexOf(":")?pe&&":"===t[1]&&"\\"===t[2]&&t[0].match(/[a-z]/i)?"file:///"+t.replace(/\\/g,"/"):t:void 0}function c(t){if(t.values)return t.values();if("undefined"==typeof Symbol||!Symbol.iterator)throw new Error("Symbol.iterator not supported in this browser");var e={};return e[Symbol.iterator]=function(){var e=Object.keys(t),n=0;return{next:function(){return n<e.length?{value:t[e[n++]],done:!1}:{value:void 0,done:!0}}}},e}function p(){this.registry=new f}function h(t){if(!(t instanceof m))throw new TypeError("Module instantiation did not return a valid namespace object.");return t}function d(t){if(void 0===t)throw new RangeError("No resolution found.");return t}function f(){this[we]={}}function m(t){Object.defineProperty(this,ke,{value:t}),Object.keys(t).forEach(g,this)}function g(t){Object.defineProperty(this,t,{enumerable:!0,get:function(){return this[ke][t]}})}function v(){p.call(this);var t=this.registry.delete;this.registry.delete=function(n){var r=t.call(this,n);return e.hasOwnProperty(n)&&!e[n].linkRecord&&(delete e[n],r=!0),r};var e={};this[_e]={lastRegister:void 0,records:e},this.trace=!1}function y(t,e,n){return t.records[e]={key:e,registration:n,module:void 0,importerSetters:void 0,loadError:void 0,evalError:void 0,linkRecord:{instantiatePromise:void 0,dependencies:void 0,execute:void 0,executingRequire:!1,moduleObj:void 0,setters:void 0,depsInstantiatePromise:void 0,dependencyInstantiations:void 0}}}function b(t,e,n,r,a){var i=r[e];if(i)return Promise.resolve(i);var o=a.records[e];return o&&!o.module?o.loadError?Promise.reject(o.loadError):S(t,o,o.linkRecord,r,a):t.resolve(e,n).then(function(e){if(i=r[e])return i;if((o=a.records[e])&&!o.module||(o=y(a,e,o&&o.registration)),o.loadError)return Promise.reject(o.loadError);var n=o.linkRecord;return n?S(t,o,n,r,a):o})}function x(t,e,n){return function(){var t=n.lastRegister;return t?(n.lastRegister=void 0,e.registration=t,!0):!!e.registration}}function S(t,e,n,r,a){return n.instantiatePromise||(n.instantiatePromise=(e.registration?Promise.resolve():Promise.resolve().then(function(){return a.lastRegister=void 0,t[Me](e.key,t[Me].length>1&&x(t,e,a))})).then(function(i){if(void 0!==i){if(!(i instanceof m))throw new TypeError("Instantiate did not return a valid Module object.");return delete a.records[e.key],t.trace&&k(t,e,n),r[e.key]=i}var o=e.registration;if(e.registration=void 0,!o)throw new TypeError("Module instantiation did not call an anonymous or correctly named System.register.");return n.dependencies=o[0],e.importerSetters=[],n.moduleObj={},o[2]?(n.moduleObj.default=n.moduleObj.__useDefault={},n.executingRequire=o[1],n.execute=o[2]):_(t,e,n,o[1]),e}).catch(function(t){throw e.linkRecord=void 0,e.loadError=e.loadError||s(t,"Instantiating "+e.key)}))}function w(t,e,n,r,a,i){return t.resolve(e,n).then(function(n){i&&(i[e]=n);var o=a.records[n],s=r[n];if(s&&(!o||o.module&&s!==o.module))return s;if(o&&o.loadError)throw o.loadError;(!o||!s&&o.module)&&(o=y(a,n,o&&o.registration));var l=o.linkRecord;return l?S(t,o,l,r,a):o})}function k(t,e,n){t.loads=t.loads||{},t.loads[e.key]={key:e.key,deps:n.dependencies,dynamicDeps:[],depMap:n.depMap||{}}}function _(t,e,n,r){var a=n.moduleObj,i=e.importerSetters,o=!1,s=r.call(de,function(t,e){if("object"==typeof t){var n=!1;for(var r in t)e=t[r],"__useDefault"===r||r in a&&a[r]===e||(n=!0,a[r]=e);if(!1===n)return e}else{if((o||t in a)&&a[t]===e)return e;a[t]=e}for(var s=0;s<i.length;s++)i[s](a);return e},new C(t,e.key));n.setters=s.setters,n.execute=s.execute,s.exports&&(n.moduleObj=a=s.exports,o=!0)}function M(t,e,n,r,a){if(n.depsInstantiatePromise)return n.depsInstantiatePromise;for(var i=Array(n.dependencies.length),o=0;o<n.dependencies.length;o++)i[o]=w(t,n.dependencies[o],e.key,r,a,t.trace&&n.depMap||(n.depMap={}));var l=Promise.all(i).then(function(t){if(n.dependencyInstantiations=t,n.setters)for(var r=0;r<t.length;r++){var a=n.setters[r];if(a){var i=t[r];if(i instanceof m)a(i);else{if(i.loadError)throw i.loadError;a(i.module||i.linkRecord.moduleObj),i.importerSetters&&i.importerSetters.push(a)}}}return e});return t.trace&&(l=l.then(function(){return k(t,e,n),e})),(l=l.catch(function(t){throw n.depsInstantiatePromise=void 0,s(t,"Loading "+e.key)})).catch(function(){}),n.depsInstantiatePromise=l}function T(t,e,n,r,a){return new Promise(function(n,i){function o(e){var n=e.linkRecord;n&&-1===l.indexOf(e)&&(l.push(e),u++,M(t,e,n,r,a).then(s,i))}function s(t){u--;var e=t.linkRecord;if(e)for(var r=0;r<e.dependencies.length;r++){var a=e.dependencyInstantiations[r];a instanceof m||o(a)}0===u&&n()}var l=[],u=0;o(e)})}function C(t,e){this.loader=t,this.key=this.id=e,this.meta={url:e}}function P(t,e,n,r,a,i){if(e.module)return e.module;if(e.evalError)throw e.evalError;if(i&&-1!==i.indexOf(e))return e.linkRecord.moduleObj;var o=A(t,e,n,r,a,n.setters?[]:i||[]);if(o)throw o;return e.module}function O(t,e,n,r,a,i,o){return function(s){for(var l=0;l<n.length;l++)if(n[l]===s){var u,c=r[l];return u=c instanceof m?c:P(t,c,c.linkRecord,a,i,o),"__useDefault"in u?u.__useDefault:u}throw new Error("Module "+s+" not declared as a System.registerDynamic dependency of "+e)}}function A(t,e,n,r,a,i){i.push(e);var o;if(n.setters)for(var l,u,c=0;c<n.dependencies.length;c++)if(!((l=n.dependencyInstantiations[c])instanceof m)&&((u=l.linkRecord)&&-1===i.indexOf(l)&&(o=l.evalError?l.evalError:A(t,l,u,r,a,u.setters?i:[])),o))return e.linkRecord=void 0,e.evalError=s(o,"Evaluating "+e.key),e.evalError;if(n.execute)if(n.setters)o=E(n.execute);else{var p={id:e.key},h=n.moduleObj;Object.defineProperty(p,"exports",{configurable:!0,set:function(t){h.default=h.__useDefault=t},get:function(){return h.__useDefault}});var d=O(t,e.key,n.dependencies,n.dependencyInstantiations,r,a,i);if(!n.executingRequire)for(c=0;c<n.dependencies.length;c++)d(n.dependencies[c]);o=D(n.execute,d,h.default,p),p.exports!==h.__useDefault&&(h.default=h.__useDefault=p.exports);var f=h.default;if(f&&f.__esModule)for(var g in f)Object.hasOwnProperty.call(f,g)&&(h[g]=f[g])}if(e.linkRecord=void 0,o)return e.evalError=s(o,"Evaluating "+e.key);if(r[e.key]=e.module=new m(n.moduleObj),!n.setters){if(e.importerSetters)for(c=0;c<e.importerSetters.length;c++)e.importerSetters[c](e.module);e.importerSetters=void 0}}function E(t){try{t.call(Te)}catch(t){return t}}function D(t,e,n,r){try{var a=t.call(de,e,n,r);void 0!==a&&(r.exports=a)}catch(t){return t}}function $(){}function I(t){return t instanceof m?t:new m(t&&t.__esModule?t:{default:t,__useDefault:t})}function F(t){return void 0===Ce&&(Ce="undefined"!=typeof Symbol&&!!Symbol.toStringTag),t instanceof m||Ce&&"[object Module]"==Object.prototype.toString.call(t)}function R(t,e){(e||this.warnings&&"undefined"!=typeof console&&console.warn)&&console.warn(t)}function q(t,e,n){var r=new Uint8Array(e);return 0===r[0]&&97===r[1]&&115===r[2]?WebAssembly.compile(e).then(function(e){var r=[],a=[],i={};return WebAssembly.Module.imports&&WebAssembly.Module.imports(e).forEach(function(t){var e=t.module;a.push(function(t){i[e]=t}),-1===r.indexOf(e)&&r.push(e)}),t.register(r,function(t){return{setters:a,execute:function(){t(new WebAssembly.Instance(e,i).exports)}}}),n(),!0}):Promise.resolve(!1)}function j(t,e){if("."===t[0])throw new Error("Node module "+t+" can't be loaded as it is not a package require.");if(!Pe){var n=this._nodeRequire("module"),r=decodeURI(e.substr(he?8:7));(Pe=new n(r)).paths=n._nodeModulePaths(r)}return Pe.require(t)}function L(t,e){for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function N(t,e){for(var n in e)Object.hasOwnProperty.call(e,n)&&void 0===t[n]&&(t[n]=e[n]);return t}function V(t,e,n){for(var r in e)if(Object.hasOwnProperty.call(e,r)){var a=e[r];void 0===t[r]?t[r]=a:a instanceof Array&&t[r]instanceof Array?t[r]=[].concat(n?a:t[r]).concat(n?t[r]:a):"object"==typeof a&&null!==a&&"object"==typeof t[r]?t[r]=(n?N:L)(L({},t[r]),a):n||(t[r]=a)}}function U(t){if(Ie||Fe){var e=document.createElement("link");Ie?(e.rel="preload",e.as="script"):e.rel="prefetch",e.href=t,document.head.appendChild(e)}else(new Image).src=t}function B(t,e,n){try{importScripts(t)}catch(t){n(t)}e()}function z(t,e,n,r,a){function i(){r(),s()}function o(e){s(),a(new Error("Fetching "+t))}function s(){for(var t=0;t<Re.length;t++)if(Re[t].err===o){Re.splice(t,1);break}l.removeEventListener("load",i,!1),l.removeEventListener("error",o,!1),document.head.removeChild(l)}if(t=t.replace(/#/g,"%23"),$e)return B(t,r,a);var l=document.createElement("script");l.type="text/javascript",l.charset="utf-8",l.async=!0,e&&(l.crossOrigin=e),n&&(l.integrity=n),l.addEventListener("load",i,!1),l.addEventListener("error",o,!1),l.src=t,document.head.appendChild(l)}function Q(t,e){for(var n=t.split(".");n.length;)e=e[n.shift()];return e}function H(t,e,n){var r=W(e,n);if(r){var a=e[r]+n.substr(r.length),i=u(a,ue);return void 0!==i?i:t+a}return-1!==n.indexOf(":")?n:t+n}function Y(t){var e=this.name;if(e.substr(0,t.length)===t&&(e.length===t.length||"/"===e[t.length]||"/"===t[t.length-1]||":"===t[t.length-1])){var n=t.split("/").length;n>this.len&&(this.match=t,this.len=n)}}function W(t,e){if(Object.hasOwnProperty.call(t,e))return e;var n={name:e,match:void 0,len:0};return Object.keys(t).forEach(Y,n),n.match}function G(t,e,n,r){if("file:///"===t.substr(0,8)){if(Ve)return K(t,e,n,r);throw new Error("Unable to fetch file URLs in this environment.")}t=t.replace(/#/g,"%23");var a={headers:{Accept:"application/x-es-module, */*"}};return n&&(a.integrity=n),e&&("string"==typeof e&&(a.headers.Authorization=e),a.credentials="include"),fetch(t,a).then(function(t){if(t.ok)return r?t.arrayBuffer():t.text();throw new Error("Fetch error: "+t.status+" "+t.statusText)})}function K(t,e,n,r){return new Promise(function(n,a){function i(){n(r?s.response:s.responseText)}function o(){a(new Error("XHR error: "+(s.status?" ("+s.status+(s.statusText?" "+s.statusText:"")+")":"")+" loading "+t))}t=t.replace(/#/g,"%23");var s=new XMLHttpRequest;r&&(s.responseType="arraybuffer"),s.onreadystatechange=function(){4===s.readyState&&(0==s.status?s.response?i():(s.addEventListener("error",o),s.addEventListener("load",i)):200===s.status?i():o())},s.open("GET",t,!0),s.setRequestHeader&&(s.setRequestHeader("Accept","application/x-es-module, */*"),e&&("string"==typeof e&&s.setRequestHeader("Authorization",e),s.withCredentials=!0)),s.send(null)})}function J(t,e,r,a){return"file:///"!=t.substr(0,8)?Promise.reject(new Error('Unable to fetch "'+t+'". Only file URLs of the form file:/// supported running in Node.')):(je=je||n(1426),t=he?t.replace(/\//g,"\\").substr(8):t.substr(7),new Promise(function(e,n){je.readFile(t,function(t,r){if(t)return n(t);if(a)e(r);else{var i=r+"";"\ufeff"===i[0]&&(i=i.substr(1)),e(i)}})}))}function X(){throw new Error("No fetch method is defined for this environment.")}function Z(){return{pluginKey:void 0,pluginArgument:void 0,pluginModule:void 0,packageKey:void 0,packageConfig:void 0,load:void 0}}function tt(t,e,n){var r=Z();if(n){var a;e.pluginFirst?-1!==(a=n.lastIndexOf("!"))&&(r.pluginArgument=r.pluginKey=n.substr(0,a)):-1!==(a=n.indexOf("!"))&&(r.pluginArgument=r.pluginKey=n.substr(a+1)),r.packageKey=W(e.packages,n),r.packageKey&&(r.packageConfig=e.packages[r.packageKey])}return r}function et(t,e){var n=this[Ee],r=Z(),a=tt(this,n,e),i=this;return Promise.resolve().then(function(){var n=t.lastIndexOf("#?");if(-1===n)return Promise.resolve(t);var r=St.call(i,t.substr(n+2));return wt.call(i,r,e,!0).then(function(e){return e?t.substr(0,n):"@empty"})}).then(function(t){var o=ut(n.pluginFirst,t);return o?(r.pluginKey=o.plugin,Promise.all([ot.call(i,n,o.argument,a&&a.pluginArgument||e,r,a,!0),i.resolve(o.plugin,e)]).then(function(t){if(r.pluginArgument=t[0],r.pluginKey=t[1],r.pluginArgument===r.pluginKey)throw new Error("Plugin "+r.pluginArgument+" cannot load itself, make sure it is excluded from any wildcard meta configuration via a custom loader: false rule.");return ct(n.pluginFirst,t[0],t[1])})):ot.call(i,n,t,a&&a.pluginArgument||e,r,a,!1)}).then(function(t){return kt.call(i,t,e,a)}).then(function(t){return lt.call(i,n,t,r),r.pluginKey||!r.load.loader?t:i.resolve(r.load.loader,t).then(function(e){return r.pluginKey=e,r.pluginArgument=t,t})}).then(function(t){return i[De][t]=r,t})}function nt(t,e){var n=ut(t.pluginFirst,e);if(n){var r=nt.call(this,t,n.plugin);return ct(t.pluginFirst,at.call(this,t,n.argument,void 0,!1,!1),r)}return at.call(this,t,e,void 0,!1,!1)}function rt(t,e){var n=this[Ee],r=Z(),a=a||tt(this,n,e),i=ut(n.pluginFirst,t);return i?(r.pluginKey=rt.call(this,i.plugin,e),ct(n.pluginFirst,it.call(this,n,i.argument,a.pluginArgument||e,r,a,!!r.pluginKey),r.pluginKey)):it.call(this,n,t,a.pluginArgument||e,r,a,!!r.pluginKey)}function at(t,e,n,r,a){var i=u(e,n||ue);if(i)return H(t.baseURL,t.paths,i);if(r){var o=W(t.map,e);if(o&&(e=t.map[o]+e.substr(o.length),i=u(e,ue)))return H(t.baseURL,t.paths,i)}if(this.registry.has(e))return e;if("@node/"===e.substr(0,6))return e;var s=a&&"/"!==e[e.length-1],l=H(t.baseURL,t.paths,s?e+"/":e);return s?l.substr(0,l.length-1):l}function it(t,e,n,r,a,i){if(a&&a.packageConfig&&"."!==e[0]){var o=a.packageConfig.map,s=o&&W(o,e);if(s&&"string"==typeof o[s]){var l=ft(this,t,a.packageConfig,a.packageKey,s,e,r,i);if(l)return l}}var u=at.call(this,t,e,n,!0,!0),c=yt(t,u);if(r.packageKey=c&&c.packageKey||W(t.packages,u),!r.packageKey)return u;if(-1!==t.packageConfigKeys.indexOf(u))return r.packageKey=void 0,u;r.packageConfig=t.packages[r.packageKey]||(t.packages[r.packageKey]=Ot());var p=u.substr(r.packageKey.length+1);return ht(this,t,r.packageConfig,r.packageKey,p,r,i)}function ot(t,e,n,r,a,i){var o=this;return Oe.then(function(){if(a&&a.packageConfig&&"./"!==e.substr(0,2)){var n=a.packageConfig.map,s=n&&W(n,e);if(s)return gt(o,t,a.packageConfig,a.packageKey,s,e,r,i)}return Oe}).then(function(a){if(a)return a;var s=at.call(o,t,e,n,!0,!0),l=yt(t,s);return r.packageKey=l&&l.packageKey||W(t.packages,s),r.packageKey?-1!==t.packageConfigKeys.indexOf(s)?(r.packageKey=void 0,r.load=st(),r.load.format="json",r.load.loader="",Promise.resolve(s)):(r.packageConfig=t.packages[r.packageKey]||(t.packages[r.packageKey]=Ot()),(l&&!r.packageConfig.configured?bt(o,t,l.configPath,r):Oe).then(function(){var e=s.substr(r.packageKey.length+1);return mt(o,t,r.packageConfig,r.packageKey,e,r,i)})):Promise.resolve(s)})}function st(){return{extension:"",deps:void 0,format:void 0,loader:void 0,scriptLoad:void 0,globals:void 0,nonce:void 0,integrity:void 0,sourceMap:void 0,exports:void 0,encapsulateGlobal:!1,crossOrigin:void 0,cjsRequireDetection:!0,cjsDeferDepsExecute:!1,esModule:!1}}function lt(t,e,n){n.load=n.load||st();var r,a=0;for(var i in t.meta)if(-1!==(r=i.indexOf("*"))&&i.substr(0,r)===e.substr(0,r)&&i.substr(r+1)===e.substr(e.length-i.length+r+1)){var o=i.split("/").length;o>a&&(a=o),V(n.load,t.meta[i],a!==o)}if(t.meta[e]&&V(n.load,t.meta[e],!1),n.packageKey){var s=e.substr(n.packageKey.length+1),l={};n.packageConfig.meta&&(a=0,xt(n.packageConfig.meta,s,function(t,e,n){n>a&&(a=n),V(l,e,n&&a>n)}),V(n.load,l,!1)),!n.packageConfig.format||n.pluginKey||n.load.loader||(n.load.format=n.load.format||n.packageConfig.format)}}function ut(t,e){var n,r,a=t?e.indexOf("!"):e.lastIndexOf("!");if(-1!==a)return t?(n=e.substr(a+1),r=e.substr(0,a)):(n=e.substr(0,a),r=e.substr(a+1)||n.substr(n.lastIndexOf(".")+1)),{argument:n,plugin:r}}function ct(t,e,n){return t?n+"!"+e:e+"!"+n}function pt(t,e,n,r,a){if(!r||!e.defaultExtension||"/"===r[r.length-1]||a)return r;var i=!1;if(e.meta&&xt(e.meta,r,function(t,e,n){if(0===n||t.lastIndexOf("*")!==t.length-1)return i=!0}),!i&&t.meta&&xt(t.meta,n+"/"+r,function(t,e,n){if(0===n||t.lastIndexOf("*")!==t.length-1)return i=!0}),i)return r;var o="."+e.defaultExtension;return r.substr(r.length-o.length)!==o?r+o:r}function ht(t,e,n,r,a,i,o){if(!a){if(!n.main)return r;a="./"===n.main.substr(0,2)?n.main.substr(2):n.main}if(n.map){var s="./"+a,l=W(n.map,s);if(l||(s="./"+pt(e,n,r,a,o))!="./"+a&&(l=W(n.map,s)),l){var u=ft(t,e,n,r,l,s,i,o);if(u)return u}}return r+"/"+pt(e,n,r,a,o)}function dt(t,e,n){return!(e.substr(0,t.length)===t&&n.length>t.length)}function ft(t,e,n,r,a,i,o,s){"/"===i[i.length-1]&&(i=i.substr(0,i.length-1));var l=n.map[a];if("object"==typeof l)throw new Error("Synchronous conditional normalization not supported sync normalizing "+a+" in "+r);if(dt(a,l,i)&&"string"==typeof l)return it.call(t,e,l+i.substr(a.length),r+"/",o,o,s)}function mt(t,e,n,r,a,i,o){if(!a){if(!n.main)return Promise.resolve(r);a="./"===n.main.substr(0,2)?n.main.substr(2):n.main}var s,l;return n.map&&(s="./"+a,(l=W(n.map,s))||(s="./"+pt(e,n,r,a,o))!="./"+a&&(l=W(n.map,s))),(l?gt(t,e,n,r,l,s,i,o):Oe).then(function(t){return t?Promise.resolve(t):Promise.resolve(r+"/"+pt(e,n,r,a,o))})}function gt(t,e,n,r,a,i,o,s){"/"===i[i.length-1]&&(i=i.substr(0,i.length-1));var l=n.map[a];if("string"==typeof l)return dt(a,l,i)?ot.call(t,e,l+i.substr(a.length),r+"/",o,o,s).then(function(e){return kt.call(t,e,r+"/",o)}):Oe;var u=[],c=[];for(var p in l){var h=St(p);c.push({condition:h,map:l[p]}),u.push(v.prototype.import.call(t,h.module,r))}return Promise.all(u).then(function(t){for(var e=0;e<c.length;e++){var n=c[e].condition,r=Q(n.prop,"__useDefault"in t[e]?t[e].__useDefault:t[e]);if(!n.negate&&r||n.negate&&!r)return c[e].map}}).then(function(n){if(n)return dt(a,n,i)?ot.call(t,e,n+i.substr(a.length),r+"/",o,o,s).then(function(e){return kt.call(t,e,r+"/",o)}):Oe})}function vt(t){var e=t.lastIndexOf("*"),n=Math.max(e+1,t.lastIndexOf("/"));return{length:n,regEx:new RegExp("^("+t.substr(0,n).replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,"[^\\/]+")+")(\\/|$)"),wildcard:-1!==e}}function yt(t,e){for(var n,r,a=!1,i=0;i<t.packageConfigPaths.length;i++){var o=t.packageConfigPaths[i],s=Be[o]||(Be[o]=vt(o));if(!(e.length<s.length)){var l=e.match(s.regEx);!l||n&&(a&&s.wildcard||!(n.length<l[1].length))||(n=l[1],a=!s.wildcard,r=n+o.substr(s.length))}}if(n)return{packageKey:n,configPath:r}}function bt(t,e,n,r,a){var i=t.pluginLoader||t;return-1===e.packageConfigKeys.indexOf(n)&&e.packageConfigKeys.push(n),i.import(n).then(function(t){At(r.packageConfig,t,r.packageKey,!0,e),r.packageConfig.configured=!0}).catch(function(t){throw s(t,"Unable to fetch package configuration file "+n)})}function xt(t,e,n){var r;for(var a in t){var i="./"===a.substr(0,2)?"./":"";if(i&&(a=a.substr(2)),-1!==(r=a.indexOf("*"))&&a.substr(0,r)===e.substr(0,r)&&a.substr(r+1)===e.substr(e.length-a.length+r+1)&&n(a,t[i+a],a.split("/").length))return}var o=t[e]&&Object.hasOwnProperty.call(t,e)?t[e]:t["./"+e];o&&n(o,o,0)}function St(t){var e,n,r,a=t.lastIndexOf("|");return-1!==a?(e=t.substr(a+1),n=t.substr(0,a),"~"===e[0]&&(r=!0,e=e.substr(1))):(r="~"===t[0],e="default",n=t.substr(r),-1!==ze.indexOf(n)&&(e=n,n=null)),{module:n||"@system-env",prop:e,negate:r}}function wt(t,e,n){return v.prototype.import.call(this,t.module,e).then(function(e){var r=Q(t.prop,e);if(n&&"boolean"!=typeof r)throw new TypeError("Condition did not resolve to a boolean.");return t.negate?!r:r})}function kt(t,e,n){var r=t.match(Qe);if(!r)return Promise.resolve(t);var a=St.call(this,r[0].substr(2,r[0].length-3));return wt.call(this,a,e,!1).then(function(n){if("string"!=typeof n)throw new TypeError("The condition value for "+t+" doesn't resolve to a string.");if(-1!==n.indexOf("/"))throw new TypeError("Unabled to interpolate conditional "+t+(e?" in "+e:"")+"\n\tThe condition value "+n+' cannot contain a "/" separator.');return t.replace(Qe,n)})}function _t(t,e,n){for(var r=0;r<He.length;r++){var a=He[r];e[a]&&An[a.substr(0,a.length-6)]&&n(e[a])}}function Mt(t,e){var n={};for(var r in t){var a=t[r];e>1?a instanceof Array?n[r]=[].concat(a):"object"==typeof a?n[r]=Mt(a,e-1):"packageConfig"!==r&&(n[r]=a):n[r]=a}return n}function Tt(t,e){var n=t[e];return n instanceof Array?t[e].concat([]):"object"==typeof n?Mt(n,3):t[e]}function Ct(t){if(t){if(-1!==En.indexOf(t))return Tt(this[Ee],t);throw new Error('"'+t+'" is not a valid configuration name. Must be one of '+En.join(", ")+".")}for(var e={},n=0;n<En.length;n++){var r=En[n],a=Tt(this[Ee],r);void 0!==a&&(e[r]=a)}return e}function Pt(t,e){var n=this,r=this[Ee];if("warnings"in t&&(r.warnings=t.warnings),"wasm"in t&&(r.wasm="undefined"!=typeof WebAssembly&&t.wasm),("production"in t||"build"in t)&&se.call(n,!!t.production,!!(t.build||An&&An.build)),!e){var a;_t(n,t,function(t){a=a||t.baseURL}),(a=a||t.baseURL)&&(r.baseURL=u(a,ue)||u("./"+a,ue),"/"!==r.baseURL[r.baseURL.length-1]&&(r.baseURL+="/")),t.paths&&L(r.paths,t.paths),_t(n,t,function(t){t.paths&&L(r.paths,t.paths)});for(var i in r.paths)-1!==r.paths[i].indexOf("*")&&(R.call(r,"Path config "+i+" -> "+r.paths[i]+" is no longer supported as wildcards are deprecated."),delete r.paths[i])}if(t.defaultJSExtensions&&R.call(r,"The defaultJSExtensions configuration option is deprecated.\n  Use packages defaultExtension instead.",!0),"boolean"==typeof t.pluginFirst&&(r.pluginFirst=t.pluginFirst),t.map)for(var i in t.map){var o=t.map[i];if("string"==typeof o){var s=at.call(n,r,o,void 0,!1,!1);"/"===s[s.length-1]&&":"!==i[i.length-1]&&"/"!==i[i.length-1]&&(s=s.substr(0,s.length-1)),r.map[i]=s}else{g=(g=at.call(n,r,"/"!==i[i.length-1]?i+"/":i,void 0,!0,!0)).substr(0,g.length-1);var l=r.packages[g];l||((l=r.packages[g]=Ot()).defaultExtension=""),At(l,{map:o},g,!1,r)}}if(t.packageConfigPaths){for(var c=[],p=0;p<t.packageConfigPaths.length;p++){var h=t.packageConfigPaths[p],d=Math.max(h.lastIndexOf("*")+1,h.lastIndexOf("/")),f=at.call(n,r,h.substr(0,d),void 0,!1,!1);c[p]=f+h.substr(d)}r.packageConfigPaths=c}if(t.bundles)for(var i in t.bundles){for(var m=[],p=0;p<t.bundles[i].length;p++)m.push(n.normalizeSync(t.bundles[i][p]));r.bundles[i]=m}if(t.packages)for(var i in t.packages){if(i.match(/^([^\/]+:)?\/\/$/))throw new TypeError('"'+i+'" is not a valid package name.');var g=at.call(n,r,"/"!==i[i.length-1]?i+"/":i,void 0,!0,!0);g=g.substr(0,g.length-1),At(r.packages[g]=r.packages[g]||Ot(),t.packages[i],g,!1,r)}if(t.depCache)for(var i in t.depCache)r.depCache[n.normalizeSync(i)]=[].concat(t.depCache[i]);if(t.meta)for(var i in t.meta)if("*"===i[0])L(r.meta[i]=r.meta[i]||{},t.meta[i]);else{var v=at.call(n,r,i,void 0,!0,!0);L(r.meta[v]=r.meta[v]||{},t.meta[i])}"transpiler"in t&&(r.transpiler=t.transpiler);for(var y in t)-1===En.indexOf(y)&&-1===He.indexOf(y)&&(n[y]=t[y]);_t(n,t,function(t){n.config(t,!0)})}function Ot(){return{defaultExtension:void 0,main:void 0,format:void 0,meta:void 0,map:void 0,packageConfig:void 0,configured:!1}}function At(t,e,n,r,a){for(var i in e)"main"===i||"format"===i||"defaultExtension"===i||"configured"===i?r&&void 0!==t[i]||(t[i]=e[i]):"map"===i?(r?N:L)(t.map=t.map||{},e.map):"meta"===i?(r?N:L)(t.meta=t.meta||{},e.meta):Object.hasOwnProperty.call(e,i)&&R.call(a,'"'+i+'" is not a valid package configuration option in package '+n);return void 0===t.defaultExtension&&(t.defaultExtension="js"),void 0===t.main&&t.map&&t.map["."]?(t.main=t.map["."],delete t.map["."]):"object"==typeof t.main&&(t.map=t.map||{},t.map["./@main"]=t.main,t.main.default=t.main.default||"./",t.main="@main"),t}function Et(t){return Ye?Xe+new e(t).toString("base64"):"undefined"!=typeof btoa?Xe+btoa(unescape(encodeURIComponent(t))):""}function Dt(t,e,n,r){var a=t.lastIndexOf("\n");if(e){if("object"!=typeof e)throw new TypeError("load.metadata.sourceMap must be set to an object.");e=JSON.stringify(e)}return(r?"(function(System, SystemJS) {":"")+t+(r?"\n})(System, System);":"")+("\n//# sourceURL="!=t.substr(a,15)?"\n//# sourceURL="+n+(e?"!transpiled":""):"")+(e&&Et(e)||"")}function $t(t,e,n,r,a){We||(We=document.head||document.body||document.documentElement);var i=document.createElement("script");i.text=Dt(e,n,r,!1);var o,s=window.onerror;if(window.onerror=function(t){o=addToError(t,"Evaluating "+r),s&&s.apply(this,arguments)},It(t),a&&i.setAttribute("nonce",a),We.appendChild(i),We.removeChild(i),Ft(),window.onerror=s,o)return o}function It(t){0==Ze++&&(Je=de.System),de.System=de.SystemJS=t}function Ft(){0==--Ze&&(de.System=de.SystemJS=Je)}function Rt(t,e,n,r,a,i,o){if(e){if(i&&tn)return $t(t,e,n,r,i);try{It(t),!Ge&&t._nodeRequire&&(Ge=t._nodeRequire("vm"),Ke=Ge.runInThisContext("typeof System !== 'undefined' && System")===t),Ke?Ge.runInThisContext(Dt(e,n,r,!o),{filename:r+(n?"!transpiled":"")}):(0,eval)(Dt(e,n,r,!o)),Ft()}catch(t){return Ft(),t}}}function qt(t){return"file:///"===t.substr(0,8)?t.substr(7+!!he):en&&t.substr(0,en.length)===en?t.substr(en.length):t}function jt(t,e){return qt(this.normalizeSync(t,e))}function Lt(t){var e,n=t.lastIndexOf("!"),r=(e=-1!==n?t.substr(0,n):t).split("/");return r.pop(),r=r.join("/"),{filename:qt(e),dirname:qt(r)}}function Nt(t){function e(t,e){for(var n=0;n<t.length;n++)if(t[n][0]<e.index&&t[n][1]>e.index)return!0;return!1}Ne.lastIndex=ln.lastIndex=un.lastIndex=0;var n,r=[],a=[],i=[];if(t.length/t.split("\n").length<200){for(;n=un.exec(t);)a.push([n.index,n.index+n[0].length]);for(;n=ln.exec(t);)e(a,n)||i.push([n.index+n[1].length,n.index+n[0].length-1])}for(;n=Ne.exec(t);)if(!e(a,n)&&!e(i,n)){var o=n[1].substr(1,n[1].length-2);if(o.match(/"|'/))continue;r.push(o)}return r}function Vt(t){if(-1===cn.indexOf(t)){try{var e=de[t]}catch(e){cn.push(t)}this(t,e)}}function Ut(t){if("string"==typeof t)return Q(t,de);if(!(t instanceof Array))throw new Error("Global exports must be a string or array.");for(var e={},n=0;n<t.length;n++)e[t[n].split(".").pop()]=Q(t[n],de);return e}function Bt(t,e,n,r){var a=de.define;de.define=void 0;var i;if(n){i={};for(var o in n)i[o]=de[o],de[o]=n[o]}return e||(rn={},Object.keys(de).forEach(Vt,function(t,e){rn[t]=e})),function(){var t,n=e?Ut(e):{},o=!!e;if(e&&!r||Object.keys(de).forEach(Vt,function(a,i){rn[a]!==i&&void 0!==i&&(r&&(de[a]=void 0),e||(n[a]=i,void 0!==t?o||t===i||(o=!0):t=i))}),n=o?n:t,i)for(var s in i)de[s]=i[s];return de.define=a,n}}function zt(t,e){var n=((t=t.replace(ln,"")).match(dn)[1].split(",")[e]||"require").replace(fn,""),r=mn[n]||(mn[n]=new RegExp(pn+n+hn,"g"));r.lastIndex=0;for(var a,i=[];a=r.exec(t);)i.push(a[2]||a[3]);return i}function Qt(t){return function(e,n,r){t(e,n,r),"object"!=typeof(n=r.exports)&&"function"!=typeof n||"__esModule"in n||Object.defineProperty(r.exports,"__esModule",{value:!0})}}function Ht(t,e){on=t,vn=e,an=void 0,gn=!1}function Yt(t){an?t.registerDynamic(on?an[0].concat(on):an[0],!1,vn?Qt(an[1]):an[1]):gn&&t.registerDynamic([],!1,$)}function Wt(t,e){!t.load.esModule||"object"!=typeof e&&"function"!=typeof e||"__esModule"in e||Object.defineProperty(e,"__esModule",{value:!0})}function Gt(t,e){var n=this,r=this[Ee];return(Jt(r,this,t)||Oe).then(function(){if(!e()){var a=n[De][t];if("@node/"===t.substr(0,6)){if(!n._nodeRequire)throw new TypeError("Error loading "+t+". Can only load node core modules in Node.");return n.registerDynamic([],!1,function(){return j.call(n,t.substr(6),n.baseURL)}),void e()}return a.load.scriptLoad?!a.load.pluginKey&&yn||(a.load.scriptLoad=!1,R.call(r,'scriptLoad not supported for "'+t+'"')):!1!==a.load.scriptLoad&&!a.load.pluginKey&&yn&&(a.load.deps||a.load.globals||!("system"===a.load.format||"register"===a.load.format||"global"===a.load.format&&a.load.exports)||(a.load.scriptLoad=!0)),a.load.scriptLoad?new Promise(function(r,i){if("amd"===a.load.format&&de.define!==n.amdDefine)throw new Error("Loading AMD with scriptLoad requires setting the global `"+xn+".define = SystemJS.amdDefine`");z(t,a.load.crossOrigin,a.load.integrity,function(){if(!e()){a.load.format="global";var t=a.load.exports&&Ut(a.load.exports);n.registerDynamic([],!1,function(){return Wt(a,t),t}),e()}r()},i)}):Kt(n,t,a).then(function(){return Xt(n,t,a,e,r.wasm)})}}).then(function(e){return delete n[De][t],e})}function Kt(t,e,n){return n.pluginKey?t.import(n.pluginKey).then(function(t){n.pluginModule=t,n.pluginLoad={name:e,address:n.pluginArgument,source:void 0,metadata:n.load},n.load.deps=n.load.deps||[]}):Oe}function Jt(t,e,n){var r=t.depCache[n];if(r)for(o=0;o<r.length;o++)e.normalize(r[o],n).then(U);else{var a=!1;for(var i in t.bundles){for(var o=0;o<t.bundles[i].length;o++){var s=t.bundles[i][o];if(s===n){a=!0;break}if(-1!==s.indexOf("*")){var l=s.split("*");if(2!==l.length){t.bundles[i].splice(o--,1);continue}if(n.substr(0,l[0].length)===l[0]&&n.substr(n.length-l[1].length,l[1].length)===l[1]){a=!0;break}}}if(a)return e.import(i)}}}function Xt(t,e,n,r,a){return n.load.exports&&!n.load.format&&(n.load.format="global"),Oe.then(function(){if(n.pluginModule&&n.pluginModule.locate)return Promise.resolve(n.pluginModule.locate.call(t,n.pluginLoad)).then(function(t){t&&(n.pluginLoad.address=t)})}).then(function(){return n.pluginModule?(a=!1,n.pluginModule.fetch?n.pluginModule.fetch.call(t,n.pluginLoad,function(t){return Ue(t.address,n.load.authorization,n.load.integrity,!1)}):Ue(n.pluginLoad.address,n.load.authorization,n.load.integrity,!1)):Ue(e,n.load.authorization,n.load.integrity,a)}).then(function(i){return a&&"string"!=typeof i?q(t,i,r).then(function(a){if(!a){var o=ce?new TextDecoder("utf-8").decode(new Uint8Array(i)):i.toString();return Zt(t,e,o,n,r)}}):Zt(t,e,i,n,r)})}function Zt(t,e,n,r,a){return Promise.resolve(n).then(function(e){return"detect"===r.load.format&&(r.load.format=void 0),ie(e,r),r.pluginModule?(r.pluginLoad.source=e,r.pluginModule.translate?Promise.resolve(r.pluginModule.translate.call(t,r.pluginLoad,r.traceOpts)).then(function(t){if(r.load.sourceMap){if("object"!=typeof r.load.sourceMap)throw new Error("metadata.load.sourceMap must be set to an object.");ne(r.pluginLoad.address,r.load.sourceMap)}return"string"==typeof t?t:r.pluginLoad.source}):e):e}).then(function(n){return r.load.format||'"bundle"'!==n.substring(0,8)?"register"===r.load.format||!r.load.format&&te(n)?(r.load.format="register",n):"esm"===r.load.format||!r.load.format&&n.match(Sn)?(r.load.format="esm",re(t,n,e,r,a)):n:(r.load.format="system",n)}).then(function(e){if("string"!=typeof e||!r.pluginModule||!r.pluginModule.instantiate)return e;var n=!1;return r.pluginLoad.source=e,Promise.resolve(r.pluginModule.instantiate.call(t,r.pluginLoad,function(t){if(e=t.source,r.load=t.metadata,n)throw new Error("Instantiate must only be called once.");n=!0})).then(function(t){return n?e:I(t)})}).then(function(n){if("string"!=typeof n)return n;r.load.format||(r.load.format=ee(n));var i=!1;switch(r.load.format){case"esm":case"register":case"system":if(l=Rt(t,n,r.load.sourceMap,e,r.load.integrity,r.load.nonce,!1))throw l;if(!a())return Ae;return;case"json":var o=JSON.parse(n);return t.newModule({default:o,__useDefault:o});case"amd":var s=de.define;de.define=t.amdDefine,Ht(r.load.deps,r.load.esModule);var l=Rt(t,n,r.load.sourceMap,e,r.load.integrity,r.load.nonce,!1);if((i=a())||(Yt(t),i=a()),de.define=s,l)throw l;break;case"cjs":var u=r.load.deps,c=(r.load.deps||[]).concat(r.load.cjsRequireDetection?Nt(n):[]);for(var p in r.load.globals)r.load.globals[p]&&c.push(r.load.globals[p]);t.registerDynamic(c,!0,function(a,i,o){if(a.resolve=function(e){return jt.call(t,e,o.id)},o.paths=[],o.require=a,!r.load.cjsDeferDepsExecute&&u)for(var s=0;s<u.length;s++)a(u[s]);var l=Lt(o.id),c={exports:i,args:[a,i,o,l.filename,l.dirname,de,de]},p="(function (require, exports, module, __filename, __dirname, global, GLOBAL";if(r.load.globals)for(var h in r.load.globals)c.args.push(a(r.load.globals[h])),p+=", "+h;var d=de.define;de.define=void 0,de.__cjsWrapper=c,n=p+") {"+n.replace(Mn,"")+"\n}).apply(__cjsWrapper.exports, __cjsWrapper.args);";var f=Rt(t,n,r.load.sourceMap,e,r.load.integrity,r.load.nonce,!1);if(f)throw f;Wt(r,i),de.__cjsWrapper=void 0,de.define=d}),i=a();break;case"global":c=r.load.deps||[];for(var p in r.load.globals){var h=r.load.globals[p];h&&c.push(h)}t.registerDynamic(c,!1,function(a,i,o){var s;if(r.load.globals){s={};for(var l in r.load.globals)r.load.globals[l]&&(s[l]=a(r.load.globals[l]))}var u=r.load.exports;u&&(n+="\n"+xn+'["'+u+'"] = '+u+";");var c=Bt(o.id,u,s,r.load.encapsulateGlobal),p=Rt(t,n,r.load.sourceMap,e,r.load.integrity,r.load.nonce,!0);if(p)throw p;var h=c();return Wt(r,h),h}),i=a();break;default:throw new TypeError('Unknown module format "'+r.load.format+'" for "'+e+'".'+("es6"===r.load.format?' Use "esm" instead here.':""))}if(!i)throw new Error("Module "+e+" detected as "+r.load.format+" but didn't execute correctly.")})}function te(t){var e=t.match(wn);return e&&"System.register"===t.substr(e[0].length,15)}function ee(t){return t.match(kn)?"amd":(_n.lastIndex=0,Ne.lastIndex=0,Ne.exec(t)||_n.exec(t)?"cjs":"global")}function ne(t,e){var n=t.split("!")[0];e.file&&e.file!=t||(e.file=n+"!transpiled"),(!e.sources||e.sources.length<=1&&(!e.sources[0]||e.sources[0]===t))&&(e.sources=[n])}function re(t,e,n,r,a){if(!t.transpiler)throw new TypeError("Unable to dynamically transpile ES module\n   A loader plugin needs to be configured via `SystemJS.config({ transpiler: 'transpiler-module' })`.");if(r.load.deps){for(var i="",o=0;o<r.load.deps.length;o++)i+='import "'+r.load.deps[o]+'"; ';e=i+e}return t.import.call(t,t.transpiler).then(function(a){if(!(a=a.__useDefault||a).translate)throw new Error(t.transpiler+" is not a valid transpiler plugin.");return a===r.pluginModule?e:("string"==typeof r.load.sourceMap&&(r.load.sourceMap=JSON.parse(r.load.sourceMap)),r.pluginLoad=r.pluginLoad||{name:n,address:n,source:e,metadata:r.load},r.load.deps=r.load.deps||[],Promise.resolve(a.translate.call(t,r.pluginLoad,r.traceOpts)).then(function(t){var e=r.load.sourceMap;return e&&"object"==typeof e&&ne(n,e),"esm"===r.load.format&&te(t)&&(r.load.format="register"),t}))},function(t){throw s(t,"Unable to load transpiler to transpile "+n)})}function ae(t,e,n){for(var r,a=e.split(".");a.length>1;)t=t[r=a.shift()]=t[r]||{};void 0===t[r=a.shift()]&&(t[r]=n)}function ie(t,e){var n=t.match(Tn);if(n)for(var r=n[0].match(Cn),a=0;a<r.length;a++){var i=r[a],o=i.length,s=i.substr(0,1);if(";"==i.substr(o-1,1)&&o--,'"'==s||"'"==s){var l=i.substr(1,i.length-3),u=l.substr(0,l.indexOf(" "));if(u){var c=l.substr(u.length+1,l.length-u.length-1);"deps"===u&&(u="deps[]"),"[]"===u.substr(u.length-2,2)?(u=u.substr(0,u.length-2),e.load[u]=e.load[u]||[],e.load[u].push(c)):"use"!==u&&ae(e.load,u,c)}else e.load[l]=!0}}}function oe(){v.call(this),this._loader={},this[De]={},this[Ee]={baseURL:ue,paths:{},packageConfigPaths:[],packageConfigKeys:[],map:{},packages:{},depCache:{},meta:{},bundles:{},production:!1,transpiler:void 0,loadedBundles:{},warnings:!1,pluginFirst:!1,wasm:!1},this.scriptSrc=bn,this._nodeRequire=sn,this.registry.set("@empty",Ae),se.call(this,!1,!1),nn(this)}function se(t,e){this[Ee].production=t,this.registry.set("@system-env",An=this.newModule({browser:ce,node:!!this._nodeRequire,production:!e&&t,dev:e||!t,build:e,default:!0}))}function le(t,e){R.call(t[Ee],"SystemJS."+e+" is deprecated for SystemJS.registry."+e)}var ue,ce="undefined"!=typeof window&&"undefined"!=typeof document,pe=void 0!==r&&r.versions&&r.versions.node,he=void 0!==r&&"string"==typeof r.platform&&r.platform.match(/^win/),de="undefined"!=typeof self?self:a,fe="undefined"!=typeof Symbol;if("undefined"!=typeof document&&document.getElementsByTagName){if(!(ue=document.baseURI)){var me=document.getElementsByTagName("base");ue=me[0]&&me[0].href||window.location.href}}else"undefined"!=typeof location&&(ue=location.href);if(ue){var ge=(ue=ue.split("#")[0].split("?")[0]).lastIndexOf("/");-1!==ge&&(ue=ue.substr(0,ge+1))}else{if(void 0===r||!r.cwd)throw new TypeError("No environment baseURI");ue="file://"+(he?"/":"")+r.cwd(),he&&(ue=ue.replace(/\\/g,"/"))}"/"!==ue[ue.length-1]&&(ue+="/");var ve="_"==new Error(0,"_").fileName,ye=Promise.resolve();p.prototype.constructor=p,p.prototype.import=function(t,e){if("string"!=typeof t)throw new TypeError("Loader import method must be passed a module key string");var n=this;return ye.then(function(){return n[xe](t,e)}).then(h).catch(function(n){throw s(n,"Loading "+t+(e?" from "+e:""))})};var be=p.resolve=o("resolve"),xe=p.resolveInstantiate=o("resolveInstantiate");p.prototype[xe]=function(t,e){var n=this;return n.resolve(t,e).then(function(t){return n.registry.get(t)})},p.prototype.resolve=function(t,e){var n=this;return ye.then(function(){return n[be](t,e)}).then(d).catch(function(n){throw s(n,"Resolving "+t+(e?" to "+e:""))})};var Se="undefined"!=typeof Symbol&&Symbol.iterator,we=o("registry");Se&&(f.prototype[Symbol.iterator]=function(){return this.entries()[Symbol.iterator]()},f.prototype.entries=function(){var t=this[we];return c(Object.keys(t).map(function(e){return[e,t[e]]}))}),f.prototype.keys=function(){return c(Object.keys(this[we]))},f.prototype.values=function(){var t=this[we];return c(Object.keys(t).map(function(e){return t[e]}))},f.prototype.get=function(t){return this[we][t]},f.prototype.set=function(t,e){if(!(e instanceof m))throw new Error("Registry must be set with an instance of Module Namespace");return this[we][t]=e,this},f.prototype.has=function(t){return Object.hasOwnProperty.call(this[we],t)},f.prototype.delete=function(t){return!!Object.hasOwnProperty.call(this[we],t)&&(delete this[we][t],!0)};var ke=o("baseObject");m.prototype=Object.create(null),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(m.prototype,Symbol.toStringTag,{value:"Module"});var _e=o("register-internal");v.prototype=Object.create(p.prototype),v.prototype.constructor=v;var Me=v.instantiate=o("instantiate");v.prototype[v.resolve=p.resolve]=function(t,e){return u(t,e||ue)},v.prototype[Me]=function(t,e){},v.prototype[p.resolveInstantiate]=function(t,e){var n=this,r=this[_e],a=this.registry[we];return b(n,t,e,a,r).then(function(t){if(t instanceof m)return t;var e=t.linkRecord;if(!e){if(t.module)return t.module;throw t.evalError}return T(n,t,e,a,r).then(function(){return P(n,t,e,a,r,void 0)})})},v.prototype.register=function(t,e,n){var r=this[_e];void 0===n?r.lastRegister=[t,e,void 0]:(r.records[t]||y(r,t,void 0)).registration=[e,n,void 0]},v.prototype.registerDynamic=function(t,e,n,r){var a=this[_e];"string"!=typeof t?a.lastRegister=[t,e,n]:(a.records[t]||y(a,t,void 0)).registration=[e,n,r]},C.prototype.import=function(t){return this.loader.trace&&this.loader.loads[this.key].dynamicDeps.push(t),this.loader.import(t,this.key)};var Te={};Object.freeze&&Object.freeze(Te);var Ce,Pe,Oe=Promise.resolve(),Ae=new m({}),Ee=o("loader-config"),De=o("metadata"),$e="undefined"==typeof window&&"undefined"!=typeof self&&"undefined"!=typeof importScripts,Ie=!1,Fe=!1;if(ce&&function(){var t=document.createElement("link").relList;if(t&&t.supports){Fe=!0;try{Ie=t.supports("preload")}catch(t){}}}(),ce){var Re=[],qe=window.onerror;window.onerror=function(t,e){for(var n=0;n<Re.length;n++)if(Re[n].src===e)return void Re[n].err(t);qe&&qe.apply(this,arguments)}}var je,Le,Ne=/(?:^\uFEFF?|[^$_a-zA-Z\xA0-\uFFFF."'])require\s*\(\s*("[^"\\]*(?:\\.[^"\\]*)*"|'[^'\\]*(?:\\.[^'\\]*)*'|`[^`\\]*(?:\\.[^`\\]*)*`)\s*\)/g,Ve="undefined"!=typeof XMLHttpRequest,Ue=Le="undefined"!=typeof self&&void 0!==self.fetch?G:Ve?K:void 0!==r?J:X,Be={},ze=["browser","node","dev","build","production","default"],Qe=/#\{[^\}]+\}/,He=["browserConfig","nodeConfig","devConfig","buildConfig","productionConfig"],Ye=void 0!==e;try{Ye&&"YQ=="!==new e("a").toString("base64")&&(Ye=!1)}catch(o){Ye=!1}var We,Ge,Ke,Je,Xe="\n//# sourceMappingURL=data:application/json;base64,",Ze=0,tn=!1;ce&&"undefined"!=typeof document&&document.getElementsByTagName&&(window.chrome&&window.chrome.extension||navigator.userAgent.match(/^Node\.js/)||(tn=!0));var en,nn=function(t){function e(n,r,a,i){if("object"==typeof n&&!(n instanceof Array))return e.apply(null,Array.prototype.splice.call(arguments,1,arguments.length-1));if("string"==typeof n&&"function"==typeof r&&(n=[n]),!(n instanceof Array)){if("string"==typeof n){var o=t.decanonicalize(n,i),s=t.get(o);if(!s)throw new Error('Module not already loaded loading "'+n+'" as '+o+(i?' from "'+i+'".':"."));return"__useDefault"in s?s.__useDefault:s}throw new TypeError("Invalid require")}for(var l=[],u=0;u<n.length;u++)l.push(t.import(n[u],i));Promise.all(l).then(function(t){r&&r.apply(null,t)},a)}function n(n,r,a){function i(n,i,u){for(var c=[],p=0;p<r.length;p++)c.push(n(r[p]));if(u.uri=u.id,u.config=$,-1!==l&&c.splice(l,0,u),-1!==s&&c.splice(s,0,i),-1!==o){var h=function(r,a,i){return"string"==typeof r&&"function"!=typeof a?n(r):e.call(t,r,a,i,u.id)};h.toUrl=function(e){return t.normalizeSync(e,u.id)},c.splice(o,0,h)}var d=de.require;de.require=e;var f=a.apply(-1===s?de:i,c);de.require=d,void 0!==f&&(u.exports=f)}"string"!=typeof n&&(a=r,r=n,n=null),r instanceof Array||(a=r,r=["require","exports","module"].splice(0,a.length)),"function"!=typeof a&&(a=function(t){return function(){return t}}(a)),n||on&&(r=r.concat(on),on=void 0);var o,s,l;-1!==(o=r.indexOf("require"))&&(r.splice(o,1),n||(r=r.concat(zt(a.toString(),o)))),-1!==(s=r.indexOf("exports"))&&r.splice(s,1),-1!==(l=r.indexOf("module"))&&r.splice(l,1),n?(t.registerDynamic(n,r,!1,i),an?(an=void 0,gn=!0):gn||(an=[r,i])):t.registerDynamic(r,!1,vn?Qt(i):i)}t.set("@@cjs-helpers",t.newModule({requireResolve:jt.bind(t),getPathVars:Lt})),t.set("@@global-helpers",t.newModule({prepareGlobal:Bt})),n.amd={},t.amdDefine=n,t.amdRequire=e};"undefined"!=typeof window&&"undefined"!=typeof document&&window.location&&(en=location.protocol+"//"+location.hostname+(location.port?":"+location.port:""));var rn,an,on,sn,ln=/(^|[^\\])(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,un=/("[^"\\\n\r]*(\\.[^"\\\n\r]*)*"|'[^'\\\n\r]*(\\.[^'\\\n\r]*)*')/g,cn=["_g","sessionStorage","localStorage","clipboardData","frames","frameElement","external","mozAnimationStartTime","webkitStorageInfo","webkitIndexedDB","mozInnerScreenY","mozInnerScreenX"],pn="(?:^|[^$_a-zA-Z\\xA0-\\uFFFF.])",hn="\\s*\\(\\s*(\"([^\"]+)\"|'([^']+)')\\s*\\)",dn=/\(([^\)]*)\)/,fn=/^\s+|\s+$/g,mn={},gn=!1,vn=!1,yn=(ce||$e)&&"undefined"!=typeof navigator&&navigator.userAgent&&!navigator.userAgent.match(/MSIE (9|10).0/);void 0===r||r.browser||(sn=void 0);var bn,xn="undefined"!=typeof self?"self":"global",Sn=/(^\s*|[}\);\n]\s*)(import\s*(['"]|(\*\s+as\s+)?(?!type)([^"'\(\)\n; ]+)\s*from\s*['"]|\{)|export\s+\*\s+from\s+["']|export\s*(\{|default|function|class|var|const|let|async\s+function))/,wn=/^(\s*\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\s*\/\/[^\n]*|\s*"[^"]+"\s*;?|\s*'[^']+'\s*;?)*\s*/,kn=/(?:^\uFEFF?|[^$_a-zA-Z\xA0-\uFFFF.])define\s*\(\s*("[^"]+"\s*,\s*|'[^']+'\s*,\s*)?\s*(\[(\s*(("[^"]+"|'[^']+')\s*,|\/\/.*\r?\n|\/\*(.|\s)*?\*\/))*(\s*("[^"]+"|'[^']+')\s*,?)?(\s*(\/\/.*\r?\n|\/\*(.|\s)*?\*\/))*\s*\]|function\s*|{|[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*\))/,_n=/(?:^\uFEFF?|[^$_a-zA-Z\xA0-\uFFFF.])(exports\s*(\[['"]|\.)|module(\.exports|\['exports'\]|\["exports"\])\s*(\[['"]|[=,\.]))/,Mn=/^\#\!.*/,Tn=/^(\s*\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\s*\/\/[^\n]*|\s*"[^"]+"\s*;?|\s*'[^']+'\s*;?)+/,Cn=/\/\*[^\*]*(\*(?!\/)[^\*]*)*\*\/|\/\/[^\n]*|"[^"]+"\s*;?|'[^']+'\s*;?/g;if("undefined"==typeof Promise)throw new Error("SystemJS needs a Promise polyfill.");if("undefined"!=typeof document){var Pn=document.getElementsByTagName("script"),On=Pn[Pn.length-1];document.currentScript&&(On.defer||On.async)&&(On=document.currentScript),bn=On&&On.src}else if("undefined"!=typeof importScripts)try{throw new Error("_")}catch(o){o.stack.replace(/(?:at|@).*(http.+):[\d]+:[\d]+/,function(t,e){bn=e})}else void 0!==i&&(bn=i);var An;oe.prototype=Object.create(v.prototype),oe.prototype.constructor=oe,oe.prototype[oe.resolve=v.resolve]=oe.prototype.normalize=et,oe.prototype.load=function(t,e){return R.call(this[Ee],"System.load is deprecated."),this.import(t,e)},oe.prototype.decanonicalize=oe.prototype.normalizeSync=oe.prototype.resolveSync=rt,oe.prototype[oe.instantiate=v.instantiate]=Gt,oe.prototype.config=Pt,oe.prototype.getConfig=Ct,oe.prototype.global=de,oe.prototype.import=function(){return v.prototype.import.apply(this,arguments).then(function(t){return"__useDefault"in t?t.__useDefault:t})};for(var En=["baseURL","map","paths","packages","packageConfigPaths","depCache","meta","bundles","transpiler","warnings","pluginFirst","production","wasm"],Dn="undefined"!=typeof Proxy,$n=0;$n<En.length;$n++)!function(t){Object.defineProperty(oe.prototype,t,{get:function(){var e=Tt(this[Ee],t);return Dn&&"object"==typeof e&&(e=new Proxy(e,{set:function(e,n){throw new Error("Cannot set SystemJS."+t+'["'+n+'"] directly. Use SystemJS.config({ '+t+': { "'+n+'": ... } }) rather.')}})),e},set:function(e){throw new Error("Setting `SystemJS."+t+"` directly is no longer supported. Use `SystemJS.config({ "+t+": ... })`.")}})}(En[$n]);oe.prototype.delete=function(t){return le(this,"delete"),this.registry.delete(t)},oe.prototype.get=function(t){return le(this,"get"),this.registry.get(t)},oe.prototype.has=function(t){return le(this,"has"),this.registry.has(t)},oe.prototype.set=function(t,e){return le(this,"set"),this.registry.set(t,e)},oe.prototype.newModule=function(t){return new m(t)},oe.prototype.isModule=F,oe.prototype.register=function(t,e,n){return"string"==typeof t&&(t=nt.call(this,this[Ee],t)),v.prototype.register.call(this,t,e,n)},oe.prototype.registerDynamic=function(t,e,n,r){return"string"==typeof t&&(t=nt.call(this,this[Ee],t)),v.prototype.registerDynamic.call(this,t,e,n,r)},oe.prototype.version="0.20.19 Dev";var In=new oe;(ce||$e)&&(de.SystemJS=de.System=In),void 0!==t&&t.exports&&(t.exports=In)}()}).call(e,n(1421).Buffer,n(1425),n(54),"/index.js")},1421:function(t,e,n){"use strict";(function(t){function r(){return i.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(r()<e)throw new RangeError("Invalid typed array length");return i.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e),t.__proto__=i.prototype):(null===t&&(t=new i(e)),t.length=e),t}function i(t,e,n){if(!(i.TYPED_ARRAY_SUPPORT||this instanceof i))return new i(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return o(this,t,e,n)}function o(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?h(t,e,n,r):"string"==typeof e?c(t,e,n):d(t,e)}function s(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e,n,r){return s(e),e<=0?a(t,e):void 0!==n?"string"==typeof r?a(t,e).fill(n,r):a(t,e).fill(n):a(t,e)}function u(t,e){if(s(e),t=a(t,e<0?0:0|f(e)),!i.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function c(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!i.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|g(e,n);t=a(t,r);var o=t.write(e,n);return o!==r&&(t=t.slice(0,o)),t}function p(t,e){var n=e.length<0?0:0|f(e.length);t=a(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function h(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),i.TYPED_ARRAY_SUPPORT?(t=e,t.__proto__=i.prototype):t=p(t,e),t}function d(t,e){if(i.isBuffer(e)){var n=0|f(e.length);return t=a(t,n),0===t.length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||G(e.length)?a(t,0):p(t,e);if("Buffer"===e.type&&X(e.data))return p(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function f(t){if(t>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|t}function m(t){return+t!=t&&(t=0),i.alloc(+t)}function g(t,e){if(i.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(t).length;default:if(r)return z(t).length;e=(""+e).toLowerCase(),r=!0}}function v(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if(n>>>=0,e>>>=0,n<=e)return"";for(t||(t="utf8");;)switch(t){case"hex":return D(this,e,n);case"utf8":case"utf-8":return P(this,e,n);case"ascii":return A(this,e,n);case"latin1":case"binary":return E(this,e,n);case"base64":return C(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,a){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(a)return-1;n=t.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof e&&(e=i.from(e,r)),i.isBuffer(e))return 0===e.length?-1:x(t,e,n,r,a);if("number"==typeof e)return e&=255,i.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):x(t,[e],n,r,a);throw new TypeError("val must be string, number or Buffer")}function x(t,e,n,r,a){function i(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}var o=1,s=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,l/=2,n/=2}var u;if(a){var c=-1;for(u=n;u<s;u++)if(i(t,u)===i(e,-1===c?0:u-c)){if(-1===c&&(c=u),u-c+1===l)return c*o}else-1!==c&&(u-=u-c),c=-1}else for(n+l>s&&(n=s-l),u=n;u>=0;u--){for(var p=!0,h=0;h<l;h++)if(i(t,u+h)!==i(e,h)){p=!1;break}if(p)return u}return-1}function S(t,e,n,r){n=Number(n)||0;var a=t.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[n+o]=s}return o}function w(t,e,n,r){return W(z(e,t.length-n),t,n,r)}function k(t,e,n,r){return W(Q(e),t,n,r)}function _(t,e,n,r){return k(t,e,n,r)}function M(t,e,n,r){return W(Y(e),t,n,r)}function T(t,e,n,r){return W(H(e,t.length-n),t,n,r)}function C(t,e,n){return 0===e&&n===t.length?K.fromByteArray(t):K.fromByteArray(t.slice(e,n))}function P(t,e,n){n=Math.min(t.length,n);for(var r=[],a=e;a<n;){var i=t[a],o=null,s=i>239?4:i>223?3:i>191?2:1;if(a+s<=n){var l,u,c,p;switch(s){case 1:i<128&&(o=i);break;case 2:l=t[a+1],128==(192&l)&&(p=(31&i)<<6|63&l)>127&&(o=p);break;case 3:l=t[a+1],u=t[a+2],128==(192&l)&&128==(192&u)&&(p=(15&i)<<12|(63&l)<<6|63&u)>2047&&(p<55296||p>57343)&&(o=p);break;case 4:l=t[a+1],u=t[a+2],c=t[a+3],128==(192&l)&&128==(192&u)&&128==(192&c)&&(p=(15&i)<<18|(63&l)<<12|(63&u)<<6|63&c)>65535&&p<1114112&&(o=p)}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),a+=s}return O(r)}function O(t){var e=t.length;if(e<=Z)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=Z));return n}function A(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(127&t[a]);return r}function E(t,e,n){var r="";n=Math.min(t.length,n);for(var a=e;a<n;++a)r+=String.fromCharCode(t[a]);return r}function D(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=e;i<n;++i)a+=B(t[i]);return a}function $(t,e,n){for(var r=t.slice(e,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,n,r,a,o){if(!i.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>a||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function R(t,e,n,r){e<0&&(e=65535+e+1);for(var a=0,i=Math.min(t.length-n,2);a<i;++a)t[n+a]=(e&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function q(t,e,n,r){e<0&&(e=4294967295+e+1);for(var a=0,i=Math.min(t.length-n,4);a<i;++a)t[n+a]=e>>>8*(r?a:3-a)&255}function j(t,e,n,r,a,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(t,e,n,r,a){return a||j(t,e,n,4,3.4028234663852886e38,-3.4028234663852886e38),J.write(t,e,n,r,23,4),n+4}function N(t,e,n,r,a){return a||j(t,e,n,8,1.7976931348623157e308,-1.7976931348623157e308),J.write(t,e,n,r,52,8),n+8}function V(t){if(t=U(t).replace(tt,""),t.length<2)return"";for(;t.length%4!=0;)t+="=";return t}function U(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function B(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){e=e||1/0;for(var n,r=t.length,a=null,i=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!a){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(e-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function Q(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function H(t,e){for(var n,r,a,i=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,a=n%256,i.push(a),i.push(r);return i}function Y(t){return K.toByteArray(V(t))}function W(t,e,n,r){for(var a=0;a<r&&!(a+n>=e.length||a>=t.length);++a)e[a+n]=t[a];return a}function G(t){return t!==t}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var K=n(1422),J=n(1423),X=n(1424);e.Buffer=i,e.SlowBuffer=m,e.INSPECT_MAX_BYTES=50,i.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=r(),i.poolSize=8192,i._augment=function(t){return t.__proto__=i.prototype,t},i.from=function(t,e,n){return o(null,t,e,n)},i.TYPED_ARRAY_SUPPORT&&(i.prototype.__proto__=Uint8Array.prototype,i.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&i[Symbol.species]===i&&Object.defineProperty(i,Symbol.species,{value:null,configurable:!0})),i.alloc=function(t,e,n){return l(null,t,e,n)},i.allocUnsafe=function(t){return u(null,t)},i.allocUnsafeSlow=function(t){return u(null,t)},i.isBuffer=function(t){return!(null==t||!t._isBuffer)},i.compare=function(t,e){if(!i.isBuffer(t)||!i.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,a=0,o=Math.min(n,r);a<o;++a)if(t[a]!==e[a]){n=t[a],r=e[a];break}return n<r?-1:r<n?1:0},i.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(t,e){if(!X(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return i.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=i.allocUnsafe(e),a=0;for(n=0;n<t.length;++n){var o=t[n];if(!i.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,a),a+=o.length}return r},i.byteLength=g,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},i.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},i.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},i.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):v.apply(this,arguments)},i.prototype.equals=function(t){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===i.compare(this,t)},i.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},i.prototype.compare=function(t,e,n,r,a){if(!i.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),e<0||n>t.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&e>=n)return 0;if(r>=a)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,r>>>=0,a>>>=0,this===t)return 0;for(var o=a-r,s=n-e,l=Math.min(o,s),u=this.slice(r,a),c=t.slice(e,n),p=0;p<l;++p)if(u[p]!==c[p]){o=u[p],s=c[p];break}return o<s?-1:s<o?1:0},i.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},i.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},i.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},i.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-e;if((void 0===n||n>a)&&(n=a),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return S(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return k(this,t,e,n);case"latin1":case"binary":return _(this,t,e,n);case"base64":return M(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;i.prototype.slice=function(t,e){var n=this.length;t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r;if(i.TYPED_ARRAY_SUPPORT)r=this.subarray(t,e),r.__proto__=i.prototype;else{var a=e-t;r=new i(a,void 0);for(var o=0;o<a;++o)r[o]=this[o+t]}return r},i.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],a=1,i=0;++i<e&&(a*=256);)r+=this[t+i]*a;return r},i.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t+--e],a=1;e>0&&(a*=256);)r+=this[t+--e]*a;return r},i.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},i.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},i.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},i.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},i.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},i.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],a=1,i=0;++i<e&&(a*=256);)r+=this[t+i]*a;return a*=128,r>=a&&(r-=Math.pow(2,8*e)),r},i.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=e,a=1,i=this[t+--r];r>0&&(a*=256);)i+=this[t+--r]*a;return a*=128,i>=a&&(i-=Math.pow(2,8*e)),i},i.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},i.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},i.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},i.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},i.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),J.read(this,t,!0,23,4)},i.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),J.read(this,t,!1,23,4)},i.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),J.read(this,t,!0,52,8)},i.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),J.read(this,t,!1,52,8)},i.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){F(this,t,e,n,Math.pow(2,8*n)-1,0)}var a=1,i=0;for(this[e]=255&t;++i<n&&(a*=256);)this[e+i]=t/a&255;return e+n},i.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e|=0,n|=0,!r){F(this,t,e,n,Math.pow(2,8*n)-1,0)}var a=n-1,i=1;for(this[e+a]=255&t;--a>=0&&(i*=256);)this[e+a]=t/i&255;return e+n},i.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,255,0),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},i.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},i.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},i.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):q(this,t,e,!0),e+4},i.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):q(this,t,e,!1),e+4},i.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);F(this,t,e,n,a-1,-a)}var i=0,o=1,s=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},i.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var a=Math.pow(2,8*n-1);F(this,t,e,n,a-1,-a)}var i=n-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o>>0)-s&255;return e+n},i.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,127,-128),i.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},i.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):R(this,t,e,!0),e+2},i.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):R(this,t,e,!1),e+2},i.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),i.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):q(this,t,e,!0),e+4},i.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),i.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):q(this,t,e,!1),e+4},i.prototype.writeFloatLE=function(t,e,n){return L(this,t,e,!0,n)},i.prototype.writeFloatBE=function(t,e,n){return L(this,t,e,!1,n)},i.prototype.writeDoubleLE=function(t,e,n){return N(this,t,e,!0,n)},i.prototype.writeDoubleBE=function(t,e,n){return N(this,t,e,!1,n)},i.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var a,o=r-n;if(this===t&&n<e&&e<r)for(a=o-1;a>=0;--a)t[a+e]=this[a+n];else if(o<1e3||!i.TYPED_ARRAY_SUPPORT)for(a=0;a<o;++a)t[a+e]=this[a+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},i.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var a=t.charCodeAt(0);a<256&&(t=a)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!i.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0);var o;if("number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=i.isBuffer(t)?t:z(new i(t,r).toString()),l=s.length;for(o=0;o<n-e;++o)this[o+e]=s[o%l]}return this};var tt=/[^+\/0-9A-Za-z-_]/g}).call(e,n(54))},1422:function(t,e,n){"use strict";function r(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function a(t){return 3*t.length/4-r(t)}function i(t){var e,n,a,i,o,s=t.length;i=r(t),o=new p(3*s/4-i),n=i>0?s-4:s;var l=0;for(e=0;e<n;e+=4)a=c[t.charCodeAt(e)]<<18|c[t.charCodeAt(e+1)]<<12|c[t.charCodeAt(e+2)]<<6|c[t.charCodeAt(e+3)],o[l++]=a>>16&255,o[l++]=a>>8&255,o[l++]=255&a;return 2===i?(a=c[t.charCodeAt(e)]<<2|c[t.charCodeAt(e+1)]>>4,o[l++]=255&a):1===i&&(a=c[t.charCodeAt(e)]<<10|c[t.charCodeAt(e+1)]<<4|c[t.charCodeAt(e+2)]>>2,o[l++]=a>>8&255,o[l++]=255&a),o}function o(t){return u[t>>18&63]+u[t>>12&63]+u[t>>6&63]+u[63&t]}function s(t,e,n){for(var r,a=[],i=e;i<n;i+=3)r=(t[i]<<16)+(t[i+1]<<8)+t[i+2],a.push(o(r));return a.join("")}function l(t){for(var e,n=t.length,r=n%3,a="",i=[],o=0,l=n-r;o<l;o+=16383)i.push(s(t,o,o+16383>l?l:o+16383));return 1===r?(e=t[n-1],a+=u[e>>2],a+=u[e<<4&63],a+="=="):2===r&&(e=(t[n-2]<<8)+t[n-1],a+=u[e>>10],a+=u[e>>4&63],a+=u[e<<2&63],a+="="),i.push(a),i.join("")}e.byteLength=a,e.toByteArray=i,e.fromByteArray=l;for(var u=[],c=[],p="undefined"!=typeof Uint8Array?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,f=h.length;d<f;++d)u[d]=h[d],c[h.charCodeAt(d)]=d;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63},1423:function(t,e){e.read=function(t,e,n,r,a){var i,o,s=8*a-r-1,l=(1<<s)-1,u=l>>1,c=-7,p=n?a-1:0,h=n?-1:1,d=t[e+p];for(p+=h,i=d&(1<<-c)-1,d>>=-c,c+=s;c>0;i=256*i+t[e+p],p+=h,c-=8);for(o=i&(1<<-c)-1,i>>=-c,c+=r;c>0;o=256*o+t[e+p],p+=h,c-=8);if(0===i)i=1-u;else{if(i===l)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),i-=u}return(d?-1:1)*o*Math.pow(2,i-r)},e.write=function(t,e,n,r,a,i){var o,s,l,u=8*i-a-1,c=(1<<u)-1,p=c>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,f=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),e+=o+p>=1?h/l:h*Math.pow(2,1-p),e*l>=2&&(o++,l/=2),o+p>=c?(s=0,o=c):o+p>=1?(s=(e*l-1)*Math.pow(2,a),o+=p):(s=e*Math.pow(2,p-1)*Math.pow(2,a),o=0));a>=8;t[n+d]=255&s,d+=f,s/=256,a-=8);for(o=o<<a|s,u+=a;u>0;t[n+d]=255&o,d+=f,o/=256,u-=8);t[n+d-f]|=128*m}},1424:function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},1425:function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function a(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function i(t){if(p===clearTimeout)return clearTimeout(t);if((p===r||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function o(){m&&d&&(m=!1,d.length?f=d.concat(f):g=-1,f.length&&s())}function s(){if(!m){var t=a(o);m=!0;for(var e=f.length;e;){for(d=f,f=[];++g<e;)d&&d[g].run();g=-1,e=f.length}d=null,m=!1,i(t)}}function l(t,e){this.fun=t,this.array=e}function u(){}var c,p,h=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{p="function"==typeof clearTimeout?clearTimeout:r}catch(t){p=r}}();var d,f=[],m=!1,g=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new l(t,e)),1!==f.length||m||a(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(t){return[]},h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},1426:function(t,e){},1427:function(t,e,n){"use strict";n.d(e,"a",function(){return f});var r=n(27),a=n(13),i=n.n(a),o=n(7),s=n.n(o),l=n(464),u=n(1313),c=n(471),p=n(467),h=n(1428),d=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.editorTabIndex=1,r.$q=n.get("$q"),r.datasourceSrv=n.get("datasourceSrv"),r.timeSrv=n.get("timeSrv"),r.templateSrv=n.get("templateSrv"),r.scope=e,r.panel.datasource=r.panel.datasource||null,r.panel.targets||(r.panel.targets=[{}]),r.events.on("refresh",r.onMetricsPanelRefresh.bind(r)),r.events.on("init-edit-mode",r.onInitMetricsPanelEditMode.bind(r)),r.events.on("panel-teardown",r.onPanelTearDown.bind(r)),r}return d(e,t),e.prototype.onPanelTearDown=function(){this.dataSubscription&&(this.dataSubscription.unsubscribe(),this.dataSubscription=null)},e.prototype.onInitMetricsPanelEditMode=function(){this.addEditorTab("Metrics",h.a),this.addEditorTab("Time range","public/app/features/panel/partials/panelTime.html")},e.prototype.onMetricsPanelRefresh=function(){var t=this;if(!this.otherPanelInFullscreenMode()){if(this.panel.snapshotData){this.updateTimeRange();var e=this.panel.snapshotData;return s.a.isArray(e)||(e=e.data),void this.events.emit("data-snapshot-load",e)}this.dataStream||(delete this.error,this.loading=!0,this.setTimeQueryStart(),this.datasourceSrv.get(this.panel.datasource).then(this.updateTimeRange.bind(this)).then(this.issueQueries.bind(this)).then(this.handleQueryResult.bind(this)).catch(function(e){if(e.cancelled)return void console.log("Panel request cancelled",e);t.loading=!1,t.error=e.message||"Request Error",t.inspector={error:e},e.data&&(e.data.message&&(t.error=e.data.message),e.data.error&&(t.error=e.data.error)),t.events.emit("data-error",e),console.log("Panel data error:",e)}))}},e.prototype.setTimeQueryStart=function(){this.timing.queryStart=(new Date).getTime()},e.prototype.setTimeQueryEnd=function(){this.timing.queryEnd=(new Date).getTime()},e.prototype.updateTimeRange=function(t){return this.datasource=t||this.datasource,this.range=this.timeSrv.timeRange(),this.applyPanelTimeOverrides(),this.panel.maxDataPoints?this.resolution=this.panel.maxDataPoints:this.resolution=Math.ceil(i()(window).width()*(this.panel.span/12)),this.calculateInterval(),this.datasource},e.prototype.calculateInterval=function(){var t=this.panel.interval;t?t=this.templateSrv.replace(t,this.panel.scopedVars):this.datasource&&this.datasource.interval&&(t=this.datasource.interval);var e=l.default.calculateInterval(this.range,this.resolution,t);this.interval=e.interval,this.intervalMs=e.intervalMs},e.prototype.applyPanelTimeOverrides=function(){if(this.timeInfo="",this.panel.timeFrom){var t=this.templateSrv.replace(this.panel.timeFrom,this.panel.scopedVars),e=c.a(t);if(e.invalid)return void(this.timeInfo="invalid time override");if(s.a.isString(this.range.raw.from)){var n=p.parse(e.from);this.timeInfo=e.display,this.range.from=n,this.range.to=p.parse(e.to),this.range.raw.from=e.from,this.range.raw.to=e.to}}if(this.panel.timeShift){var r=this.templateSrv.replace(this.panel.timeShift,this.panel.scopedVars);if(c.a(r).invalid)return void(this.timeInfo="invalid timeshift");var a="-"+r;this.timeInfo+=" timeshift "+a,this.range.from=p.parseDateMath(a,this.range.from,!1),this.range.to=p.parseDateMath(a,this.range.to,!0),this.range.raw={from:this.range.from,to:this.range.to}}this.panel.hideTimeOverride&&(this.timeInfo="")},e.prototype.issueQueries=function(t){if(this.datasource=t,!this.panel.targets||0===this.panel.targets.length)return this.$q.when([]);var e=Object.assign({},this.panel.scopedVars,{__interval:{text:this.interval,value:this.interval},__interval_ms:{text:this.intervalMs,value:this.intervalMs}}),n={timezone:this.dashboard.getTimezone(),panelId:this.panel.id,range:this.range,rangeRaw:this.range.raw,interval:this.interval,intervalMs:this.intervalMs,targets:this.panel.targets,maxDataPoints:this.resolution,scopedVars:e,cacheTimeout:this.panel.cacheTimeout};return t.query(n)},e.prototype.handleQueryResult=function(t){if(this.setTimeQueryEnd(),this.loading=!1,t&&t.subscribe)return void this.handleDataStream(t);this.dashboard.snapshot&&(this.panel.snapshotData=t.data),t&&t.data||(console.log("Data source query result invalid, missing data field:",t),t={data:[]}),this.events.emit("data-received",t.data)},e.prototype.handleDataStream=function(t){var e=this;if(this.dataStream)return void console.log("two stream observables!");this.dataStream=t,this.dataSubscription=t.subscribe({next:function(t){console.log("dataSubject next!"),t.range&&(e.range=t.range),e.events.emit("data-received",t.data)},error:function(t){e.events.emit("data-error",t),console.log("panel: observer got error")},complete:function(){console.log("panel: observer got complete"),e.dataStream=null}})},e.prototype.setDatasource=function(t){var e=this;t.meta.mixed?s.a.each(this.panel.targets,function(t){t.datasource=e.panel.datasource,t.datasource||(t.datasource=r.default.defaultDatasource)}):this.datasource&&this.datasource.meta.mixed&&s.a.each(this.panel.targets,function(t){delete t.datasource}),this.panel.datasource=t.value,this.datasourceName=t.name,this.datasource=null,this.refresh()},e.prototype.addQuery=function(t){t.refId=this.dashboard.getNextQueryLetter(this.panel),this.panel.targets.push(t),this.nextRefId=this.dashboard.getNextQueryLetter(this.panel)},e.prototype.removeQuery=function(t){var e=s.a.indexOf(this.panel.targets,t);this.panel.targets.splice(e,1),this.nextRefId=this.dashboard.getNextQueryLetter(this.panel),this.refresh()},e.prototype.moveQuery=function(t,e){var n=s.a.indexOf(this.panel.targets,t);s.a.move(this.panel.targets,n,n+e)},e}(u.a)},1428:function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/features/panel/partials/metrics_tab.html",controller:o}}e.a=r;var a=n(469),i=n.n(a),o=function(){function t(t,e,n,r){this.$sce=e,this.backendSrv=r,this.panelCtrl=t.ctrl,t.ctrl=this,this.panel=this.panelCtrl.panel,this.dashboard=this.panelCtrl.dashboard,this.datasources=n.getMetricSources(),this.panelDsValue=this.panelCtrl.panel.datasource;for(var a=0,i=this.datasources;a<i.length;a++){var o=i[a];o.value===this.panelDsValue&&(this.datasourceInstance=o)}this.addQueryDropdown={text:"Add Query",value:null,fake:!0},this.panelCtrl.nextRefId=this.dashboard.getNextQueryLetter(this.panel),this.updateDatasourceOptions()}return t.$inject=["$scope","$sce","datasourceSrv","backendSrv"],t.prototype.updateDatasourceOptions=function(){this.datasourceInstance&&(this.hasQueryHelp=this.datasourceInstance.meta.hasQueryHelp,this.queryOptions=this.datasourceInstance.meta.queryOptions)},t.prototype.getOptions=function(t){return Promise.resolve(this.datasources.filter(function(e){return t||!e.meta.builtIn}).map(function(t){return{value:t.value,text:t.name,datasource:t}}))},t.prototype.datasourceChanged=function(t){t&&(this.datasourceInstance=t.datasource,this.panelCtrl.setDatasource(t.datasource),this.updateDatasourceOptions())},t.prototype.addMixedQuery=function(t){t&&(this.panelCtrl.addQuery({isNew:!0,datasource:t.datasource.name}),this.addQueryDropdown={text:"Add Query",value:null,fake:!0})},t.prototype.addQuery=function(){this.panelCtrl.addQuery({isNew:!0})},t.prototype.toggleHelp=function(){var t=this;this.optionsOpen=!1,this.queryTroubleshooterOpen=!1,this.helpOpen=!this.helpOpen,this.backendSrv.get("/api/plugins/"+this.datasourceInstance.meta.id+"/markdown/query_help").then(function(e){var n=new i.a;t.helpHtml=t.$sce.trustAsHtml(n.render(e))})},t.prototype.toggleOptions=function(){this.helpOpen=!1,this.queryTroubleshooterOpen=!1,this.optionsOpen=!this.optionsOpen},t.prototype.toggleQueryTroubleshooter=function(){this.helpOpen=!1,this.optionsOpen=!1,this.queryTroubleshooterOpen=!this.queryTroubleshooterOpen},t}()},1429:function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/features/alerting/partials/alert_tab.html",controller:p}}e.a=r;var a=n(7),i=n.n(a),o=n(1430),s=n(1308),l=n(1307),u=n(27),c=n(53),p=function(){function t(t,e,n,r,a,i){this.$scope=t,this.backendSrv=e,this.dashboardSrv=n,this.uiSegmentSrv=r,this.$q=a,this.datasourceSrv=i,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.$scope.ctrl=this,this.subTabIndex=0,this.evalFunctions=l.a.evalFunctions,this.evalOperators=l.a.evalOperators,this.conditionTypes=l.a.conditionTypes,this.noDataModes=l.a.noDataModes,this.executionErrorModes=l.a.executionErrorModes,this.appSubUrl=u.default.appSubUrl}return t.$inject=["$scope","backendSrv","dashboardSrv","uiSegmentSrv","$q","datasourceSrv"],t.prototype.$onInit=function(){var t=this;this.addNotificationSegment=this.uiSegmentSrv.newPlusButton();var e=this.graphThresholdChanged.bind(this);return this.panelCtrl.events.on("threshold-changed",e),this.$scope.$on("$destroy",function(){t.panelCtrl.events.off("threshold-changed",e),t.panelCtrl.editingThresholds=!1,t.panelCtrl.render()}),this.notifications=[],this.alertNotifications=[],this.alertHistory=[],this.backendSrv.get("/api/alert-notifications").then(function(e){t.notifications=e,t.initModel(),t.validateModel()})},t.prototype.getAlertHistory=function(){var t=this;this.backendSrv.get("/api/annotations?dashboardId="+this.panelCtrl.dashboard.id+"&panelId="+this.panel.id+"&limit=50").then(function(e){t.alertHistory=i.a.map(e,function(e){return e.time=t.dashboardSrv.getCurrent().formatDate(e.time,"MMM D, YYYY HH:mm:ss"),e.stateModel=l.a.getStateDisplayModel(e.newState),e.info=l.a.getAlertAnnotationInfo(e),e})})},t.prototype.getNotificationIcon=function(t){switch(t){case"email":return"fa fa-envelope";case"slack":return"fa fa-slack";case"victorops":return"fa fa-pagelines";case"webhook":return"fa fa-cubes";case"pagerduty":return"fa fa-bullhorn";case"opsgenie":return"fa fa-bell";case"hipchat":return"fa fa-mail-forward";case"pushover":return"fa fa-mobile";case"kafka":return"fa fa-random"}return"fa fa-bell"},t.prototype.getNotifications=function(){var t=this;return Promise.resolve(this.notifications.map(function(e){return t.uiSegmentSrv.newSegment(e.name)}))},t.prototype.changeTabIndex=function(t){this.subTabIndex=t,2===this.subTabIndex&&this.getAlertHistory()},t.prototype.notificationAdded=function(){var t=i.a.find(this.notifications,{name:this.addNotificationSegment.value});t&&(this.alertNotifications.push({name:t.name,iconClass:this.getNotificationIcon(t.type),isDefault:!1}),this.alert.notifications.push({id:t.id}),this.addNotificationSegment.value=this.uiSegmentSrv.newPlusButton().value,this.addNotificationSegment.html=this.uiSegmentSrv.newPlusButton().html)},t.prototype.removeNotification=function(t){this.alert.notifications.splice(t,1),this.alertNotifications.splice(t,1)},t.prototype.initModel=function(){var t=this,e=this.alert=this.panel.alert;if(e){e.conditions=e.conditions||[],0===e.conditions.length&&e.conditions.push(this.buildDefaultCondition()),e.noDataState=e.noDataState||"no_data",e.executionErrorState=e.executionErrorState||"alerting",e.frequency=e.frequency||"60s",e.handler=e.handler||1,e.notifications=e.notifications||[];var n=this.panel.title+" alert";e.name=e.name||n,this.conditionModels=i.a.reduce(e.conditions,function(e,n){return e.push(t.buildConditionModel(n)),e},[]),o.a.alertToGraphThresholds(this.panel);for(var r=0,a=e.notifications;r<a.length;r++){var s=a[r],l=i.a.find(this.notifications,{id:s.id});l&&!1===l.isDefault&&(l.iconClass=this.getNotificationIcon(l.type),this.alertNotifications.push(l))}for(var u=0,c=this.notifications;u<c.length;u++){var p=c[u];p.isDefault&&(p.iconClass=this.getNotificationIcon(p.type),p.bgColor="#00678b",this.alertNotifications.push(p))}this.panelCtrl.editingThresholds=!0,this.panelCtrl.render()}},t.prototype.graphThresholdChanged=function(t){for(var e=0,n=this.alert.conditions;e<n.length;e++){var r=n[e];if("query"===r.type){r.evaluator.params[t.handleIndex]=t.threshold.value,this.evaluatorParamsChanged();break}}},t.prototype.buildDefaultCondition=function(){return{type:"query",query:{params:["A","5m","now"]},reducer:{type:"avg",params:[]},evaluator:{type:"gt",params:[null]},operator:{type:"and"}}},t.prototype.validateModel=function(){var t=this;if(this.alert)for(var e,n=null,r=0,a=this.alert.conditions;r<a.length;r++){var i=a[r];if("query"===i.type){for(var o=0,s=this.panel.targets;o<s.length;o++){var l=s[o];if(e||(e=l),i.query.params[0]===l.refId){n=l;break}}n||(e?(i.query.params[0]=e.refId,n=e,!0):this.error="Could not find any metric queries");var u=n.datasource||this.panel.datasource;this.datasourceSrv.get(u).then(function(e){e.meta.alerting?e.targetContainsTemplate(n)?t.error="Template variables are not supported in alert queries":t.error="":t.error="The datasource does not support alerting queries"})}}},t.prototype.buildConditionModel=function(t){var e={source:t,type:t.type};return e.queryPart=new s.a(t.query,l.a.alertQueryDef),e.reducerPart=l.a.createReducerPart(t.reducer),e.evaluator=t.evaluator,e.operator=t.operator,e},t.prototype.handleQueryPartEvent=function(t,e){var n=this;switch(e.name){case"action-remove-part":break;case"get-part-actions":return this.$q.when([]);case"part-param-changed":this.validateModel();case"get-param-options":var r=this.panel.targets.map(function(t){return n.uiSegmentSrv.newSegment({value:t.refId})});return this.$q.when(r)}},t.prototype.handleReducerPartEvent=function(t,e){switch(e.name){case"action":t.source.reducer.type=e.action.value,t.reducerPart=l.a.createReducerPart(t.source.reducer);break;case"get-part-actions":for(var n=[],r=0,a=l.a.reducerTypes;r<a.length;r++){var i=a[r];i.value!==t.source.reducer.type&&n.push(i)}return this.$q.when(n)}},t.prototype.addCondition=function(t){var e=this.buildDefaultCondition();this.alert.conditions.push(e),this.conditionModels.push(this.buildConditionModel(e))},t.prototype.removeCondition=function(t){this.alert.conditions.splice(t,1),this.conditionModels.splice(t,1)},t.prototype.delete=function(){var t=this;c.a.emit("confirm-modal",{title:"Delete Alert",text:"Are you sure you want to delete this alert rule?",text2:"You need to save dashboard for the delete to take effect",icon:"fa-trash",yesText:"Delete",onConfirm:function(){delete t.panel.alert,t.alert=null,t.panel.thresholds=[],t.conditionModels=[],t.panelCtrl.alertState=null,t.panelCtrl.render()}})},t.prototype.enable=function(){this.panel.alert={},this.initModel()},t.prototype.evaluatorParamsChanged=function(){o.a.alertToGraphThresholds(this.panel),this.panelCtrl.render()},t.prototype.evaluatorTypeChanged=function(t){switch(t.type){case"lt":case"gt":t.params=[t.params[0]];break;case"within_range":case"outside_range":t.params=[t.params[0],t.params[1]];break;case"no_value":t.params=[]}this.evaluatorParamsChanged()},t.prototype.clearHistory=function(){var t=this;c.a.emit("confirm-modal",{title:"Delete Alert History",text:"Are you sure you want to remove all history & annotations for this alert?",icon:"fa-trash",yesText:"Yes",onConfirm:function(){t.backendSrv.post("/api/annotations/mass-delete",{dashboardId:t.panelCtrl.dashboard.id,panelId:t.panel.id}).then(function(e){t.alertHistory=[],t.panelCtrl.refresh()})}})},t.prototype.test=function(){var t=this;this.testing=!0,this.testResult=!1;var e={dashboard:this.dashboardSrv.getCurrent().getSaveModelClone(),panelId:this.panelCtrl.panel.id};return this.backendSrv.post("/api/alerts/test",e).then(function(e){t.testResult=e,t.testing=!1})},t}()},1430:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(){}return t.alertToGraphThresholds=function(t){if("graph"!==t.type)return!1;for(var e=0;e<t.alert.conditions.length;e++){var n=t.alert.conditions[e];if("query"===n.type){var r=n.evaluator,a=t.thresholds=[];switch(r.type){case"gt":var i=r.params[0];a.push({value:i,op:"gt"});break;case"lt":var i=r.params[0];a.push({value:i,op:"lt"});break;case"outside_range":var o=r.params[0],s=r.params[1];o>s?(a.push({value:o,op:"gt"}),a.push({value:s,op:"lt"})):(a.push({value:o,op:"lt"}),a.push({value:s,op:"gt"}));break;case"within_range":var o=r.params[0],s=r.params[1];o>s?(a.push({value:o,op:"lt"}),a.push({value:s,op:"gt"})):(a.push({value:o,op:"gt"}),a.push({value:s,op:"lt"}))}break}}for(var l=0,u=t.thresholds;l<u.length;l++){var c=u[l];c.fill=!0,c.line=!0,c.colorMode="critical"}return!0},t}()},1431:function(t,e,n){"use strict";var r=n(1432),a=n(1441),i=n(1445),o=n(1454),s=n(1458),l=n(1460),u=n(1465),c=n(1467),p=n(1471),h=n(1475),d=n(1482),f=n(1483),m=n(1494),g=n(1495),v=n(1496),y=n(1497),b=n(1504),x=n(1508),S=n(1510),w=n(1511),k=n(1512),_={"app/plugins/datasource/graphite/module":r,"app/plugins/datasource/cloudwatch/module":a,"app/plugins/datasource/elasticsearch/module":i,"app/plugins/datasource/opentsdb/module":o,"app/plugins/datasource/grafana/module":s,"app/plugins/datasource/influxdb/module":l,"app/plugins/datasource/mixed/module":u,"app/plugins/datasource/mysql/module":c,"app/plugins/datasource/postgres/module":p,"app/plugins/datasource/prometheus/module":h,"app/plugins/app/testdata/module":w,"app/plugins/app/testdata/datasource/module":k,"app/plugins/panel/text/module":d,"app/plugins/panel/graph/module":f,"app/plugins/panel/dashlist/module":m,"app/plugins/panel/pluginlist/module":g,"app/plugins/panel/alertlist/module":v,"app/plugins/panel/heatmap/module":y,"app/plugins/panel/table/module":b,"app/plugins/panel/singlestat/module":x,"app/plugins/panel/gettingstarted/module":S};e.a=_},1432:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AnnotationsQueryCtrl",function(){return o});var r=n(1433),a=n(1434),i=n(1440);n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return a.a}),n.d(e,"ConfigCtrl",function(){return i.a});var o=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},1433:function(t,e,n){"use strict";function r(t,e,n,r){var i=this;this.basicAuth=t.basicAuth,this.url=t.url,this.name=t.name,this.graphiteVersion=t.jsonData.graphiteVersion||"0.9",this.supportsTags=a(this.graphiteVersion),this.cacheTimeout=t.cacheTimeout,this.withCredentials=t.withCredentials,this.render_method=t.render_method||"POST",this.getQueryOptionsInfo=function(){return{maxDataPoints:!0,cacheTimeout:!0,links:[{text:"Help",url:"http://docs.grafana.org/features/datasources/graphite/#using-graphite-in-grafana"}]}},this.query=function(t){var n={from:this.translateTime(t.rangeRaw.from,!1),until:this.translateTime(t.rangeRaw.to,!0),targets:t.targets,format:t.format,cacheTimeout:t.cacheTimeout||this.cacheTimeout,maxDataPoints:t.maxDataPoints},r=this.buildGraphiteParams(n,t.scopedVars);if(0===r.length)return e.when({data:[]});var a={method:"POST",url:"/render",data:r.join("&"),headers:{"Content-Type":"application/x-www-form-urlencoded"}};return t.panelId&&(a.requestId=this.name+".panelId."+t.panelId),this.doGraphiteRequest(a).then(this.convertDataPointsToMs)},this.convertDataPointsToMs=function(t){if(!t||!t.data)return[];for(var e=0;e<t.data.length;e++)for(var n=t.data[e],r=0;r<n.datapoints.length;r++)n.datapoints[r][1]*=1e3;return t},this.parseTags=function(t){var e=[];return e=t.split(","),1===e.length&&(e=t.split(" "),""===e[0]&&(e=[])),e},this.annotationQuery=function(t){var e=this;if(t.annotation.target){var n=r.replace(t.annotation.target,{},"glob"),a={rangeRaw:t.rangeRaw,targets:[{target:n}],format:"json",maxDataPoints:100};return this.query(a).then(function(e){for(var n=[],r=0;r<e.data.length;r++)for(var a=e.data[r],i=0;i<a.datapoints.length;i++){var o=a.datapoints[i];o[0]&&n.push({annotation:t.annotation,time:o[1],title:a.target})}return n})}var i=r.replace(t.annotation.tags);return this.events({range:t.rangeRaw,tags:i}).then(function(n){for(var r=[],a=0;a<n.data.length;a++){var i=n.data[a],s=i.tags;o.a.isString(i.tags)&&(s=e.parseTags(i.tags)),r.push({annotation:t.annotation,time:1e3*i.when,title:i.what,tags:s,text:i.data})}return r})},this.events=function(t){try{var n="";return t.tags&&(n="&tags="+t.tags),this.doGraphiteRequest({method:"GET",url:"/events/get_data?from="+this.translateTime(t.range.from,!1)+"&until="+this.translateTime(t.range.to,!0)+n})}catch(t){return e.reject(t)}},this.targetContainsTemplate=function(t){return r.variableExists(t.target)},this.translateTime=function(t,e){if(o.a.isString(t)){if("now"===t)return"now";if(t.indexOf("now-")>=0&&-1===t.indexOf("/"))return t=t.substring(3),t=t.replace("m","min"),t=t.replace("M","mon");t=s.parse(t,e)}return e?t.get("s")&&t.add(1,"m"):!1===e&&t.get("s")&&t.subtract(1,"m"),t.unix()},this.metricFindQuery=function(t,e){var n=e||{},a=r.replace(t),i={method:"GET",url:"/metrics/find",params:{query:a},requestId:n.requestId};return n&&n.range&&(i.params.from=this.translateTime(n.range.from,!1),i.params.until=this.translateTime(n.range.to,!0)),this.doGraphiteRequest(i).then(function(t){return o.a.map(t.data,function(t){return{text:t.text,expandable:!!t.expandable}})})},this.getTags=function(t){var e=t||{},n={method:"GET",url:"/tags",requestId:e.requestId};return e&&e.range&&(n.params.from=this.translateTime(e.range.from,!1),n.params.until=this.translateTime(e.range.to,!0)),this.doGraphiteRequest(n).then(function(t){return o.a.map(t.data,function(t){return{text:t.tag,id:t.id}})})},this.getTagValues=function(t,e){var n=e||{},r={method:"GET",url:"/tags/"+t,requestId:n.requestId};return n&&n.range&&(r.params.from=this.translateTime(n.range.from,!1),r.params.until=this.translateTime(n.range.to,!0)),this.doGraphiteRequest(r).then(function(t){return t.data&&t.data.values?o.a.map(t.data.values,function(t){return{text:t.value,id:t.id}}):[]})},this.getTagsAutoComplete=function(t,e){var n={method:"GET",url:"/tags/autoComplete/tags",params:{expr:t}};return e&&(n.params.tagPrefix=e),i.doGraphiteRequest(n).then(function(t){return t.data?o.a.map(t.data,function(t){return{text:t}}):[]})},this.getTagValuesAutoComplete=function(t,e,n){var r={method:"GET",url:"/tags/autoComplete/values",params:{expr:t,tag:e}};return n&&(r.params.valuePrefix=n),i.doGraphiteRequest(r).then(function(t){return t.data?o.a.map(t.data,function(t){return{text:t}}):[]})},this.getVersion=function(){var t={method:"GET",url:"/version/_"};return this.doGraphiteRequest(t).then(function(t){if(t.data){return new l.a(t.data).isValid()?t.data:""}return""}).catch(function(){return""})},this.testDatasource=function(){return this.metricFindQuery("*").then(function(){return{status:"success",message:"Data source is working"}})},this.doGraphiteRequest=function(t){return(this.basicAuth||this.withCredentials)&&(t.withCredentials=!0),this.basicAuth&&(t.headers=t.headers||{},t.headers.Authorization=this.basicAuth),t.url=this.url+t.url,t.inspect={type:"graphite"},n.datasourceRequest(t)},this._seriesRefLetters="ABCDEFGHIJKLMNOPQRSTUVWXYZ",this.buildGraphiteParams=function(t,e){function n(t){return t.replace("m","min").replace("M","mon")}function a(t,e){return p[e]||t}var i,s,l,u=["from","until","rawData","format","maxDataPoints","cacheTimeout"],c=[],p={},h=/\#([A-Z])/g,d=/'(\d+)m'/gi,f=!1;for(t.format="json",l=0;l<t.targets.length;l++)i=t.targets[l],i.target&&(i.refId||(i.refId=this._seriesRefLetters[l]),s=r.replace(i.target,e),s=s.replace(d,n),p[i.refId]=s);for(l=0;l<t.targets.length;l++)i=t.targets[l],i.target&&(s=p[i.refId],s=s.replace(h,a),p[i.refId]=s,i.hide||(f=!0,c.push("target="+encodeURIComponent(s))));return o.a.each(t,function(t,e){-1!==o.a.indexOf(u,e)&&t&&c.push(e+"="+encodeURIComponent(t))}),f?c:[]}}function a(t){return Object(l.b)(t,"1.1")}r.$inject=["instanceSettings","$q","backendSrv","templateSrv"],e.a=r;var i=n(7),o=n.n(i),s=n(467),l=n(1329)},1434:function(t,e,n){"use strict";function r(t){return l.a.map(t,function(t){return{text:t,value:t}})}function a(t){return t.replace(m,"")}n.d(e,"a",function(){return g});var i=n(1435),o=(n.n(i),n(1436)),s=(n.n(o),n(7)),l=n.n(s),u=n(1318),c=n(1437),p=n(1305),h=n(53),d=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=["=","!=","=~","!=~"],m="tag: ",g=function(t){function e(e,n,r,a){var i=t.call(this,e,n)||this;return i.uiSegmentSrv=r,i.templateSrv=a,i.supportsTags=i.datasource.supportsTags,i.target&&(i.target.target=i.target.target||"",i.queryModel=new c.a(i.target,a),i.buildSegments()),i.removeTagValue="-- remove tag --",i}return d(e,t),e.$inject=["$scope","$injector","uiSegmentSrv","templateSrv"],e.prototype.parseTarget=function(){this.queryModel.parseTarget(),this.buildSegments()},e.prototype.toggleEditorMode=function(){this.target.textEditor=!this.target.textEditor,this.parseTarget()},e.prototype.buildSegments=function(){var t=this;this.segments=l.a.map(this.queryModel.segments,function(e){return t.uiSegmentSrv.newSegment(e)});var e=this.queryModel.checkOtherSegmentsIndex||0;this.checkOtherSegments(e),this.queryModel.seriesByTagUsed&&this.fixTagSegments()},e.prototype.addSelectMetricSegment=function(){this.queryModel.addSelectMetricSegment(),this.segments.push(this.uiSegmentSrv.newSelectMetric())},e.prototype.checkOtherSegments=function(t){var e=this;if(0===t)return void this.addSelectMetricSegment();var n=this.queryModel.getSegmentPathUpTo(t+1);return""===n?Promise.resolve():this.datasource.metricFindQuery(n).then(function(r){if(0===r.length)""!==n&&(e.queryModel.segments=e.queryModel.segments.splice(0,t),e.segments=e.segments.splice(0,t),e.addSelectMetricSegment());else if(r[0].expandable){if(e.segments.length!==t)return e.checkOtherSegments(t+1);e.addSelectMetricSegment()}}).catch(function(t){h.a.emit("alert-error",["Error",t])})},e.prototype.setSegmentFocus=function(t){l.a.each(this.segments,function(e,n){e.focus=t===n})},e.prototype.getAltSegments=function(t){var e=this,n=0===t?"*":this.queryModel.getSegmentPathUpTo(t)+".*",r={range:this.panelCtrl.range,requestId:"get-alt-segments"};return this.datasource.metricFindQuery(n,r).then(function(n){var r=l.a.map(n,function(t){return e.uiSegmentSrv.newSegment({value:t.text,expandable:t.expandable})});return 0===r.length?r:(l.a.each(e.templateSrv.variables,function(t){r.unshift(e.uiSegmentSrv.newSegment({type:"template",value:"$"+t.name,expandable:!0}))}),r.unshift(e.uiSegmentSrv.newSegment("*")),e.supportsTags&&0===t?(e.removeTaggedEntry(r),e.addAltTagSegments(t,r)):r)}).catch(function(t){return[]})},e.prototype.addAltTagSegments=function(t,e){return this.getTagsAsSegments().then(function(t){return t=l.a.map(t,function(t){return t.value=m+t.value,t}),e.concat.apply(e,t)})},e.prototype.removeTaggedEntry=function(t){t=l.a.remove(t,function(t){return"_tagged"===t.value})},e.prototype.segmentValueChanged=function(t,e){var n=this;if(this.error=null,this.queryModel.updateSegmentValue(t,e),this.queryModel.functions.length>0&&this.queryModel.functions[0].def.fake&&(this.queryModel.functions=[]),"tag"===t.type){var r=a(t.value);return void this.addSeriesByTagFunc(r)}if(t.expandable)return this.checkOtherSegments(e+1).then(function(){n.setSegmentFocus(e+1),n.targetChanged()});this.spliceSegments(e+1),this.setSegmentFocus(e+1),this.targetChanged()},e.prototype.spliceSegments=function(t){this.segments=this.segments.splice(0,t),this.queryModel.segments=this.queryModel.segments.splice(0,t)},e.prototype.emptySegments=function(){this.queryModel.segments=[],this.segments=[]},e.prototype.targetTextChanged=function(){this.updateModelTarget(),this.refresh()},e.prototype.updateModelTarget=function(){this.queryModel.updateModelTarget(this.panelCtrl.panel.targets)},e.prototype.targetChanged=function(){if(!this.queryModel.error){var t=this.queryModel.target.target;if(this.updateModelTarget(),this.queryModel.target!==t){"select metric"!==(this.segments.length>0?this.segments[this.segments.length-1]:{}).value&&this.panelCtrl.refresh()}}},e.prototype.addFunction=function(t){var e=u.default.createFuncInstance(t,{withDefaultParams:!0});e.added=!0,this.queryModel.addFunction(e),this.smartlyHandleNewAliasByNode(e),1===this.segments.length&&this.segments[0].fake&&this.emptySegments(),!e.params.length&&e.added&&this.targetChanged(),"seriesByTag"===e.def.name&&this.parseTarget()},e.prototype.removeFunction=function(t){this.queryModel.removeFunction(t),this.targetChanged()},e.prototype.addSeriesByTagFunc=function(t){var e=u.default.getFuncDef("seriesByTag"),n=u.default.createFuncInstance(e,{withDefaultParams:!1}),r=t+"=select tag value";n.params=[r],this.queryModel.addFunction(n),n.added=!0,this.emptySegments(),this.targetChanged(),this.parseTarget()},e.prototype.smartlyHandleNewAliasByNode=function(t){if("aliasByNode"===t.def.name)for(var e=0;e<this.segments.length;e++)if(this.segments[e].value.indexOf("*")>=0)return t.params[0]=e,t.added=!1,void this.targetChanged()},e.prototype.getAllTags=function(){var t=this;return this.datasource.getTags().then(function(e){var n=l.a.map(e,"text");return n.splice(0,0,t.removeTagValue),r(n)})},e.prototype.getTags=function(t,e){var n=this,a=this.queryModel.renderTagExpressions(t);return this.datasource.getTagsAutoComplete(a,e).then(function(t){var e=l.a.map(t,"text");return e.splice(0,0,n.removeTagValue),r(e)})},e.prototype.getTagsAsSegments=function(){var t=this,e=this.queryModel.renderTagExpressions();return this.datasource.getTagsAutoComplete(e).then(function(e){return l.a.map(e,function(e){return t.uiSegmentSrv.newSegment({value:e.text,type:"tag",expandable:!1})})})},e.prototype.getTagOperators=function(){return r(f)},e.prototype.getAllTagValues=function(t){var e=t.key;return this.datasource.getTagValues(e).then(function(t){return r(l.a.map(t,"text"))})},e.prototype.getTagValues=function(t,e,n){var a=this.queryModel.renderTagExpressions(e),i=t.key;return this.datasource.getTagValuesAutoComplete(a,i,n).then(function(t){return r(l.a.map(t,"text"))})},e.prototype.tagChanged=function(t,e){this.queryModel.updateTag(t,e),this.targetChanged()},e.prototype.addNewTag=function(t){var e=t.value,n={key:e,operator:"=",value:"select tag value"};this.queryModel.addTag(n),this.targetChanged(),this.fixTagSegments()},e.prototype.removeTag=function(t){this.queryModel.removeTag(t),this.targetChanged()},e.prototype.fixTagSegments=function(){this.addTagSegments=[this.uiSegmentSrv.newPlusButton()]},e.prototype.showDelimiter=function(t){return t!==this.queryModel.tags.length-1},e.templateUrl="partials/query.editor.html",e}(p.QueryCtrl)},1435:function(t,e,n){var r,a;r=[n(12),n(7),n(13),n(1318)],void 0!==(a=function(t,e,n,r){"use strict";function a(t){return e.reduce(t,function(t,n){return e.each(n,function(e){t.push(e.name)}),t},[])}function i(t){return e.map(t,function(t,n){return{text:n,submenu:e.map(t,function(t){return{text:t.name,click:"ctrl.addFunction('"+t.name+"')"}})}})}r=r.default,t.module("grafana.directives").directive("graphiteAddFunc",["$compile",function(t){return{link:function(o,s){var l=o.ctrl,u=l.datasource.graphiteVersion,c=r.getCategories(u),p=a(c);o.functionMenu=i(c);var h=n('<input type="text" class="gf-form-input" spellcheck="false" style="display:none"></input>'),d=n('<a  class="gf-form-label query-part dropdown-toggle" tabindex="1" gf-dropdown="functionMenu" data-toggle="dropdown"><i class="fa fa-plus"></i></a>');h.appendTo(s),d.appendTo(s),h.attr("data-provide","typeahead"),h.typeahead({source:p,minLength:1,items:10,updater:function(t){var n=r.getFuncDef(t);if(n||(t=t.toLowerCase(),n=e.find(p,function(e){return 0===e.toLowerCase().indexOf(t)})))return o.$apply(function(){l.addFunction(n)}),h.trigger("blur"),""}}),d.click(function(){d.hide(),h.show(),h.focus()}),h.keyup(function(){s.toggleClass("open",""===h.val())}),h.blur(function(){setTimeout(function(){h.val(""),h.hide(),d.show(),s.removeClass("open")},200)}),t(s.contents())(o)}}}])}.apply(e,r))&&(t.exports=a)},1436:function(t,e,n){var r,a;r=[n(12),n(7),n(13)],void 0!==(a=function(t,e,n){"use strict";t.module("grafana.directives").directive("graphiteFuncEditor",["$compile","templateSrv",function(t,r){return{restrict:"A",link:function(a,i){function o(t){var e=n(this),r=e.next();r.val(S.params[t]),r.css("width",e.width()+16+"px"),e.hide(),r.show(),r.focus(),r.select();var a=r.data("typeahead");a&&(r.val(""),a.lookup())}function s(){_!==S.params.length&&(k||(k=!0,setTimeout(function(){v(),k=!1},200)))}function l(t){var e=n(this),i=e.prev(),o=e.val();(""!==o||S.def.params[t].optional)&&(i.html(r.highlightVariablesAsHtml(o)),S.updateParam(e.val(),t),s(),a.$apply(function(){x.targetChanged()}),e.hide(),i.show())}function u(t,e){13===e.which&&l.call(this,t)}function c(){this.style.width=8*(3+this.value.length)+"px"}function p(t,n){t.attr("data-provide","typeahead");var r=w.params[n].options;"int"===w.params[n].type&&(r=e.map(r,function(t){return t.toString()})),t.typeahead({source:r,minLength:0,items:20,updater:function(e){return setTimeout(function(){l.call(t[0],n)},0),e}}),t.data("typeahead").lookup=function(){return this.query=this.$element.val()||"",this.process(this.source)}}function h(){var t=i.closest(".tight-form");if(i.hasClass("show-function-controls"))return i.removeClass("show-function-controls"),t.removeClass("has-open-function"),void b.hide();i.addClass("show-function-controls"),t.addClass("has-open-function"),b.show()}function d(){b.appendTo(i),y.appendTo(i),e.each(w.params,function(t,a){if(!(t.optional&&S.params.length<=a)){a>0&&n("<span>, </span>").appendTo(i);var s=r.highlightVariablesAsHtml(S.params[a]),h=n('<a ng-click="" class="graphite-func-param-link">'+s+"</a>"),d=n('<input type="text" style="display:none" class="input-mini tight-form-func-param"></input>');_++,h.appendTo(i),d.appendTo(i),d.blur(e.partial(l,a)),d.keyup(c),d.keypress(e.partial(u,a)),h.click(e.partial(o,a)),w.params[a].options&&p(d,a)}}),n("<span>)</span>").appendTo(i),t(i.contents())(a)}function f(){a.func.added&&(a.func.added=!1,setTimeout(function(){i.find(".graphite-func-param-link").first().click()},10))}function m(){y.click(h)}function g(){b.click(function(t){var r=n(t.target);return r.hasClass("fa-remove")?(h(),void a.$apply(function(){x.removeFunction(a.func)})):r.hasClass("fa-arrow-left")?void a.$apply(function(){e.move(x.functions,a.$index,a.$index-1),x.targetChanged()}):r.hasClass("fa-arrow-right")?void a.$apply(function(){e.move(x.functions,a.$index,a.$index+1),x.targetChanged()}):r.hasClass("fa-question-circle")?void window.open("http://graphite.readthedocs.org/en/latest/functions.html#graphite.render.functions."+w.name,"_blank"):void 0})}function v(){i.children().remove(),d(),f(),m(),g()}var y=n('<a ng-click="">{{func.def.name}}</a><span>(</span>'),b=n('<div class="tight-form-func-controls"><span class="pointer fa fa-arrow-left"></span><span class="pointer fa fa-question-circle"></span><span class="pointer fa fa-remove" ></span><span class="pointer fa fa-arrow-right"></span></div>'),x=a.ctrl,S=a.func,w=S.def,k=!1,_=0;v()}}}])}.apply(e,r))&&(t.exports=a)},1437:function(t,e,n){"use strict";function r(t,e){return e.render(t)}function a(t){return t.key+t.operator+t.value}var i=n(7),o=n.n(i),s=n(1318),l=n(1438),u=function(){function t(t,e,n){this.target=t,this.parseTarget(),this.removeTagValue="-- remove tag --"}return t.$inject=["target","templateSrv","scopedVars"],t.prototype.parseTarget=function(){if(this.functions=[],this.segments=[],this.tags=[],this.error=null,!this.target.textEditor){var t=new l.a(this.target.target),e=t.getAst();if(null===e)return void(this.checkOtherSegmentsIndex=0);if("error"===e.type)return this.error=e.message+" at position: "+e.pos,void(this.target.textEditor=!0);try{this.parseTargetRecursive(e,null,0)}catch(t){console.log("error parsing target:",t.message),this.error=t.message,this.target.textEditor=!0}this.checkOtherSegmentsIndex=this.segments.length-1,this.checkForSeriesByTag()}},t.prototype.checkForSeriesByTag=function(){var t=o.a.find(this.functions,function(t){return"seriesByTag"===t.def.name});if(t){this.seriesByTagUsed=!0,t.hidden=!0;var e=this.splitSeriesByTagParams(t);this.tags=e}},t.prototype.getSegmentPathUpTo=function(t){var e=this.segments.slice(0,t);return o.a.reduce(e,function(t,e){return t?t+"."+e.value:e.value},"")},t.prototype.parseTargetRecursive=function(t,e,n){var r=this;if(null===t)return null;switch(t.type){case"function":var a=s.default.createFuncInstance(t.name,{withDefaultParams:!1});o.a.each(t.params,function(t,e){r.parseTargetRecursive(t,a,e)}),a.updateText(),this.functions.push(a);break;case"series-ref":this.addFunctionParameter(e,t.value,n,this.segments.length>0);break;case"bool":case"string":case"number":if(n-1>=e.def.params.length)throw{message:"invalid number of parameters to method "+e.def.name};var i=this.isShiftParamsBack(e);this.addFunctionParameter(e,t.value,n,i);break;case"metric":if(this.segments.length>0){if(1!==t.segments.length)throw{message:"Multiple metric params not supported, use text editor."};this.addFunctionParameter(e,t.segments[0].value,n,!0);break}this.segments=t.segments}},t.prototype.isShiftParamsBack=function(t){return"seriesByTag"!==t.def.name},t.prototype.updateSegmentValue=function(t,e){this.segments[e].value=t.value},t.prototype.addSelectMetricSegment=function(){this.segments.push({value:"select metric"})},t.prototype.addFunction=function(t){this.functions.push(t),this.moveAliasFuncLast()},t.prototype.moveAliasFuncLast=function(){var t=o.a.find(this.functions,function(t){return"alias"===t.def.name||"aliasByNode"===t.def.name||"aliasByMetric"===t.def.name});t&&(this.functions=o.a.without(this.functions,t),this.functions.push(t))},t.prototype.addFunctionParameter=function(t,e,n,r){r&&(n=Math.max(n-1,0)),t.params[n]=e},t.prototype.removeFunction=function(t){this.functions=o.a.without(this.functions,t)},t.prototype.updateModelTarget=function(t){if(!this.target.textEditor){var e=this.getSegmentPathUpTo(this.segments.length);this.target.target=o.a.reduce(this.functions,r,e)}this.updateRenderedTarget(this.target,t);for(var n=0,a=t||[];n<a.length;n++){var i=a[n];i.refId!==this.target.refId&&this.updateRenderedTarget(i,t)}},t.prototype.updateRenderedTarget=function(t,e){var n=o.a.keyBy(e,"refId");delete n[t.refId];for(var r=/\#([A-Z])/g,a=t.target;a.match(r);){var i=a.replace(r,function(t,e){var r=n[e];return r?(delete n[e],r.target):t});if(i===a)break;a=i}delete t.targetFull,t.target!==a&&(t.targetFull=a)},t.prototype.splitSeriesByTagParams=function(t){var e=/([^\!=~]+)([\!=~]+)([^\!=~]+)/;return o.a.flatten(o.a.map(t.params,function(t){var n=e.exec(t);if(n){var r=n.slice(1);if(3===r.length)return{key:r[0],operator:r[1],value:r[2]}}return[]}))},t.prototype.getSeriesByTagFuncIndex=function(){return o.a.findIndex(this.functions,function(t){return"seriesByTag"===t.def.name})},t.prototype.getSeriesByTagFunc=function(){var t=this.getSeriesByTagFuncIndex();return t>=0?this.functions[t]:void 0},t.prototype.addTag=function(t){var e=a(t);this.getSeriesByTagFunc().params.push(e),this.tags.push(t)},t.prototype.removeTag=function(t){this.getSeriesByTagFunc().params.splice(t,1),this.tags.splice(t,1)},t.prototype.updateTag=function(t,e){if(this.error=null,t.key===this.removeTagValue)return void this.removeTag(e);var n=a(t);this.getSeriesByTagFunc().params[e]=n,this.tags[e]=t},t.prototype.renderTagExpressions=function(t){return void 0===t&&(t=-1),o.a.compact(o.a.map(this.tags,function(e,n){if(n!==t)return e.key+e.operator+e.value}))},t}();e.a=u},1438:function(t,e,n){"use strict";function r(t){this.expression=t,this.lexer=new a.a(t),this.tokens=this.lexer.tokenize(),this.index=0}e.a=r;var a=n(1439);r.prototype={getAst:function(){return this.start()},start:function(){try{return this.functionCall()||this.metricExpression()}catch(t){return{type:"error",message:t.message,pos:t.pos}}},curlyBraceSegment:function(){if(this.match("identifier","{")||this.match("{")){for(var t="";!this.match("")&&!this.match("}");)t+=this.consumeToken().value;return this.match("}")||this.errorMark("Expected closing '}'"),t+=this.consumeToken().value,this.match("identifier")&&(t+=this.consumeToken().value),{type:"segment",value:t}}return null},metricSegment:function(){var t=this.curlyBraceSegment();if(t)return t;if(this.match("identifier")||this.match("number")){var e=this.consumeToken().value.split(".");return 2===e.length&&(this.tokens.splice(this.index,0,{type:"."}),this.tokens.splice(this.index+1,0,{type:"number",value:e[1]})),{type:"segment",value:e[0]}}this.match("templateStart")||this.errorMark("Expected metric identifier"),this.consumeToken(),this.match("identifier")||this.errorMark("Expected identifier after templateStart");var n={type:"template",value:this.consumeToken().value};return this.match("templateEnd")||this.errorMark("Expected templateEnd"),this.consumeToken(),n},metricExpression:function(){if(!(this.match("templateStart")||this.match("identifier")||this.match("number")||this.match("{")))return null;var t={type:"metric",segments:[]};for(t.segments.push(this.metricSegment());this.match(".");){this.consumeToken();var e=this.metricSegment();e||this.errorMark("Expected metric identifier"),t.segments.push(e)}return t},functionCall:function(){if(!this.match("identifier","("))return null;var t={type:"function",name:this.consumeToken().value};return this.consumeToken(),t.params=this.functionParameters(),this.match(")")||this.errorMark("Expected closing parenthesis"),this.consumeToken(),t},boolExpression:function(){return this.match("bool")?{type:"bool",value:"true"===this.consumeToken().value}:null},functionParameters:function(){if(this.match(")")||this.match(""))return[];var t=this.functionCall()||this.numericLiteral()||this.seriesRefExpression()||this.boolExpression()||this.metricExpression()||this.stringLiteral();return this.match(",")?(this.consumeToken(),[t].concat(this.functionParameters())):[t]},seriesRefExpression:function(){return this.match("identifier")&&this.tokens[this.index].value.match(/\#[A-Z]/)?{type:"series-ref",value:this.consumeToken().value}:null},numericLiteral:function(){return this.match("number")?{type:"number",value:parseFloat(this.consumeToken().value)}:null},stringLiteral:function(){if(!this.match("string"))return null;var t=this.consumeToken();if(t.isUnclosed)throw{message:"Unclosed string parameter",pos:t.pos};return{type:"string",value:t.value}},errorMark:function(t){var e=this.tokens[this.index];throw{message:t+" instead found "+(e?e.type:"end of string"),pos:e?e.pos:this.lexer.char}},consumeToken:function(){return this.index++,this.tokens[this.index-1]},matchToken:function(t,e){var n=this.tokens[this.index+e];return void 0===n&&""===t||n&&n.type===t},match:function(t,e){return this.matchToken(t,0)&&(!e||this.matchToken(e,1))}}},1439:function(t,e,n){"use strict";function r(t){this.input=t,this.char=1,this.from=1}e.a=r;for(var a=n(7),i=n.n(a),o=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3805,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4304,4346,4348,4348,4352,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7104,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11520,11557,11568,11621,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,13312,19893,19893,19968,19968,40907,40907,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42897,42912,42921,43002,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,44032,55203,55203,55216,55238,55243,55291,63744,64045,64048,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500,65536,65547,65549,65574,65576,65594,65596,65597,65599,65613,65616,65629,65664,65786,65856,65908,66176,66204,66208,66256,66304,66334,66352,66378,66432,66461,66464,66499,66504,66511,66513,66517,66560,66717,67584,67589,67592,67592,67594,67637,67639,67640,67644,67644,67647,67669,67840,67861,67872,67897,68096,68096,68112,68115,68117,68119,68121,68147,68192,68220,68352,68405,68416,68437,68448,68466,68608,68680,69635,69687,69763,69807,73728,74606,74752,74850,77824,78894,92160,92728,110592,110593,119808,119892,119894,119964,119966,119967,119970,119970,119973,119974,119977,119980,119982,119993,119995,119995,119997,120003,120005,120069,120071,120074,120077,120084,120086,120092,120094,120121,120123,120126,120128,120132,120134,120134,120138,120144,120146,120485,120488,120512,120514,120538,120540,120570,120572,120596,120598,120628,120630,120654,120656,120686,120688,120712,120714,120744,120746,120770,120772,120779,131072,131072,173782,173782,173824,173824,177972,177972,177984,177984,178205,178205,194560,195101],s=[],l=0;l<128;l++)s[l]=l>=48&&l<=57||36===l||126===l||124===l||l>=65&&l<=90||95===l||45===l||42===l||58===l||91===l||93===l||63===l||37===l||35===l||61===l||l>=97&&l<=122;var u=s;r.prototype={peek:function(t){return this.input.charAt(t||0)},skip:function(t){t=t||1,this.char+=t,this.input=this.input.slice(t)},tokenize:function(){for(var t,e=[];t=this.next();)e.push(t);return e},next:function(){this.from=this.char;if(/\s/.test(this.peek())){for(this.char;/\s/.test(this.peek());)this.from+=1,this.skip();if(""===this.peek())return null}var t=this.scanStringLiteral();return t||(t=this.scanPunctuator()||this.scanNumericLiteral()||this.scanIdentifier()||this.scanTemplateSequence(),t?(this.skip(t.value.length),t):null)},scanTemplateSequence:function(){return"["===this.peek()&&"["===this.peek(1)?{type:"templateStart",value:"[[",pos:this.char}:"]"===this.peek()&&"]"===this.peek(1)?{type:"templateEnd",value:"[[",pos:this.char}:null},scanIdentifier:function(){function t(t){for(var e=0;e<o.length;){if(t<o[e++])return!1;if(t<=o[e++])return!0}return!1}function e(t){return/^[0-9a-fA-F]$/.test(t)}var n,r,a="",l=0,c=i.a.bind(function(){if(l+=1,"u"!==this.peek(l))return null;var n,r=this.peek(l+1),a=this.peek(l+2),i=this.peek(l+3),o=this.peek(l+4);return e(r)&&e(a)&&e(i)&&e(o)?(n=parseInt(r+a+i+o,16),t(n)?(l+=5,"\\u"+r+a+i+o):null):null},this),p=i.a.bind(function(){var e=this.peek(l),n=e.charCodeAt(0);return"*"===e?(l+=1,e):92===n?c():n<128?s[n]?(l+=1,e):null:t(n)?(l+=1,e):null},this),h=i.a.bind(function(){var e=this.peek(l),n=e.charCodeAt(0);return 92===n?c():n<128?u[n]?(l+=1,e):null:t(n)?(l+=1,e):null},this);if(null===(r=p()))return null;for(a=r;null!==(r=h());)a+=r;switch(a){case"true":case"false":n="bool";break;default:n="identifier"}return{type:n,value:a,pos:this.char}},scanNumericLiteral:function(){function t(t){return/^[0-9]$/.test(t)}function e(t){return/^[0-7]$/.test(t)}function n(t){return"$"===t||"_"===t||"\\"===t||t>="a"&&t<="z"||t>="A"&&t<="Z"}var r,a=0,i="",o=this.input.length,s=this.peek(a);if("-"===s&&(i+=s,a+=1,s=this.peek(a)),"."!==s&&!t(s))return null;if("."!==s){if(i+=this.peek(a),a+=1,s=this.peek(a),"0"===i){if("x"===s||"X"===s){for(a+=1,i+=s;a<o&&(s=this.peek(a),function(t){return/^[0-9a-fA-F]$/.test(t)}(s));)i+=s,a+=1;return i.length<=2?{type:"number",value:i,isMalformed:!0,pos:this.char}:a<o&&(s=this.peek(a),n(s))?null:{type:"number",value:i,base:16,isMalformed:!1,pos:this.char}}if(e(s)){for(a+=1,i+=s,r=!1;a<o;){if(s=this.peek(a),t(s)&&(r=!0),!e(s)){if(!this.isPunctuator(s))return null;break}i+=s,a+=1}return a<o&&(s=this.peek(a),n(s))?null:{type:"number",value:i,base:8,isMalformed:r}}t(s)&&(a+=1,i+=s)}for(;a<o&&(s=this.peek(a),t(s));)i+=s,a+=1}if("."===s)for(i+=s,a+=1;a<o&&(s=this.peek(a),t(s));)i+=s,a+=1;if("e"===s||"E"===s){if(i+=s,a+=1,s=this.peek(a),"+"!==s&&"-"!==s||(i+=this.peek(a),a+=1),s=this.peek(a),!t(s))return null;for(i+=s,a+=1;a<o&&(s=this.peek(a),t(s));)i+=s,a+=1}return a<o&&(s=this.peek(a),!this.isPunctuator(s))?null:{type:"number",value:i,base:10,pos:this.char,isMalformed:!isFinite(+i)}},isPunctuator:function(t){switch(t){case".":case"(":case")":case",":case"{":case"}":return!0}return!1},scanPunctuator:function(){var t=this.peek();return this.isPunctuator(t)?{type:t,value:t,pos:this.char}:null},scanStringLiteral:function(){var t=this.peek();if('"'!==t&&"'"!==t)return null;var e="";for(this.skip();this.peek()!==t;){if(""===this.peek())return{type:"string",value:e,isUnclosed:!0,quote:t,pos:this.char};e+=this.peek(),this.skip(1)}return this.skip(),{type:"string",value:e,isUnclosed:!1,quote:t,pos:this.char}}}},1440:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t,e){this.graphiteVersions=[{name:"0.9.x",value:"0.9"},{name:"1.0.x",value:"1.0"},{name:"1.1.x",value:"1.1"}],this.datasourceSrv=e,this.current.jsonData=this.current.jsonData||{},this.current.jsonData.graphiteVersion=this.current.jsonData.graphiteVersion||"0.9",this.autoDetectGraphiteVersion()}return t.$inject=["$scope","datasourceSrv"],t.prototype.autoDetectGraphiteVersion=function(){var t=this;this.datasourceSrv.loadDatasource(this.current.name).then(function(t){return t.getVersion()}).then(function(e){t.graphiteVersions.push({name:e,value:e}),t.current.jsonData.graphiteVersion=e})},t.templateUrl="public/app/plugins/datasource/graphite/partials/config.html",t}()},1441:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AnnotationsQueryCtrl",function(){return l});var r=n(1330),a=(n.n(r),n(1442)),i=n.n(a),o=n(1443),s=n(1444);n.d(e,"Datasource",function(){return i.a}),n.d(e,"QueryCtrl",function(){return o.a}),n.d(e,"ConfigCtrl",function(){return s.a});var l=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},1442:function(t,e,n){var r,a;r=[n(12),n(7),n(1),n(467),n(464),n(1306)],void 0!==(a=function(t,e,n,r,a,i){"use strict";function o(n,o,s,l,u){function c(t){return e.map(t.results.metricFindQuery.tables[0].rows,function(t){return{text:t[0],value:t[1]}})}this.type="cloudwatch",this.name=n.name,this.supportMetrics=!0,this.proxyUrl=n.url,this.defaultRegion=n.jsonData.defaultRegion,this.instanceSettings=n,this.standardStatistics=["Average","Maximum","Minimum","Sum","SampleCount"];var p=this;this.query=function(n){n=t.copy(n),n.targets=this.expandTemplateVariable(n.targets,n.scopedVars,l);var r=e.filter(n.targets,function(t){return!(!0===t.hide||!t.region||!t.namespace||!t.metricName||e.isEmpty(t.statistics))}).map(function(t){return t.region=l.replace(t.region,n.scopedVars),t.namespace=l.replace(t.namespace,n.scopedVars),t.metricName=l.replace(t.metricName,n.scopedVars),t.dimensions=p.convertDimensionFormat(t.dimensions,n.scopeVars),t.period=String(p.getPeriod(t,n)),e.extend({refId:t.refId,intervalMs:n.intervalMs,maxDataPoints:n.maxDataPoints,datasourceId:p.instanceSettings.id,type:"timeSeriesQuery"},t)});if(e.isEmpty(r)){var a=o.defer();return a.resolve({data:[]}),a.promise}var i={from:n.range.from.valueOf().toString(),to:n.range.to.valueOf().toString(),queries:r};return this.performTimeSeriesQuery(i)},this.getPeriod=function(t,e,n){var r=this.convertToCloudWatchTime(e.range.from,!1),i=this.convertToCloudWatchTime(e.range.to,!0);n=Math.round((n||Date.now())/1e3);var o,s=i-r,u=60;return t.period?o=/^\d+$/.test(t.period)?parseInt(t.period,10):a.interval_to_seconds(l.replace(t.period,e.scopedVars)):u=o=n-r<=1296e3?"AWS/EC2"===t.namespace?300:60:n-r<=5443200?300:3600,o<1&&(o=1),s/o>=1440&&(o=Math.ceil(s/1440/u)*u),o},this.performTimeSeriesQuery=function(t){return s.post("/api/tsdb/query",t).then(function(t){var n=[];return t.results&&e.forEach(t.results,function(t){e.forEach(t.series,function(t){n.push({target:t.name,datapoints:t.points})})}),{data:n}})},this.doMetricQueryRequest=function(t,n){var r=u.timeRange();return s.post("/api/tsdb/query",{from:r.from.valueOf().toString(),to:r.to.valueOf().toString(),queries:[e.extend({refId:"metricFindQuery",intervalMs:1,maxDataPoints:1,datasourceId:this.instanceSettings.id,type:"metricFindQuery",subtype:t},n)]}).then(function(t){return c(t)})},this.getRegions=function(){return this.doMetricQueryRequest("regions",null)},this.getNamespaces=function(){return this.doMetricQueryRequest("namespaces",null)},this.getMetrics=function(t,e){return this.doMetricQueryRequest("metrics",{region:l.replace(e),namespace:l.replace(t)})},this.getDimensionKeys=function(t,e){return this.doMetricQueryRequest("dimension_keys",{region:l.replace(e),namespace:l.replace(t)})},this.getDimensionValues=function(t,e,n,r,a){return this.doMetricQueryRequest("dimension_values",{region:l.replace(t),namespace:l.replace(e),metricName:l.replace(n),dimensionKey:l.replace(r),dimensions:this.convertDimensionFormat(a,{})})},this.getEbsVolumeIds=function(t,e){return this.doMetricQueryRequest("ebs_volume_ids",{region:l.replace(t),instanceId:l.replace(e)})},this.getEc2InstanceAttribute=function(t,e,n){return this.doMetricQueryRequest("ec2_instance_attribute",{region:l.replace(t),attributeName:l.replace(e),filters:n})},this.metricFindQuery=function(t){var e,n,r;if(t.match(/^regions\(\)/))return this.getRegions();if(t.match(/^namespaces\(\)/))return this.getNamespaces();var a=t.match(/^metrics\(([^\)]+?)(,\s?([^,]+?))?\)/);if(a)return n=a[1],e=a[3],this.getMetrics(n,e);var i=t.match(/^dimension_keys\(([^\)]+?)(,\s?([^,]+?))?\)/);if(i)return n=i[1],e=i[3],this.getDimensionKeys(n,e);var s=t.match(/^dimension_values\(([^,]+?),\s?([^,]+?),\s?([^,]+?),\s?([^,]+?)\)/);if(s){e=s[1],n=s[2],r=s[3];var u=s[4];return this.getDimensionValues(e,n,r,u,{})}var c=t.match(/^ebs_volume_ids\(([^,]+?),\s?([^,]+?)\)/);if(c){e=c[1];var p=c[2];return this.getEbsVolumeIds(e,p)}var h=t.match(/^ec2_instance_attribute\(([^,]+?),\s?([^,]+?),\s?(.+?)\)/);if(h){e=h[1];var d=h[2],f=JSON.parse(l.replace(h[3]));return this.getEc2InstanceAttribute(e,d,f)}return o.when([])},this.annotationQuery=function(t){var n=t.annotation,r=e.map(n.statistics,function(t){return l.replace(t)}),a=n.prefixMatching?"":"300",i=n.period||a;i=parseInt(i,10);var o={prefixMatching:n.prefixMatching,region:l.replace(n.region),namespace:l.replace(n.namespace),metricName:l.replace(n.metricName),dimensions:this.convertDimensionFormat(n.dimensions,{}),statistics:r,period:i,actionPrefix:n.actionPrefix||"",alarmNamePrefix:n.alarmNamePrefix||""};return s.post("/api/tsdb/query",{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[e.extend({refId:"annotationQuery",intervalMs:1,maxDataPoints:1,datasourceId:this.instanceSettings.id,type:"annotationQuery"},o)]}).then(function(t){return e.map(t.results.annotationQuery.tables[0].rows,function(t){return{annotation:n,time:Date.parse(t[0]),title:t[1],tags:[t[2]],text:t[3]}})})},this.targetContainsTemplate=function(t){return l.variableExists(t.region)||l.variableExists(t.namespace)||l.variableExists(t.metricName)||e.find(t.dimensions,function(t,e){return l.variableExists(e)||l.variableExists(t)})},this.testDatasource=function(){var t=this.defaultRegion,e={};return this.getDimensionValues(t,"AWS/Billing","EstimatedCharges","ServiceName",e).then(function(){return{status:"success",message:"Data source is working"}},function(t){return{status:"error",message:t.message}})},this.awsRequest=function(t){var e={method:"POST",url:this.proxyUrl,data:t};return s.datasourceRequest(e).then(function(t){return t.data})},this.getDefaultRegion=function(){return this.defaultRegion},this.getExpandedVariables=function(n,r,a,i){var o=e.find(a.options,{selected:!0,text:"All"});return e.chain(a.options).filter(function(t){return o?"All"!==t.text:t.selected}).map(function(e){var o=t.copy(n),s={};return s[a.name]=e,o.refId=n.refId+"_"+e.value,o.dimensions[r]=i.replace(o.dimensions[r],s),o}).value()},this.expandTemplateVariable=function(t,n,r){var a=this;return e.chain(t).map(function(t){var o=e.findKey(t.dimensions,function(t){return r.variableExists(t)&&!e.has(n,r.getVariableName(t))});if(o){var s=e.find(r.variables,function(e){return i.containsVariable(t.dimensions[o],e.name)&&e.multi}),l=e.find(r.variables,function(e){return i.containsVariable(t.dimensions[o],e.name)});return a.getExpandedVariables(t,o,s||l,r)}return[t]}).flatten().value()},this.convertToCloudWatchTime=function(t,n){return e.isString(t)&&(t=r.parse(t,n)),Math.round(t.valueOf()/1e3)},this.convertDimensionFormat=function(t,n){var r={};return e.each(t,function(t,e){r[l.replace(e,n)]=l.replace(t,n)}),r}}return o.$inject=["instanceSettings","$q","backendSrv","templateSrv","timeSrv"],a=a.default,o}.apply(e,r))&&(t.exports=a)},1443:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(1330),a=(n.n(r),n(1305)),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.aliasSyntax="{{metric}} {{stat}} {{namespace}} {{region}} {{<dimension name>}}",r}return i(e,t),e.$inject=["$scope","$injector"],e.templateUrl="partials/query.editor.html",e}(a.QueryCtrl)},1444:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t){this.accessKeyExist=!1,this.secretKeyExist=!1,this.authTypes=[{name:"Access & secret key",value:"keys"},{name:"Credentials file",value:"credentials"},{name:"ARN",value:"arn"}],this.indexPatternTypes=[{name:"No pattern",value:void 0},{name:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{name:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{name:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{name:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{name:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],this.current.jsonData.timeField=this.current.jsonData.timeField||"@timestamp",this.current.jsonData.authType=this.current.jsonData.authType||"credentials",this.accessKeyExist=this.current.secureJsonFields.accessKey,this.secretKeyExist=this.current.secureJsonFields.secretKey}return t.$inject=["$scope"],t.prototype.resetAccessKey=function(){this.accessKeyExist=!1},t.prototype.resetSecretKey=function(){this.secretKeyExist=!1},t.templateUrl="partials/config.html",t}()},1445:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryOptionsCtrl",function(){return o}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(1446),a=n(1450),i=n(1453);n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return a.a}),n.d(e,"ConfigCtrl",function(){return i.a});var o=function(){function t(){}return t.templateUrl="partials/query.options.html",t}(),s=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},1446:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=n(1),l=n.n(s),u=n(1447),c=n(1448),p=n(1449),h=function(){function t(t,e,n,r,a){this.$q=e,this.backendSrv=n,this.templateSrv=r,this.timeSrv=a,this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials,this.url=t.url,this.name=t.name,this.index=t.index,this.timeField=t.jsonData.timeField,this.esVersion=t.jsonData.esVersion,this.indexPattern=new c.a(t.index,t.jsonData.interval),this.interval=t.jsonData.timeInterval,this.queryBuilder=new u.a({timeField:this.timeField,esVersion:this.esVersion})}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv","timeSrv"],t.prototype.request=function(t,e,n){var r={url:this.url+"/"+e,method:t,data:n};return(this.basicAuth||this.withCredentials)&&(r.withCredentials=!0),this.basicAuth&&(r.headers={Authorization:this.basicAuth}),this.backendSrv.datasourceRequest(r)},t.prototype.get=function(t){var e=this.timeSrv.timeRange(),n=this.indexPattern.getIndexList(e.from.valueOf(),e.to.valueOf());return o.a.isArray(n)&&n.length?this.request("GET",n[0]+t).then(function(t){return t.data.$$config=t.config,t.data}):this.request("GET",this.indexPattern.getIndexForToday()+t).then(function(t){return t.data.$$config=t.config,t.data})},t.prototype.post=function(t,e){return this.request("POST",t,e).then(function(t){return t.data.$$config=t.config,t.data}).catch(function(t){if(t.data&&t.data.error)throw{message:"Elasticsearch error: "+t.data.error.reason,error:t.data.error};throw t})},t.prototype.annotationQuery=function(t){var e=t.annotation,n=e.timeField||"@timestamp",r=e.query||"*",i=e.tagsField||"tags",s=e.textField||null,u={};u[n]={from:t.range.from.valueOf(),to:t.range.to.valueOf(),format:"epoch_millis"};var c=this.templateSrv.replace(r,{},"lucene"),p={bool:{filter:[{range:u},{query_string:{query:c}}]}},h={query:p,size:1e4};this.esVersion<5&&(h.fields=[n,"_source"]);var d={search_type:"query_then_fetch",ignore_unavailable:!0};e.index?d.index=e.index:d.index=this.indexPattern.getIndexList(t.range.from,t.range.to);var f=a.a.toJson(d)+"\n"+a.a.toJson(h)+"\n";return this.post("_msearch",f).then(function(t){for(var r=[],a=t.responses[0].hits.hits,u=function(t,e){if(e){for(var n=e.split("."),r=t,a=0;a<n.length;a++)if(!(r=r[n[a]]))return console.log("could not find field in annotation: ",e),"";return r}},c=0;c<a.length;c++){var p=a[c]._source,h=p[n];if(void 0!==a[c].fields){var d=a[c].fields;(o.a.isString(d[n])||o.a.isNumber(d[n]))&&(h=d[n])}var f={annotation:e,time:l.a.utc(h).valueOf(),text:u(p,s),tags:u(p,i)};if(e.titleField){var m=u(p,e.titleField);m&&(f.text=m+"\n"+f.text)}"string"==typeof f.tags&&(f.tags=f.tags.split(",")),r.push(f)}return r})},t.prototype.testDatasource=function(){return this.timeSrv.setTime({from:"now-1m",to:"now"},!0),this.getFields({type:"date"}).then(function(t){return o.a.find(t,{text:this.timeField})?{status:"success",message:"Index OK. Time field name OK."}:{status:"error",message:"No date field named "+this.timeField+" found"}}.bind(this),function(t){if(console.log(t),t.data&&t.data.error){var e=a.a.toJson(t.data.error);return t.data.error.reason&&(e=t.data.error.reason),{status:"error",message:e}}return{status:"error",message:t.status}})},t.prototype.getQueryHeader=function(t,e,n){return a.a.toJson({search_type:t,ignore_unavailable:!0,index:this.indexPattern.getIndexList(e,n)})},t.prototype.query=function(t){for(var e,n="",r=[],i=this.templateSrv.getAdhocFilters(this.name),o=0;o<t.targets.length;o++)if(e=t.targets[o],!e.hide){var s=this.templateSrv.replace(e.query||"*",t.scopedVars,"lucene"),l=this.queryBuilder.build(e,i,s),u=a.a.toJson(l),c=0===l.size&&this.esVersion<5?"count":"query_then_fetch",h=this.getQueryHeader(c,t.range.from,t.range.to);n+=h+"\n",n+=u+"\n",r.push(e)}return 0===r.length?this.$q.when([]):(n=n.replace(/\$timeFrom/g,t.range.from.valueOf()),n=n.replace(/\$timeTo/g,t.range.to.valueOf()),n=this.templateSrv.replace(n,t.scopedVars),this.post("_msearch",n).then(function(t){return new p.a(r,t).getTimeSeries()}))},t.prototype.getFields=function(t){return this.get("/_mapping").then(function(e){function n(t,e,n){return"_"!==e[0]&&(!n.type||(n.type===t.type||n.type===a[t.type]))}function r(e){for(var a in e){var l=e[a];if(o.a.isObject(l.properties)&&(i.push(a),r(l.properties)),o.a.isObject(l.fields)&&(i.push(a),r(l.fields)),o.a.isString(l.type)){var u=i.concat(a).join(".");n(l,a,t)&&(s[u]={text:u,type:l.type})}}i.pop()}var a={float:"number",double:"number",integer:"number",long:"number",date:"date",string:"string",text:"string",scaled_float:"number",nested:"nested"},i=[],s={};for(var l in e){var u=e[l];if(u&&u.mappings){var c=u.mappings;for(var p in c){r(c[p].properties)}}}return o.a.map(s,function(t){return t})})},t.prototype.getTerms=function(t){var e=this.timeSrv.timeRange(),n=this.esVersion>=5?"query_then_fetch":"count",r=this.getQueryHeader(n,e.from,e.to),i=a.a.toJson(this.queryBuilder.getTermsQuery(t));return i=i.replace(/\$timeFrom/g,e.from.valueOf()),i=i.replace(/\$timeTo/g,e.to.valueOf()),i=r+"\n"+i+"\n",this.post("_msearch?search_type="+n,i).then(function(t){if(!t.responses[0].aggregations)return[];var e=t.responses[0].aggregations[1].buckets;return o.a.map(e,function(t){return{text:t.key_as_string||t.key,value:t.key}})})},t.prototype.metricFindQuery=function(t){return t=a.a.fromJson(t),t?"fields"===t.find?(t.field=this.templateSrv.replace(t.field,{},"lucene"),this.getFields(t)):"terms"===t.find?(t.query=this.templateSrv.replace(t.query||"*",{},"lucene"),this.getTerms(t)):void 0:this.$q.when([])},t.prototype.getTagKeys=function(){return this.getFields({})},t.prototype.getTagValues=function(t){return this.getTerms({field:t.key,query:"*"})},t}()},1447:function(t,e,n){"use strict";n.d(e,"a",function(){return a});var r=n(1311),a=function(){function t(t){this.timeField=t.timeField,this.esVersion=t.esVersion}return t.prototype.getRangeFilter=function(){var t={};return t[this.timeField]={gte:"$timeFrom",lte:"$timeTo",format:"epoch_millis"},t},t.prototype.buildTermsAgg=function(t,e,n){var r,a,i;if(e.terms={field:t.field},!t.settings)return e;if(e.terms.size=0===parseInt(t.settings.size,10)?500:parseInt(t.settings.size,10),void 0!==t.settings.orderBy&&(e.terms.order={},e.terms.order[t.settings.orderBy]=t.settings.order,r=parseInt(t.settings.orderBy,10),!isNaN(r)))for(i=0;i<n.metrics.length;i++)if(a=n.metrics[i],a.id===t.settings.orderBy){e.aggs={},e.aggs[a.id]={},e.aggs[a.id][a.type]={field:a.field};break}return void 0!==t.settings.min_doc_count&&(e.terms.min_doc_count=parseInt(t.settings.min_doc_count,10)),t.settings.missing&&(e.terms.missing=t.settings.missing),e},t.prototype.getDateHistogramAgg=function(t){var e={},n=t.settings||{};return e.interval=n.interval,e.field=this.timeField,e.min_doc_count=n.min_doc_count||0,e.extended_bounds={min:"$timeFrom",max:"$timeTo"},e.format="epoch_millis","auto"===e.interval&&(e.interval="$__interval"),n.missing&&(e.missing=n.missing),e},t.prototype.getHistogramAgg=function(t){var e={},n=t.settings||{};return e.interval=n.interval,e.field=t.field,e.min_doc_count=n.min_doc_count||0,n.missing&&(e.missing=n.missing),e},t.prototype.getFiltersAgg=function(t){for(var e={},n=0;n<t.settings.filters.length;n++){var r=t.settings.filters[n].query,a=t.settings.filters[n].label;a=""===a||void 0===a?r:a,e[a]={query_string:{query:r,analyze_wildcard:!0}}}return e},t.prototype.documentQuery=function(t,e){return t.size=e,t.sort={},t.sort[this.timeField]={order:"desc",unmapped_type:"boolean"},this.esVersion<5&&(t.fields=["*","_source"]),t.script_fields={},this.esVersion<5?t.fielddata_fields=[this.timeField]:t.docvalue_fields=[this.timeField],t},t.prototype.addAdhocFilters=function(t,e){if(e){var n,r,a,i;for(n=0;n<e.length;n++)switch(r=e[n],a={},a[r.key]=r.value,i={},i[r.key]={query:r.value},r.operator){case"=":t.query.bool.must||(t.query.bool.must=[]),t.query.bool.must.push({match_phrase:i});break;case"!=":t.query.bool.must_not||(t.query.bool.must_not=[]),t.query.bool.must_not.push({match_phrase:i});break;case"<":a[r.key]={lt:r.value},t.query.bool.filter.push({range:a});break;case">":a[r.key]={gt:r.value},t.query.bool.filter.push({range:a});break;case"=~":t.query.bool.filter.push({regexp:a});break;case"!~":t.query.bool.filter.push({bool:{must_not:{regexp:a}}})}}},t.prototype.build=function(t,e,n){t.metrics=t.metrics||[{type:"count",id:"1"}],t.dsType="elasticsearch",t.bucketAggs=t.bucketAggs||[{type:"date_histogram",id:"2",settings:{interval:"auto"}}],t.timeField=this.timeField;var a,i,o,s={size:0,query:{bool:{filter:[{range:this.getRangeFilter()},{query_string:{analyze_wildcard:!0,query:n}}]}}};if(this.addAdhocFilters(s,e),0===t.bucketAggs.length){if(!(o=t.metrics[0])||"raw_document"!==o.type)throw{message:"Invalid query"};var l=o.settings&&o.settings.size||500;return this.documentQuery(s,l)}for(i=s,a=0;a<t.bucketAggs.length;a++){var u=t.bucketAggs[a],c={};switch(u.type){case"date_histogram":c.date_histogram=this.getDateHistogramAgg(u);break;case"histogram":c.histogram=this.getHistogramAgg(u);break;case"filters":c.filters={filters:this.getFiltersAgg(u)};break;case"terms":this.buildTermsAgg(u,c,t);break;case"geohash_grid":c.geohash_grid={field:u.field,precision:u.settings.precision}}i.aggs=i.aggs||{},i.aggs[u.id]=c,i=c}for(i.aggs={},a=0;a<t.metrics.length;a++)if(o=t.metrics[a],"count"!==o.type){var p={},h=null;if(r.isPipelineAgg(o.type)){if(!o.pipelineAgg||!/^\d*$/.test(o.pipelineAgg))continue;h={buckets_path:o.pipelineAgg}}else h={field:o.field};for(var d in o.settings)o.settings.hasOwnProperty(d)&&null!==o.settings[d]&&(h[d]=o.settings[d]);p[o.type]=h,i.aggs[o.id]=p}return s},t.prototype.getTermsQuery=function(t){var e={size:0,query:{bool:{filter:[{range:this.getRangeFilter()}]}}};t.query&&e.query.bool.filter.push({query_string:{analyze_wildcard:!0,query:t.query}});var n=500;return t.size&&(n=t.size),e.aggs={1:{terms:{field:t.field,size:n,order:{_term:"asc"}}}},e},t}()},1448:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(1),a=n.n(r),i={Hourly:{startOf:"hour",amount:"hours"},Daily:{startOf:"day",amount:"days"},Weekly:{startOf:"isoWeek",amount:"weeks"},Monthly:{startOf:"month",amount:"months"},Yearly:{startOf:"year",amount:"years"}},o=function(){function t(t,e){this.pattern=t,this.interval=e}return t.prototype.getIndexForToday=function(){return this.interval?a.a.utc().format(this.pattern):this.pattern},t.prototype.getIndexList=function(t,e){if(!this.interval)return this.pattern;for(var n=i[this.interval],r=a()(t).utc().startOf(n.startOf),o=a()(e).utc().startOf(n.startOf).valueOf(),s=[];r.valueOf()<=o;)s.push(r.format(this.pattern)),r.add(1,n.amount);return s},t}()},1449:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(7),a=n.n(r),i=n(1311),o=n(1310),s=function(){function t(t,e){this.targets=t,this.response=e,this.targets=t,this.response=e}return t.prototype.processMetrics=function(t,e,n,r){var a,i,o,s,l,u;for(i=0;i<e.metrics.length;i++)if(a=e.metrics[i],!a.hide)switch(a.type){case"count":for(s={datapoints:[],metric:"count",props:r},o=0;o<t.buckets.length;o++)l=t.buckets[o],u=l.doc_count,s.datapoints.push([u,l.key]);n.push(s);break;case"percentiles":if(0===t.buckets.length)break;var c=t.buckets[0],p=c[a.id].values;for(var h in p){for(s={datapoints:[],metric:"p"+h,props:r,field:a.field},o=0;o<t.buckets.length;o++){l=t.buckets[o];var d=l[a.id].values;s.datapoints.push([d[h],l.key])}n.push(s)}break;case"extended_stats":for(var f in a.meta)if(a.meta[f]){for(s={datapoints:[],metric:f,props:r,field:a.field},o=0;o<t.buckets.length;o++){l=t.buckets[o];var m=l[a.id];m.std_deviation_bounds_upper=m.std_deviation_bounds.upper,m.std_deviation_bounds_lower=m.std_deviation_bounds.lower,s.datapoints.push([m[f],l.key])}n.push(s)}break;default:for(s={datapoints:[],metric:a.type,field:a.field,props:r},o=0;o<t.buckets.length;o++)l=t.buckets[o],void 0!==(u=l[a.id])&&(u.normalized_value?s.datapoints.push([u.normalized_value,l.key]):s.datapoints.push([u.value,l.key]));n.push(s)}},t.prototype.processAggregationDocs=function(t,e,n,r,i){if(0===r.columns.length){for(var o=0,s=a.a.keys(i);o<s.length;o++){var l=s[o];r.addColumn({text:l,filterable:!0})}r.addColumn({text:e.field,filterable:!0})}for(var u=function(t,e,n){r.addColumn({text:e}),t.push(n)},c=0,p=t.buckets;c<p.length;c++){for(var h=p[c],d=[],f=0,m=a.a.values(i);f<m.length;f++){var g=m[f];d.push(g)}d.push(h.key);for(var v=0,y=n.metrics;v<y.length;v++){var b=y[v];switch(b.type){case"count":u(d,this.getMetricName(b.type),h.doc_count);break;case"extended_stats":for(var x in b.meta)if(b.meta[x]){var S=h[b.id];S.std_deviation_bounds_upper=S.std_deviation_bounds.upper,S.std_deviation_bounds_lower=S.std_deviation_bounds.lower,u(d,this.getMetricName(x),S[x])}break;default:var w=this.getMetricName(b.type);a.a.filter(n.metrics,{type:b.type}).length>1&&(w+=" "+b.field),u(d,w,h[b.id].value)}}r.rows.push(d)}},t.prototype.processBuckets=function(t,e,n,r,i,o){var s,l,u,c,p=e.bucketAggs.length-1;for(c in t)if(l=a.a.find(e.bucketAggs,{id:c}),u=t[c],l)if(o===p)"date_histogram"===l.type?this.processMetrics(u,e,n,i):this.processAggregationDocs(u,l,e,r,i);else for(var h in u.buckets)s=u.buckets[h],i=a.a.clone(i),void 0!==s.key?i[l.field]=s.key:i.filter=h,s.key_as_string&&(i[l.field]=s.key_as_string),this.processBuckets(s,e,n,r,i,o+1)},t.prototype.getMetricName=function(t){var e=a.a.find(i.metricAggTypes,{value:t});return e||(e=a.a.find(i.extendedStats,{value:t})),e?e.text:t},t.prototype.getSeriesName=function(t,e,n){var r=this.getMetricName(t.metric);if(e.alias){var o=/\{\{([\s\S]+?)\}\}/g;return e.alias.replace(o,function(e,n,a){var i=n||a;return 0===i.indexOf("term ")?t.props[i.substring(5)]:void 0!==t.props[i]?t.props[i]:"metric"===i?r:"field"===i?t.field:e})}if(t.field&&i.isPipelineAgg(t.metric)){var s=a.a.find(e.metrics,{id:t.field});s?r+=" "+i.describeMetric(s):r="Unset"}else t.field&&(r+=" "+t.field);if(0===a.a.keys(t.props).length)return r;var l="";for(var u in t.props)l+=t.props[u]+" ";return 1===n?l.trim():l.trim()+" "+r},t.prototype.nameSeries=function(t,e){for(var n=a.a.uniq(a.a.map(t,"metric")).length,r=0;r<t.length;r++){var i=t[r];i.target=this.getSeriesName(i,e,n)}},t.prototype.processHits=function(t,e){var n,r,a,i,o={target:"docs",type:"docs",datapoints:[],total:t.total,filterable:!0};for(i=0;i<t.hits.length;i++){if(r=t.hits[i],a={_id:r._id,_type:r._type,_index:r._index},r._source)for(n in r._source)a[n]=r._source[n];for(n in r.fields)a[n]=r.fields[n];o.datapoints.push(a)}e.push(o)},t.prototype.trimDatapoints=function(t,e){var n=a.a.find(e.bucketAggs,{type:"date_histogram"});if(n&&n.settings&&n.settings.trimEdges){var r=n.settings.trimEdges;for(var i in t){var o=t[i];o.datapoints.length>2*r&&(o.datapoints=o.datapoints.slice(r,o.datapoints.length-r))}}},t.prototype.getErrorFromElasticResponse=function(t,e){var n={};return n.data=JSON.stringify(e,null,4),e.root_cause&&e.root_cause.length>0&&e.root_cause[0].reason?n.message=e.root_cause[0].reason:n.message=e.reason||"Unkown elatic error response",t.$$config&&(n.config=t.$$config),n},t.prototype.getTimeSeries=function(){for(var t=[],e=0;e<this.response.responses.length;e++){var n=this.response.responses[e];if(n.error)throw this.getErrorFromElasticResponse(this.response,n.error);if(n.hits&&n.hits.hits.length>0&&this.processHits(n.hits,t),n.aggregations){var r=n.aggregations,a=this.targets[e],i=[],s=new o.default;this.processBuckets(r,a,i,s,{},0),this.trimDatapoints(i,a),this.nameSeries(i,a);for(var l=0;l<i.length;l++)t.push(i[l]);s.rows.length>0&&t.push(s)}}return{data:t}},t}()},1450:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(1451),a=(n.n(r),n(1452)),i=(n.n(a),n(12)),o=n.n(i),s=n(7),l=n.n(s),u=n(1311),c=n(1305),p=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(t){function e(e,n,r,a){var i=t.call(this,e,n)||this;return i.$rootScope=r,i.uiSegmentSrv=a,i.esVersion=i.datasource.esVersion,i.queryUpdated(),i}return p(e,t),e.$inject=["$scope","$injector","$rootScope","uiSegmentSrv"],e.prototype.getFields=function(t){var e=o.a.toJson({find:"fields",type:t});return this.datasource.metricFindQuery(e).then(this.uiSegmentSrv.transformToSegments(!1)).catch(this.handleQueryError.bind(this))},e.prototype.queryUpdated=function(){var t=o.a.toJson(this.datasource.queryBuilder.build(this.target),!0);this.rawQueryOld&&t!==this.rawQueryOld&&this.refresh(),this.rawQueryOld=t,this.$rootScope.appEvent("elastic-query-updated")},e.prototype.getCollapsedText=function(){var t=this.target.metrics,e=this.target.bucketAggs,n=u.getMetricAggTypes(this.esVersion),r=u.bucketAggTypes,a="";return this.target.query&&(a+="Query: "+this.target.query+", "),a+="Metrics: ",l.a.each(t,function(t,e){var r=l.a.find(n,{value:t.type});a+=r.text+"(",r.requiresField&&(a+=t.field),a+="), "}),l.a.each(e,function(t,e){0===e&&(a+=" Group by: ");var n=l.a.find(r,{value:t.type});a+=n.text+"(",n.requiresField&&(a+=t.field),a+="), "}),this.target.alias&&(a+="Alias: "+this.target.alias),a},e.prototype.handleQueryError=function(t){return this.error=t.message||"Failed to issue metric query",[]},e.templateUrl="partials/query.editor.html",e}(c.QueryCtrl)},1451:function(t,e,n){(function(t){var r,a;r=[n(12),n(7),n(1311)],void 0!==(a=function(t,e,n){"use strict";var r=t.module("grafana.directives");r.directive("elasticBucketAgg",function(){return{templateUrl:"public/app/plugins/datasource/elasticsearch/partials/bucket_agg.html",controller:"ElasticBucketAggCtrl",restrict:"E",scope:{target:"=",index:"=",onChange:"&",getFields:"&"}}}),r.controller("ElasticBucketAggCtrl",["$scope","uiSegmentSrv","$q","$rootScope",function(t,r,a,i){var o=t.target.bucketAggs;t.orderByOptions=[],t.getBucketAggTypes=function(){return n.bucketAggTypes},t.getOrderOptions=function(){return n.orderOptions},t.getSizeOptions=function(){return n.sizeOptions},i.onAppEvent("elastic-query-updated",function(){t.validateModel()},t),t.init=function(){t.agg=o[t.index],t.validateModel()},t.onChangeInternal=function(){t.onChange()},t.onTypeChanged=function(){switch(t.agg.settings={},t.showOptions=!1,t.agg.type){case"date_histogram":case"histogram":case"terms":delete t.agg.query,t.agg.field="select field";break;case"filters":delete t.agg.field,t.agg.query="*";break;case"geohash_grid":t.agg.settings.precision=3}t.validateModel(),t.onChange()},t.validateModel=function(){t.index=e.indexOf(o,t.agg),t.isFirst=0===t.index,t.bucketAggCount=o.length;var r="",a=t.agg.settings||{};switch(t.agg.type){case"terms":a.order=a.order||"desc",a.size=a.size||"10",a.min_doc_count=a.min_doc_count||1,a.orderBy=a.orderBy||"_term","0"!==a.size&&(r=n.describeOrder(a.order)+" "+a.size+", "),a.min_doc_count>0&&(r+="Min Doc Count: "+a.min_doc_count+", "),r+="Order by: "+n.describeOrderBy(a.orderBy,t.target),"0"===a.size&&(r+=" ("+a.order+")");break;case"filters":a.filters=a.filters||[{query:"*"}],r=e.reduce(a.filters,function(t,e,n){return t+="Q"+(n+1)+"  = "+e.query+" "},""),r.length>50&&(r=r.substr(0,50)+"..."),r="Filter Queries ("+a.filters.length+")";break;case"date_histogram":a.interval=a.interval||"auto",a.min_doc_count=a.min_doc_count||0,t.agg.field=t.target.timeField,r="Interval: "+a.interval,a.min_doc_count>0&&(r+=", Min Doc Count: "+a.min_doc_count),(void 0===a.trimEdges||a.trimEdges<0)&&(a.trimEdges=0),a.trimEdges&&a.trimEdges>0&&(r+=", Trim edges: "+a.trimEdges);break;case"histogram":a.interval=a.interval||1e3,a.min_doc_count=e.defaultTo(a.min_doc_count,1),r="Interval: "+a.interval,a.min_doc_count>0&&(r+=", Min Doc Count: "+a.min_doc_count);break;case"geohash_grid":a.precision=Math.max(Math.min(a.precision,7),1),r="Precision: "+a.precision}return t.settingsLinkText=r,t.agg.settings=a,!0},t.addFiltersQuery=function(){t.agg.settings.filters.push({query:"*"})},t.removeFiltersQuery=function(n){t.agg.settings.filters=e.without(t.agg.settings.filters,n)},t.toggleOptions=function(){t.showOptions=!t.showOptions},t.getOrderByOptions=function(){return n.getOrderByOptions(t.target)},t.getFieldsInternal=function(){return"date_histogram"===t.agg.type?t.getFields({$fieldType:"date"}):t.getFields()},t.getIntervalOptions=function(){return a.when(r.transformToSegments(!0,"interval")(n.intervalOptions))},t.addBucketAgg=function(){var n=o[o.length-1],r=o.length-1;n&&n.type;var a=e.reduce(t.target.bucketAggs.concat(t.target.metrics),function(t,e){return parseInt(e.id)>t?parseInt(e.id):t},0);o.splice(r,0,{type:"terms",field:"select field",id:(a+1).toString(),fake:!0}),t.onChange()},t.removeBucketAgg=function(){o.splice(t.index,1),t.onChange()},t.init()}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1452:function(t,e,n){(function(t){var r,a;r=[n(12),n(7),n(1311)],void 0!==(a=function(t,e,n){"use strict";var r=t.module("grafana.directives");r.directive("elasticMetricAgg",function(){return{templateUrl:"public/app/plugins/datasource/elasticsearch/partials/metric_agg.html",controller:"ElasticMetricAggCtrl",restrict:"E",scope:{target:"=",index:"=",onChange:"&",getFields:"&",esVersion:"="}}}),r.controller("ElasticMetricAggCtrl",["$scope","uiSegmentSrv","$q","$rootScope",function(t,r,a,i){var o=t.target.metrics;t.metricAggTypes=n.getMetricAggTypes(t.esVersion),t.extendedStats=n.extendedStats,t.pipelineAggOptions=[],t.modelSettingsValues={},t.init=function(){t.agg=o[t.index],t.validateModel(),t.updatePipelineAggOptions()},t.updatePipelineAggOptions=function(){t.pipelineAggOptions=n.getPipelineAggOptions(t.target)},i.onAppEvent("elastic-query-updated",function(){t.index=e.indexOf(o,t.agg),t.updatePipelineAggOptions(),t.validateModel()},t),t.validateModel=function(){if(t.isFirst=0===t.index,t.isSingle=1===o.length,t.settingsLinkText="",t.aggDef=e.find(t.metricAggTypes,{value:t.agg.type}),n.isPipelineAgg(t.agg.type)){t.agg.pipelineAgg=t.agg.pipelineAgg||"select metric",t.agg.field=t.agg.pipelineAgg;var r=n.getPipelineOptions(t.agg);r.length>0&&(e.each(r,function(e){t.agg.settings[e.text]=t.agg.settings[e.text]||e.default}),t.settingsLinkText="Options")}else t.agg.field||(t.agg.field="select field");switch(t.agg.type){case"cardinality":var a=t.agg.settings.precision_threshold||"";t.settingsLinkText="Precision threshold: "+a;break;case"percentiles":t.agg.settings.percents=t.agg.settings.percents||[25,50,75,95,99],t.settingsLinkText="Values: "+t.agg.settings.percents.join(",");break;case"extended_stats":0===e.keys(t.agg.meta).length&&(t.agg.meta.std_deviation_bounds_lower=!0,t.agg.meta.std_deviation_bounds_upper=!0);var i=e.reduce(t.agg.meta,function(n,r,a){if(r){var i=e.find(t.extendedStats,{value:a});n.push(i.text)}return n},[]);t.settingsLinkText="Stats: "+i.join(", ");break;case"moving_avg":t.movingAvgModelTypes=n.movingAvgModelOptions,t.modelSettings=n.getMovingAvgSettings(t.agg.settings.model,!0),t.updateMovingAvgModelSettings();break;case"raw_document":t.agg.settings.size=t.agg.settings.size||500,t.settingsLinkText="Size: "+t.agg.settings.size,t.target.metrics.splice(0,t.target.metrics.length,t.agg),t.target.bucketAggs=[]}if(t.aggDef.supportsInlineScript){var s=t.agg.inlineScript;s?t.agg.settings.script={inline:s}:delete t.agg.settings.script,""===t.settingsLinkText&&(t.settingsLinkText="Options")}},t.toggleOptions=function(){t.showOptions=!t.showOptions,t.updatePipelineAggOptions()},t.onChangeInternal=function(){t.onChange()},t.updateMovingAvgModelSettings=function(){for(var e=[],r=n.getMovingAvgSettings(t.agg.settings.model,!1),a=0;a<r.length;a++)e.push(r[a].value);for(var i in t.agg.settings.settings)null!==t.agg.settings.settings[i]&&-1!==e.indexOf(i)||delete t.agg.settings.settings[i]},t.onChangeClearInternal=function(){delete t.agg.settings.minimize,t.onChange()},t.onTypeChange=function(){t.agg.settings={},t.agg.meta={},t.showOptions=!1,t.updatePipelineAggOptions(),t.onChange()},t.getFieldsInternal=function(){return"cardinality"===t.agg.type?t.getFields():t.getFields({$fieldType:"number"})},t.addMetricAgg=function(){var n=o.length,r=e.reduce(t.target.bucketAggs.concat(t.target.metrics),function(t,e){return parseInt(e.id)>t?parseInt(e.id):t},0);o.splice(n,0,{type:"count",field:"select field",id:(r+1).toString()}),t.onChange()},t.removeMetricAgg=function(){o.splice(t.index,1),t.onChange()},t.toggleShowMetric=function(){t.agg.hide=!t.agg.hide,t.agg.hide||delete t.agg.hide,t.onChange()},t.init()}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1453:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(7),a=n.n(r),i=function(){function t(t){this.indexPatternTypes=[{name:"No pattern",value:void 0},{name:"Hourly",value:"Hourly",example:"[logstash-]YYYY.MM.DD.HH"},{name:"Daily",value:"Daily",example:"[logstash-]YYYY.MM.DD"},{name:"Weekly",value:"Weekly",example:"[logstash-]GGGG.WW"},{name:"Monthly",value:"Monthly",example:"[logstash-]YYYY.MM"},{name:"Yearly",value:"Yearly",example:"[logstash-]YYYY"}],this.esVersions=[{name:"2.x",value:2},{name:"5.x",value:5}],this.current.jsonData.timeField=this.current.jsonData.timeField||"@timestamp",this.current.jsonData.esVersion=this.current.jsonData.esVersion||5}return t.$inject=["$scope"],t.prototype.indexPatternTypeChanged=function(){var t=a.a.find(this.indexPatternTypes,{value:this.current.jsonData.interval});this.current.database=t.example||"es-index-name"},t.templateUrl="public/app/plugins/datasource/elasticsearch/partials/config.html",t}()},1454:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(1455),a=n.n(r),i=n(1456),o=n(1457);n.d(e,"Datasource",function(){return a.a}),n.d(e,"QueryCtrl",function(){return i.a}),n.d(e,"ConfigCtrl",function(){return o.a});var s=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},1455:function(t,e,n){var r,a;r=[n(12),n(7),n(467),n(1)],void 0!==(a=function(t,e,n){"use strict";function r(r,a,i,o){function s(t,n,r,a,i){var o=l(t,r,n,a),s=[];return e.each(t.dps,function(t,e){2===i?s.push([t,1*e]):s.push([t,1e3*e])}),{target:o,datapoints:s}}function l(t,n,r,a){if(n.alias){var i=e.clone(a.scopedVars||{});return e.each(t.tags,function(t,e){i["tag_"+e]={value:t}}),o.replace(n.alias,i)}var s=t.metric,l=[];return e.isEmpty(t.tags)||e.each(e.toPairs(t.tags),function(t){e.has(r,t[0])&&l.push(t[0]+"="+t[1])}),e.isEmpty(l)||(s+="{"+l.join(", ")+"}"),s}function u(e,n,r){if(!e.metric||e.hide)return null;var a={metric:o.replace(e.metric,n.scopedVars,"pipe"),aggregator:"avg"};if(e.aggregator&&(a.aggregator=o.replace(e.aggregator)),e.shouldComputeRate&&(a.rate=!0,a.rateOptions={counter:!!e.isCounter},e.counterMax&&e.counterMax.length&&(a.rateOptions.counterMax=parseInt(e.counterMax)),e.counterResetValue&&e.counterResetValue.length&&(a.rateOptions.resetValue=parseInt(e.counterResetValue)),r>=2&&(a.rateOptions.dropResets=!(a.rateOptions.counterMax||a.rateOptions.ResetValue&&0!==a.rateOptions.ResetValue))),!e.disableDownsampling){var i=o.replace(e.downsampleInterval||n.interval);i.match(/\.[0-9]+s/)&&(i=1e3*parseFloat(i)+"ms"),a.downsample=i+"-"+e.downsampleAggregator,e.downsampleFillPolicy&&"none"!==e.downsampleFillPolicy&&(a.downsample+="-"+e.downsampleFillPolicy)}if(e.filters&&e.filters.length>0){if(a.filters=t.copy(e.filters),a.filters)for(var s in a.filters)a.filters[s].filter=o.replace(a.filters[s].filter,n.scopedVars,"pipe")}else if(a.tags=t.copy(e.tags),a.tags)for(var l in a.tags)a.tags[l]=o.replace(a.tags[l],n.scopedVars,"pipe");return e.explicitTags&&(a.explicitTags=!0),a}function c(t,n,r){var a,i;return e.map(t,function(t){return 3===r?t.query.index:e.findIndex(n.targets,function(r){return r.filters&&r.filters.length>0?r.metric===t.metric:r.metric===t.metric&&e.every(r.tags,function(r,s){return a=o.replace(r,n.scopedVars,"pipe"),i=a.split("|"),e.includes(i,t.tags[s])||"*"===a})})})}function p(t,e){return"now"===t?null:(t=n.parse(t,e),t.valueOf())}this.type="opentsdb",this.url=r.url,this.name=r.name,this.withCredentials=r.withCredentials,this.basicAuth=r.basicAuth,r.jsonData=r.jsonData||{},this.tsdbVersion=r.jsonData.tsdbVersion||1,this.tsdbResolution=r.jsonData.tsdbResolution||1,this.supportMetrics=!0,this.tagKeys={},this.cnMap={"env.air.beichen":"","env.radar.beichen":"","env.power.beichen":"","env.video.beichen":"",env:"","env.air":"","env.water":"","env.gas":"",public:"",private:"","env.device":"",etc:"",evn:"evn",swm:"swm","swm.flowmeter":"","swm.pressuremeter":"","swm.watermeter":"",site:"",city:"",DT:"",PRESSURE:"",FLOW:"",TOTAL_FLOW_L:"",TOTAL_FLOW_S:"",TEMPERATURE:"",HUMIDITY:"",epa:"",company:"",town:"",dsws:"",ydxh:"",odour:"",police:"",straw:"",SPEED:"",DIRECTION:"",CURRENT:"",POWER:"",SOC:"",VOLTAGE:"",DL:""},this.air=["AQI","PM25","PM10","O3","SO2","NO2","CO","TEMPERATURE","HUMIDITY"],this.water=["PH","DO","COD","FTU","CT","TEMPERATURE","TOTAL_P","NH3_N"],this.gas=["CL2","ETO","HCL","NH3","C6H6","H2S","C7H8","TEMPERATURE","HUMIDITY"],this.query=function(t){var n=p(t.rangeRaw.from,!1),r=p(t.rangeRaw.to,!0),i=[];e.each(t.targets,function(e){e.metric&&i.push(u(e,t,this.tsdbVersion))}.bind(this));var o=e.compact(i);if(e.isEmpty(o)){var l=a.defer();return l.resolve({data:[]}),l.promise}var h={};return e.each(o,function(t){t.filters&&t.filters.length>0?e.each(t.filters,function(t){h[t.tagk]=!0}):e.each(t.tags,function(t,e){h[e]=!0})}),t.targets=e.filter(t.targets,function(t){return!0!==t.hide}),this.performTimeSeriesQuery(o,n,r).then(function(n){var r=c(n.data,t,this.tsdbVersion);return{data:e.map(n.data,function(e,n){return n=r[n],-1===n&&(n=0),this._saveTagKeys(e),s(e,h,t.targets[n],t,this.tsdbResolution)}.bind(this))}}.bind(this))},this.annotationQuery=function(t){var n=p(t.rangeRaw.from,!1),r=p(t.rangeRaw.to,!0),a=[],i=[];a.push({aggregator:"sum",metric:t.annotation.target});var o=e.compact(a);return this.performTimeSeriesQuery(o,n,r).then(function(n){if(n.data[0]){var r=n.data[0].annotations;t.annotation.isGlobal&&(r=n.data[0].globalAnnotations),r&&e.each(r,function(e){var n={text:e.description,time:1e3*Math.floor(e.startTime),annotation:t.annotation};i.push(n)})}return i}.bind(this))},this.targetContainsTemplate=function(t){if(t.filters&&t.filters.length>0)for(var e=0;e<t.filters.length;e++)if(o.variableExists(t.filters[e].filter))return!0;if(t.tags&&Object.keys(t.tags).length>0)for(var n in t.tags)if(o.variableExists(t.tags[n]))return!0;return!1},this.performTimeSeriesQuery=function(t,e,n){var r=!1;2===this.tsdbResolution&&(r=!0);var a={start:e,queries:t,msResolution:r,globalAnnotations:!0};3===this.tsdbVersion&&(a.showQuery=!0),n&&(a.end=n);var o={method:"POST",url:this.url+"/api/query",data:a};return this._addCredentialOptions(o),i.datasourceRequest(o)},this.suggestTagKeys=function(t){return a.when(this.tagKeys[t]||[])},this._saveTagKeys=function(t){var n=Object.keys(t.tags);e.each(t.aggregateTags,function(t){n.push(t)}),this.tagKeys[t.metric]=n},this._performSuggestQuery=function(t,e){return this._get("/api/suggest",{type:e,q:t,max:1e3}).then(function(t){return t.data})},this._performMetricKeyValueLookup=function(t,n){if(!t||!n)return a.when([]);var r=n.split(",").map(function(t){return t.trim()}),i=r[0],o=i+"=*";r.length>1&&(o+=","+r.splice(1).join(","));var s=t+"{"+o+"}";return this._get("/api/search/lookup",{m:s,limit:3e3}).then(function(t){t=t.data.results;var n=[];return e.each(t,function(t){-1===n.indexOf(t.tags[i])&&n.push(t.tags[i])}),n})},this._performMetricKeyLookup=function(t){return t?this._get("/api/search/lookup",{m:t,limit:1e3}).then(function(t){t=t.data.results;var n=[];return e.each(t,function(t){e.each(t.tags,function(t,e){-1===n.indexOf(e)&&n.push(e)})}),n}):a.when([])},this._get=function(t,e){var n={method:"GET",url:this.url+t,params:e};return this._addCredentialOptions(n),i.datasourceRequest(n)},this._addCredentialOptions=function(t){(this.basicAuth||this.withCredentials)&&(t.withCredentials=!0),this.basicAuth&&(t.headers={Authorization:this.basicAuth})},this.metricFindQuery=function(t,n){if(!t)return a.when([]);var r;try{r=o.replace(t,{},"distributed")}catch(t){return a.reject(t)}var i=this,s=function(t){if(m){var r=m[2].split(",").map(function(t){return t.trim()}),a=r[0];if("index"===a&&("env.air"===m[1]?t=i.air:"env.gas"===m[1]?t=i.gas:"env.water"===m[1]&&(t=i.water)),"host"===a&&n){var o={};return e.map(n.variable.cnData,function(t){return o[t.key]=t.name,t}),e.map(t,function(t){return{text:t,cn:o[t]}})}if("source"===a&&n){var o={};return e.map(n.variable.cnData,function(t){return o[t.key]=t.name,t}),e.map(t,function(t){return"env.air.beichen"===m[1]&&"source"==a&&"private"==t?{text:t,cn:""}:"env.power.beichen"===m[1]&&"source"==a&&"company"==t?{text:t,cn:""}:{text:t,cn:i.cnMap[t]}})}}return e.map(t,function(t){return{text:t,cn:i.cnMap[t]}})},l=/metrics\((.*)\)/,u=/tag_names\((.*)\)/,c=/tag_values\((.*?),\s?(.*)\)/,p=/suggest_tagk\((.*)\)/,h=/suggest_tagv\((.*)\)/,d=r.match(l);if(d)return this._performSuggestQuery(d[1],"metrics").then(s);var f=r.match(u);if(f)return this._performMetricKeyLookup(f[1]).then(s);var m=r.match(c);if(console.info(m),m)return this._performMetricKeyValueLookup(m[1],m[2]).then(s);var g=r.match(p);if(g)return this._performSuggestQuery(g[1],"tagk").then(s);var v=r.match(h);return v?this._performSuggestQuery(v[1],"tagv").then(s):a.when([])},this.testDatasource=function(){return this._performSuggestQuery("cpu","metrics").then(function(){return{status:"success",message:"Data source is working"}})};var h=null;this.getAggregators=function(){return h||(h=this._get("/api/aggregators").then(function(t){return t.data&&e.isArray(t.data)?t.data.sort():[]}))};var d=null;this.getFilterTypes=function(){return d||(d=this._get("/api/config/filters").then(function(t){return t.data?Object.keys(t.data).sort():[]}))}}return r.$inject=["instanceSettings","$q","backendSrv","templateSrv"],r}.apply(e,r))&&(t.exports=a)},1456:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(7),a=n.n(r),i=n(464),o=n(1305),s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.errors=r.validateTarget(),r.aggregators=["avg","sum","min","max","dev","zimsum","mimmin","mimmax"],r.fillPolicies=["none","nan","null","zero"],r.filterTypes=["wildcard","iliteral_or","not_iliteral_or","not_literal_or","iwildcard","literal_or","regexp"],r.tsdbVersion=r.datasource.tsdbVersion,r.target.aggregator||(r.target.aggregator="sum"),r.target.downsampleAggregator||(r.target.downsampleAggregator="avg"),r.target.downsampleFillPolicy||(r.target.downsampleFillPolicy="none"),r.datasource.getAggregators().then(function(t){0!==t.length&&(r.aggregators=t)}),r.datasource.getFilterTypes().then(function(t){0!==t.length&&(r.filterTypes=t)}),r.suggestMetrics=function(t,e){r.datasource.metricFindQuery("metrics("+t+")").then(r.getTextValues).then(e)},r.suggestTagKeys=function(t,e){r.datasource.suggestTagKeys(r.target.metric).then(e)},r.suggestTagValues=function(t,e){r.datasource.metricFindQuery("suggest_tagv("+t+")").then(r.getTextValues).then(e)},r}return s(e,t),e.$inject=["$scope","$injector"],e.prototype.targetBlur=function(){this.errors=this.validateTarget(),this.refresh()},e.prototype.getTextValues=function(t){return a.a.map(t,function(t){return t.text})},e.prototype.addTag=function(){if(this.target.filters&&this.target.filters.length>0&&(this.errors.tags="Please remove filters to use tags, tags and filters are mutually exclusive."),!this.addTagMode)return void(this.addTagMode=!0);this.target.tags||(this.target.tags={}),this.errors=this.validateTarget(),this.errors.tags||(this.target.tags[this.target.currentTagKey]=this.target.currentTagValue,this.target.currentTagKey="",this.target.currentTagValue="",this.targetBlur()),this.addTagMode=!1},e.prototype.removeTag=function(t){delete this.target.tags[t],this.targetBlur()},e.prototype.editTag=function(t,e){this.removeTag(t),this.target.currentTagKey=t,this.target.currentTagValue=e,this.addTag()},e.prototype.closeAddTagMode=function(){this.addTagMode=!1},e.prototype.addFilter=function(){if(this.target.tags&&a.a.size(this.target.tags)>0&&(this.errors.filters="Please remove tags to use filters, tags and filters are mutually exclusive."),!this.addFilterMode)return void(this.addFilterMode=!0);if(this.target.filters||(this.target.filters=[]),this.target.currentFilterType||(this.target.currentFilterType="iliteral_or"),this.target.currentFilterGroupBy||(this.target.currentFilterGroupBy=!1),this.errors=this.validateTarget(),!this.errors.filters){var t={type:this.target.currentFilterType,tagk:this.target.currentFilterKey,filter:this.target.currentFilterValue,groupBy:this.target.currentFilterGroupBy};this.target.filters.push(t),this.target.currentFilterType="literal_or",this.target.currentFilterKey="",this.target.currentFilterValue="",this.target.currentFilterGroupBy=!1,this.targetBlur()}this.addFilterMode=!1},e.prototype.removeFilter=function(t){this.target.filters.splice(t,1),this.targetBlur()},e.prototype.editFilter=function(t,e){this.removeFilter(e),this.target.currentFilterKey=t.tagk,this.target.currentFilterValue=t.filter,this.target.currentFilterType=t.type,this.target.currentFilterGroupBy=t.groupBy,this.addFilter()},e.prototype.closeAddFilterMode=function(){this.addFilterMode=!1},e.prototype.validateTarget=function(){var t={};if(this.target.shouldDownsample)try{this.target.downsampleInterval?i.default.describe_interval(this.target.downsampleInterval):t.downsampleInterval="You must supply a downsample interval (e.g. '1m' or '1h')."}catch(e){t.downsampleInterval=e.message}return this.target.tags&&a.a.has(this.target.tags,this.target.currentTagKey)&&(t.tags="Duplicate tag key '"+this.target.currentTagKey+"'."),t},e.templateUrl="partials/query.editor.html",e}(o.QueryCtrl)},1457:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r=function(){function t(t){this.tsdbVersions=[{name:"<=2.1",value:1},{name:"==2.2",value:2},{name:"==2.3",value:3}],this.tsdbResolutions=[{name:"second",value:1},{name:"millisecond",value:2}],this.current.jsonData=this.current.jsonData||{},this.current.jsonData.tsdbVersion=this.current.jsonData.tsdbVersion||1,this.current.jsonData.tsdbResolution=this.current.jsonData.tsdbResolution||1}return t.$inject=["$scope"],t.templateUrl="public/app/plugins/datasource/opentsdb/partials/config.html",t}()},1458:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryCtrl",function(){return o}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(1459),a=n(1305);n.d(e,"GrafanaDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a});var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.templateUrl="partials/query.editor.html",e}(a.QueryCtrl),s=function(){function t(){this.types=[{text:"Dashboard",value:"dashboard"},{text:"Tags",value:"tags"}],this.annotation.type=this.annotation.type||"tags",this.annotation.limit=this.annotation.limit||100}return t.templateUrl="partials/annotations.editor.html",t}()},1459:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(7),a=n.n(r),i=function(){function t(t,e){this.backendSrv=t,this.$q=e}return t.$inject=["backendSrv","$q"],t.prototype.query=function(t){return this.backendSrv.get("/api/tsdb/testdata/random-walk",{from:t.range.from.valueOf(),to:t.range.to.valueOf(),intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints}).then(function(t){var e=[];return t.results&&a.a.forEach(t.results,function(t){for(var n=0,r=t.series;n<r.length;n++){var a=r[n];e.push({target:a.name,datapoints:a.points})}}),{data:e}})},t.prototype.metricFindQuery=function(t){return this.$q.when({data:[]})},t.prototype.annotationQuery=function(t){var e={from:t.range.from.valueOf(),to:t.range.to.valueOf(),limit:t.annotation.limit,tags:t.annotation.tags};if("dashboard"===t.annotation.type){if(!t.dashboard.id)return this.$q.when([]);e.dashboardId=t.dashboard.id,delete e.tags}else if(!a.a.isArray(t.annotation.tags)||0===t.annotation.tags.length)return this.$q.when([]);return this.backendSrv.get("/api/annotations",e)},t}()},1460:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return i}),n.d(e,"AnnotationsQueryCtrl",function(){return o});var r=n(1461),a=n(1464);n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return a.a});var i=function(){function t(){}return t.templateUrl="partials/config.html",t}(),o=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},1461:function(t,e,n){"use strict";var r=n(7),a=n.n(r),i=n(467),o=n(1462),s=n.n(o),l=n(1331),u=n(1463),c=n(1333),p=function(){function t(t,e,n,r){this.$q=e,this.backendSrv=n,this.templateSrv=r,this.type="influxdb",this.urls=a.a.map(t.url.split(","),function(t){return t.trim()}),this.username=t.username,this.password=t.password,this.name=t.name,this.database=t.database,this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials,this.interval=(t.jsonData||{}).timeInterval,this.supportAnnotations=!0,this.supportMetrics=!0,this.responseParser=new u.a}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv"],t.prototype.query=function(t){var e,n,r,i=this,o=this.getTimeFilter(t),u=t.scopedVars,c=a.a.cloneDeep(t.targets),p=[],h=a.a.map(c,function(t){return t.hide?"":(p.push(t),u.interval=u.__interval,e=new l.a(t,i.templateSrv,u),e.render(!0))}).reduce(function(t,e){return""!==e&&(t+=";"+e),t});if(""===h)return this.$q.when({data:[]});var d=this.templateSrv.getAdhocFilters(this.name);return d.length>0&&(o+=" AND "+e.renderAdhocFilters(d)),u.timeFilter={value:o},h=this.templateSrv.replace(h,u),this._seriesQuery(h).then(function(e){if(!e||!e.results)return[];var a=[];for(n=0;n<e.results.length;n++){var o=e.results[n];if(o&&o.series){var l=p[n],u=l.alias;u&&(u=i.templateSrv.replace(l.alias,t.scopedVars));var c=new s.a({series:e.results[n].series,alias:u});switch(l.resultFormat){case"table":a.push(c.getTable());break;default:var h=c.getTimeSeries();for(r=0;r<h.length;r++)a.push(h[r])}}}return{data:a}})},t.prototype.annotationQuery=function(t){if(!t.annotation.query)return this.$q.reject({message:"Query missing in annotation definition"});var e=this.getTimeFilter({rangeRaw:t.rangeRaw}),n=t.annotation.query.replace("$timeFilter",e);return n=this.templateSrv.replace(n,null,"regex"),this._seriesQuery(n).then(function(e){if(!e||!e.results||!e.results[0])throw{message:"No results in response from InfluxDB"};return new s.a({series:e.results[0].series,annotation:t.annotation}).getAnnotations()})},t.prototype.targetContainsTemplate=function(t){for(var e=0,n=t.groupBy;e<n.length;e++)for(var r=n[e],a=0,i=r.params;a<i.length;a++){var o=i[a];if(this.templateSrv.variableExists(o))return!0}for(var s in t.tags)if(this.templateSrv.variableExists(t.tags[s].value))return!0;return!1},t.prototype.metricFindQuery=function(t){var e=this.templateSrv.replace(t,null,"regex");return this._seriesQuery(e).then(a.a.curry(this.responseParser.parse)(t))},t.prototype.getTagKeys=function(t){var e=new c.a({measurement:"",tags:[]},this.database),n=e.buildExploreQuery("TAG_KEYS");return this.metricFindQuery(n)},t.prototype.getTagValues=function(t){var e=new c.a({measurement:"",tags:[]},this.database),n=e.buildExploreQuery("TAG_VALUES",t.key);return this.metricFindQuery(n)},t.prototype._seriesQuery=function(t){return t?this._influxRequest("GET","/query",{q:t,epoch:"ms"}):this.$q.when({results:[]})},t.prototype.serializeParams=function(t){return t?a.a.reduce(t,function(t,e,n){return null===e||void 0===e?t:(t.push(encodeURIComponent(n)+"="+encodeURIComponent(e)),t)},[]).join("&"):""},t.prototype.testDatasource=function(){var t=this;return this.metricFindQuery("SHOW DATABASES").then(function(e){return a.a.find(e,{text:t.database})?{status:"success",message:"Data source is working"}:{status:"error",message:"Could not find the specified database name."}}).catch(function(t){return{status:"error",message:t.message}})},t.prototype._influxRequest=function(t,e,n){var r=this,i=r.urls.shift();r.urls.push(i);var o={};r.username&&(o.u=r.username,o.p=r.password),r.database&&(o.db=r.database),"GET"===t&&(a.a.extend(o,n),n=null);var s={method:t,url:i+e,params:o,data:n,precision:"ms",inspect:{type:"influxdb"},paramSerializer:this.serializeParams};return s.headers=s.headers||{},(this.basicAuth||this.withCredentials)&&(s.withCredentials=!0),r.basicAuth&&(s.headers.Authorization=r.basicAuth),this.backendSrv.datasourceRequest(s).then(function(t){return t.data},function(t){if(0!==t.status||t.status>=300)throw t.data&&t.data.error?{message:"InfluxDB Error: "+t.data.error,data:t.data,config:t.config}:{message:"Network Error: "+t.statusText+"("+t.status+")",data:t.data,config:t.config}})},t.prototype.getTimeFilter=function(t){var e=this.getInfluxTime(t.rangeRaw.from,!1),n=this.getInfluxTime(t.rangeRaw.to,!0),r="ms"===e[e.length-1];return"now()"!==n||r?"time >= "+e+" and time <= "+n:"time >= "+e},t.prototype.getInfluxTime=function(t,e){if(a.a.isString(t)){if("now"===t)return"now()";var n=/^now-(\d+)([d|h|m|s])$/.exec(t);if(n){return"now() - "+parseInt(n[1])+n[2]}t=i.parse(t,e)}return t.valueOf()+"ms"},t}();e.a=p},1462:function(t,e,n){var r,a;r=[n(7),n(1310)],void 0!==(a=function(t,e){"use strict";function n(t){this.series=t.series,this.alias=t.alias,this.annotation=t.annotation}var r=n.prototype;return r.getTimeSeries=function(){var e,n,r=[],a=this;return 0===a.series.length?r:(t.each(a.series,function(i){var o=i.columns.length,s=t.map(i.tags,function(t,e){return e+": "+t});for(n=1;n<o;n++){var l=i.name,u=i.columns[n];"value"!==u&&(l=l+"."+u),a.alias?l=a._getSeriesName(i,n):i.tags&&(l=l+" {"+s.join(", ")+"}");var c=[];if(i.values)for(e=0;e<i.values.length;e++)c[e]=[i.values[e][n],i.values[e][0]];r.push({target:l,datapoints:c})}}),r)},r._getSeriesName=function(t,e){var n=/\$(\w+)|\[\[([\s\S]+?)\]\]/g,r=t.name.split(".");return this.alias.replace(n,function(n,a,i){var o=a||i,s=parseInt(o,10);if("m"===o||"measurement"===o)return t.name;if("col"===o)return t.columns[e];if(!isNaN(s))return r[s];if(0!==o.indexOf("tag_"))return n;var l=o.replace("tag_","");return t.tags?t.tags[l]:n})},r.getAnnotations=function(){var e=[],n=this;return t.each(this.series,function(r){var a=null,i=null,o=[],s=null;t.each(r.columns,function(e,r){if("time"===e)return void(i=r);if("sequence_number"!==e)return a||(a=r),e===n.annotation.titleColumn?void(a=r):t.includes((n.annotation.tagsColumn||"").replace(" ","").split(","),e)?void o.push(r):e===n.annotation.textColumn?void(s=r):void 0}),t.each(r.values,function(r){var l={annotation:n.annotation,time:+new Date(r[i]),title:r[a],tags:t.flatten(o.filter(function(t){return r[t]}).map(function(t){return r[t].split(",")})),text:r[s]};e.push(l)})}),e},r.getTable=function(){var n,r,a=new e.default,i=this;return 0===i.series.length?a:(t.each(i.series,function(e,i){if(0===i)for(a.columns.push({text:"Time",type:"time"}),t.each(t.keys(e.tags),function(t){a.columns.push({text:t})}),r=1;r<e.columns.length;r++)a.columns.push({text:e.columns[r]});if(e.values)for(n=0;n<e.values.length;n++){var o=e.values[n],s=[o[0]];if(e.tags)for(var l in e.tags)e.tags.hasOwnProperty(l)&&s.push(e.tags[l]);for(r=1;r<o.length;r++)s.push(o[r]);a.rows.push(s)}}),a)},n}.apply(e,r))&&(t.exports=a)},1463:function(t,e,n){"use strict";function r(t,e){t[e]=e}var a=n(7),i=n.n(a),o=function(){function t(){}return t.prototype.parse=function(t,e){if(!e||0===e.results.length)return[];var n=e.results[0];if(!n.series)return[];var a=t.toLowerCase().indexOf("show tag values")>=0,o={};return i.a.each(n.series,function(t){i.a.each(t.values,function(t){i.a.isArray(t)?a?r(o,t[1]||t[0]):r(o,t[0]):r(o,t)})}),i.a.map(o,function(t){return{text:t}})},t}();e.a=o},1464:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=n(1333),l=n(1331),u=n(1332),c=n(1305),p=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(t){function e(e,n,r,a,i){var o=t.call(this,e,n)||this;o.templateSrv=r,o.$q=a,o.uiSegmentSrv=i,o.target=o.target,o.queryModel=new l.a(o.target,r,o.panel.scopedVars),o.queryBuilder=new s.a(o.target,o.datasource.database),o.groupBySegment=o.uiSegmentSrv.newPlusButton(),o.resultFormats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],o.policySegment=i.newSegment(o.target.policy),o.target.measurement?o.measurementSegment=i.newSegment(o.target.measurement):o.measurementSegment=i.newSelectMeasurement(),o.tagSegments=[];for(var u=0,c=o.target.tags;u<c.length;u++){var p=c[u];p.operator||(/^\/.*\/$/.test(p.value)?p.operator="=~":p.operator="="),p.condition&&o.tagSegments.push(i.newCondition(p.condition)),o.tagSegments.push(i.newKey(p.key)),o.tagSegments.push(i.newOperator(p.operator)),o.tagSegments.push(i.newKeyValue(p.value))}return o.fixTagSegments(),o.buildSelectMenu(),o.removeTagFilterSegment=i.newSegment({fake:!0,value:"-- remove tag filter --"}),o}return p(e,t),e.$inject=["$scope","$injector","templateSrv","$q","uiSegmentSrv"],e.prototype.removeOrderByTime=function(){this.target.orderByTime="ASC"},e.prototype.buildSelectMenu=function(){var t=u.a.getCategories();this.selectMenu=o.a.reduce(t,function(t,e,n){var r={text:n,submenu:e.map(function(t){return{text:t.type,value:t.type}})};return t.push(r),t},[])},e.prototype.getGroupByOptions=function(){var t=this,e=this.queryBuilder.buildExploreQuery("TAG_KEYS");return this.datasource.metricFindQuery(e).then(function(e){var n=[];t.queryModel.hasFill()||n.push(t.uiSegmentSrv.newSegment({value:"fill(null)"})),t.target.limit||n.push(t.uiSegmentSrv.newSegment({value:"LIMIT"})),t.target.slimit||n.push(t.uiSegmentSrv.newSegment({value:"SLIMIT"})),"ASC"===t.target.orderByTime&&n.push(t.uiSegmentSrv.newSegment({value:"ORDER BY time DESC"})),t.queryModel.hasGroupByTime()||n.push(t.uiSegmentSrv.newSegment({value:"time($interval)"}));for(var r=0,a=e;r<a.length;r++){var i=a[r];n.push(t.uiSegmentSrv.newSegment({value:"tag("+i.text+")"}))}return n}).catch(this.handleQueryError.bind(this))},e.prototype.groupByAction=function(){switch(this.groupBySegment.value){case"LIMIT":this.target.limit=10;break;case"SLIMIT":this.target.slimit=10;break;case"ORDER BY time DESC":this.target.orderByTime="DESC";break;default:this.queryModel.addGroupBy(this.groupBySegment.value)}var t=this.uiSegmentSrv.newPlusButton();this.groupBySegment.value=t.value,this.groupBySegment.html=t.html,this.panelCtrl.refresh()},e.prototype.addSelectPart=function(t,e,n){this.queryModel.addSelectPart(t,n.value),this.panelCtrl.refresh()},e.prototype.handleSelectPartEvent=function(t,e,n){switch(n.name){case"get-param-options":var r=this.queryBuilder.buildExploreQuery("FIELDS");return this.datasource.metricFindQuery(r).then(this.transformToSegments(!0)).catch(this.handleQueryError.bind(this));case"part-param-changed":this.panelCtrl.refresh();break;case"action":this.queryModel.removeSelectPart(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.handleGroupByPartEvent=function(t,e,n){switch(n.name){case"get-param-options":var r=this.queryBuilder.buildExploreQuery("TAG_KEYS");return this.datasource.metricFindQuery(r).then(this.transformToSegments(!0)).catch(this.handleQueryError.bind(this));case"part-param-changed":this.panelCtrl.refresh();break;case"action":this.queryModel.removeGroupByPart(t,e),this.panelCtrl.refresh();break;case"get-part-actions":return this.$q.when([{text:"Remove",value:"remove-part"}])}},e.prototype.fixTagSegments=function(){var t=this.tagSegments.length,e=this.tagSegments[Math.max(t-1,0)];e&&"plus-button"===e.type||this.tagSegments.push(this.uiSegmentSrv.newPlusButton())},e.prototype.measurementChanged=function(){this.target.measurement=this.measurementSegment.value,this.panelCtrl.refresh()},e.prototype.getPolicySegments=function(){var t=this.queryBuilder.buildExploreQuery("RETENTION POLICIES");return this.datasource.metricFindQuery(t).then(this.transformToSegments(!1)).catch(this.handleQueryError.bind(this))},e.prototype.policyChanged=function(){this.target.policy=this.policySegment.value,this.panelCtrl.refresh()},e.prototype.toggleEditorMode=function(){try{this.target.query=this.queryModel.render(!1)}catch(t){console.log("query render error")}this.target.rawQuery=!this.target.rawQuery},e.prototype.getMeasurements=function(t){var e=this.queryBuilder.buildExploreQuery("MEASUREMENTS",void 0,t);return this.datasource.metricFindQuery(e).then(this.transformToSegments(!0)).catch(this.handleQueryError.bind(this))},e.prototype.handleQueryError=function(t){return this.error=t.message||"Failed to issue metric query",[]},e.prototype.transformToSegments=function(t){var e=this;return function(n){var r=o.a.map(n,function(t){return e.uiSegmentSrv.newSegment({value:t.text,expandable:t.expandable})});if(t)for(var a=0,i=e.templateSrv.variables;a<i.length;a++){var s=i[a];r.unshift(e.uiSegmentSrv.newSegment({type:"template",value:"/^$"+s.name+"$/",expandable:!0}))}return r}},e.prototype.getTagsOrValues=function(t,e){var n=this;if("condition"===t.type)return this.$q.when([this.uiSegmentSrv.newSegment("AND"),this.uiSegmentSrv.newSegment("OR")]);if("operator"===t.type){return/^\/.*\/$/.test(this.tagSegments[e+1].value)?this.$q.when(this.uiSegmentSrv.newOperators(["=~","!~"])):this.$q.when(this.uiSegmentSrv.newOperators(["=","!=","<>","<",">"]))}var r,i;return"key"===t.type||"plus-button"===t.type?(r=this.queryBuilder.buildExploreQuery("TAG_KEYS"),i=!1):"value"===t.type&&(r=this.queryBuilder.buildExploreQuery("TAG_VALUES",this.tagSegments[e-2].value),i=!0),this.datasource.metricFindQuery(r).then(this.transformToSegments(i)).then(function(e){return"key"===t.type&&e.splice(0,0,a.a.copy(n.removeTagFilterSegment)),e}).catch(this.handleQueryError.bind(this))},e.prototype.getFieldSegments=function(){var t=this.queryBuilder.buildExploreQuery("FIELDS");return this.datasource.metricFindQuery(t).then(this.transformToSegments(!1)).catch(this.handleQueryError)},e.prototype.tagSegmentUpdated=function(t,e){this.tagSegments[e]=t,t.value===this.removeTagFilterSegment.value?(this.tagSegments.splice(e,3),0===this.tagSegments.length?this.tagSegments.push(this.uiSegmentSrv.newPlusButton()):this.tagSegments.length>2&&(this.tagSegments.splice(Math.max(e-1,0),1),"plus-button"!==this.tagSegments[this.tagSegments.length-1].type&&this.tagSegments.push(this.uiSegmentSrv.newPlusButton()))):("plus-button"===t.type&&(e>2&&this.tagSegments.splice(e,0,this.uiSegmentSrv.newCondition("AND")),this.tagSegments.push(this.uiSegmentSrv.newOperator("=")),this.tagSegments.push(this.uiSegmentSrv.newFake("select tag value","value","query-segment-value")),t.type="key",t.cssClass="query-segment-key"),e+1===this.tagSegments.length&&this.tagSegments.push(this.uiSegmentSrv.newPlusButton())),this.rebuildTargetTagConditions()},e.prototype.rebuildTargetTagConditions=function(){var t=this,e=[],n=0,r="";o.a.each(this.tagSegments,function(a,i){"key"===a.type?(0===e.length&&e.push({}),e[n].key=a.value):"value"===a.type?(r=t.getTagValueOperator(a.value,e[n].operator),r&&(t.tagSegments[i-1]=t.uiSegmentSrv.newOperator(r),e[n].operator=r),e[n].value=a.value):"condition"===a.type?(e.push({condition:a.value}),n+=1):"operator"===a.type&&(e[n].operator=a.value)}),this.target.tags=e,this.panelCtrl.refresh()},e.prototype.getTagValueOperator=function(t,e){return"=~"!==e&&"!~"!==e&&/^\/.*\/$/.test(t)?"=~":"=~"!==e&&"!~"!==e||!/^(?!\/.*\/$)/.test(t)?null:"="},e.prototype.getCollapsedText=function(){return this.queryModel.render(!1)},e.templateUrl="partials/query.editor.html",e}(c.QueryCtrl)},1465:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1466);n.d(e,"MixedDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a})},1466:function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=function(){function t(t,e){this.$q=t,this.datasourceSrv=e}return t.$inject=["$q","datasourceSrv"],t.prototype.query=function(t){var e=this,n=o.a.groupBy(t.targets,"datasource"),r=o.a.map(n,function(n){var r=n[0].datasource;return"-- Mixed --"===r?e.$q([]):e.datasourceSrv.get(r).then(function(e){var r=a.a.copy(t);return r.targets=n,e.query(r)})});return this.$q.all(r).then(function(t){return{data:o.a.flatten(o.a.map(t,"data"))}})},t}()},1467:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return i}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(1468),a=n(1470);n.d(e,"MysqlDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return a.a});var i=function(){function t(){}return t.templateUrl="partials/config.html",t}(),o="SELECT\n    UNIX_TIMESTAMP(<time_column>) as time_sec,\n    <text_column> as text,\n    <tags_column> as tags\n  FROM <table name>\n  WHERE $__timeFilter(time_column)\n  ORDER BY <time_column> ASC\n  LIMIT 100\n  ",s=function(){function t(){this.annotation.rawQuery=this.annotation.rawQuery||o}return t.templateUrl="partials/annotations.editor.html",t}()},1468:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(7),a=n.n(r),i=n(1469),o=function(){function t(t,e,n,r){this.backendSrv=e,this.$q=n,this.templateSrv=r,this.name=t.name,this.id=t.id,this.responseParser=new i.a(this.$q)}return t.$inject=["instanceSettings","backendSrv","$q","templateSrv"],t.prototype.interpolateVariable=function(t,e){return"string"==typeof t?e.multi||e.includeAll?"'"+t+"'":t:"number"==typeof t?t:a.a.map(t,function(e){return"number"==typeof t?t:"'"+e+"'"}).join(",")},t.prototype.query=function(t){var e=this,n=a.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(n){return{refId:n.refId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,datasourceId:e.id,rawSql:e.templateSrv.replace(n.rawSql,t.scopedVars,e.interpolateVariable),format:n.format}});return 0===n.length?this.$q.when({data:[]}):this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:n}}).then(this.responseParser.processQueryResult)},t.prototype.annotationQuery=function(t){var e=this;if(!t.annotation.rawQuery)return this.$q.reject({message:"Query missing in annotation definition"});var n={refId:t.annotation.name,datasourceId:this.id,rawSql:this.templateSrv.replace(t.annotation.rawQuery,t.scopedVars,this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[n]}}).then(function(n){return e.responseParser.transformAnnotationResponse(t,n)})},t.prototype.metricFindQuery=function(t,e){var n=this,r="tempvar";e&&e.variable&&e.variable.name&&(r=e.variable.name);var a={refId:r,datasourceId:this.id,rawSql:this.templateSrv.replace(t,{},this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{queries:[a]}}).then(function(t){return n.responseParser.parseMetricFindQueryResult(r,t)})},t.prototype.testDatasource=function(){return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:"5m",to:"now",queries:[{refId:"A",intervalMs:1,maxDataPoints:1,datasourceId:this.id,rawSql:"SELECT 1",format:"table"}]}}).then(function(t){return{status:"success",message:"Database Connection OK"}}).catch(function(t){return console.log(t),t.data&&t.data.message?{status:"error",message:t.data.message}:{status:"error",message:t.status}})},t}()},1469:function(t,e,n){"use strict";var r=n(7),a=n.n(r),i=function(){function t(t){this.$q=t}return t.prototype.processQueryResult=function(t){var e=[];if(!t.data.results)return{data:e};for(var n in t.data.results){var r=t.data.results[n];if(r.series)for(var a=0,i=r.series;a<i.length;a++){var o=i[a];e.push({target:o.name,datapoints:o.points,refId:r.refId,meta:r.meta})}if(r.tables)for(var s=0,l=r.tables;s<l.length;s++){var u=l[s];u.type="table",u.refId=r.refId,u.meta=r.meta,e.push(u)}}return{data:e}},t.prototype.parseMetricFindQueryResult=function(t,e){if(!e||0===e.data.length||0===e.data.results[t].meta.rowCount)return[];var n=e.data.results[t].tables[0].columns,r=e.data.results[t].tables[0].rows,a=this.findColIndex(n,"__text"),i=this.findColIndex(n,"__value");return 2===n.length&&-1!==a&&-1!==i?this.transformToKeyValueList(r,a,i):this.transformToSimpleList(r)},t.prototype.transformToKeyValueList=function(t,e,n){for(var r=[],a=0;a<t.length;a++)this.containsKey(r,t[a][e])||r.push({text:t[a][e],value:t[a][n]});return r},t.prototype.transformToSimpleList=function(t){for(var e=[],n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++){var i=t[n][r];-1===e.indexOf(i)&&e.push(i)}return a.a.map(e,function(t){return{text:t}})},t.prototype.findColIndex=function(t,e){for(var n=0;n<t.length;n++)if(t[n].text===e)return n;return-1},t.prototype.containsKey=function(t,e){for(var n=0;n<t.length;n++)if(t[n].text===e)return!0;return!1},t.prototype.transformAnnotationResponse=function(t,e){for(var n=e.data.results[t.annotation.name].tables[0],r=-1,a=-1,i=-1,o=0;o<n.columns.length;o++)if("time_sec"===n.columns[o].text)r=o;else{if("title"===n.columns[o].text)return this.$q.reject({message:"The title column for annotations is deprecated, now only a column named text is returned"});"text"===n.columns[o].text?a=o:"tags"===n.columns[o].text&&(i=o)}if(-1===r)return this.$q.reject({message:"Missing mandatory time column (with time_sec column alias) in annotation query."});for(var s=[],o=0;o<n.rows.length;o++){var l=n.rows[o];s.push({annotation:t.annotation,time:1e3*Math.floor(l[r]),text:l[a],tags:l[i]?l[i].trim().split(/\s*,\s*/):[]})}return s},t}();e.a=i},1470:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(7),a=n.n(r),i=n(1305),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s="SELECT\n  UNIX_TIMESTAMP(<time_column>) as time_sec,\n  <value column> as value,\n  <series name column> as metric\nFROM <table name>\nWHERE $__timeFilter(time_column)\nORDER BY <time_column> ASC\n",l=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.target.format=r.target.format||"time_series",r.target.alias="",r.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],r.target.rawSql||("table"===r.panelCtrl.panel.type?(r.target.format="table",r.target.rawSql="SELECT 1"):r.target.rawSql=s),r.panelCtrl.events.on("data-received",r.onDataReceived.bind(r),e),r.panelCtrl.events.on("data-error",r.onDataError.bind(r),e),r}return o(e,t),e.$inject=["$scope","$injector"],e.prototype.onDataReceived=function(t){this.lastQueryMeta=null,this.lastQueryError=null;var e=a.a.find(t,{refId:this.target.refId});e&&(this.lastQueryMeta=e.meta)},e.prototype.onDataError=function(t){if(t.data&&t.data.results){var e=t.data.results[this.target.refId];e&&(this.lastQueryMeta=e.meta,this.lastQueryError=e.error)}},e.templateUrl="partials/query.editor.html",e}(i.QueryCtrl)},1471:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return i}),n.d(e,"AnnotationsQueryCtrl",function(){return s});var r=n(1472),a=n(1474);n.d(e,"PostgresDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return a.a});var i=function(){function t(t){this.current.jsonData.sslmode=this.current.jsonData.sslmode||"require"}return t.$inject=["$scope"],t.templateUrl="partials/config.html",t}(),o="SELECT\n  extract(epoch from time_column) AS time,\n  text_column as text,\n  tags_column as tags\nFROM\n  metric_table\nWHERE\n  $__timeFilter(time_column)\n",s=function(){function t(){this.annotation.rawQuery=this.annotation.rawQuery||o}return t.templateUrl="partials/annotations.editor.html",t}()},1472:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var r=n(7),a=n.n(r),i=n(1473),o=function(){function t(t,e,n,r){this.backendSrv=e,this.$q=n,this.templateSrv=r,this.name=t.name,this.id=t.id,this.responseParser=new i.a(this.$q)}return t.$inject=["instanceSettings","backendSrv","$q","templateSrv"],t.prototype.interpolateVariable=function(t,e){return"string"==typeof t?e.multi||e.includeAll?"'"+t+"'":t:"number"==typeof t?t:a.a.map(t,function(t){return"'"+t+"'"}).join(",")},t.prototype.query=function(t){var e=this,n=a.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(n){return{refId:n.refId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,datasourceId:e.id,rawSql:e.templateSrv.replace(n.rawSql,t.scopedVars,e.interpolateVariable),format:n.format}});return 0===n.length?this.$q.when({data:[]}):this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:n}}).then(this.responseParser.processQueryResult)},t.prototype.annotationQuery=function(t){var e=this;if(!t.annotation.rawQuery)return this.$q.reject({message:"Query missing in annotation definition"});var n={refId:t.annotation.name,datasourceId:this.id,rawSql:this.templateSrv.replace(t.annotation.rawQuery,t.scopedVars,this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:[n]}}).then(function(n){return e.responseParser.transformAnnotationResponse(t,n)})},t.prototype.metricFindQuery=function(t,e){var n=this,r="tempvar";e&&e.variable&&e.variable.name&&(r=e.variable.name);var a={refId:r,datasourceId:this.id,rawSql:this.templateSrv.replace(t,{},this.interpolateVariable),format:"table"};return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{queries:[a]}}).then(function(t){return n.responseParser.parseMetricFindQueryResult(r,t)})},t.prototype.testDatasource=function(){return this.backendSrv.datasourceRequest({url:"/api/tsdb/query",method:"POST",data:{from:"5m",to:"now",queries:[{refId:"A",intervalMs:1,maxDataPoints:1,datasourceId:this.id,rawSql:"SELECT 1",format:"table"}]}}).then(function(t){return{status:"success",message:"Database Connection OK"}}).catch(function(t){return console.log(t),t.data&&t.data.message?{status:"error",message:t.data.message}:{status:"error",message:t.status}})},t}()},1473:function(t,e,n){"use strict";var r=n(7),a=n.n(r),i=function(){function t(t){this.$q=t}return t.prototype.processQueryResult=function(t){var e=[];if(!t.data.results)return{data:e};for(var n in t.data.results){var r=t.data.results[n];if(r.series)for(var a=0,i=r.series;a<i.length;a++){var o=i[a];e.push({target:o.name,datapoints:o.points,refId:r.refId,meta:r.meta})}if(r.tables)for(var s=0,l=r.tables;s<l.length;s++){var u=l[s];u.type="table",u.refId=r.refId,u.meta=r.meta,e.push(u)}}return{data:e}},t.prototype.parseMetricFindQueryResult=function(t,e){if(!e||0===e.data.length||0===e.data.results[t].meta.rowCount)return[];var n=e.data.results[t].tables[0].columns,r=e.data.results[t].tables[0].rows,a=this.findColIndex(n,"__text"),i=this.findColIndex(n,"__value");return 2===n.length&&-1!==a&&-1!==i?this.transformToKeyValueList(r,a,i):this.transformToSimpleList(r)},t.prototype.transformToKeyValueList=function(t,e,n){for(var r=[],a=0;a<t.length;a++)this.containsKey(r,t[a][e])||r.push({text:t[a][e],value:t[a][n]});return r},t.prototype.transformToSimpleList=function(t){for(var e=[],n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++){var i=t[n][r];-1===e.indexOf(i)&&e.push(i)}return a.a.map(e,function(t){return{text:t}})},t.prototype.findColIndex=function(t,e){for(var n=0;n<t.length;n++)if(t[n].text===e)return n;return-1},t.prototype.containsKey=function(t,e){for(var n=0;n<t.length;n++)if(t[n].text===e)return!0;return!1},t.prototype.transformAnnotationResponse=function(t,e){for(var n=e.data.results[t.annotation.name].tables[0],r=-1,a=-1,i=-1,o=0;o<n.columns.length;o++)"time"===n.columns[o].text?r=o:"text"===n.columns[o].text?a=o:"tags"===n.columns[o].text&&(i=o);if(-1===r)return this.$q.reject({message:"Missing mandatory time column in annotation query."});for(var s=[],o=0;o<n.rows.length;o++){var l=n.rows[o];s.push({annotation:t.annotation,time:1e3*Math.floor(l[r]),title:l[-1],text:l[a],tags:l[i]?l[i].trim().split(/\s*,\s*/):[]})}return s},t}();e.a=i},1474:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(7),a=n.n(r),i=n(1305),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s="SELECT\n  $__time(time_column),\n  value1\nFROM\n  metric_table\nWHERE\n  $__timeFilter(time_column)\n",l=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.target.format=r.target.format||"time_series",r.target.alias="",r.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],r.target.rawSql||("table"===r.panelCtrl.panel.type?(r.target.format="table",r.target.rawSql="SELECT 1"):r.target.rawSql=s),r.panelCtrl.events.on("data-received",r.onDataReceived.bind(r),e),r.panelCtrl.events.on("data-error",r.onDataError.bind(r),e),r}return o(e,t),e.$inject=["$scope","$injector"],e.prototype.onDataReceived=function(t){this.lastQueryMeta=null,this.lastQueryError=null;var e=a.a.find(t,{refId:this.target.refId});e&&(this.lastQueryMeta=e.meta)},e.prototype.onDataError=function(t){if(t.data&&t.data.results){var e=t.data.results[this.target.refId];e&&(this.lastQueryMeta=e.meta,this.lastQueryError=e.error)}},e.templateUrl="partials/query.editor.html",e}(i.QueryCtrl)},1475:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return i}),n.d(e,"AnnotationsQueryCtrl",function(){return o});var r=n(1476),a=n(1478);n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return a.a});var i=function(){function t(){}return t.templateUrl="partials/config.html",t}(),o=function(){function t(){}return t.templateUrl="partials/annotations.editor.html",t}()},1476:function(t,e,n){"use strict";function r(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\\\$&")}n.d(e,"a",function(){return p});var a=n(7),i=n.n(a),o=n(464),s=n(467),l=n(1477),u=n.n(l),c=n(1310),p=function(){function t(t,e,n,r,a){this.$q=e,this.backendSrv=n,this.templateSrv=r,this.timeSrv=a,this.type="prometheus",this.editorSrc="app/features/prometheus/partials/query.editor.html",this.name=t.name,this.supportMetrics=!0,this.url=t.url,this.directUrl=t.directUrl,this.basicAuth=t.basicAuth,this.withCredentials=t.withCredentials,this.interval=t.jsonData.timeInterval||"15s"}return t.$inject=["instanceSettings","$q","backendSrv","templateSrv","timeSrv"],t.prototype._request=function(t,e,n){var r={url:this.url+e,method:t,requestId:n};return(this.basicAuth||this.withCredentials)&&(r.withCredentials=!0),this.basicAuth&&(r.headers={Authorization:this.basicAuth}),this.backendSrv.datasourceRequest(r)},t.prototype.interpolateQueryExpr=function(t,e,n){return e.multi||e.includeAll?"string"==typeof t?r(t):i.a.map(t,r).join("|"):t},t.prototype.targetContainsTemplate=function(t){return this.templateSrv.variableExists(t.expr)},t.prototype.query=function(t){var e=this,n=this,r=this.getPrometheusTime(t.range.from,!1),a=this.getPrometheusTime(t.range.to,!0),o=Math.ceil(a-r),s=[],l=[];t=i.a.clone(t);for(var u=0,c=t.targets;u<c.length;u++){var p=c[u];p.expr&&!p.hide&&(l.push(p),s.push(this.createQuery(p,t,o)))}if(i.a.isEmpty(s))return this.$q.when({data:[]});var h=i.a.map(s,function(t){return t.instant?e.performInstantQuery(t,a):e.performTimeSeriesQuery(t,r,a)});return this.$q.all(h).then(function(t){var e=[];return i.a.each(t,function(t,i){if("error"===t.status)throw t.error;if("table"===l[i].format)e.push(n.transformMetricDataToTable(t.data.data.result));else for(var o=0,u=t.data.data.result;o<u.length;o++){var c=u[o];"matrix"===t.data.data.resultType?e.push(n.transformMetricData(c,l[i],r,a,s[i].step)):"vector"===t.data.data.resultType&&e.push(n.transformInstantMetricData(c,l[i]))}}),{data:e}})},t.prototype.createQuery=function(t,e,n){var r={};r.instant=t.instant;var a=o.default.interval_to_seconds(e.interval),i=o.default.interval_to_seconds(this.templateSrv.replace(t.interval,e.scopedVars)||e.interval),s=t.intervalFactor||1,l=this.adjustInterval(a,i,n,s),u=e.scopedVars;return a!==l&&(a=l,u=Object.assign({},e.scopedVars,{__interval:{text:a+"s",value:a+"s"},__interval_ms:{text:1e3*a,value:1e3*a}})),r.step=a,r.expr=this.templateSrv.replace(t.expr,u,this.interpolateQueryExpr),r.requestId=e.panelId+t.refId,r},t.prototype.adjustInterval=function(t,e,n,r){return 0!==t&&n/r/t>11e3&&(t=Math.ceil(n/r/11e3)),Math.max(t*r,e,1)},t.prototype.performTimeSeriesQuery=function(t,e,n){if(e>n)throw{message:"Invalid time range"};var r="/api/v1/query_range?query="+encodeURIComponent(t.expr)+"&start="+e+"&end="+n+"&step="+t.step;return this._request("GET",r,t.requestId)},t.prototype.performInstantQuery=function(t,e){var n="/api/v1/query?query="+encodeURIComponent(t.expr)+"&time="+e;return this._request("GET",n,t.requestId)},t.prototype.performSuggestQuery=function(t,e){var n=this;void 0===e&&(e=!1);return e&&this.metricsNameCache&&this.metricsNameCache.expire>Date.now()?this.$q.when(i.a.filter(this.metricsNameCache.data,function(e){return 1!==e.indexOf(t)})):this._request("GET","/api/v1/label/__name__/values").then(function(e){return n.metricsNameCache={data:e.data.data,expire:Date.now()+6e4},i.a.filter(e.data.data,function(e){return 1!==e.indexOf(t)})})},t.prototype.metricFindQuery=function(t){if(!t)return this.$q.when([]);var e=this.templateSrv.replace(t,{},this.interpolateQueryExpr);return new u.a(this,e,this.timeSrv).process()},t.prototype.annotationQuery=function(t){var e=t.annotation,n=e.expr||"",r=e.tagKeys||"",a=e.titleFormat||"",s=e.textFormat||"";if(!n)return this.$q.when([]);var l=this.templateSrv.replace(n,{},this.interpolateQueryExpr),u="60s";e.step&&(u=this.templateSrv.replace(e.step));var c=this.getPrometheusTime(t.range.from,!1),p=this.getPrometheusTime(t.range.to,!0),h={expr:l,step:this.adjustInterval(o.default.interval_to_seconds(u),0,Math.ceil(p-c),1)+"s"},d=this;return this.performTimeSeriesQuery(h,c,p).then(function(t){var n=[];return r=r.split(","),i.a.each(t.data.data.result,function(t){for(var o=i.a.chain(t.metric).filter(function(t,e){return i.a.includes(r,e)}).value(),l=0,u=t.values;l<u.length;l++){var c=u[l];if("1"===c[1]){var p={annotation:e,time:1e3*Math.floor(parseFloat(c[0])),title:d.renderTemplate(a,t.metric),tags:o,text:d.renderTemplate(s,t.metric)};n.push(p)}}}),n})},t.prototype.testDatasource=function(){return this.metricFindQuery("metrics(.*)").then(function(){return{status:"success",message:"Data source is working"}})},t.prototype.transformMetricData=function(t,e,n,r,a){var o=[],s=null;s=this.createMetricLabel(t.metric,e);for(var l=1e3*a,u=1e3*n,c=0,p=t.values;c<p.length;c++){var h=p[c],d=parseFloat(h[1]);i.a.isNaN(d)&&(d=null);for(var f=1e3*parseFloat(h[0]),m=u;m<f;m+=l)o.push([null,m]);u=f+l,o.push([d,f])}for(var g=1e3*r,m=u;m<=g;m+=l)o.push([null,m]);return{target:s,datapoints:o}},t.prototype.transformMetricDataToTable=function(t){var e,n,r=new c.default,a={};if(0===t.length)return r;i.a.each(t,function(t){for(var e in t.metric)a.hasOwnProperty(e)||(a[e]=1)});var o=i.a.keys(a).sort();return r.columns.push({text:"Time",type:"time"}),i.a.each(o,function(t,e){a[t]=e+1,r.columns.push({text:t})}),r.columns.push({text:"Value"}),i.a.each(t,function(t){if(t.value&&(t.values=[t.value]),t.values)for(e=0;e<t.values.length;e++){var a=t.values[e],i=[1e3*a[0]];if(t.metric)for(n=0;n<o.length;n++){var s=o[n];t.metric.hasOwnProperty(s)?i.push(t.metric[s]):i.push("")}i.push(parseFloat(a[1])),r.rows.push(i)}}),r},t.prototype.transformInstantMetricData=function(t,e){var n=[],r=null;return r=this.createMetricLabel(t.metric,e),n.push([parseFloat(t.value[1]),1e3*t.value[0]]),{target:r,datapoints:n}},t.prototype.createMetricLabel=function(t,e){return i.a.isUndefined(e)||i.a.isEmpty(e.legendFormat)?this.getOriginalMetricName(t):this.renderTemplate(this.templateSrv.replace(e.legendFormat),t)||"{}"},t.prototype.renderTemplate=function(t,e){var n=/\{\{\s*(.+?)\s*\}\}/g;return t.replace(n,function(t,n){return e[n]?e[n]:n})},t.prototype.getOriginalMetricName=function(t){var e=t.__name__||"";return delete t.__name__,e+"{"+i.a.map(i.a.toPairs(t),function(t){return t[0]+'="'+t[1]+'"'}).join(",")+"}"},t.prototype.getPrometheusTime=function(t,e){return i.a.isString(t)&&(t=s.parse(t,e)),Math.ceil(t.valueOf()/1e3)},t}()},1477:function(t,e,n){var r,a;r=[n(7)],void 0!==(a=function(t){"use strict";function e(t,e,n){this.datasource=t,this.query=e,this.range=n.timeRange()}return e.prototype.process=function(){var t=/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]+)\)$/,e=/^metrics\((.+)\)$/,n=/^query_result\((.+)\)$/,r=this.query.match(t);if(r)return r[1]?this.labelValuesQuery(r[2],r[1]):this.labelValuesQuery(r[2],null);var a=this.query.match(e);if(a)return this.metricNameQuery(a[1]);var i=this.query.match(n);return i?this.queryResultQuery(i[1]):this.metricNameAndLabelsQuery(this.query)},e.prototype.labelValuesQuery=function(e,n){var r;if(n){var a=this.datasource.getPrometheusTime(this.range.from,!1),i=this.datasource.getPrometheusTime(this.range.to,!0);return r="/api/v1/series?match[]="+encodeURIComponent(n)+"&start="+a+"&end="+i,this.datasource._request("GET",r).then(function(n){var r=t.map(n.data.data,function(t){return t[e]});return t.uniq(r).map(function(t){return{text:t,expandable:!0}})})}return r="/api/v1/label/"+e+"/values",this.datasource._request("GET",r).then(function(e){return t.map(e.data.data,function(t){return{text:t}})})},e.prototype.metricNameQuery=function(e){return this.datasource._request("GET","/api/v1/label/__name__/values").then(function(n){return t.chain(n.data.data).filter(function(t){return new RegExp(e).test(t)}).map(function(t){return{text:t,expandable:!0}}).value()})},e.prototype.queryResultQuery=function(e){var n=this.datasource.getPrometheusTime(this.range.to,!0);return this.datasource.performInstantQuery({expr:e},n).then(function(e){return t.map(e.data.data.result,function(e){var n=e.metric.__name__||"";return delete e.metric.__name__,n+="{"+t.map(e.metric,function(t,e){return e+'="'+t+'"'}).join(",")+"}",n+=" "+e.value[1]+" "+1e3*e.value[0],{text:n,expandable:!0}})})},e.prototype.metricNameAndLabelsQuery=function(e){var n=this.datasource.getPrometheusTime(this.range.from,!1),r=this.datasource.getPrometheusTime(this.range.to,!0),a="/api/v1/series?match[]="+encodeURIComponent(e)+"&start="+n+"&end="+r,i=this;return this.datasource._request("GET",a).then(function(e){return t.map(e.data.data,function(t){return{text:i.datasource.getOriginalMetricName(t),expandable:!0}})})},e}.apply(e,r))&&(t.exports=a)},1478:function(t,e,n){"use strict";n.d(e,"a",function(){return h});var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=n(1305),l=n(1479),u=n(1480),c=(n.n(u),n(1481)),p=(n.n(c),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),h=function(t){function e(e,n,r){var a=t.call(this,e,n)||this;a.templateSrv=r;var i=a.target;return i.expr=i.expr||"",i.intervalFactor=i.intervalFactor||2,i.format=i.format||a.getDefaultFormat(),a.metric="",a.resolutions=o.a.map([1,2,3,4,5,10],function(t){return{factor:t,label:"1/"+t}}),a.formats=[{text:"Time series",value:"time_series"},{text:"Table",value:"table"}],a.instant=!1,a.updateLink(),a}return p(e,t),e.$inject=["$scope","$injector","templateSrv"],e.prototype.getCompleter=function(t){return new l.a(this.datasource)},e.prototype.getDefaultFormat=function(){return"table"===this.panelCtrl.panel.type?"table":"time_series"},e.prototype.refreshMetricData=function(){o.a.isEqual(this.oldTarget,this.target)||(this.oldTarget=a.a.copy(this.target),this.panelCtrl.refresh(),this.updateLink())},e.prototype.updateLink=function(){var t=this.panelCtrl.range;if(t){var e=Math.ceil((t.to.valueOf()-t.from.valueOf())/1e3),n=t.to.utc().format("YYYY-MM-DD HH:mm"),r={"g0.expr":this.templateSrv.replace(this.target.expr,this.panelCtrl.panel.scopedVars,this.datasource.interpolateQueryExpr),"g0.range_input":e+"s","g0.end_input":n,"g0.step_input":this.target.step,"g0.stacked":this.panelCtrl.panel.stack?1:0,"g0.tab":0},a=o.a.map(r,function(t,e){return e+"="+encodeURIComponent(t)}).join("&");this.linkToPrometheus=this.datasource.directUrl+"/graph?"+a}},e.prototype.getCollapsedText=function(){return this.target.expr},e.templateUrl="partials/query.editor.html",e}(s.QueryCtrl)},1479:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(7),a=n.n(r),i=function(){function t(t){this.datasource=t,this.identifierRegexps=[/\[/,/[a-zA-Z0-9_:]/],this.labelQueryCache={},this.labelNameCache={},this.labelValueCache={}}return t.prototype.getCompletions=function(t,e,n,r,i){var o,s=this,l=e.getTokenAt(n.row,n.column);switch(l.type){case"entity.name.tag":return o=this.findMetricName(e,n.row,n.column),o?this.labelNameCache[o]?void i(null,this.labelNameCache[o]):this.getLabelNameAndValueForMetric(o).then(function(t){var e=s.transformToCompletions(a.a.uniq(a.a.flatten(t.map(function(t){return Object.keys(t.metric)}))),"label name");s.labelNameCache[o]=e,i(null,e)}):void i(null,this.transformToCompletions(["__name__","instance","job"],"label name"));case"string.quoted":if(!(o=this.findMetricName(e,n.row,n.column)))return void i(null,[]);var u=this.findToken(e,n.row,n.column,"entity.name.tag",null,"paren.lparen");if(!u)return void i(null,[]);var c=u.value;return this.labelValueCache[o]&&this.labelValueCache[o][c]?void i(null,this.labelValueCache[o][c]):this.getLabelNameAndValueForMetric(o).then(function(t){var e=s.transformToCompletions(a.a.uniq(t.map(function(t){return t.metric[c]})),"label value");s.labelValueCache[o]=s.labelValueCache[o]||{},s.labelValueCache[o][c]=e,i(null,e)})}if("paren.lparen"===l.type&&"["===l.value){for(var p=[],h=0,d=["s","m","h"];h<d.length;h++)for(var f=d[h],m=0,g=[1,5,10,30];m<g.length;m++){var v=g[m];p.push({caption:v+f,value:"["+v+f,meta:"range vector"})}return p.push({caption:"$__interval",value:"[$__interval",meta:"range vector"}),p.push({caption:"$__interval_ms",value:"[$__interval_ms",meta:"range vector"}),void i(null,p)}var y=r;return this.datasource.performSuggestQuery(y,!0).then(function(t){i(null,t.map(function(t){var e=t;return"("===r&&(e="("+t),{caption:t,value:e,meta:"metric"}}))})},t.prototype.getLabelNameAndValueForMetric=function(t){var e=this;if(this.labelQueryCache[t])return Promise.resolve(this.labelQueryCache[t]);var n="=~";/[a-zA-Z_:][a-zA-Z0-9_:]*/.test(t)&&(n="=");var r="{__name__"+n+'"'+t+'"}';return this.datasource.performInstantQuery({expr:r},(new Date).getTime()/1e3).then(function(n){return e.labelQueryCache[t]=n.data.data.result,n.data.data.result})},t.prototype.transformToCompletions=function(t,e){return t.map(function(t){return{caption:t,value:t,meta:e,score:Number.MAX_VALUE}})},t.prototype.findMetricName=function(t,e,n){var r,a="",i=this.findToken(t,e,n,"entity.name.tag","__name__","paren.lparen");if(i){r=t.getTokens(i.row);var o=r[i.index+2];o&&"string.quoted"===o.type&&(a=o.value.slice(1,-1))}else{var s=this.findToken(t,e,n,"identifier",null,null);s&&(r=t.getTokens(s.row),"paren.lparen"===r[s.index+1].type&&(a=s.value))}return a},t.prototype.findToken=function(t,e,n,r,a,i){for(var o,s,l=e;l>=0;l--){if(o=t.getTokens(l),l===e){var u=0;for(s=0;s<o.length&&!((u+=o[s].value.length)>=n);s++);}else s=o.length-1;for(;s>=0;s--){if(o[s].type===i)return null;if(o[s].type===r&&(!a||o[s].value===a))return o[s].row=l,o[s].index=s,o[s]}}return null},t}()},1480:function(t,e){ace.define("ace/mode/prometheus_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(t,e,n){"use strict";var r=t("../lib/oop"),a=t("./text_highlight_rules").TextHighlightRules,i=function(){var t=this.createKeywordMapper({"support.function":"abs|absent|ceil|changes|clamp_max|clamp_min|count_scalar|day_of_month|day_of_week|days_in_month|delta|deriv|drop_common_labels|exp|floor|histogram_quantile|holt_winters|hour|idelta|increase|irate|label_replace|ln|log2|log10|minute|month|predict_linear|rate|resets|round|scalar|sort|sort_desc|sqrt|time|vector|year|avg_over_time|min_over_time|max_over_time|sum_over_time|count_over_time|quantile_over_time|stddev_over_time|stdvar_over_time",keyword:"by|without|keep_common|offset|bool|and|or|unless|ignoring|on|group_left|group_right|count|count_values|min|max|avg|sum|stddev|stdvar|bottomk|topk|quantile","constant.language":"true|false|null|__name__|job"},"identifier",!0);this.$rules={start:[{token:"string",regex:/"(?:[^"\\]|\\.)*?"/},{token:"string",regex:"'.*?'"},{token:"constant.numeric",regex:"[-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language",regex:"\\d+[smhdwy]"},{token:t,regex:"[a-zA-Z_:][a-zA-Z0-9_:]*"},{token:"keyword.operator",regex:"\\+|\\-|\\*|\\/|%|\\^|==|!=|<=|>=|<|>"},{token:"paren.lparen",regex:"[[(]"},{token:"paren.lparen",regex:"{",next:"start-label-matcher"},{token:"paren.rparen",regex:"[\\])]"},{token:"paren.rparen",regex:"}"},{token:"text",regex:"\\s+"}],"start-label-matcher":[{token:"entity.name.tag",regex:"[a-zA-Z_][a-zA-Z0-9_]*"},{token:"keyword.operator",regex:"=~|=|!~|!="},{token:"string.quoted",regex:"\"[^\"]*\"|'[^']*'"},{token:"punctuation.operator",regex:","},{token:"paren.rparen",regex:"}",next:"start"}]},this.normalizeRules()};r.inherits(i,a),e.PrometheusHighlightRules=i}),ace.define("ace/mode/prometheus_completions",["require","exports","module","ace/token_iterator","ace/lib/lang"],function(t,e,n){"use strict";function r(t,e){e=e||60;for(var n=[],r=0,a=0,i=e,o="",s=0;s<t.length;s++)" "===t[s]?r=s:s>=i&&0!=r&&(o=t.slice(a,r),n.push(o),a=r+1,i=s+e,r=0);return o=t.slice(a),n.push(o),n.join("&nbsp<br>")}function a(t){return t=t.replace(/```(.+)```/,"<pre>$1</pre>"),t=t.replace(/`([^`]+)`/,"<code>$1</code>")}function i(t){var e=o.escapeHTML(t.docText);return e=a(r(e,40)),["<b>",o.escapeHTML(t.def),"</b>","<hr></hr>",e,"<br>&nbsp"].join("")}var o=t("../lib/lang"),s=["by","without","keep_common","offset","bool","and","or","unless","ignoring","on","group_left","group_right","count","count_values","min","max","avg","sum","stddev","stdvar","bottomk","topk","quantile"],l=s.map(function(t){return{caption:t,value:t,meta:"keyword",score:Number.MAX_VALUE}}),u=[{name:"abs()",value:"abs",def:"abs(v instant-vector)",docText:"Returns the input vector with all sample values converted to their absolute value."},{name:"absent()",value:"absent",def:"absent(v instant-vector)",docText:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{name:"ceil()",value:"ceil",def:"ceil(v instant-vector)",docText:"Rounds the sample values of all elements in `v` up to the nearest integer."},{name:"changes()",value:"changes",def:"changes(v range-vector)",docText:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{name:"clamp_max()",value:"clamp_max",def:"clamp_max(v instant-vector, max scalar)",docText:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{name:"clamp_min()",value:"clamp_min",def:"clamp_min(v instant-vector, min scalar)",docText:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{name:"count_scalar()",value:"count_scalar",def:"count_scalar(v instant-vector)",docText:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{name:"day_of_month()",value:"day_of_month",def:"day_of_month(v=vector(time()) instant-vector)",docText:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{name:"day_of_week()",value:"day_of_week",def:"day_of_week(v=vector(time()) instant-vector)",docText:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{name:"days_in_month()",value:"days_in_month",def:"days_in_month(v=vector(time()) instant-vector)",docText:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{name:"delta()",value:"delta",def:"delta(v range-vector)",docText:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{name:"deriv()",value:"deriv",def:"deriv(v range-vector)",docText:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{name:"drop_common_labels()",value:"drop_common_labels",def:"drop_common_labels(instant-vector)",docText:"Drops all labels that have the same name and value across all series in the input vector."},{name:"exp()",value:"exp",def:"exp(v instant-vector)",docText:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{name:"floor()",value:"floor",def:"floor(v instant-vector)",docText:"Rounds the sample values of all elements in `v` down to the nearest integer."},{name:"histogram_quantile()",value:"histogram_quantile",def:"histogram_quantile( float, b instant-vector)",docText:"Calculates the -quantile (0    1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{name:"holt_winters()",value:"holt_winters",def:"holt_winters(v range-vector, sf scalar, tf scalar)",docText:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{name:"hour()",value:"hour",def:"hour(v=vector(time()) instant-vector)",docText:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{name:"idelta()",value:"idelta",def:"idelta(v range-vector)",docText:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{name:"increase()",value:"increase",def:"increase(v range-vector)",docText:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{name:"irate()",value:"irate",def:"irate(v range-vector)",docText:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{name:"label_replace()",value:"label_replace",def:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",docText:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{name:"ln()",value:"ln",def:"ln(v instant-vector)",docText:"calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{name:"log2()",value:"log2",def:"log2(v instant-vector)",docText:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{name:"log10()",value:"log10",def:"log10(v instant-vector)",docText:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{name:"minute()",value:"minute",def:"minute(v=vector(time()) instant-vector)",docText:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{name:"month()",value:"month",def:"month(v=vector(time()) instant-vector)",docText:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{name:"predict_linear()",value:"predict_linear",def:"predict_linear(v range-vector, t scalar)",docText:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{name:"rate()",value:"rate",def:"rate(v range-vector)",docText:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{name:"resets()",value:"resets",def:"resets(v range-vector)",docText:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{name:"round()",value:"round",def:"round(v instant-vector, to_nearest=1 scalar)",docText:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{name:"scalar()",value:"scalar",def:"scalar(v instant-vector)",docText:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{name:"sort()",value:"sort",def:"sort(v instant-vector)",docText:"Returns vector elements sorted by their sample values, in ascending order."},{name:"sort_desc()",value:"sort_desc",def:"sort_desc(v instant-vector)",docText:"Returns vector elements sorted by their sample values, in descending order."},{name:"sqrt()",value:"sqrt",def:"sqrt(v instant-vector)",docText:"Calculates the square root of all elements in `v`."},{name:"time()",value:"time",def:"time()",docText:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{name:"vector()",value:"vector",def:"vector(s scalar)",docText:"Returns the scalar `s` as a vector with no labels."},{name:"year()",value:"year",def:"year(v=vector(time()) instant-vector)",docText:"Returns the year for each of the given times in UTC."},{name:"avg_over_time()",value:"avg_over_time",def:"avg_over_time(range-vector)",docText:"The average value of all points in the specified interval."},{name:"min_over_time()",value:"min_over_time",def:"min_over_time(range-vector)",docText:"The minimum value of all points in the specified interval."},{name:"max_over_time()",value:"max_over_time",def:"max_over_time(range-vector)",docText:"The maximum value of all points in the specified interval."},{name:"sum_over_time()",value:"sum_over_time",def:"sum_over_time(range-vector)",docText:"The sum of all values in the specified interval."},{name:"count_over_time()",value:"count_over_time",def:"count_over_time(range-vector)",docText:"The count of all values in the specified interval."},{name:"quantile_over_time()",value:"quantile_over_time",def:"quantile_over_time(scalar, range-vector)",docText:"The -quantile (0    1) of the values in the specified interval."},{name:"stddev_over_time()",value:"stddev_over_time",def:"stddev_over_time(range-vector)",docText:"The population standard deviation of the values in the specified interval."},{name:"stdvar_over_time()",value:"stdvar_over_time",def:"stdvar_over_time(range-vector)",docText:"The population standard variance of the values in the specified interval."}],c=u.map(function(t){return{caption:t.name,value:t.value,docHTML:i(t),meta:"function",score:Number.MAX_VALUE}}),p=function(){};(function(){this.getCompletions=function(t,e,n,r,a){var i=e.getTokenAt(n.row,n.column);if("entity.name.tag"===i.type||"string.quoted"===i.type)return a(null,[]);a(null,l.concat(c))}}).call(p.prototype),e.PrometheusCompletions=p}),ace.define("ace/mode/behaviour/prometheus",["require","exports","module","ace/lib/oop","ace/mode/behaviour","ace/mode/behaviour/cstyle","ace/token_iterator"],function(t,e,n){"use strict";function r(t,e,n,r){var a=t.end.row-t.start.row;return{text:n+e+r,selection:[0,t.start.column+1,a,t.end.column+(a?0:1)]}}var a=t("../../lib/oop"),i=(t("../behaviour").Behaviour,t("./cstyle").CstyleBehaviour),o=(t("../../token_iterator").TokenIterator,function(){this.inherit(i),this.add("braces","insertion",function(t,e,n,a,o){if("{"==o){var s=n.getSelectionRange(),l=a.doc.getTextRange(s);if(""!==l&&n.getWrapBehavioursEnabled())return r(s,l,"{","}");if(i.isSaneInsertion(n,a))return{text:"{}",selection:[1,1]}}else if("}"==o){var u=n.getCursorPosition(),c=a.doc.getLine(u.row),p=c.substring(u.column,u.column+1);if("}"==p){var h=a.$findOpeningBracket("}",{column:u.column+1,row:u.row});if(null!==h&&i.isAutoInsertedClosing(u,c,o))return{text:"",selection:[1,1]}}}}),this.add("braces","deletion",function(t,e,n,r,a){var i=r.doc.getTextRange(a);if(!a.isMultiLine()&&"{"==i){if("}"==r.doc.getLine(a.start.row).substring(a.start.column+1,a.start.column+2))return a.end.column++,a}})});a.inherits(o,i),e.PrometheusBehaviour=o}),ace.define("ace/mode/prometheus",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/prometheus_highlight_rules"],function(t,e,n){"use strict";var r=t("../lib/oop"),a=t("./text").Mode,i=t("./prometheus_highlight_rules").PrometheusHighlightRules,o=t("./prometheus_completions").PrometheusCompletions,s=t("./behaviour/prometheus").PrometheusBehaviour,l=function(){this.HighlightRules=i,this.$behaviour=new s,this.$completer=new o,this.completer=this.$completer};r.inherits(l,a),function(){this.$id="ace/mode/prometheus"}.call(l.prototype),e.Mode=l})},1481:function(t,e){ace.define("ace/snippets/prometheus",["require","exports","module"],function(t,e,n){"use strict";e.snippets=[{content:"rate(${1:metric}[${2:range}])",name:"rate()",scope:"prometheus",tabTrigger:"r"}],e.scope="prometheus"})},1482:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"TextPanelCtrl",function(){return s}),n.d(e,"PanelCtrl",function(){return s});var r=n(7),a=n.n(r),i=n(1305),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(e,n,r,i){var o=t.call(this,e,n)||this;return o.templateSrv=r,o.$sce=i,o.panelDefaults={mode:"markdown",content:"# title"},a.a.defaults(o.panel,o.panelDefaults),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.events.on("refresh",o.onRefresh.bind(o)),o.events.on("render",o.onRender.bind(o)),e.$watch("ctrl.panel.content",a.a.throttle(function(){o.render()},1e3)),o}return o(e,t),e.$inject=["$scope","$injector","templateSrv","$sce"],e.prototype.onInitEditMode=function(){this.addEditorTab("Options","public/app/plugins/panel/text/editor.html"),this.editorTabIndex=1,"text"===this.panel.mode&&(this.panel.mode="markdown")},e.prototype.onRefresh=function(){this.render()},e.prototype.onRender=function(){"markdown"===this.panel.mode?this.renderMarkdown(this.panel.content):"html"===this.panel.mode&&this.updateContent(this.panel.content),this.renderingCompleted()},e.prototype.renderText=function(t){t=t.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\n/g,"<br/>"),this.updateContent(t)},e.prototype.renderMarkdown=function(t){var e=this;if(!this.remarkable)return new Promise(function(t){t()}).then(n.bind(null,469)).then(function(n){e.remarkable=new n,e.$scope.$apply(function(){e.updateContent(e.remarkable.render(t))})});this.$scope.$applyAsync(function(){e.updateContent(e.remarkable.render(t))})},e.prototype.updateContent=function(t){try{this.content=this.$sce.trustAsHtml(this.templateSrv.replace(t,this.panel.scopedVars))}catch(e){console.log("Text panel error: ",e),this.content=this.$sce.trustAsHtml(t)}},e.templateUrl="public/app/plugins/panel/text/module.html",e}(i.PanelCtrl)},1483:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"GraphCtrl",function(){return d}),n.d(e,"PanelCtrl",function(){return d});var r=(n(1484),n(1489)),a=(n.n(r),n(1490)),i=(n.n(a),n(1491),n(1492)),o=n(7),s=n.n(o),l=n(27),u=n(1305),c=n(1341),p=n(1493),h=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t){function e(e,n,r){var a=t.call(this,e,n)||this;return a.annotationsSrv=r,a.hiddenSeries={},a.seriesList=[],a.dataList=[],a.annotations=[],a.colors=[],a.panelDefaults={datasource:null,renderer:"flot",yaxes:[{label:null,show:!0,logBase:1,min:null,max:null,format:"short"},{label:null,show:!0,logBase:1,min:null,max:null,format:"short"}],xaxis:{show:!0,mode:"time",name:null,values:[],buckets:null},lines:!0,fill:1,linewidth:1,dashes:!1,dashLength:10,spaceLength:10,points:!1,pointradius:5,bars:!1,stack:!1,percentage:!1,legend:{show:!0,values:!1,min:!1,max:!1,current:!1,total:!1,avg:!1},nullPointMode:"null",steppedLine:!1,tooltip:{value_type:"individual",shared:!0,sort:0},timeFrom:null,timeShift:null,targets:[{}],aliasColors:{},seriesOverrides:[],thresholds:[]},s.a.defaults(a.panel,a.panelDefaults),s.a.defaults(a.panel.tooltip,a.panelDefaults.tooltip),s.a.defaults(a.panel.legend,a.panelDefaults.legend),s.a.defaults(a.panel.xaxis,a.panelDefaults.xaxis),a.processor=new c.a(a.panel),a.events.on("render",a.onRender.bind(a)),a.events.on("data-received",a.onDataReceived.bind(a)),a.events.on("data-error",a.onDataError.bind(a)),a.events.on("data-snapshot-load",a.onDataSnapshotLoad.bind(a)),a.events.on("init-edit-mode",a.onInitEditMode.bind(a)),a.events.on("init-panel-actions",a.onInitPanelActions.bind(a)),a}return h(e,t),e.$inject=["$scope","$injector","annotationsSrv"],e.prototype.onInitEditMode=function(){this.addEditorTab("Axes",p.a,2),this.addEditorTab("Legend","public/app/plugins/panel/graph/tab_legend.html",3),this.addEditorTab("Display","public/app/plugins/panel/graph/tab_display.html",4),l.default.alertingEnabled&&this.addEditorTab("Alert",u.alertTab,5),this.subTabIndex=0},e.prototype.onInitPanelActions=function(t){t.push({text:"Export CSV",click:"ctrl.exportCsv()"}),t.push({text:"Toggle legend",click:"ctrl.toggleLegend()"})},e.prototype.issueQueries=function(e){return this.annotationsPromise=this.annotationsSrv.getAnnotations({dashboard:this.dashboard,panel:this.panel,range:this.range}),t.prototype.issueQueries.call(this,e)},e.prototype.zoomOut=function(t){this.publishAppEvent("zoom-out",2)},e.prototype.onDataSnapshotLoad=function(t){this.annotationsPromise=this.annotationsSrv.getAnnotations({dashboard:this.dashboard,panel:this.panel,range:this.range}),this.onDataReceived(t)},e.prototype.onDataError=function(t){this.seriesList=[],this.annotations=[],this.render([])},e.prototype.onDataReceived=function(t){var e=this;if(this.dataList=t,this.seriesList=this.processor.getSeriesList({dataList:t,range:this.range}),this.dataWarning=null,0===this.seriesList.reduce(function(t,e){return t+e.datapoints.length},0))this.dataWarning={title:"No data points",tip:"No datapoints returned from data query"};else for(var n=0,r=this.seriesList;n<r.length;n++){var a=r[n];if(a.isOutsideRange){this.dataWarning={title:"Data points outside time range",tip:"Can be caused by timezone mismatch or missing time filter in query"};break}}this.annotationsPromise.then(function(t){e.loading=!1,e.alertState=t.alertState,e.annotations=t.annotations,e.render(e.seriesList)},function(){e.loading=!1,e.render(e.seriesList)})},e.prototype.onRender=function(){if(this.seriesList)for(var t=0,e=this.seriesList;t<e.length;t++){var n=e[t];n.applySeriesOverrides(this.panel.seriesOverrides),n.unit&&(this.panel.yaxes[n.yaxis-1].format=n.unit)}},e.prototype.changeSeriesColor=function(t,e){t.color=e,this.panel.aliasColors[t.alias]=t.color,this.render()},e.prototype.toggleSeries=function(t,e){e.ctrlKey||e.metaKey||e.shiftKey?this.hiddenSeries[t.alias]?delete this.hiddenSeries[t.alias]:this.hiddenSeries[t.alias]=!0:this.toggleSeriesExclusiveMode(t),this.render()},e.prototype.toggleSeriesExclusiveMode=function(t){var e=this,n=this.hiddenSeries;n[t.alias]&&delete n[t.alias],s.a.every(this.seriesList,function(e){return e.alias===t.alias||n[e.alias]})?s.a.each(this.seriesList,function(t){delete e.hiddenSeries[t.alias]}):s.a.each(this.seriesList,function(n){n.alias!==t.alias&&(e.hiddenSeries[n.alias]=!0)})},e.prototype.toggleAxis=function(t){var e=s.a.find(this.panel.seriesOverrides,{alias:t.alias});e||(e={alias:t.alias},this.panel.seriesOverrides.push(e)),t.yaxis=e.yaxis=2===t.yaxis?1:2,this.render()},e.prototype.addSeriesOverride=function(t){this.panel.seriesOverrides.push(t||{})},e.prototype.removeSeriesOverride=function(t){this.panel.seriesOverrides=s.a.without(this.panel.seriesOverrides,t),this.render()},e.prototype.toggleLegend=function(){this.panel.legend.show=!this.panel.legend.show,this.refresh()},e.prototype.legendValuesOptionChanged=function(){var t=this.panel.legend;t.values=t.min||t.max||t.avg||t.current||t.total,this.render()},e.prototype.exportCsv=function(){var t=this.$scope.$new(!0);t.seriesList=this.seriesList,this.publishAppEvent("show-modal",{templateHtml:'<export-data-modal data="seriesList"></export-data-modal>',scope:t,modalClass:"modal--narrow"})},e.template=i.a,e}(u.MetricsPanelCtrl)},1484:function(t,e,n){"use strict";function r(t,e,n,r){return{restrict:"A",template:"",link:function(t,n){function a(t){if(!L.legend.show||L.legend.rightSide)return 0;if(L.legend.alignAsTable){var e=g.a.filter(I,function(t){return!1===t.hideFromLegend(L.legend)}),n=23+21*e.length;return Math.min(n,Math.floor(t/2))}return 26}function i(){try{var t=q.height-a(q.height);return n.css("height",t+"px"),!0}catch(t){return console.log(t),!1}}function o(){return!I||(!i()||0===B)}function s(e){for(var r=e.getYAxes(),a=0;a<I.length;a++){var i=I[a],o=r[i.yaxis||0],s=b.default.valueFormats[L.yaxes[i.yaxis||0].format];if(g.a.isNumber(L.decimals))i.updateLegendValues(s,L.decimals,null);else{var l=((o?o.tickDecimals:0)||-1)+1;i.updateLegendValues(s,l,o?o.scaledDecimals:2)}U.$$phase||t.$digest()}L.yaxes[0].label&&L.yaxes[0].show&&f()("<div class='axisLabel left-yaxis-label flot-temp-elem'></div>").text(L.yaxes[0].label).appendTo(n),L.yaxes[1].label&&L.yaxes[1].show&&f()("<div class='axisLabel right-yaxis-label flot-temp-elem'></div>").text(L.yaxes[1].label).appendTo(n),Q.draw(e)}function l(t,e){var n=L.yaxes[0],r=L.yaxes[1];n.show&&n.label&&(e.left=20),r.show&&r.label&&(e.right=20);for(var a=t.getYAxes(),i=0;i<a.length;i++){var o=a[i],s=L.yaxes[i];o.options.max=null!==o.options.max?o.options.max:s.max,o.options.min=null!==o.options.min?o.options.min:s.min}}function u(t){for(var e=Number.MAX_VALUE,n=0;n<t.length;n++)if(t[n].stats.timeStep){if(L.bars){if(t[n].bars&&!1===t[n].bars.show)continue}else if(void 0===t[n].bars||void 0===t[n].bars.show||!t[n].bars.show)continue;t[n].stats.timeStep<e&&(e=t[n].stats.timeStep)}return e}function c(){function t(t){try{F=f.a.plot(n,R,r),q.renderError&&(delete q.error,delete q.inspector)}catch(t){console.log("flotcharts error",t),q.error=t.message||"Render Error",q.renderError=!0,q.inspector={error:t}}t&&q.renderingCompleted()}if(B=n.width(),!o()){Q.prepare(n,I),L.dashes=!!L.lines&&L.dashes;for(var e=!!L.stack||null,r={hooks:{draw:[s],processOffset:[l]},legend:{show:!1},series:{stackpercent:!!L.stack&&L.percentage,stack:L.percentage?null:e,lines:{show:L.lines,zero:!1,fill:h(L.fill),lineWidth:L.dashes?0:L.linewidth,steps:L.steppedLine},dashes:{show:L.dashes,lineWidth:L.linewidth,dashLength:[L.dashLength,L.spaceLength]},bars:{show:L.bars,fill:1,barWidth:1,zero:!1,lineWidth:0},points:{show:L.points,fill:1,fillColor:!1,radius:L.points?L.pointradius:2},shadowSize:0},yaxes:[],xaxis:{},grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#c8c8c8",margin:{left:0,right:0},labelMarginX:0},selection:{mode:"x",color:"#666"},crosshair:{mode:"x"}},a=0;a<I.length;a++){var i=I[a];i.data=i.getFlotPairs(i.nullPointMode||L.nullPointMode),q.hiddenSeries[i.alias]&&(i.data=[],i.stack=!1)}switch(L.xaxis.mode){case"series":r.series.bars.barWidth=.7,r.series.bars.align="center";for(var a=0;a<I.length;a++){var i=I[a];i.data=[[a+1,i.stats[L.xaxis.values[0]]]]}v(r);break;case"histogram":var c=void 0,y=Object(T.b)(I);if(I.length&&y.length){var b=g.a.min(g.a.map(I,function(t){return t.stats.min})),S=g.a.max(g.a.map(I,function(t){return t.stats.max})),k=L.xaxis.buckets||B/50;c=Object(x.tickStep)(b,S,k);var _=Object(T.a)(y,c);I[0].data=_,r.series.bars.barWidth=.8*c}else c=0;w(r,c);break;case"table":r.series.bars.barWidth=.7,r.series.bars.align="center",C(r);break;default:r.series.bars.barWidth=u(I)/1.5,m(r)}Q.addFlotOptions(r,L),z.addFlotEvents(N,r),P(I,r),R=p(I,q.panel),d(L)?(t(!1),setTimeout(function(){t(!0)},50),V=L.legend.rightSide):t(!0)}}function p(t,e){var n=e.legend.sort,r=e.legend.sortDesc,a=null!==n||void 0!==n,i=null!==r||void 0!==r;if(e.stack&&a&&i){var o=o=!0===e.legend.sortDesc?-1:1;t.sort(function(t,e){return t.stats[n]>e.stats[n]?1*o:t.stats[n]<e.stats[n]?-1*o:0})}return t.sort(function(t,e){return t.zindex>e.zindex?1:t.zindex<e.zindex?-1:0}),t}function h(t){return L.percentage&&L.stack&&0===t?.001:t/10}function d(t){return!!t.legend.rightSide||null!==V&&t.legend.rightSide!==V}function m(t){var e=B/100,n=g.a.isUndefined(q.range.from)?null:q.range.from.valueOf(),r=g.a.isUndefined(q.range.to)?null:q.range.to.valueOf();t.xaxis={timezone:j.getTimezone(),show:L.xaxis.show,mode:"time",min:n,max:r,label:"Datetime",ticks:e,timeformat:$(e,n,r)}}function v(t){var e=g.a.map(I,function(t,e){return[e+1,t.alias]});t.xaxis={timezone:j.getTimezone(),show:L.xaxis.show,mode:null,min:0,max:e.length+1,label:"Datetime",ticks:e}}function w(t,e){var n,r,a,i=B/50;if(I.length&&e){n=g.a.map(I[0].data,function(t){return t[0]}),r=g.a.min(n),a=g.a.max(n);for(var o=e,s=Math.floor((a-r)/o);s>i;)o*=2,s=Math.ceil((a-r)/o);r=Math.floor(r/o)*o,a=Math.ceil(a/o)*o,n=[];for(var l=r;l<=a;l+=o)n.push(l)}else n=i/2,r=0,a=1;t.xaxis={timezone:j.getTimezone(),show:L.xaxis.show,mode:null,min:r,max:a,label:"Histogram",ticks:n},D(t.xaxis,"short")}function C(t){var e=g.a.map(I,function(t,e){return g.a.map(t.datapoints,function(n,r){return[e*t.datapoints.length+r+1,n[1]]})});e=g.a.flatten(e,!0),t.xaxis={timezone:j.getTimezone(),show:L.xaxis.show,mode:null,min:0,max:e.length+1,label:"Datetime",ticks:e}}function P(t,e){var n={position:"left",show:L.yaxes[0].show,index:1,logBase:L.yaxes[0].logBase||1,min:O(L.yaxes[0].min),max:O(L.yaxes[0].max),tickDecimals:L.yaxes[0].decimals};if(e.yaxes.push(n),g.a.find(t,{yaxis:2})){var r=g.a.clone(n);r.index=2,r.show=L.yaxes[1].show,r.logBase=L.yaxes[1].logBase||1,r.position="right",r.min=O(L.yaxes[1].min),r.max=O(L.yaxes[1].max),r.tickDecimals=L.yaxes[1].decimals,e.yaxes.push(r),A(e.yaxes[1],t),D(e.yaxes[1],L.percentage&&L.stack?"percent":L.yaxes[1].format)}A(e.yaxes[0],t),D(e.yaxes[0],L.percentage&&L.stack?"percent":L.yaxes[0].format)}function O(t){return null===t||void 0===t?null:g.a.toNumber(t)}function A(t,e){if(1!==t.logBase){var n=0===t.min;t.min<Number.MIN_VALUE&&(t.min=null),t.max<Number.MIN_VALUE&&(t.max=null);var r,a,i=t.max,o=t.min;for(a=0;a<e.length;a++)r=e[a],r.yaxis===t.index&&((!i||i<r.stats.max)&&(i=r.stats.max),(!o||o>r.stats.logmin)&&(o=r.stats.logmin));t.transform=function(e){return e<Number.MIN_VALUE?null:Math.log(e)/Math.log(t.logBase)},t.inverseTransform=function(e){return Math.pow(t.logBase,e)},i||o?i?o||(o=i*t.inverseTransform(-4)):i=o*t.inverseTransform(4):(i=t.inverseTransform(2),o=t.inverseTransform(-2)),o=t.min?t.inverseTransform(Math.ceil(t.transform(t.min))):t.min=t.inverseTransform(Math.floor(t.transform(o))),i=t.max?t.inverseTransform(Math.floor(t.transform(t.max))):t.max=t.inverseTransform(Math.ceil(t.transform(i))),!o||o<Number.MIN_VALUE||!i||i<Number.MIN_VALUE||(Number.isFinite(o)&&Number.isFinite(i)?(n&&(t.min=.1,o=1),t.ticks=E(o,i,t.logBase),n&&t.ticks.unshift(.1),t.ticks[t.ticks.length-1]>t.max&&(t.max=t.ticks[t.ticks.length-1])):(t.ticks=[1,2],delete t.min,delete t.max))}}function E(t,e,n){var r,a=[];for(r=t;r<=e;r*=n)a.push(r);var i=Math.ceil(q.height/25),o=a.length;if(o>i){var s=Math.ceil(o/i)*n;for(a=[],r=t;r<=e*s;r*=s)a.push(r)}return a}function D(t,e){t.tickFormatter=function(t,n){return b.default.valueFormats[e](t,n.tickDecimals,n.scaledDecimals)}}function $(t,e,n){if(e&&n&&t){var r=n-e,a=r/t/1e3;return a<=45?"%H:%M:%S":a<=7200||r<=864e5?"%H:%M":a<=8e4?"%m/%d %H:%M":a<=2419200||r<=31536e6?"%m/%d":"%Y-%m"}return"%H:%M"}var I,F,R,q=t.ctrl,j=q.dashboard,L=q.panel,N=[],V=null,U=t.$root,B=0,z=new M.EventManager(q),Q=new _.a(q),H=new k.a(n,j,t,function(){return R});q.events.on("panel-teardown",function(){Q=null,F&&(F.destroy(),F=null)}),q.events.on("render",function(t){(I=t||I)&&(N=q.annotations||[],c())}),S.appEvents.on("graph-hover",function(t){j.sharedTooltipModeEnabled()&&F&&t.panel.id!==L.id&&!q.otherPanelInFullscreenMode()&&H.show(t.pos)},t),S.appEvents.on("graph-hover-clear",function(t,e){F&&H.clear(F)},t),n.bind("plotselected",function(n,a){(a.ctrlKey||a.metaKey)&&r.isEditor?setTimeout(function(){z.updateTime(a.xaxis)},100):t.$apply(function(){e.setTime({from:y.a.utc(a.xaxis.from),to:y.a.utc(a.xaxis.to)})})}),n.bind("plotclick",function(t,e,n){if((e.ctrlKey||e.metaKey)&&r.isEditor){e.x!==e.x1||setTimeout(function(){z.updateTime({from:e.x,to:null})},100)}}),t.$on("$destroy",function(){H.destroy(),n.off(),n.remove()})}}}r.$inject=["$rootScope","timeSrv","popoverSrv","contextSrv"];var a=n(1315),i=(n.n(a),n(1334)),o=(n.n(i),n(1335)),s=(n.n(o),n(1336)),l=(n.n(s),n(1337)),u=(n.n(l),n(1338)),c=(n.n(u),n(1339)),p=(n.n(c),n(1340)),h=(n.n(p),n(1485)),d=(n.n(h),n(13)),f=n.n(d),m=n(7),g=n.n(m),v=n(1),y=n.n(v),b=n(464),x=n(1314),S=n(465),w=n(1486),k=n.n(w),_=n(1487),M=n(1316),T=n(1488);S.coreModule.directive("grafanaGraph",r)},1485:function(t,e,n){var r,a;r=[n(13),n(7),n(12),n(79)],void 0!==(a=function(t,e,n,r){"use strict";function a(t,e,a){var i=n.element(document).injector(),o=document.createElement("div");o.innerHTML='<annotation-tooltip event="event" on-edit="onEdit()"></annotation-tooltip>',i.invoke(["$compile","$rootScope",function(n,i){var s=a.getOptions().events.manager,l=i.$new(!0);l.event=e,l.onEdit=function(){s.editEvent(e)},n(o)(l),l.$digest(),l.$destroy();var u=new r({target:t[0],content:o,position:"bottom center",classes:"drop-popover drop-popover--annotation",openOn:"hover",hoverCloseDelay:200,tetherOptions:{constraints:[{to:"window",pin:!0,attachment:"both"}]}});u.open(),u.on("close",function(){setTimeout(function(){u.destroy()})})}])}function i(t,e,a){var i=a.getOptions().events.manager;if(i.editorOpen)return void(s=t);i.editorOpened(),s=t,setTimeout(function(){var t=n.element(document).injector(),a=document.createElement("div");a.innerHTML='<event-editor panel-ctrl="panelCtrl" event="event" close="close()"></event-editor>',t.invoke(["$compile","$rootScope",function(t,n){var o,l=n.$new(!0);l.event=e,l.panelCtrl=i.panelCtrl,l.close=function(){o.close()},t(a)(l),l.$digest(),o=new r({target:s[0],content:a,position:"bottom center",classes:"drop-popover drop-popover--form",openOn:"click",tetherOptions:{constraints:[{to:"window",pin:!0,attachment:"both"}]}}),o.open(),i.editorOpened(),o.on("close",function(){setTimeout(function(){i.editorClosed(),l.$destroy(),o.destroy()})})}])},100)}function o(e){var n=this,r=new c(e);e.getEvents=function(){return r._events},e.hideEvents=function(){t.each(r._events,function(t,e){e.visual().getObject().hide()})},e.showEvents=function(){e.hideEvents(),t.each(r._events,function(t,e){e.hide()}),n.eventMarkers.drawEvents()},e.setEvents=function(t){r.eventsEnabled&&r.setupEvents(t)},e.hooks.processOptions.push(function(t,e){null!=e.events.data&&(r.eventsEnabled=!0)}),e.hooks.draw.push(function(t){var e=t.getOptions();r.eventsEnabled&&(r.getEvents().length<1?(r.setTypes(e.events.types),r.setupEvents(e.events.data)):r.updateEvents()),r.drawEvents()})}var s=null,l=function(t,e,n,r,a,i,o,s){var l=t,u=e,c=n,p=r,h={left:a,top:i},d=o,f=s;this.width=function(){return d},this.height=function(){return f},this.position=function(){return h},this.draw=function(){u(l)},this.clear=function(){c(l)},this.getObject=function(){return l},this.moveTo=function(t){h=t,p(l,h)}},u=function(t,e){var n=t,r=e,a=!1;this.visual=function(){return r},this.getOptions=function(){return n},this.getParent=function(){},this.isHidden=function(){return a},this.hide=function(){a=!0},this.unhide=function(){a=!1}},c=function(n){var r=[];this._types=[],this._plot=n,this.eventsEnabled=!1,this.getEvents=function(){return r},this.setTypes=function(t){return this._types=t},this.setupEvents=function(n){var a=this,i=e.partition(n,"isRegion"),o=i[0];n=i[1],t.each(n,function(t,e){var n=new u(e,a._buildDiv(e));r.push(n)}),t.each(o,function(t,e){var n=new u(e,a._buildRegDiv(e));r.push(n)}),r.sort(function(t,e){var n=t.getOptions(),r=e.getOptions();return n.min>r.min?1:n.min<r.min?-1:0})},this.drawEvents=function(){var e=this;t.each(r,function(t,n){e._insidePlot(n.getOptions().min)&&!n.isHidden()?n.visual().draw():n.visual().getObject().hide()})},this.updateEvents=function(){var e,n,a=this,i=this._plot.getPlotOffset(),o=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];t.each(r,function(t,r){n=i.top+a._plot.height()-r.visual().height(),e=o.p2c(r.getOptions().min)+i.left-r.visual().width()/2,r.visual().moveTo({top:n,left:e})})},this._clearEvents=function(){t.each(r,function(t,e){e.visual().clear()}),r=[]},this._buildDiv=function(e){var n,r,o,s,u,c,p,h,d=this,f=this._plot.getPlaceholder(),m=this._plot.getPlotOffset(),g=this._plot.getAxes(),v=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];g.yaxis&&g.yaxis.used&&g.yaxis,g.yaxis2&&g.yaxis2.used&&g.yaxis2;var y=e.eventType;o=null!==this._types&&this._types[y]&&this._types[y].color?this._types[y].color:"#666",s=null!==this._types&&this._types[y]&&this._types[y].markerSize?this._types[y].markerSize:8,u=null===this._types||!this._types[y]||void 0===this._types[y].markerShow||this._types[y].markerShow,h=null===this._types||!this._types[y]||void 0===this._types[y].markerTooltip||this._types[y].markerTooltip,c=null!=this._types&&this._types[y]&&this._types[y].lineStyle?this._types[y].lineStyle.toLowerCase():"dashed",p=null!=this._types&&this._types[y]&&void 0!==this._types[y].lineWidth?this._types[y].lineWidth:1;var b=v.options.eventSectionHeight||0;b/=3,n=m.top+this._plot.height()+b,r=v.p2c(e.min)+m.left;var x=t('<div class="events_line flot-temp-elem"></div>').css({position:"absolute",opacity:.8,left:r+"px",top:8,width:p+"px",height:this._plot.height()+.8*b,"border-left-width":p+"px","border-left-style":c,"border-left-color":o,color:o}).appendTo(f);if(u){var S=t('<div class="events_marker"></div>').css({position:"absolute",left:-s-Math.round(p/2)+"px","font-size":0,"line-height":0,width:0,height:0,"border-left":s+"px solid transparent","border-right":s+"px solid transparent"});S.appendTo(x),this._types[y]&&this._types[y].position&&"BOTTOM"===this._types[y].position.toUpperCase()?S.css({top:n-s-8+"px","border-top":"none","border-bottom":s+"px solid "+o}):S.css({top:"0px","border-top":s+"px solid "+o,"border-bottom":"none"}),S.data({event:e});var w=function(){a(S,t(this).data("event"),d._plot)};e.editModel&&i(S,e.editModel,d._plot);var k=function(){d._plot.clearSelection()};h&&(S.css({cursor:"help"}),S.hover(w,k))}return new l(x,function(t){t.show()},function(t){t.remove()},function(t,e){t.css({top:e.top,left:e.left})},r,n,x.width(),x.height())},this._buildRegDiv=function(n){var r,o,s,u,c,p,h,d=this,f=this._plot.getPlaceholder(),m=this._plot.getPlotOffset(),g=this._plot.getAxes(),v=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1];g.yaxis&&g.yaxis.used&&g.yaxis,g.yaxis2&&g.yaxis2.used&&g.yaxis2;var y=n.eventType;p=null!==this._types&&this._types[y]&&this._types[y].color?this._types[y].color:"#666",h=null===this._types||!this._types[y]||void 0===this._types[y].markerTooltip||this._types[y].markerTooltip,s=null!=this._types&&this._types[y]&&void 0!==this._types[y].lineWidth?this._types[y].lineWidth:1,c=null!=this._types&&this._types[y]&&this._types[y].lineStyle?this._types[y].lineStyle.toLowerCase():"dashed";r=m.top+this._plot.height()+2;var b=Math.min(n.min,n.timeEnd),x=Math.max(n.min,n.timeEnd);o=v.p2c(b)+m.left;var S=v.p2c(x)+m.left;u=S-o,e.each([o,S],function(e){t('<div class="events_line flot-temp-elem"></div>').css({position:"absolute",opacity:.8,left:e+"px",top:8,width:s+"px",height:d._plot.height()+2,"border-left-width":s+"px","border-left-style":c,"border-left-color":p,color:p}).appendTo(f)});var w=t('<div class="events_marker region_marker flot-temp-elem"></div>').css({position:"absolute",opacity:.5,left:o+"px",top:r,width:Math.round(u+s)+"px",height:"0.5rem","border-left-color":p,color:p,"background-color":p});w.appendTo(f),w.data({event:n});var k=function(){a(w,t(this).data("event"),d._plot)};n.editModel&&i(w,n.editModel,d._plot);var _=function(){d._plot.clearSelection()};return h&&(w.css({cursor:"help"}),w.hover(k,_)),new l(w,function(t){t.show()},function(t){t.remove()},function(t,e){t.css({top:e.top,left:e.left})},o,r,w.width(),w.height())},this._insidePlot=function(t){var e=this._plot.getXAxes()[this._plot.getOptions().events.xaxis-1],n=e.p2c(t);return n>0&&n<e.p2c(e.max)}},p={events:{data:null,types:null,xaxis:1,position:"BOTTOM"}};t.plot.plugins.push({init:o,options:p,name:"events",version:"0.2.5"})}.apply(e,r))&&(t.exports=a)},1486:function(t,e,n){var r,a;r=[n(13),n(465)],void 0!==(a=function(t,e){"use strict";function n(e,n,a,i){var o=this,s=a.ctrl,l=s.panel,u=t('<div class="graph-tooltip">');this.destroy=function(){u.remove()},this.findHoverIndexFromDataPoints=function(t,e,n){for(var r=e.datapoints.pointsize,a=n*r,i=e.datapoints.points.length,o=a;o<i;o+=r)if(!e.lines.steps&&null!=e.datapoints.points[a]&&null==e.datapoints.points[o]||e.datapoints.points[o]>t)return Math.max(o-r,0)/r;return o/r-1},this.findHoverIndexFromData=function(t,e){for(var n,r=0,a=e.data.length-1;;){if(r>a)return Math.max(a,0);if(n=Math.floor((r+a)/2),e.data[n][0]===t)return n;e.data[n][0]<t?r=n+1:a=n-1}},this.renderAndShow=function(t,e,n,r){"time"===r&&(e='<div class="graph-tooltip-time">'+t+"</div>"+e),u.html(e).place_tt(n.pageX+20,n.pageY)},this.getMultiSeriesPlotHoverInfo=function(t,e){var n,r,a,i,o,s,u,c,p,h=[[],[],[]],d=0;for(r=0;r<t.length;r++)a=t[r],!a.data.length||l.legend.hideEmpty&&a.allIsNull?h[0].push({hidden:!0,value:0}):!a.data.length||l.legend.hideZero&&a.allIsZero?h[0].push({hidden:!0,value:0}):(i=this.findHoverIndexFromData(e.x,a),o=e.x-a.data[i][0],s=a.data[i][0],(!c||o>=0&&(o<c||c<0)||o<0&&o>c)&&(c=o,p=s),a.stack?"individual"===l.tooltip.value_type?n=a.data[i][1]:a.stack?(d+=a.data[i][1],n=d):n=a.data[i][1]:n=a.data[i][1],(a.lines.steps||a.stack)&&(i=this.findHoverIndexFromDataPoints(e.x,a,i)),u=0,a.yaxis&&(u=a.yaxis.n),h[u].push({value:n,hoverIndex:i,color:a.color,label:a.aliasEscaped,time:s,distance:o,index:r}));return h=h[0].concat(h[1],h[2]),h.time=p,h},e.mouseleave(function(){if(l.tooltip.shared){var t=e.data().plot;t&&(u.detach(),t.unhighlight())}r.emit("graph-hover-clear")}),e.bind("plothover",function(t,n,a){o.show(n,a),n.panelRelY=(n.pageY-e.offset().top)/e.height(),r.emit("graph-hover",{pos:n,panel:l})}),e.bind("plotclick",function(t,e,n){r.emit("graph-click",{pos:e,panel:l,item:n})}),this.clear=function(t){u.detach(),t.clearCrosshair(),t.unhighlight()},this.show=function(r,a){var s,c,p,h,d,f,m,g,v=e.data().plot,y=v.getData(),b=v.getXAxes(),x=b[0].options.mode,S=i(),w=l.tooltip.shared;if(r.panelRelY){var k=v.pointOffset({x:r.x});if(Number.isNaN(k.left)||k.left<0||k.left>e.width())return void o.clear(v);r.pageX=e.offset().left+k.left,r.pageY=e.offset().top+e.height()*r.panelRelY;if(!(r.pageY>=t(window).scrollTop()&&r.pageY<=t(window).innerHeight()+t(window).scrollTop()))return void o.clear(v);if(v.setCrosshair(r),w=!0,n.sharedCrosshairModeOnly())return}if(0!==S.length)if(g=S[0].hasMsResolution?"YYYY-MM-DD HH:mm:ss.SSS":"YYYY-MM-DD HH:mm:ss",w){v.unhighlight();var _=o.getMultiSeriesPlotHoverInfo(y,r);for(m="",p=n.formatDate(_.time,g),2===l.tooltip.sort?_.sort(function(t,e){return e.value-t.value}):1===l.tooltip.sort&&_.sort(function(t,e){return t.value-e.value}),d=0;d<_.length;d++)if(h=_[d],!h.hidden){var M="";a&&h.index===a.seriesIndex&&(M="graph-tooltip-list-item--highlight"),f=S[h.index],c=f.formatValue(h.value),m+='<div class="graph-tooltip-list-item '+M+'"><div class="graph-tooltip-series-name">',m+='<i class="fa fa-minus" style="color:'+h.color+';"></i> '+h.label+":</div>",m+='<div class="graph-tooltip-value">'+c+"</div></div>",v.highlight(h.index,h.hoverIndex)}o.renderAndShow(p,m,r,x)}else a?(f=S[a.seriesIndex],s='<div class="graph-tooltip-list-item"><div class="graph-tooltip-series-name">',s+='<i class="fa fa-minus" style="color:'+a.series.color+';"></i> '+f.aliasEscaped+":</div>",c=l.stack&&"individual"===l.tooltip.value_type?a.datapoint[1]-a.datapoint[2]:a.datapoint[1],c=f.formatValue(c),p=n.formatDate(a.datapoint[0],g),s+='<div class="graph-tooltip-value">'+c+"</div>",o.renderAndShow(p,s,r,x)):u.detach()}}var r=e.appEvents;return n}.apply(e,r))&&(t.exports=a)},1487:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(1315),a=(n.n(r),n(13)),i=n.n(a),o=n(7),s=n.n(o),l=function(){function t(t){this.panelCtrl=t}return t.prototype.getHandleHtml=function(t,e,n){var r=e.colorMode;return"custom"===e.colorMode&&(r="critical"),'\n    <div class="alert-handle-wrapper alert-handle-wrapper--T'+t+'">\n      <div class="alert-handle-line alert-handle-line--'+r+'">\n      </div>\n      <div class="alert-handle" data-handle-index="'+t+'">\n        <i class="icon-gf icon-gf-'+r+" alert-state-"+r+'"></i>\n        <span class="alert-handle-value">'+n+'<i class="alert-handle-grip"></i></span>\n      </div>\n    </div>'},t.prototype.initDragging=function(t){function e(t){if(null===l)l=t.clientY;else{var e=t.clientY-l;r+=e,l=t.clientY,a.css({top:r+e})}}function n(){s=!1;var t=u.c2p({left:0,top:r}).y;t=parseInt(t.toFixed(0)),p.value=t,a.off("mousemove",e),a.off("mouseup",e),a.off("mouseleave",e),c.$scope.$apply(function(){c.render(),c.events.emit("threshold-changed",{threshold:p,handleIndex:o})})}var r,a=i()(t.currentTarget).parents(".alert-handle-wrapper"),o=i()(t.currentTarget).data("handleIndex"),s=!1,l=null,u=this.plot,c=this.panelCtrl,p=this.thresholds[o];s=!0,l=null,r=a.position().top,a.on("mousemove",e),a.on("mouseup",n),a.on("mouseleave",n)},t.prototype.cleanUp=function(){this.placeholder.find(".alert-handle-wrapper").remove(),this.needsCleanup=!1},t.prototype.renderHandle=function(t,e){var n=this.thresholds[t],r=n.value,a=r,o=0;if(s.a.isNumber(r)){var l=this.plot.p2c({x:0,y:r});o=Math.round(Math.min(Math.max(l.top,0),this.height)-6)}else a="",o=e;var u=i()(this.getHandleHtml(t,n,a));this.placeholder.append(u),u.toggleClass("alert-handle-wrapper--no-value",""===a),u.css({top:o})},t.prototype.shouldDrawHandles=function(){return!this.hasSecondYAxis&&this.panelCtrl.editingThresholds&&this.panelCtrl.panel.thresholds.length>0},t.prototype.prepare=function(t,e){this.hasSecondYAxis=!1;for(var n=0;n<e.length;n++)if(e[n].yaxis>1){this.hasSecondYAxis=!0;break}if(this.shouldDrawHandles()){var r=this.panelCtrl.panel.thresholds.length>1?"220px":"110px";t.css("margin-right",r)}else this.needsCleanup&&t.css("margin-right","0")},t.prototype.draw=function(t){this.thresholds=this.panelCtrl.panel.thresholds,this.plot=t,this.placeholder=t.getPlaceholder(),this.needsCleanup&&this.cleanUp(),this.shouldDrawHandles()&&(this.height=t.height(),this.thresholds.length>0&&this.renderHandle(0,10),this.thresholds.length>1&&this.renderHandle(1,this.height-30),this.placeholder.off("mousedown",".alert-handle"),this.placeholder.on("mousedown",".alert-handle",this.initDragging.bind(this)),this.needsCleanup=!0)},t.prototype.addFlotOptions=function(t,e){if(e.thresholds&&0!==e.thresholds.length){var n,r,a,i=1/0,o=-1/0;for(n=0;n<e.thresholds.length;n++)if(r=e.thresholds[n],s.a.isNumber(r.value)){var l;switch(r.op){case"gt":l=i,e.thresholds.length>n+1&&(a=e.thresholds[n+1],a.value>r.value&&(l=a.value,o=l));break;case"lt":l=o,e.thresholds.length>n+1&&(a=e.thresholds[n+1],a.value<r.value&&(l=a.value,i=l))}var u,c;switch(r.colorMode){case"critical":u="rgba(234, 112, 112, 0.12)",c="rgba(237, 46, 24, 0.60)";break;case"warning":u="rgba(235, 138, 14, 0.12)",c="rgba(247, 149, 32, 0.60)";break;case"ok":u="rgba(11, 237, 50, 0.090)",c="rgba(6,163,69, 0.60)";break;case"custom":u=r.fillColor,c=r.lineColor}r.fill&&t.grid.markings.push({yaxis:{from:r.value,to:l},color:u}),r.line&&t.grid.markings.push({yaxis:{from:r.value,to:r.value},color:c})}}},t}()},1488:function(t,e,n){"use strict";function r(t){for(var e=[],n=0;n<t.length;n++)for(var r=t[n],a=r.datapoints,i=0;i<a.length;i++)null!==a[i][0]&&e.push(a[i][0]);return e}function a(t,e){for(var n={},r=0;r<t.length;r++){var a=i(t[r],e);n[a]?n[a]=n[a]+1:n[a]=1}var o=s.a.map(n,function(t,e){return[Number(e),t]});return s.a.sortBy(o,function(t){return t[0]})}function i(t,e){return Math.floor(t/e)*e}e.b=r,e.a=a;var o=n(7),s=n.n(o)},1489:function(t,e,n){(function(t){var r,a;r=[n(12),n(7),n(13)],void 0!==(a=function(t,e,n){"use strict";t.module("grafana.directives").directive("graphLegend",["popoverSrv","$timeout",function(t,r){return{link:function(a,i){function o(t){return t.parents("[data-series-index]").data("series-index")}function s(e){if(!n(e.target).parents(".popover").length){var a=n(e.currentTarget).find(".fa-minus"),i=o(a),s=d[i];r(function(){t.show({element:a[0],position:"bottom center",template:'<series-color-picker series="series" onToggleAxis="toggleAxis" onColorChange="colorSelected"></series-color-picker>',openOn:"hover",model:{series:s,toggleAxis:function(){v.toggleAxis(s)},colorSelected:function(t){v.changeSeriesColor(s,t)}}})})}}function l(t){var e=n(t.currentTarget),r=o(e),a=d[r],i=n(m.children("tbody")).scrollTop();v.toggleSeries(a,t),n(m.children("tbody")).scrollTop(i)}function u(t){var e=n(t.currentTarget),r=e.data("stat");if(r!==y.legend.sort&&(y.legend.sortDesc=null),!1===y.legend.sortDesc)return y.legend.sort=null,y.legend.sortDesc=null,void v.render();y.legend.sortDesc=!y.legend.sortDesc,y.legend.sort=r,v.render()}function c(t){if(!y.legend[t])return"";var e='<th class="pointer" data-stat="'+t+'">'+t;return y.legend.sort===t&&(e+=' <span class="'+(y.legend.sortDesc?"fa fa-caret-down":"fa fa-caret-up")+'"></span>'),e+"</th>"}function p(){if(!v.panel.legend.show)return i.empty(),void(g=!0);g&&(i.append(m),m.on("click",".graph-legend-icon",s),m.on("click",".graph-legend-alias",l),m.on("click","th",u),g=!1),d=h,m.empty();var t=y.legend.rightSide&&y.legend.sideWidth?y.legend.sideWidth+"px":"";m.css("min-width",t),m.toggleClass("graph-legend-table",!0===y.legend.alignAsTable);var r;if(y.legend.alignAsTable){var a="<tr>";a+='<th colspan="2" style="text-align:left"></th>',y.legend.values&&(a+=c("min"),a+=c("max"),a+=c("avg"),a+=c("current"),a+=c("total")),a+="</tr>",r=n(a)}y.legend.sort&&(d=e.sortBy(d,function(t){return t.stats[y.legend.sort]}),y.legend.sortDesc&&(d=d.reverse()));var o=0,p=[];for(f=0;f<d.length;f++){var b=d[f];if(!b.hideFromLegend(y.legend)){var x='<div class="graph-legend-series';if(2===b.yaxis&&(x+=" graph-legend-series--right-y"),v.hiddenSeries[b.alias]&&(x+=" graph-legend-series-hidden"),x+='" data-series-index="'+f+'">',x+='<div class="graph-legend-icon">',x+='<i class="fa fa-minus pointer" style="color:'+b.color+'"></i>',x+="</div>",x+='<a class="graph-legend-alias pointer" title="'+b.aliasEscaped+'">'+b.aliasEscaped+"</a>",y.legend.values){var S=b.formatValue(b.stats.avg),w=b.formatValue(b.stats.current),k=b.formatValue(b.stats.min),_=b.formatValue(b.stats.max),M=b.formatValue(b.stats.total);y.legend.min&&(x+='<div class="graph-legend-value min">'+k+"</div>"),y.legend.max&&(x+='<div class="graph-legend-value max">'+_+"</div>"),y.legend.avg&&(x+='<div class="graph-legend-value avg">'+S+"</div>"),y.legend.current&&(x+='<div class="graph-legend-value current">'+w+"</div>"),y.legend.total&&(x+='<div class="graph-legend-value total">'+M+"</div>")}x+="</div>",p.push(n(x)),o++}}if(y.legend.alignAsTable){var T=v.height;y.legend.rightSide||(T/=2);var C=n("<tbody></tbody>");C.css("max-height",T-6),C.append(r),C.append(p),m.append(C)}else m.append(p)}var h,d,f,m=n('<section class="graph-legend"></section>'),g=!0,v=a.ctrl,y=v.panel;v.events.on("render",function(){(h=v.seriesList)&&p()})}}}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1490:function(t,e,n){(function(t){var r,a;r=[n(12),n(13),n(7)],void 0!==(a=function(t,e,n){"use strict";t.module("grafana.controllers").controller("SeriesOverridesCtrl",["$scope","$element","popoverSrv",function(t,e,r){t.overrideMenu=[],t.currentOverrides=[],t.override=t.override||{},t.addOverrideOption=function(e,r,a){var i={};i.text=e,i.propertyName=r,i.index=t.overrideMenu.length,i.values=a,i.submenu=n.map(a,function(t){return{text:String(t),value:t}}),t.overrideMenu.push(i)},t.setOverride=function(e,n){if("color"===e.propertyName)return void t.openColorSelector(t.override.color);t.override[e.propertyName]=n.value,"fillBelowTo"===e.propertyName&&(t.override.lines=!1,t.ctrl.addSeriesOverride({alias:n.value,lines:!1})),t.updateCurrentOverrides(),t.ctrl.render()},t.colorSelected=function(e){t.override.color=e,t.updateCurrentOverrides(),t.ctrl.render()},t.openColorSelector=function(n){var a={color:n};r.show({element:e.find(".dropdown")[0],position:"top center",openOn:"click",template:'<series-color-picker series="series" onColorChange="colorSelected" />',model:{autoClose:!0,colorSelected:t.colorSelected,series:a},onClose:function(){t.ctrl.render()}})},t.removeOverride=function(e){delete t.override[e.propertyName],t.updateCurrentOverrides(),t.ctrl.refresh()},t.getSeriesNames=function(){return n.map(t.ctrl.seriesList,function(t){return t.alias})},t.updateCurrentOverrides=function(){t.currentOverrides=[],n.each(t.overrideMenu,function(e){var r=t.override[e.propertyName];n.isUndefined(r)||t.currentOverrides.push({name:e.text,propertyName:e.propertyName,value:String(r)})})},t.addOverrideOption("Bars","bars",[!0,!1]),t.addOverrideOption("Lines","lines",[!0,!1]),t.addOverrideOption("Line fill","fill",[0,1,2,3,4,5,6,7,8,9,10]),t.addOverrideOption("Line width","linewidth",[0,1,2,3,4,5,6,7,8,9,10]),t.addOverrideOption("Null point mode","nullPointMode",["connected","null","null as zero"]),t.addOverrideOption("Fill below to","fillBelowTo",t.getSeriesNames()),t.addOverrideOption("Staircase line","steppedLine",[!0,!1]),t.addOverrideOption("Dashes","dashes",[!0,!1]),t.addOverrideOption("Dash Length","dashLength",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),t.addOverrideOption("Dash Space","spaceLength",[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),t.addOverrideOption("Points","points",[!0,!1]),t.addOverrideOption("Points Radius","pointradius",[1,2,3,4,5]),t.addOverrideOption("Stack","stack",[!0,!1,"A","B","C","D"]),t.addOverrideOption("Color","color",["change"]),t.addOverrideOption("Y-axis","yaxis",[1,2]),t.addOverrideOption("Z-index","zindex",[-3,-2,-1,0,1,2,3]),t.addOverrideOption("Transform","transform",["negative-Y"]),t.addOverrideOption("Legend","legend",[!0,!1]),t.updateCurrentOverrides()}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1491:function(t,e,n){"use strict";var r=n(2),a=function(){function t(t){var e=this;this.panel=this.panelCtrl.panel,this.panel.alert&&(this.disabled=!0);var n=t.$on("$destroy",function(){e.panelCtrl.editingThresholds=!1,e.panelCtrl.render(),n()});this.panelCtrl.editingThresholds=!0}return t.$inject=["$scope"],t.prototype.addThreshold=function(){this.panel.thresholds.push({value:void 0,colorMode:"critical",op:"gt",fill:!0,line:!0}),this.panelCtrl.render()},t.prototype.removeThreshold=function(t){this.panel.thresholds.splice(t,1),this.panelCtrl.render()},t.prototype.render=function(){this.panelCtrl.render()},t.prototype.onFillColorChange=function(t){var e=this;return function(n){e.panel.thresholds[t].fillColor=n,e.render()}},t.prototype.onLineColorChange=function(t){var e=this;return function(n){e.panel.thresholds[t].lineColor=n,e.render()}},t}();r.default.directive("graphThresholdForm",function(){return{restrict:"E",template:'\n<div class="gf-form-group">\n  <h5>Thresholds</h5>\n  <p class="muted" ng-show="ctrl.disabled">\n    Visual thresholds options <strong>disabled.</strong>\n    Visit the Alert tab update your thresholds. <br>\n    To re-enable thresholds, the alert rule must be deleted from this panel.\n  </p>\n  <div ng-class="{\'thresholds-form-disabled\': ctrl.disabled}">\n    <div class="gf-form-inline" ng-repeat="threshold in ctrl.panel.thresholds">\n      <div class="gf-form">\n        <label class="gf-form-label">T{{$index+1}}</label>\n      </div>\n\n      <div class="gf-form">\n        <div class="gf-form-select-wrapper">\n          <select class="gf-form-input" ng-model="threshold.op"\n                  ng-options="f for f in [\'gt\', \'lt\']" ng-change="ctrl.render()" ng-disabled="ctrl.disabled"></select>\n        </div>\n        <input type="number" ng-model="threshold.value" class="gf-form-input width-8"\n               ng-change="ctrl.render()" placeholder="value" ng-disabled="ctrl.disabled">\n      </div>\n\n      <div class="gf-form">\n        <label class="gf-form-label">Color</label>\n        <div class="gf-form-select-wrapper">\n          <select class="gf-form-input" ng-model="threshold.colorMode"\n                  ng-options="f for f in [\'custom\', \'critical\', \'warning\', \'ok\']" ng-change="ctrl.render()" ng-disabled="ctrl.disabled">\n          </select>\n        </div>\n      </div>\n\n      <gf-form-switch class="gf-form" label="Fill" checked="threshold.fill"\n                      on-change="ctrl.render()" ng-disabled="ctrl.disabled"></gf-form-switch>\n\n      <div class="gf-form" ng-if="threshold.fill && threshold.colorMode === \'custom\'">\n        <label class="gf-form-label">Fill color</label>\n        <span class="gf-form-label">\n          <color-picker color="threshold.fillColor" onChange="ctrl.onFillColorChange($index)"></color-picker>\n        </span>\n      </div>\n\n      <gf-form-switch class="gf-form" label="Line" checked="threshold.line"\n                      on-change="ctrl.render()" ng-disabled="ctrl.disabled"></gf-form-switch>\n\n      <div class="gf-form" ng-if="threshold.line && threshold.colorMode === \'custom\'">\n        <label class="gf-form-label">Line color</label>\n        <span class="gf-form-label">\n          <color-picker color="threshold.lineColor" onChange="ctrl.onLineColorChange($index)"></color-picker>\n        </span>\n      </div>\n\n      <div class="gf-form">\n        <label class="gf-form-label">\n          <a class="pointer" ng-click="ctrl.removeThreshold($index)" ng-disabled="ctrl.disabled">\n            <i class="fa fa-trash"></i>\n          </a>\n        </label>\n      </div>\n    </div>\n\n    <div class="gf-form-button-row">\n      <button class="btn btn-inverse" ng-click="ctrl.addThreshold()" ng-disabled="ctrl.disabled">\n        <i class="fa fa-plus"></i>&nbsp;Add Threshold\n      </button>\n    </div>\n  </div>\n</div>\n',controller:a,bindToController:!0,controllerAs:"ctrl",scope:{panelCtrl:"="}}})},1492:function(t,e,n){"use strict";e.a='\n<div class="graph-wrapper" ng-class="{\'graph-legend-rightside\': ctrl.panel.legend.rightSide}">\n  <div class="graph-canvas-wrapper">\n\n    <div class="datapoints-warning" ng-if="ctrl.dataWarning">\n      <span class="small" bs-tooltip="ctrl.dataWarning.tip">{{ctrl.dataWarning.title}}</span>\n    </div>\n\n    <div grafana-graph class="histogram-chart" ng-dblclick="ctrl.zoomOut()">\n    </div>\n\n  </div>\n\n  <div class="graph-legend-wrapper" graph-legend></div>\n  </div>\n\n<div class="clearfix"></div>\n'},1493:function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/graph/axes_editor.html",controller:i}}e.a=r;var a=n(464),i=function(){function t(t,e){this.$scope=t,this.$q=e,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.$scope.ctrl=this,this.unitFormats=a.default.getUnitFormats(),this.logScales={linear:1,"log (base 2)":2,"log (base 10)":10,"log (base 32)":32,"log (base 1024)":1024},this.xAxisModes={Time:"time",Series:"series",Histogram:"histogram"},this.xAxisStatOptions=[{text:"Avg",value:"avg"},{text:"Min",value:"min"},{text:"Max",value:"max"},{text:"Total",value:"total"},{text:"Count",value:"count"},{text:"Current",value:"current"}],"custom"===this.panel.xaxis.mode&&(this.panel.xaxis.name||(this.panel.xaxis.name="specify field"))}return t.$inject=["$scope","$q"],t.prototype.setUnitFormat=function(t,e){t.format=e.value,this.panelCtrl.render()},t.prototype.render=function(){this.panelCtrl.render()},t.prototype.xAxisModeChanged=function(){this.panelCtrl.processor.setPanelDefaultsForNewXAxisMode(),this.panelCtrl.onDataReceived(this.panelCtrl.dataList)},t.prototype.xAxisValueChanged=function(){this.panelCtrl.onDataReceived(this.panelCtrl.dataList)},t.prototype.getDataFieldNames=function(t){var e=this.panelCtrl.processor.getDataFieldNames(this.panelCtrl.dataList,t),n=e.map(function(t){return{text:t,value:t}});return this.$q.when(n)},t}()},1494:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DashListCtrl",function(){return l}),n.d(e,"PanelCtrl",function(){return l});var r=n(7),a=n.n(r),i=n(1305),o=n(1312),s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function e(e,n,r,i){var o=t.call(this,e,n)||this;return o.backendSrv=r,o.dashboardSrv=i,o.panelDefaults={query:"",limit:10,tags:[],recent:!1,search:!1,starred:!0,headings:!0},a.a.defaults(o.panel,o.panelDefaults),o.panel.tag&&(o.panel.tags=[o.panel.tag],delete o.panel.tag),o.events.on("refresh",o.onRefresh.bind(o)),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.groups=[{list:[],show:!1,header:"Starred dashboards"},{list:[],show:!1,header:"Recently viewed dashboards"},{list:[],show:!1,header:"Search"}],o.panel.mode&&("starred"===o.panel.mode&&(o.panel.starred=!0,o.panel.headings=!1),"recently viewed"===o.panel.mode&&(o.panel.recent=!0,o.panel.starred=!1,o.panel.headings=!1),"search"===o.panel.mode&&(o.panel.search=!0,o.panel.starred=!1,o.panel.headings=!1),delete o.panel.mode),o}return s(e,t),e.$inject=["$scope","$injector","backendSrv","dashboardSrv"],e.prototype.onInitEditMode=function(){this.editorTabIndex=1,this.modes=["starred","search","recently viewed"],this.addEditorTab("Options","public/app/plugins/panel/dashlist/editor.html")},e.prototype.onRefresh=function(){var t=[];return t.push(this.getRecentDashboards()),t.push(this.getStarred()),t.push(this.getSearch()),Promise.all(t).then(this.renderingCompleted.bind(this))},e.prototype.getSearch=function(){var t=this;if(this.groups[2].show=this.panel.search,!this.panel.search)return Promise.resolve();var e={limit:this.panel.limit,query:this.panel.query,tag:this.panel.tags};return this.backendSrv.search(e).then(function(e){t.groups[2].list=e})},e.prototype.getStarred=function(){var t=this;if(this.groups[0].show=this.panel.starred,!this.panel.starred)return Promise.resolve();var e={limit:this.panel.limit,starred:"true"};return this.backendSrv.search(e).then(function(e){t.groups[0].list=e})},e.prototype.starDashboard=function(t,e){this.dashboardSrv.starDashboard(t.id,t.isStarred).then(function(e){t.isStarred=e}),e&&(e.stopPropagation(),e.preventDefault())},e.prototype.getRecentDashboards=function(){var t=this;if(this.groups[1].show=this.panel.recent,!this.panel.recent)return Promise.resolve();var e=a.a.take(o.impressions.getDashboardOpened(),this.panel.limit);return this.backendSrv.search({dashboardIds:e,limit:this.panel.limit}).then(function(n){t.groups[1].list=e.map(function(t){return a.a.find(n,function(e){return e.id===t})}).filter(function(t){return void 0!==t})})},e.templateUrl="module.html",e}(i.PanelCtrl)},1495:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PluginListCtrl",function(){return s}),n.d(e,"PanelCtrl",function(){return s});var r=n(7),a=n.n(r),i=n(1313),o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),s=function(t){function e(e,n,r,i){var o=t.call(this,e,n)||this;return o.backendSrv=r,o.$location=i,o.panelDefaults={},a.a.defaults(o.panel,o.panelDefaults),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.pluginList=[],o.viewModel=[{header:"Installed Apps",list:[],type:"app"},{header:"Installed Panels",list:[],type:"panel"},{header:"Installed Datasources",list:[],type:"datasource"}],o.update(),o}return o(e,t),e.$inject=["$scope","$injector","backendSrv","$location"],e.prototype.onInitEditMode=function(){this.editorTabIndex=1,this.addEditorTab("Options","public/app/plugins/panel/pluginlist/editor.html")},e.prototype.gotoPlugin=function(t,e){e&&e.stopPropagation(),this.$location.url("plugins/"+t.id+"/edit")},e.prototype.updateAvailable=function(t,e){e.stopPropagation(),e.preventDefault();var n=this.$scope.$new(!0);n.plugin=t,this.publishAppEvent("show-modal",{src:"public/app/features/plugins/partials/update_instructions.html",scope:n})},e.prototype.update=function(){var t=this;this.backendSrv.get("api/plugins",{embedded:0,core:0}).then(function(e){t.pluginList=e,t.viewModel[0].list=a.a.filter(e,{type:"app"}),t.viewModel[1].list=a.a.filter(e,{type:"panel"}),t.viewModel[2].list=a.a.filter(e,{type:"datasource"});for(var n=0,r=t.pluginList;n<r.length;n++){var i=r[n];i.hasUpdate?i.state="has-update":i.enabled||(i.state="not-enabled")}})},e.templateUrl="module.html",e}(i.a)},1496:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AlertListPanel",function(){return p}),n.d(e,"PanelCtrl",function(){return p});var r=n(7),a=n.n(r),i=n(1),o=n.n(i),s=n(1307),l=n(1305),u=n(467),c=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t){function e(e,n,r){var i=t.call(this,e,n)||this;i.backendSrv=r,i.showOptions=[{text:"Current state",value:"current"},{text:"Recent state changes",value:"changes"}],i.sortOrderOptions=[{text:"Alphabetical (asc)",value:1},{text:"Alphabetical (desc)",value:2},{text:"Importance",value:3}],i.stateFilter={},i.currentAlerts=[],i.alertHistory=[],i.panelDefaults={show:"current",limit:10,stateFilter:[],onlyAlertsOnDashboard:!1,sortOrder:1},a.a.defaults(i.panel,i.panelDefaults),i.events.on("init-edit-mode",i.onInitEditMode.bind(i)),i.events.on("refresh",i.onRefresh.bind(i));for(var o in i.panel.stateFilter)i.stateFilter[i.panel.stateFilter[o]]=!0;return i}return c(e,t),e.$inject=["$scope","$injector","backendSrv"],e.prototype.sortResult=function(t){if(3===this.panel.sortOrder)return a.a.sortBy(t,function(t){return s.a.alertStateSortScore[t.state]});var e=a.a.sortBy(t,function(t){return t.name.toLowerCase()});return 2===this.panel.sortOrder&&e.reverse(),e},e.prototype.updateStateFilter=function(){var t=[];for(var e in this.stateFilter)this.stateFilter[e]&&t.push(e);this.panel.stateFilter=t,this.onRefresh()},e.prototype.onRefresh=function(){"current"===this.panel.show&&this.getCurrentAlertState(),"changes"===this.panel.show&&this.getStateChanges()},e.prototype.getStateChanges=function(){var t=this,e={limit:this.panel.limit,type:"alert",newState:this.panel.stateFilter};this.panel.onlyAlertsOnDashboard&&(e.dashboardId=this.dashboard.id),e.from=1e3*u.parse(this.dashboard.time.from).unix(),e.to=1e3*u.parse(this.dashboard.time.to).unix(),this.backendSrv.get("/api/annotations",e).then(function(e){t.alertHistory=a.a.map(e,function(e){return e.time=t.dashboard.formatDate(e.time,"MMM D, YYYY HH:mm:ss"),e.stateModel=s.a.getStateDisplayModel(e.newState),e.info=s.a.getAlertAnnotationInfo(e),e}),t.noAlertsMessage=0===t.alertHistory.length?"No alerts in current time range":""})},e.prototype.getCurrentAlertState=function(){var t=this,e={state:this.panel.stateFilter};this.panel.onlyAlertsOnDashboard&&(e.dashboardId=this.dashboard.id),this.backendSrv.get("/api/alerts",e).then(function(e){t.currentAlerts=t.sortResult(a.a.map(e,function(t){return t.stateModel=s.a.getStateDisplayModel(t.state),t.newStateDateAgo=o()(t.newStateDate).locale("en").fromNow(!0),t})),t.noAlertsMessage=0===t.currentAlerts.length?"No alerts":""})},e.prototype.onInitEditMode=function(){this.addEditorTab("Options","public/app/plugins/panel/alertlist/editor.html")},e.templateUrl="module.html",e}(l.PanelCtrl)},1497:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(n(1498),n(1499));n.d(e,"PanelCtrl",function(){return r.a})},1498:function(t,e,n){"use strict";function r(t,e,n,r,a,o){var s=y()(t).find("svg"),u=b.select(s.get(0));l(t);var c=Math.floor(s.outerWidth())-30,p=s.attr("height"),h=1;r-n>c&&(h=Math.floor((r-n)/c));var d=c/(r-n),f=b.range(n,r,h),m=Object(w.a)(e,x.contextSrv.user.lightTheme,a,o);u.selectAll(".heatmap-color-legend-rect").data(f).enter().append("rect").attr("x",function(t){return t*d}).attr("y",0).attr("width",h*d+1).attr("height",p).attr("stroke-width",0).attr("fill",function(t){return m(t)}),i(t,m,n,r,a,o,c)}function a(t,e,n,r,a,o){var s=y()(t).find("svg"),u=b.select(s.get(0));l(t);var c=Math.floor(s.outerWidth())-30,p=s.attr("height"),h=1;r-n>c&&(h=Math.floor((r-n)/c));var d=c/(r-n),f=b.range(n,r,h),m=Object(w.b)(e,a,o);u.selectAll(".heatmap-opacity-legend-rect").data(f).enter().append("rect").attr("x",function(t){return t*d}).attr("y",0).attr("width",h*d).attr("height",p).attr("stroke-width",0).attr("fill",e.cardColor).style("opacity",function(t){return m(t)}),i(t,m,n,r,a,o,c)}function i(t,e,n,r,a,i,o){var s=y()(t).find("svg"),l=b.select(s.get(0));if(!(o<=0||0===s.get(0).childNodes.length)){var h=b.scaleLinear().domain([0,r]).range([0,o]),d=p(0,r,a,i),f=b.axisBottom(h).tickValues(d).tickSize(2),m=s.find(":first-child"),g=c(s)+2,v=u(m);b.select(s.get(0)).append("g").attr("class","axis").attr("transform","translate("+v+","+g+")").call(f),l.select(".axis").select(".domain").remove()}}function o(t,e){var n=y()(t).find("svg");l(t);var r=Math.floor(n.outerWidth()),a=n.attr("height");if(r){var i=Math.floor(r/2),o=Math.floor(r/i),s=b.range(0,r,o);b.select(n.get(0)).selectAll(".heatmap-color-legend-rect").data(s).enter().append("rect").attr("x",function(t){return t}).attr("y",0).attr("width",o+1).attr("height",a).attr("stroke-width",0).attr("fill",function(t){return e(t)})}}function s(t,e){var n=y()(t).find("svg");l(t);var r=b.select(n.get(0)),a=Math.floor(n.outerWidth()),i=n.attr("height");if(a){var o;"linear"===e.colorScale?o=b.scaleLinear().domain([0,a]).range([0,1]):"sqrt"===e.colorScale&&(o=b.scalePow().exponent(e.exponent).domain([0,a]).range([0,1]));var s=b.range(0,a,10);r.selectAll(".heatmap-opacity-legend-rect").data(s).enter().append("rect").attr("x",function(t){return t}).attr("y",0).attr("width",10).attr("height",i).attr("stroke-width",0).attr("fill",e.cardColor).style("opacity",function(t){return o(t)})}}function l(t){y()(t).find("svg").empty()}function u(t){var e=t.get(0);return e&&e.x&&e.x.baseVal?e.x.baseVal.value:0}function c(t){var e=t.get(0);return e&&e.height&&e.height.baseVal?e.height.baseVal.value:0}function p(t,e,n,r){for(var a=e-t,i=Object(S.tickStep)(t,e,3),o=Math.round(a/i),s=[],l=0;l<o;l++){var u=i*l;h(r,u,i)?s.push(r):(r<u&&s.push(r),h(n,u,i)?s.push(n):(n<u&&s.push(n),s.push(i*l)))}return h(n,e,i)||s.push(n),s.push(e),s=g.a.sortBy(g.a.uniq(s))}function h(t,e,n){return Math.abs(t-e)<.3*n}var d=n(12),f=n.n(d),m=n(7),g=n.n(m),v=n(13),y=n.n(v),b=n(470),x=n(465),S=n(1314),w=n(1342),t=f.a.module("grafana.directives");t.directive("colorLegend",function(){return{restrict:"E",template:'<div class="heatmap-color-legend"><svg width="16.8rem" height="24px"></svg></div>',link:function(t,e,n){function r(){var t=y()(e).find("svg"),n=Math.floor(t.outerWidth());if("spectrum"===i.color.mode){var r=g.a.find(a.colorSchemes,{value:i.color.colorScheme}),l=Object(w.a)(r,x.contextSrv.user.lightTheme,n);o(e,l)}else if("opacity"===i.color.mode){var u=i.color;s(e,u)}}var a=t.ctrl,i=t.ctrl.panel;r(),a.events.on("render",function(){r()})}}}),t.directive("heatmapLegend",function(){return{restrict:"E",template:'<div class="heatmap-color-legend"><svg width="100px" height="14px"></svg></div>',link:function(t,e,n){function i(){if(l(e),!g.a.isEmpty(o.data)&&!g.a.isEmpty(o.data.cards)){var t=o.data.cardStats.max,n=s.color.max||t,i=s.color.min||0;if("spectrum"===s.color.mode){var u=g.a.find(o.colorSchemes,{value:s.color.colorScheme});r(e,u,0,t,n,i)}else if("opacity"===s.color.mode){var c=s.color;a(e,c,0,t,n,i)}}}var o=t.ctrl,s=t.ctrl.panel;i(),o.events.on("render",function(){i()})}}})},1499:function(t,e,n){"use strict";n.d(e,"a",function(){return v});var r=n(1305),a=n(7),i=n.n(a),o=n(464),s=n(1309),l=n(1500),u=n(1501),c=n(1502),p=n(1319),h=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d={heatmap:{},cards:{cardPadding:null,cardRound:null},color:{mode:"spectrum",cardColor:"#b4ff00",colorScale:"sqrt",exponent:.5,colorScheme:"interpolateOranges"},legend:{show:!1},dataFormat:"timeseries",xAxis:{show:!0},yAxis:{show:!0,format:"short",decimals:null,logBase:1,splitFactor:null,min:null,max:null},xBucketSize:null,xBucketNumber:null,yBucketSize:null,yBucketNumber:null,tooltip:{show:!0,showHistogram:!1},highlightCards:!0},f=["opacity","spectrum"],m=["linear","sqrt"],g=[{name:"Spectral",value:"interpolateSpectral",invert:"always"},{name:"RdYlGn",value:"interpolateRdYlGn",invert:"always"},{name:"Blues",value:"interpolateBlues",invert:"dark"},{name:"Greens",value:"interpolateGreens",invert:"dark"},{name:"Greys",value:"interpolateGreys",invert:"dark"},{name:"Oranges",value:"interpolateOranges",invert:"dark"},{name:"Purples",value:"interpolatePurples",invert:"dark"},{name:"Reds",value:"interpolateReds",invert:"dark"},{name:"BuGn",value:"interpolateBuGn",invert:"dark"},{name:"BuPu",value:"interpolateBuPu",invert:"dark"},{name:"GnBu",value:"interpolateGnBu",invert:"dark"},{name:"OrRd",value:"interpolateOrRd",invert:"dark"},{name:"PuBuGn",value:"interpolatePuBuGn",invert:"dark"},{name:"PuBu",value:"interpolatePuBu",invert:"dark"},{name:"PuRd",value:"interpolatePuRd",invert:"dark"},{name:"RdPu",value:"interpolateRdPu",invert:"dark"},{name:"YlGnBu",value:"interpolateYlGnBu",invert:"dark"},{name:"YlGn",value:"interpolateYlGn",invert:"dark"},{name:"YlOrBr",value:"interpolateYlOrBr",invert:"dark"},{name:"YlOrRd",value:"interpolateYlOrRd",invert:"darm"}],v=function(t){function e(e,n,r,a){var o=t.call(this,e,n)||this;return o.$rootScope=r,o.opacityScales=[],o.colorModes=[],o.colorSchemes=[],o.$rootScope=r,o.timeSrv=a,o.selectionActivated=!1,i.a.defaultsDeep(o.panel,d),o.opacityScales=m,o.colorModes=f,o.colorSchemes=g,o.events.on("render",o.onRender.bind(o)),o.events.on("data-received",o.onDataReceived.bind(o)),o.events.on("data-error",o.onDataError.bind(o)),o.events.on("data-snapshot-load",o.onDataReceived.bind(o)),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.onCardColorChange=o.onCardColorChange.bind(o),o}return h(e,t),e.$inject=["$scope","$injector","$rootScope","timeSrv"],e.prototype.onInitEditMode=function(){this.addEditorTab("Axes",l.a,2),this.addEditorTab("Display",u.a,3),this.unitFormats=o.default.getUnitFormats()},e.prototype.zoomOut=function(t){this.publishAppEvent("zoom-out",2)},e.prototype.onRender=function(){if(this.range){var t,e,n,r,a=this.panel.yAxis.logBase;if("tsbuckets"===this.panel.dataFormat){n=this.parseHistogramSeries(this.series),r=Object(p.d)(this.series);var s=i.a.map(i.a.keys(r),function(t){return Number(t)}),l=i.a.map(this.series,function(t){return Number(t.alias)});t=Object(p.a)(s),e=Object(p.a)(l,a),1!==a&&(e=1/e)}else{var u=this.panel.xBucketNumber||30,c=Math.floor((this.range.to-this.range.from)/u);t=o.default.interval_regex.test(this.panel.xBucketSize)?o.default.interval_to_ms(this.panel.xBucketSize):isNaN(Number(this.panel.xBucketSize))||""===this.panel.xBucketSize||null===this.panel.xBucketSize?c:Number(this.panel.xBucketSize),n=this.parseSeries(this.series);var h=this.panel.yBucketNumber||10;1!==a?e=this.panel.yAxis.splitFactor:(e=n.max===n.min?n.max?n.max/10:1:(n.max-n.min)/h,e=this.panel.yBucketSize||e),r=Object(p.c)(this.series,e,t,a)}n.min||n.max||(n={min:-1,max:1,minLog:1},e=1);var d=Object(p.b)(r),f=d.cards,m=d.cardStats;this.data={buckets:r,heatmapStats:n,xBucketSize:t,yBucketSize:e,cards:f,cardStats:m}}},e.prototype.onDataReceived=function(t){if(this.series=t.map(this.seriesHandler.bind(this)),this.dataWarning=null,0===i.a.reduce(this.series,function(t,e){return t+e.datapoints.length},0))this.dataWarning={title:"No data points",tip:"No datapoints returned from data query"};else for(var e=0,n=this.series;e<n.length;e++){var r=n[e];if(r.isOutsideRange){this.dataWarning={title:"Data points outside time range",tip:"Can be caused by timezone mismatch or missing time filter in query"};break}}this.render()},e.prototype.onDataError=function(){this.series=[],this.render()},e.prototype.onCardColorChange=function(t){this.panel.color.cardColor=t,this.render()},e.prototype.seriesHandler=function(t){var e=new s.a({datapoints:t.datapoints,alias:t.target});e.flotpairs=e.getFlotPairs(this.panel.nullPointMode);var n=t.datapoints||[];if(n&&n.length>0){n[n.length-1][1]-this.range.from<-1e4&&(e.isOutsideRange=!0)}return e},e.prototype.parseSeries=function(t){var e=i.a.min(i.a.map(t,function(t){return t.stats.min})),n=i.a.min(i.a.map(t,function(t){return t.stats.logmin}));return{max:i.a.max(i.a.map(t,function(t){return t.stats.max})),min:e,minLog:n}},e.prototype.parseHistogramSeries=function(t){var e=i.a.map(t,function(t){return Number(t.alias)}),n=i.a.min(e),r=i.a.min(e);return{max:i.a.max(e),min:n,minLog:r}},e.prototype.link=function(t,e,n,r){Object(c.a)(t,e,n,r)},e.templateUrl="module.html",e}(r.MetricsPanelCtrl)},1500:function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/heatmap/partials/axes_editor.html",controller:i}}e.a=r;var a=n(464),i=function(){function t(t,e){t.editor=this,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.unitFormats=a.default.getUnitFormats(),this.logScales={linear:1,"log (base 2)":2,"log (base 10)":10,"log (base 32)":32,"log (base 1024)":1024},this.dataFormats={"Time series":"timeseries","Time series buckets":"tsbuckets"}}return t.$inject=["$scope","uiSegmentSrv"],t.prototype.setUnitFormat=function(t){this.panel.yAxis.format=t.value,this.panelCtrl.render()},t}()},1501:function(t,e,n){"use strict";function r(){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/heatmap/partials/display_editor.html",controller:a}}e.a=r;var a=function(){function t(t){t.editor=this,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.panelCtrl.render()}return t.$inject=["$scope"],t}()},1502:function(t,e,n){"use strict";function r(t,e,n,r){function s(){try{var t=r.height||pt.height||r.row.height;return l.a.isString(t)&&(t=parseInt(t.replace("px",""),10)),t-=5,t-=pt.title?24:9,At.css("height",t+"px"),!0}catch(t){return!1}}function u(t){var e=t.selectAll(".axis-y text").nodes();return l.a.max(l.a.map(e,function(t){return t.getBBox().width}))}function p(t){if(t.select(".axis-x line").empty())return 30;var e=parseFloat(t.select(".axis-x line").attr("y2"));return parseFloat(t.attr("height"))-e}function O(){t.xScale=gt=d.scaleTime().domain([ct.from,ct.to]).range([0,vt]);var e,n=vt/_,i=a(n,ct.from,ct.to);e="utc"===r.dashboard.getTimezone()?d.utcFormat(i):d.timeFormat(i);var o=d.axisBottom(gt).ticks(n).tickFormat(e).tickPadding(T).tickSize(yt),s=It.top,l=St;ht.append("g").attr("class","axis axis-x").attr("transform","translate("+l+","+s+")").call(o),ht.select(".axis-x").select(".domain").remove()}function A(){var e=Math.ceil(yt/M),n=Object(g.tickStep)(ut.heatmapStats.min,ut.heatmapStats.max,e),a=E(ut.heatmapStats.min,ut.heatmapStats.max,n),i=a.y_min,s=a.y_max;i=null!==pt.yAxis.min?pt.yAxis.min:i,s=null!==pt.yAxis.max?pt.yAxis.max:s,n=Object(g.tickStep)(i,s,e),e=Math.ceil((s-i)/n);var c=o(n),p=null===pt.yAxis.decimals?c:pt.yAxis.decimals,h=Object(g.getFlotTickSize)(i,s,e,c),f=Object(g.getScaledDecimals)(p,h);r.decimals=p,r.scaledDecimals=f,l.a.isEmpty(ut.buckets)&&(s=1,i=-1,e=3,p=1),ut.yAxis={min:i,max:s,ticks:e},t.yScale=mt=d.scaleLinear().domain([i,s]).range([yt,0]);var m=d.axisLeft(mt).ticks(e).tickFormat(q(p,f)).tickSizeInner(0-dt).tickSizeOuter(0).tickPadding(C);ht.append("g").attr("class","axis axis-y").call(m);var v=It.top,y=u(ht)+C;ht.select(".axis-y").attr("transform","translate("+y+","+v+")"),ht.select(".axis-y").select(".domain").remove()}function E(t,e,n){var r,a,i=(e*(Ft-1)-t*(Ft-1))/2;return 0===n?(a=e*Ft,r=t-t*(Ft-1),n=(a-r)/2):(a=Math.ceil((e+i)/n)*n,r=Math.floor((t-i)/n)*n),t>=0&&r<0&&(r=0),{y_min:r,y_max:a}}function D(){var e=pt.yAxis.logBase,n=$(ut.heatmapStats.minLog,ut.heatmapStats.max,e),a=n.y_min,i=n.y_max;a=pt.yAxis.min&&"0"!==pt.yAxis.min?F(pt.yAxis.min,e):a,i=null!==pt.yAxis.max?I(pt.yAxis.max,e):i,l.a.isEmpty(ut.buckets)&&(i=Math.pow(e,2),a=1),t.yScale=mt=d.scaleLog().base(pt.yAxis.logBase).domain([a,i]).range([yt,0]);var s=mt.domain(),c=R(s,e),p=o(a),h=pt.yAxis.decimals||p,f=Object(g.getFlotTickSize)(a,i,c.length,p),m=Object(g.getScaledDecimals)(h,f);r.decimals=h,r.scaledDecimals=m,ut.yAxis={min:a,max:i,ticks:c.length};var v=d.axisLeft(mt).tickValues(c).tickFormat(q(h,m)).tickSizeInner(0-dt).tickSizeOuter(0).tickPadding(C);ht.append("g").attr("class","axis axis-y").call(v);var y=It.top,b=u(ht)+C;ht.select(".axis-y").attr("transform","translate("+b+","+y+")"),a<1&&ht.select(".axis-y").select(".tick text").text("0"),ht.select(".axis-y").select(".domain").remove()}function $(t,e,n){var r,a;return r=ut.heatmapStats.minLog,r=ut.heatmapStats.minLog>1||!ut.heatmapStats.minLog?1:F(ut.heatmapStats.minLog,n),a=I(ut.heatmapStats.max,n),{y_min:r,y_max:a}}function I(t,e){return Math.pow(e,Math.ceil(i(t,e)))}function F(t,e){return Math.pow(e,Math.floor(i(t,e)))}function R(t,e){var n=t[0],r=t[1],a=[];if(n<1)for(var o=Math.floor(i(n,e)),s=o;s<0;s++){var l=Math.pow(e,s);a.push(l)}for(var u=Math.ceil(i(r,e)),s=0;s<=u;s++){var l=Math.pow(e,s);a.push(l)}return a}function q(t,e){void 0===e&&(e=null);var n=pt.yAxis.format;return function(r){return f.default.valueFormats[n](r,t,e)}}function j(){ht.select(".axis-y").selectAll(".tick line").attr("x2",vt)}function L(){yt=ft-It.top-It.bottom,bt=It.top,xt=bt+yt,1===pt.yAxis.logBase?A():D(),St=u(ht)+C,vt=dt-St-It.right,j(),O(),wt=p(ht),pt.yAxis.show||ht.select(".axis-y").selectAll("line").style("opacity",0),pt.xAxis.show||ht.select(".axis-x").selectAll("line").style("opacity",0)}function N(){var t=At[0];dt=Math.floor(At.width())-$t.right,ft=Math.floor(At.height())-$t.bottom,kt=null!==pt.cards.cardPadding?pt.cards.cardPadding:S,_t=null!==pt.cards.cardRound?pt.cards.cardRound:w,ht&&ht.remove(),ht=d.select(t).append("svg").attr("width",dt).attr("height",ft)}function V(){if(N(),L(),1!==pt.yAxis.logBase){var t=pt.yAxis.logBase,e=mt.domain(),n=R(e,t);ut.buckets=Object(y.f)(ut.buckets,l.a.min(n))}var a=ut.cards,i=ut.cardStats.max,o=pt.color.max||i,s=pt.color.min||0,u=l.a.find(r.colorSchemes,{value:pt.color.colorScheme});Ct=Object(b.a)(u,m.contextSrv.user.lightTheme,o,s),Pt=Object(b.b)(pt.color,o),z();var c=ht.selectAll(".heatmap-card").data(a);c.append("title"),c=c.enter().append("rect").attr("x",Q).attr("width",H).attr("y",Y).attr("height",W).attr("rx",_t).attr("ry",_t).attr("class","bordered heatmap-card").style("fill",G).style("stroke",G).style("stroke-width",0).style("opacity",K),At.find(".heatmap-card").on("mouseenter",function(t){Et.mouseOverBucket=!0,U(t)}).on("mouseleave",function(t){Et.mouseOverBucket=!1,B(t)})}function U(t){var e=d.select(t.target).style("fill"),n=d.color(e).darker(2),r=d.color(e).brighter(4),a=d.select(t.target);Et.originalFillColor=e,a.style("fill",n.toString()).style("stroke",r.toString()).style("stroke-width",1)}function B(t){d.select(t.target).style("fill",Et.originalFillColor).style("stroke",Et.originalFillColor).style("stroke-width",0)}function z(){var t=Math.floor(gt(ut.xBucketSize)-gt(0)),e=Math.floor(mt(mt.invert(0)-ut.yBucketSize));if(1!==pt.yAxis.logBase){var n=pt.yAxis.logBase,r=ut.yBucketSize||1;e=Math.floor((mt(1)-mt(n))/r)}Mt=t-2*kt,Tt=e?e-2*kt:0}function Q(t){return gt(t.x)<0?St+kt:gt(t.x)+St+kt}function H(t){var e;if(gt(t.x)<0){var n=gt(t.x)+Mt;e=n>0?n:0}else e=gt(t.x)+Mt>vt?vt-gt(t.x)-kt:Mt;return e=Math.max(e,x)}function Y(t){var e=mt(t.y)+bt-Tt-kt;return 1!==pt.yAxis.logBase&&0===t.y?e=xt-Tt-kt:e<bt&&(e=bt),e}function W(t){var e=mt(t.y)+bt-Tt-kt,n=Tt;return 1!==pt.yAxis.logBase&&0===t.y?Tt:(e<bt?n=mt(t.y)-kt:mt(t.y)>xt?n=xt-e:e+Tt>xt&&(n=xt-e),n=Math.min(n,yt),n=Math.max(n,x))}function G(t){return"opacity"===pt.color.mode?pt.color.cardColor:Ct(t.count)}function K(t){return"opacity"===pt.color.mode?Pt(t.count):1}function J(t){Dt.active=!0,Dt.x1=t.offsetX,Ot=function(){X()},c()(document).one("mouseup",Ot)}function X(){c()(document).unbind("mouseup",Ot),Ot=null,Dt.active=!1;var t=Math.abs(Dt.x2-Dt.x1);if(Dt.x2>=0&&t>P){var e=gt.invert(Math.min(Dt.x1,Dt.x2)-St),n=gt.invert(Math.max(Dt.x1,Dt.x2)-St);r.timeSrv.setTime({from:h.a.utc(e),to:h.a.utc(n)})}at()}function Z(){m.appEvents.emit("graph-hover-clear"),st()}function tt(t){ht&&(Dt.active?(st(),Et.destroy(),Dt.x2=nt(t.offsetX),rt(Dt.x1,Dt.x2)):(et(t),it(t.offsetX),Et.show(t,ut)))}function et(t){var e=gt.invert(t.offsetX-St).valueOf(),n=mt.invert(t.offsetY),r={pageX:t.pageX,pageY:t.pageY,x:e,x1:e,y:n,y1:n,panelRelY:null};r.panelRelY=Math.max(t.offsetY/ft,.001),m.appEvents.emit("graph-hover",{pos:r,panel:pt})}function nt(t){return t=Math.max(t,St),t=Math.min(t,vt+St)}function rt(t,e){if(ht){ht.selectAll(".heatmap-selection").remove();var n=Math.min(t,e),r=Math.abs(t-e);r>P&&ht.append("rect").attr("class","heatmap-selection").attr("x",n).attr("width",r).attr("y",bt).attr("height",yt)}}function at(){Dt.x1=-1,Dt.x2=-1,ht&&ht.selectAll(".heatmap-selection").remove()}function it(t){if(ht){ht.selectAll(".heatmap-crosshair").remove();var e=t;e=Math.max(e,St),e=Math.min(e,vt+St),ht.append("g").attr("class","heatmap-crosshair").attr("transform","translate("+e+",0)").append("line").attr("x1",1).attr("y1",bt).attr("x2",1).attr("y2",xt).attr("stroke-width",1)}}function ot(t){if(ht&&0!==r.dashboard.graphTooltip){it(gt(t.x)+St)}}function st(){ht&&ht.selectAll(".heatmap-crosshair").remove()}function lt(){if(ut=r.data,pt=r.panel,ct=r.range,s()&&ut){if(l.a.isEmpty(ut.buckets))return N(),void L();V(),t.yAxisWidth=St,t.xAxisHeight=wt,t.chartHeight=yt,t.chartWidth=vt,t.chartTop=bt}}var ut,ct,pt,ht,dt,ft,mt,gt,vt,yt,bt,xt,St,wt,kt,_t,Mt,Tt,Ct,Pt,Ot,At=e.find(".heatmap-panel"),Et=new v.a(At,t),Dt={active:!1,x1:-1,x2:-1},$t={left:0,right:0,top:0,bottom:0},It={left:25,right:15,top:10,bottom:20},Ft=k;r.events.on("render",function(){lt(),r.renderingCompleted()}),m.appEvents.on("graph-hover",function(t){ot(t.pos)},t),m.appEvents.on("graph-hover-clear",function(){st()},t),At.on("mousedown",J),At.on("mousemove",tt),At.on("mouseleave",Z)}function a(t,e,n){if(e&&n&&t){var r=n-e,a=r/t/1e3;return a<=45?"%H:%M:%S":a<=7200||r<=864e5?"%H:%M":a<=8e4?"%m/%d %H:%M":a<=2419200||r<=31536e6?"%m/%d":"%Y-%m"}return"%H:%M"}function i(t,e){return Math.log(t)/Math.log(e)}function o(t){var e=t.toString(),n=e.indexOf(".");return-1===n?0:e.length-n-1}e.a=r;var s=n(7),l=n.n(s),u=n(13),c=n.n(u),p=n(1),h=n.n(p),d=n(470),f=n(464),m=n(465),g=n(1314),v=n(1503),y=n(1319),b=n(1342),x=1,S=1,w=0,k=1.2,_=100,M=50,T=10,C=5,P=2},1503:function(t,e,n){"use strict";n.d(e,"a",function(){return c});var r=n(470),a=n(13),i=n.n(a),o=n(7),s=n.n(o),l=n(464),u=n(1319),c=function(){function t(t,e){this.scope=e,this.dashboard=e.ctrl.dashboard,this.panelCtrl=e.ctrl,this.panel=e.ctrl.panel,this.heatmapPanel=t,this.mouseOverBucket=!1,this.originalFillColor=null,t.on("mouseover",this.onMouseOver.bind(this)),t.on("mouseleave",this.onMouseLeave.bind(this))}return t.prototype.onMouseOver=function(t){this.panel.tooltip.show&&this.scope.ctrl.data&&!s.a.isEmpty(this.scope.ctrl.data.buckets)&&(this.tooltip||(this.add(),this.move(t)))},t.prototype.onMouseLeave=function(){this.destroy()},t.prototype.onMouseMove=function(t){this.panel.tooltip.show&&this.move(t)},t.prototype.add=function(){this.tooltip=r.select("body").append("div").attr("class","heatmap-tooltip graph-tooltip grafana-tooltip")},t.prototype.destroy=function(){this.tooltip&&this.tooltip.remove(),this.tooltip=null},t.prototype.show=function(t,e){if(this.panel.tooltip.show&&e&&!t.panelRelY){var n=this.getBucketIndexes(t,e),r=n.xBucketIndex,a=n.yBucketIndex;if(!e.buckets[r]||!this.tooltip)return void this.destroy();var i,o,l,u,c=e.buckets[r],p=s.a.find(c.buckets,function(t,e){return t.bounds.bottom===a||e===a}),h=this.dashboard.formatDate(c.x,"YYYY-MM-DD HH:mm:ss");if(s.a.isNumber(this.panel.tooltipDecimals))u=this.valueFormatter(this.panel.tooltipDecimals,null);else{var d=(this.panelCtrl.decimals||-1)+1;u=this.valueFormatter(d,this.panelCtrl.scaledDecimals+2)}var f='<div class="graph-tooltip-time">'+h+'</div>\n      <div class="heatmap-histogram"></div>';if(p)if(p.bounds){var m=p.y?p.bounds.bottom:0;i=u(m),o=u(p.bounds.top),l=p.count,f+="<div>\n          bucket: <b>"+i+" - "+o+"</b> <br>\n          count: <b>"+l+"</b> <br>\n        </div>"}else f+="<div>count: <b>"+p.count+"</b><br></div>";else{if(!this.panel.tooltip.showHistogram)return void this.destroy();i=a,o="",l=0}this.tooltip.html(f),this.panel.tooltip.showHistogram&&this.addHistogram(c),this.move(t)}},t.prototype.getBucketIndexes=function(t,e){return{xBucketIndex:this.getXBucketIndex(t.offsetX,e),yBucketIndex:this.getYBucketIndex(t.offsetY,e)}},t.prototype.getXBucketIndex=function(t,e){var n=this.scope.xScale.invert(t-this.scope.yAxisWidth).valueOf();return Object(u.e)(n,e.xBucketSize,1)},t.prototype.getYBucketIndex=function(t,e){var n=this.scope.yScale.invert(t-this.scope.chartTop);return Object(u.e)(n,e.yBucketSize,this.panel.yAxis.logBase)},t.prototype.getSharedTooltipPos=function(t){return t.pageX=this.heatmapPanel.offset().left+this.scope.xScale(t.x),t.pageY=this.heatmapPanel.offset().top+this.scope.chartHeight*t.panelRelY,t},t.prototype.addHistogram=function(t){var e=this.scope.ctrl.data.buckets[t.x],n=this.scope.ctrl.data.yBucketSize,a=this.scope.ctrl.data.yAxis,i=a.min,o=a.max,l=a.ticks,u=s.a.map(e.buckets,function(t){return[t.bounds.bottom,t.values.length]});u=s.a.filter(u,function(t){return t[0]>=i&&t[0]<=o});var c,p=this.scope.yScale.copy(),h=p.domain([i,o]).range([0,160]);if(1===this.panel.yAxis.logBase)c=Math.floor(160/(o-i)*n*.9);else{var d=n||1;c=Math.floor(160/l/d*.9)}c=Math.max(c,1);var f=s.a.reduce(s.a.map(u,function(t){return t[1]}),function(t,e){return t+e},0),m=r.scaleLinear().domain([0,f]).range([0,40]);this.tooltip.select(".heatmap-histogram").append("svg").attr("width",160).attr("height",40).selectAll(".bar").data(u).enter().append("rect").attr("x",function(t){return h(t[0])}).attr("width",c).attr("y",function(t){return 40-m(t[1])}).attr("height",function(t){return m(t[1])})},t.prototype.move=function(t){if(this.tooltip){var e=i()(this.tooltip.node())[0],n=e.clientWidth,r=e.clientHeight,a=t.pageX+30,o=t.pageY+5;return t.pageX+n+40>window.innerWidth&&(a=t.pageX-n-30),t.pageY-window.pageYOffset+r+20>window.innerHeight&&(o=t.pageY-r-5),this.tooltip.style("left",a+"px").style("top",o+"px")}},t.prototype.valueFormatter=function(t,e){void 0===e&&(e=null);var n=this.panel.yAxis.format;return function(r){return l.default.valueFormats[n](r,t,e)}},t}()},1504:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"TablePanelCtrl",function(){return d}),n.d(e,"PanelCtrl",function(){return d});var r=n(7),a=n.n(r),i=n(13),o=n.n(i),s=n(1305),l=n(1343),u=n(1505),c=n(1506),p=n(1507),h=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=function(t){function e(e,n,r,i,o,s){var l=t.call(this,e,n)||this;return l.annotationsSrv=i,l.$sanitize=o,l.variableSrv=s,l.panelDefaults={targets:[{}],transform:"timeseries_to_columns",pageSize:null,showHeader:!0,styles:[{type:"date",pattern:"Time",alias:"Time",dateFormat:"YYYY-MM-DD HH:mm:ss"},{unit:"short",type:"number",alias:"",decimals:2,colors:["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],colorMode:null,pattern:"/.*/",thresholds:[]}],columns:[],scroll:!0,fontSize:"100%",sort:{col:0,desc:!0}},l.pageIndex=0,void 0===l.panel.styles&&(l.panel.styles=l.panel.columns,l.panel.columns=l.panel.fields,delete l.panel.columns,delete l.panel.fields),a.a.defaults(l.panel,l.panelDefaults),l.events.on("data-received",l.onDataReceived.bind(l)),l.events.on("data-error",l.onDataError.bind(l)),l.events.on("data-snapshot-load",l.onDataReceived.bind(l)),l.events.on("init-edit-mode",l.onInitEditMode.bind(l)),l.events.on("init-panel-actions",l.onInitPanelActions.bind(l)),l}return h(e,t),e.$inject=["$scope","$injector","templateSrv","annotationsSrv","$sanitize","variableSrv"],e.prototype.onInitEditMode=function(){this.addEditorTab("Options",u.a,2),this.addEditorTab("Column Styles",c.a,3)},e.prototype.onInitPanelActions=function(t){t.push({text:"Export CSV",click:"ctrl.exportCsv()"})},e.prototype.issueQueries=function(e){return this.pageIndex=0,"annotations"===this.panel.transform?(this.setTimeQueryStart(),this.annotationsSrv.getAnnotations({dashboard:this.dashboard,panel:this.panel,range:this.range}).then(function(t){return{data:t}})):t.prototype.issueQueries.call(this,e)},e.prototype.onDataError=function(t){this.dataRaw=[],this.render()},e.prototype.onDataReceived=function(t){this.dataRaw=t,this.pageIndex=0,this.dataRaw&&this.dataRaw.length&&("table"===this.dataRaw[0].type?this.panel.transform="table":"docs"===this.dataRaw[0].type?this.panel.transform="json":"table"!==this.panel.transform&&"json"!==this.panel.transform||(this.panel.transform="timeseries_to_rows")),this.render()},e.prototype.render=function(){return this.table=Object(l.a)(this.dataRaw,this.panel),this.table.sort(this.panel.sort),this.renderer=new p.a(this.panel,this.table,this.dashboard.isTimezoneUtc(),this.$sanitize,this.templateSrv),t.prototype.render.call(this,this.table)},e.prototype.toggleColumnSort=function(t,e){this.table.columns[this.panel.sort.col]&&(this.table.columns[this.panel.sort.col].sort=!1),this.panel.sort.col===e?this.panel.sort.desc?this.panel.sort.desc=!1:this.panel.sort.col=null:(this.panel.sort.col=e,this.panel.sort.desc=!0),this.render()},e.prototype.exportCsv=function(){var t=this.$scope.$new(!0);t.tableData=this.renderer.render_values(),t.panel="table",this.publishAppEvent("show-modal",{templateHtml:'<export-data-modal panel="panel" data="tableData"></export-data-modal>',scope:t,modalClass:"modal--narrow"})},e.prototype.link=function(t,e,n,r){function a(){var t=r.height;return d>1&&(t-=26),t-31+"px"}function i(t){r.renderer.setTable(p),t.empty(),t.html(r.renderer.render(r.pageIndex))}function s(t){var e=o()(t.currentTarget);r.pageIndex=parseInt(e.text(),10)-1,u()}function l(t){t.empty();var e=h.pageSize||100;if(1!==(d=Math.ceil(p.rows.length/e))){for(var n=Math.max(r.pageIndex-3,0),a=Math.min(d,n+9),i=o()("<ul></ul>"),s=n;s<a;s++){var l=s===r.pageIndex?"active":"",u=o()('<li><a class="table-panel-page-link pointer '+l+'">'+(s+1)+"</a></li>");i.append(u)}t.append(i)}}function u(){var t=e.parents(".panel"),n=e.find(".table-panel-scroll"),r=e.find("tbody"),o=e.find(".table-panel-footer");e.css({"font-size":h.fontSize}),t.addClass("table-panel-wrapper"),i(r),l(o),n.css({"max-height":h.scroll?a():""})}function c(t){var e=o()(t.currentTarget).data(),n={datasource:h.datasource,key:p.columns[e.column].text,value:p.rows[e.row][e.column],operator:e.operator};r.variableSrv.setAdhocFilter(n)}var p,h=r.panel,d=0;e.tooltip({selector:"[data-link-tooltip]"}),e.on("click",".table-panel-page-link",s),e.on("click",".table-panel-filter-link",c);var f=t.$on("$destroy",function(){e.off("click",".table-panel-page-link"),e.off("click",".table-panel-filter-link"),f()});r.events.on("render",function(t){p=t||p,p&&u(),r.renderingCompleted()})},e.templateUrl="module.html",e}(s.MetricsPanelCtrl)},1505:function(t,e,n){"use strict";function r(t,e){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/table/editor.html",controller:s}}r.$inject=["$q","uiSegmentSrv"],e.a=r;var a=n(7),i=n.n(a),o=n(1343),s=function(){function t(t,e,n){this.$q=e,this.uiSegmentSrv=n,t.editor=this,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.transformers=o.b,this.fontSizes=["80%","90%","100%","110%","120%","130%","150%","160%","180%","200%","220%","250%"],this.addColumnSegment=n.newPlusButton(),this.updateTransformHints()}return t.$inject=["$scope","$q","uiSegmentSrv"],t.prototype.updateTransformHints=function(){switch(this.canSetColumns=!1,this.columnsHelpMessage="",this.panel.transform){case"timeseries_aggregations":case"json":this.canSetColumns=!0;break;case"table":this.columnsHelpMessage="Columns and their order are determined by the data query"}},t.prototype.getColumnOptions=function(){var t=this;if(!this.panelCtrl.dataRaw)return this.$q.when([]);var e=this.transformers[this.panel.transform].getColumns(this.panelCtrl.dataRaw),n=i.a.map(e,function(e){return t.uiSegmentSrv.newSegment({value:e.text})});return this.$q.when(n)},t.prototype.addColumn=function(){var t=o.b[this.panel.transform].getColumns(this.panelCtrl.dataRaw),e=i.a.find(t,{text:this.addColumnSegment.value});e&&(this.panel.columns.push(e),this.render());var n=this.uiSegmentSrv.newPlusButton();this.addColumnSegment.html=n.html,this.addColumnSegment.value=n.value},t.prototype.transformChanged=function(){this.panel.columns=[],"timeseries_aggregations"===this.panel.transform&&this.panel.columns.push({text:"Avg",value:"avg"}),this.updateTransformHints(),this.render()},t.prototype.render=function(){this.panelCtrl.render()},t.prototype.removeColumn=function(t){this.panel.columns=i.a.without(this.panel.columns,t),this.panelCtrl.render()},t}()},1506:function(t,e,n){"use strict";function r(t,e){return{restrict:"E",scope:!0,templateUrl:"public/app/plugins/panel/table/column_options.html",controller:s}}r.$inject=["$q","uiSegmentSrv"],e.a=r;var a=n(7),i=n.n(a),o=n(464),s=function(){function t(t){var e=this;t.editor=this,this.activeStyleIndex=0,this.panelCtrl=t.ctrl,this.panel=this.panelCtrl.panel,this.unitFormats=o.default.getUnitFormats(),this.colorModes=[{text:"Disabled",value:null},{text:"Cell",value:"cell"},{text:"Value",value:"value"},{text:"Row",value:"row"}],this.columnTypes=[{text:"Number",value:"number"},{text:"String",value:"string"},{text:"Date",value:"date"},{text:"Hidden",value:"hidden"}],this.fontSizes=["80%","90%","100%","110%","120%","130%","150%","160%","180%","200%","220%","250%"],this.dateFormats=[{text:"YYYY-MM-DD HH:mm:ss",value:"YYYY-MM-DD HH:mm:ss"},{text:"YYYY-MM-DD HH:mm:ss.SSS",value:"YYYY-MM-DD HH:mm:ss.SSS"},{text:"MM/DD/YY h:mm:ss a",value:"MM/DD/YY h:mm:ss a"},{text:"MMMM D, YYYY LT",value:"MMMM D, YYYY LT"}],this.getColumnNames=function(){return e.panelCtrl.table?i.a.map(e.panelCtrl.table.columns,function(t){return t.text}):[]},this.onColorChange=this.onColorChange.bind(this)}return t.$inject=["$scope"],t.prototype.render=function(){this.panelCtrl.render()},t.prototype.setUnitFormat=function(t,e){t.unit=e.value,this.panelCtrl.render()},t.prototype.addColumnStyle=function(){var t={unit:"short",type:"number",alias:"",decimals:2,colors:["rgba(245, 54, 54, 0.9)","rgba(237, 129, 40, 0.89)","rgba(50, 172, 45, 0.97)"],colorMode:null,pattern:"",dateFormat:"YYYY-MM-DD HH:mm:ss",thresholds:[]},e=this.panel.styles,n=e.length,r=n;if(n>0){"/.*/"===e[n-1].pattern&&(r=n-1)}e.splice(r,0,t),this.activeStyleIndex=r},t.prototype.removeColumnStyle=function(t){this.panel.styles=i.a.without(this.panel.styles,t)},t.prototype.invertColorOrder=function(t){var e=this.panel.styles[t].colors,n=e[0];e[0]=e[2],e[2]=n,this.panelCtrl.render()},t.prototype.onColorChange=function(t,e){var n=this;return function(r){n.panel.styles[t].colors[e]=r,n.render()}},t}()},1507:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(7),a=n.n(r),i=n(1),o=n.n(i),s=n(464),l=function(){function t(t,e,n,r,a){this.panel=t,this.table=e,this.isUtc=n,this.sanitize=r,this.templateSrv=a,this.initColumns()}return t.prototype.setTable=function(t){this.table=t,this.initColumns()},t.prototype.initColumns=function(){this.formatters=[],this.colorState={};for(var t=0;t<this.table.columns.length;t++){var e=this.table.columns[t];e.title=e.text;for(var n=0;n<this.panel.styles.length;n++){var r=this.panel.styles[n],a=s.default.stringToJsRegex(r.pattern);if(e.text.match(a)){e.style=r,r.alias&&(e.title=e.text.replace(a,r.alias));break}}this.formatters[t]=this.createColumnFormatter(e)}},t.prototype.getColorForValue=function(t,e){if(!e.thresholds)return null;for(var n=e.thresholds.length;n>0;n--)if(t>=e.thresholds[n-1])return e.colors[n];return a.a.first(e.colors)},t.prototype.defaultCellFormatter=function(t,e){return null===t||void 0===t||void 0===t?"":(a.a.isArray(t)&&(t=t.join(", ")),e&&e.sanitize?this.sanitize(t):a.a.escape(t))},t.prototype.createColumnFormatter=function(t){var e=this;if(!t.style)return this.defaultCellFormatter;if("hidden"===t.style.type)return function(t){};if("date"===t.style.type)return function(n){if(void 0===n||null===n)return"-";a.a.isArray(n)&&(n=n[0]);var r=o()(n);return e.isUtc&&(r=r.utc()),r.format(t.style.dateFormat)};if("number"===t.style.type){var n=s.default.valueFormats[t.unit||t.style.unit];return function(r){return null===r||void 0===r?"-":a.a.isString(r)?e.defaultCellFormatter(r,t.style):(t.style.colorMode&&(e.colorState[t.style.colorMode]=e.getColorForValue(r,t.style)),n(r,t.style.decimals,null))}}return function(n){return e.defaultCellFormatter(n,t.style)}},t.prototype.renderRowVariables=function(t){for(var e,n={},r=this.table.rows[t],a=0;a<r.length;a++)e="__cell_"+a,n[e]={value:r[a]};return n},t.prototype.formatColumnValue=function(t,e){return this.formatters[t]?this.formatters[t](e):e},t.prototype.renderCell=function(t,e,n,r){void 0===r&&(r=!1),n=this.formatColumnValue(t,n);var a=this.table.columns[t],i="",o=[],s="";this.colorState.cell?(i=' style="background-color:'+this.colorState.cell+';color: white"',this.colorState.cell=null):this.colorState.value&&(i=' style="color:'+this.colorState.value+'"',this.colorState.value=null);var l="";if(r&&(l='<div class="table-panel-width-hack">'+this.table.columns[t].title+"</div>"),void 0===n?(i=' style="display:none;"',a.hidden=!0):a.hidden=!1,a.style&&a.style.preserveFormat&&o.push("table-panel-cell-pre"),a.style&&a.style.link){var u=this.renderRowVariables(e);u.__cell={value:n};var c=this.templateSrv.replace(a.style.linkUrl,u),p=this.templateSrv.replace(a.style.linkTooltip,u),h=a.style.linkTargetBlank?"_blank":"";o.push("table-panel-cell-link"),l+='\n        <a href="'+c+'" target="'+h+'" data-link-tooltip data-original-title="'+p+'" data-placement="right">\n          '+n+"\n        </a>\n      "}else l+=n;return a.filterable&&(o.push("table-panel-cell-filterable"),l+='\n        <a class="table-panel-filter-link" data-link-tooltip data-original-title="Filter out value" data-placement="bottom"\n           data-row="'+e+'" data-column="'+t+'" data-operator="!=">\n          <i class="fa fa-search-minus"></i>\n        </a>\n        <a class="table-panel-filter-link" data-link-tooltip data-original-title="Filter for value" data-placement="bottom"\n           data-row="'+e+'" data-column="'+t+'" data-operator="=">\n          <i class="fa fa-search-plus"></i>\n        </a>'),o.length&&(s=' class="'+o.join(" ")+'"'),l="<td"+s+i+">"+l+"</td>"},t.prototype.render=function(t){for(var e=this.panel.pageSize||100,n=t*e,r=Math.min(n+e,this.table.rows.length),a="",i=n;i<r;i++){for(var o=this.table.rows[i],s="",l="",u=0;u<this.table.columns.length;u++)s+=this.renderCell(u,i,o[u],i===n);this.colorState.row&&(l=' style="background-color:'+this.colorState.row+';color: white"',this.colorState.row=null),a+="<tr "+l+">"+s+"</tr>"}return a},t.prototype.render_values=function(){for(var t=[],e=0;e<this.table.rows.length;e++){for(var n=this.table.rows[e],r=[],a=0;a<this.table.columns.length;a++)r.push(this.formatColumnValue(a,n[a]));t.push(r)}return{columns:this.table.columns,rows:t}},t}()},1508:function(t,e,n){"use strict";function r(t,e){if(!i.a.isFinite(e))return null;for(var n=t.thresholds.length;n>0;n--)if(e>=t.thresholds[n-1])return t.colorMap[n];return i.a.first(t.colorMap)}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"SingleStatCtrl",function(){return m}),n.d(e,"PanelCtrl",function(){return m}),n.d(e,"getColorForValue",function(){return r});var a=n(7),i=n.n(a),o=n(13),s=n.n(o),l=n(1315),u=(n.n(l),n(1509)),c=(n.n(u),n(1325),n(464)),p=n(27),h=n(1309),d=n(1305),f=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),m=function(t){function e(e,n,r,a){var o=t.call(this,e,n)||this;return o.$location=r,o.linkSrv=a,o.dataType="timeseries",o.valueNameOptions=[{value:"min",text:"Min"},{value:"max",text:"Max"},{value:"avg",text:"Average"},{value:"current",text:"Current"},{value:"total",text:"Total"},{value:"name",text:"Name"},{value:"first",text:"First"},{value:"delta",text:"Delta"},{value:"diff",text:"Difference"},{value:"range",text:"Range"},{value:"last_time",text:"Time of last point"}],o.panelDefaults={links:[],datasource:null,maxDataPoints:100,interval:null,targets:[{}],cacheTimeout:null,format:"none",prefix:"",postfix:"",nullText:null,valueMaps:[{value:"null",op:"=",text:"N/A"}],mappingTypes:[{name:"value to text",value:1},{name:"range to text",value:2}],rangeMaps:[{from:"null",to:"null",text:"N/A"}],mappingType:1,nullPointMode:"connected",valueName:"avg",prefixFontSize:"50%",valueFontSize:"80%",postfixFontSize:"50%",thresholds:"",colorBackground:!1,colorValue:!1,colors:["#299c46","rgba(237, 129, 40, 0.89)","#d44a3a"],sparkline:{show:!1,full:!1,lineColor:"rgb(31, 120, 193)",fillColor:"rgba(31, 118, 189, 0.18)"},gauge:{show:!1,minValue:0,maxValue:100,thresholdMarkers:!0,thresholdLabels:!1},tableColumn:""},i.a.defaults(o.panel,o.panelDefaults),o.events.on("data-received",o.onDataReceived.bind(o)),o.events.on("data-error",o.onDataError.bind(o)),o.events.on("data-snapshot-load",o.onDataReceived.bind(o)),o.events.on("init-edit-mode",o.onInitEditMode.bind(o)),o.onSparklineColorChange=o.onSparklineColorChange.bind(o),o.onSparklineFillChange=o.onSparklineFillChange.bind(o),o}return f(e,t),e.$inject=["$scope","$injector","$location","linkSrv"],e.prototype.onInitEditMode=function(){this.fontSizes=["20%","30%","50%","70%","80%","100%","110%","120%","150%","170%","200%"],this.addEditorTab("Options","public/app/plugins/panel/singlestat/editor.html",2),this.addEditorTab("Value Mappings","public/app/plugins/panel/singlestat/mappings.html",3),this.unitFormats=c.default.getUnitFormats()},e.prototype.setUnitFormat=function(t){this.panel.format=t.value,this.refresh()},e.prototype.onDataError=function(t){this.onDataReceived([])},e.prototype.onDataReceived=function(t){var e={};if(t.length>0&&"table"===t[0].type){this.dataType="table";var n=t.map(this.tableHandler.bind(this));this.setTableValues(n,e)}else this.dataType="timeseries",this.series=t.map(this.seriesHandler.bind(this)),this.setValues(e);this.data=e,this.render()},e.prototype.seriesHandler=function(t){var e=new h.a({datapoints:t.datapoints||[],alias:t.target});return e.flotpairs=e.getFlotPairs(this.panel.nullPointMode),e},e.prototype.tableHandler=function(t){var e=[],n={};return t.columns.forEach(function(t,e){n[e]=t.text}),this.tableColumnOptions=n,i.a.find(t.columns,["text",this.panel.tableColumn])||this.setTableColumnToSensibleDefault(t),t.rows.forEach(function(t){var r={};t.forEach(function(t,e){var a=n[e];r[a]=t}),e.push(r)}),e},e.prototype.setTableColumnToSensibleDefault=function(t){1===this.tableColumnOptions.length?this.panel.tableColumn=this.tableColumnOptions[0]:this.panel.tableColumn=i.a.find(t.columns,function(t){return"time"!==t.type}).text},e.prototype.setTableValues=function(t,e){if(t&&0!==t.length&&0!==t[0].length&&void 0!==t[0][0][this.panel.tableColumn]){var n=t[0][0];if(e.value=n[this.panel.tableColumn],i.a.isString(e.value))e.valueFormatted=i.a.escape(e.value),e.value=0,e.valueRounded=0;else{var r=this.getDecimalsForValue(e.value),a=c.default.valueFormats[this.panel.format];e.valueFormatted=a(n[this.panel.tableColumn],r.decimals,r.scaledDecimals),e.valueRounded=c.default.roundValue(e.value,this.panel.decimals||0)}this.setValueMapping(e)}},e.prototype.setColoring=function(t){t.background?(this.panel.colorValue=!1,this.panel.colors=["rgba(71, 212, 59, 0.4)","rgba(245, 150, 40, 0.73)","rgba(225, 40, 40, 0.59)"]):(this.panel.colorBackground=!1,this.panel.colors=["rgba(50, 172, 45, 0.97)","rgba(237, 129, 40, 0.89)","rgba(245, 54, 54, 0.9)"]),this.render()},e.prototype.invertColorOrder=function(){var t=this.panel.colors[0];this.panel.colors[0]=this.panel.colors[2],this.panel.colors[2]=t,this.render()},e.prototype.onColorChange=function(t){var e=this;return function(n){e.panel.colors[t]=n,e.render()}},e.prototype.onSparklineColorChange=function(t){this.panel.sparkline.lineColor=t,this.render()},e.prototype.onSparklineFillChange=function(t){this.panel.sparkline.fillColor=t,this.render()},e.prototype.getDecimalsForValue=function(t){if(i.a.isNumber(this.panel.decimals))return{decimals:this.panel.decimals,scaledDecimals:null};var e,n=t/2,r=-Math.floor(Math.log(n)/Math.LN10),a=Math.pow(10,-r),o=n/a;o<1.5?e=1:o<3?(e=2,o>2.25&&(e=2.5,++r)):e=o<7.5?5:10,e*=a,Math.floor(t)===t&&(r=0);var s={};return s.decimals=Math.max(0,r),s.scaledDecimals=s.decimals-Math.floor(Math.log(e)/Math.LN10)+2,s},e.prototype.setValues=function(t){if(t.flotpairs=[],this.series.length>1){var e=new Error;throw e.message="Multiple Series Error",e.data="Metric query returns "+this.series.length+" series. Single Stat Panel expects a single series.\n\nResponse:\n"+JSON.stringify(this.series),e}if(this.series&&this.series.length>0){var n=i.a.last(this.series[0].datapoints),r=i.a.isArray(n)?n[0]:null;if("name"===this.panel.valueName)t.value=0,t.valueRounded=0,t.valueFormatted=this.series[0].alias;else if(i.a.isString(r))t.value=0,t.valueFormatted=i.a.escape(r),t.valueRounded=0;else if("last_time"===this.panel.valueName){var a=c.default.valueFormats[this.panel.format];t.value=n[1],t.valueRounded=t.value,t.valueFormatted=a(t.value,0,0)}else{t.value=this.series[0].stats[this.panel.valueName],t.flotpairs=this.series[0].flotpairs;var o=this.getDecimalsForValue(t.value),a=c.default.valueFormats[this.panel.format];t.valueFormatted=a(t.value,o.decimals,o.scaledDecimals),t.valueRounded=c.default.roundValue(t.value,o.decimals)}t.scopedVars=i.a.extend({},this.panel.scopedVars),t.scopedVars.__name={value:this.series[0].label}}this.setValueMapping(t)},e.prototype.setValueMapping=function(t){if(1===this.panel.mappingType)for(var e=0;e<this.panel.valueMaps.length;e++){var n=this.panel.valueMaps[e];if("null"!==n.value){var r=parseFloat(n.value);if(r===t.valueRounded)return void(t.valueFormatted=n.text)}else if(null===t.value||void 0===t.value)return void(t.valueFormatted=n.text)}else if(2===this.panel.mappingType)for(var e=0;e<this.panel.rangeMaps.length;e++){var n=this.panel.rangeMaps[e];if("null"!==n.from||"null"!==n.to){var a=parseFloat(n.from),i=parseFloat(n.to);if(i>=t.valueRounded&&a<=t.valueRounded)return void(t.valueFormatted=n.text)}else if(null===t.value||void 0===t.value)return void(t.valueFormatted=n.text)}null!==t.value&&void 0!==t.value||(t.valueFormatted="no value")},e.prototype.removeValueMap=function(t){var e=i.a.indexOf(this.panel.valueMaps,t);this.panel.valueMaps.splice(e,1),this.render()},e.prototype.addValueMap=function(){this.panel.valueMaps.push({value:"",op:"=",text:""})},e.prototype.removeRangeMap=function(t){var e=i.a.indexOf(this.panel.rangeMaps,t);this.panel.rangeMaps.splice(e,1),this.render()},e.prototype.addRangeMap=function(){this.panel.rangeMaps.push({from:"",to:"",text:""})},e.prototype.link=function(t,e,n,a){function i(){e.css("height",a.height+"px")}function o(t,e){if(!x.colorValue)return e;var n=r(m,t);return n?'<span style="color:'+n+'">'+e+"</span>":e}function l(t,e,n){return n=S.replace(n,m.scopedVars),'<span class="'+t+'" style="font-size:'+e+'">'+n+"</span>"}function u(){var t='<div class="singlestat-panel-value-container">';x.prefix&&(t+=l("singlestat-panel-prefix",x.prefixFontSize,x.prefix));var e=o(m.value,m.valueFormatted);return t+=l("singlestat-panel-value",x.valueFontSize,e),x.postfix&&(t+=l("singlestat-panel-postfix",x.postfixFontSize,x.postfix)),t+="</div>"}function c(){var t=x.prefix?S.replace(x.prefix,m.scopedVars):"";return t+=m.valueFormatted,t+=x.postfix?S.replace(x.postfix,m.scopedVars):""}function h(){var t=e.width(),n=e.height(),i=Math.min(t,1.3*n);if(a.invalidGaugeRange=!1,x.gauge.minValue>x.gauge.maxValue)return void(a.invalidGaugeRange=!0);var o=s()("<div></div>"),l={top:"10px",margin:"auto",position:"relative",height:.9*n+"px",width:i+"px"};o.css(l);for(var u=[],h=0;h<m.thresholds.length;h++)u.push({value:m.thresholds[h],color:m.colorMap[h]});u.push({value:x.gauge.maxValue,color:m.colorMap[m.colorMap.length-1]});var d=p.default.bootData.user.lightTheme?"rgb(230,230,230)":"rgb(38,38,38)",f=parseInt(x.valueFontSize)/100,g=Math.min(i/5,100)*f,v=x.gauge.thresholdLabels?1.5:1,y=Math.min(i/6,60)/v,b=y/5,S=g/2.5,w={series:{gauges:{gauge:{min:x.gauge.minValue,max:x.gauge.maxValue,background:{color:d},border:{color:null},shadow:{show:!1},width:y},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0},cell:{border:{width:0}},threshold:{values:u,label:{show:x.gauge.thresholdLabels,margin:b+1,font:{size:S}},show:x.gauge.thresholdMarkers,width:b},value:{color:x.colorValue?r(m,m.valueRounded):null,formatter:function(){return c()},font:{size:g,family:'"Helvetica Neue", Helvetica, Arial, sans-serif'}},show:!0}}};e.append(o);var k={data:[[0,m.valueRounded]]};s.a.plot(o,[k],w)}function d(){var t=e.width()+20;if(t<30)return void setTimeout(d,30);var n=a.height,r=s()("<div></div>"),i={};if(i.position="absolute",x.sparkline.full){i.bottom="5px",i.left="-5px",i.width=t-10+"px";var o=n<=100?5:15*Math.round(n/100)+5;i.height=n-o+"px"}else i.bottom="0px",i.left="-5px",i.width=t-10+"px",i.height=Math.floor(.25*n)+"px";r.css(i);var l={legend:{show:!1},series:{lines:{show:!0,fill:1,lineWidth:1,fillColor:x.sparkline.fillColor}},yaxes:{show:!1},xaxis:{show:!1,mode:"time",min:a.range.from.valueOf(),max:a.range.to.valueOf()},grid:{hoverable:!1,show:!1}};e.append(r);var u={data:m.flotpairs,color:x.sparkline.lineColor};s.a.plot(r,[u],l)}function f(){if(a.data){m=a.data,m.thresholds=x.thresholds.split(",").map(function(t){return Number(t.trim())}),m.colorMap=x.colors,i();var n=x.gauge.show?"":u();if(x.colorBackground){var o=r(m,m.value);o&&(w.css("background-color",o),t.fullscreen?e.css("background-color",o):e.css("background-color",""))}else w.css("background-color",""),e.css("background-color","");e.html(n),x.sparkline.show&&d(),x.gauge.show&&h(),e.toggleClass("pointer",x.links.length>0),g=x.links.length>0?y.getPanelLinkAnchorInfo(x.links[0],m.scopedVars):null}}var m,g,v=this.$location,y=this.linkSrv,b=this.$timeout,x=a.panel,S=this.templateSrv,w=e.find(".panel-container");e=e.find(".singlestat-panel"),function(){var t=s()('<div id="tooltip" class="">hello</div>"');e.mouseleave(function(){0!==x.links.length&&b(function(){t.detach()})}),e.click(function(e){if(g&&!(s()(e).parents(".panel-header").length>0)){if("_blank"===g.target)return void window.open(g.href,"_blank");0===g.href.indexOf("http")?window.location.href=g.href:b(function(){v.url(g.href)}),t.detach()}}),e.mousemove(function(e){g&&(t.text("click to go to: "+g.title),t.place_tt(e.pageX,e.pageY-50))})}(),this.events.on("render",function(){f(),a.renderingCompleted()})},e.templateUrl="module.html",e}(d.MetricsPanelCtrl)},1509:function(t,e){/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */
!function(t){function e(t){return"undefined"!=typeof Logger?new Logger(t):null}function n(t,e){return e%t}function r(t,e){return Math.floor(e/t)}function a(t){return t*Math.PI}function i(t,e,n,r,a,i,o,s,l,u){if(i!==o){t.save(),t.beginPath(),t.arc(e,n,r,i,o,!1),t.lineTo(e+(r-a)*Math.cos(o),n+(r-a)*Math.sin(o)),t.arc(e,n,r-a,o,i,!0),t.closePath(),l&&(t.lineWidth=l),s&&(t.strokeStyle=s,t.stroke()),u&&(t.fillStyle=u,t.fill()),t.restore()}}function o(n){n.hooks.processOptions.push(function(t,n){e(n.series.gauges.debug);n.series.gauges.show&&(n.grid.show=!1,n.legend.show=!1),n.series.gauges.threshold.values.sort(function(t,e){return t.value<e.value?-1:t.value>e.value?1:0})}),n.hooks.draw.push(function(n,r){var a=n.getOptions(),i=a.series.gauges;e(i.debug);if(i.show){var o=n.getData();if(o&&o.length){var l=new s(n,r),u=l.calculateLayout();i.debug.layout,l.drawBackground(u);for(var c=0;c<o.length;c++){var p=o[c],h=t.extend({},i,p.gauges);p.gauges&&l.calculateAutoValues(h,u.cellWidth);var d=l.calculateCellLayout(h,u,c);l.drawCellBackground(h,d),h.debug.layout,h.label.show&&l.drawLable(h,u,d,c,p),l.drawGauge(h,u,d,p.label,p.data[0][1]),h.threshold.show&&l.drawThreshold(h,u,d),h.threshold.label.show&&l.drawThresholdValues(h,u,d,c),h.value.show&&l.drawValue(h,u,d,c,p)}}}})}var s=function(){function o(t,e){"auto"===t.gauge.width&&(t.gauge.width=Math.max(5,e/8)),"auto"===t.label.margin&&(t.label.margin=Math.max(1,e/20)),"auto"===t.label.font.size&&(t.label.font.size=Math.max(5,e/8)),"auto"===t.value.margin&&(t.value.margin=Math.max(1,e/30)),"auto"===t.value.font.size&&(t.value.font.size=Math.max(5,e/9)),"auto"===t.threshold.width&&(t.threshold.width=Math.max(3,e/100)),"auto"===t.threshold.label.margin&&(t.threshold.label.margin=Math.max(3,e/40)),"auto"===t.threshold.label.font.size&&(t.threshold.label.font.size=Math.max(5,e/15))}function s(t,e){for(var n,r=0;r<t.threshold.values.length;r++){var a=t.threshold.values[r];if(n=a.color,e<a.value)break}return n}function l(t,e,n){var r=t.gauge.startAngle+(t.gauge.endAngle-t.gauge.startAngle)*((n-t.gauge.min)/(t.gauge.max-t.gauge.min));return r<t.gauge.startAngle?r=t.gauge.startAngle:r>t.gauge.endAngle&&(r=t.gauge.endAngle),r}function u(t,e,n,r,a,o,s,l,u,c){a!==o&&(h.save(),i(h,t,e,n,r,a,o,s,l,u),c&&(i(h,t,e,n,r,a,o),h.clip(),h.shadowOffsetX=0,h.shadowOffsetY=0,h.shadowBlur=10,h.shadowColor="gray",i(h,t,e,n+1,r+2,a,o,s,1)),h.restore())}function c(t,e,n,r,i,o){p(n.cx+(e.thresholdLabelMargin+e.thresholdLabelFontSize/2+e.radius)*Math.cos(a(o)),n.cy+(e.thresholdLabelMargin+e.thresholdLabelFontSize/2+e.radius)*Math.sin(a(o)),"flotGagueThresholdValue"+r,t.threshold.label.formatter?t.threshold.label.formatter(i):i,t.threshold.label,o)}function p(e,n,r,a,i,o){var s=t("."+r,d),l=s.length;l||(s=t("<span></span>"),s.attr("id",r),s.css("position","absolute"),s.css("top",n+"px"),i.font.size&&s.css("font-size",i.font.size+"px"),i.font.family&&s.css("font-family",i.font.family),i.color&&s.css("color",i.color),i.background.color&&s.css("background-color",i.background.color),i.background.opacity&&s.css("opacity",i.background.opacity),d.append(s)),s.text(a),s.css("left",e+"px"),s.css("left",parseInt(s.css("left"))-s.width()/2+"px"),!l&&o&&(s.css("top",parseInt(s.css("top"))-s.height()/2+"px"),s.css("transform","rotate("+(180*o+90)+"deg)"))}var h,d,f,m,g,v,y=function(t,n){h=n,d=t.getPlaceholder(),f=t.getOptions(),m=f.series.gauges,g=t.getData(),v=e(m.debug)};return y.prototype.calculateLayout=function(){var t=d.width(),e=d.height(),n=Math.min(g.length,m.layout.columns),r=Math.ceil(g.length/n),i=m.layout.margin,s=m.layout.hMargin,l=m.layout.vMargin,u=(t-2*i-s*(n-1))/n,c=(e-2*i-l*(r-1))/r;if(m.layout.square){var p=Math.min(u,c);u=p,c=p}o(m,u);var h=m.cell.margin,f=0,v=0;m.label.show&&(f=m.label.margin,v=m.label.font.size);var y=0,b=0;m.value.show&&(y=m.value.margin,b=m.value.font.size);var x=0;m.threshold.show&&(x=m.threshold.width);var S=0,w=0;m.threshold.label.show&&(S=m.threshold.label.margin,w=m.threshold.label.font.size);for(var k=u/2-h-x-2*S-w,_=m.gauge.startAngle,M=m.gauge.endAngle,T=(M-_)/100,C=-1,P=_;P<M;P+=T)C=Math.max(C,Math.sin(a(P)));C=Math.max(C,Math.sin(a(M)));var O=(c-2*h-2*f-v)/(1+C);O*C<y+b/2&&(O=c-2*h-2*f-v-y-b/2);var A=O-2*S-w-x,E=Math.min(k,A),D=m.gauge.width;D>=E&&(D=Math.max(3,E/3));var $=2*S+w+x+E;return{canvasWidth:t,canvasHeight:e,margin:i,hMargin:s,vMargin:l,columns:n,rows:r,cellWidth:u,cellHeight:c,cellMargin:h,labelMargin:f,labelFontSize:v,valueMargin:y,valueFontSize:b,width:D,radius:E,thresholdWidth:x,thresholdLabelMargin:S,thresholdLabelFontSize:w,gaugeOuterHeight:Math.max($*(1+C),$+y+b/2)}},y.prototype.calculateAutoValues=o,y.prototype.calculateCellLayout=function(t,e,a){var i=n(e.columns,a),o=r(e.columns,a),s=e.margin+(e.cellWidth+e.hMargin)*i,l=e.margin+(e.cellHeight+e.vMargin)*o,u=s+e.cellWidth/2,c=l+e.cellMargin+2*e.labelMargin+e.labelFontSize+e.thresholdWidth+e.thresholdLabelFontSize+2*e.thresholdLabelMargin+e.radius,p=e.cellHeight-2*e.cellMargin-2*e.labelMargin-e.labelFontSize-e.gaugeOuterHeight,h=0;return"middle"===t.cell.vAlign?h=p/2:"bottom"===t.cell.vAlign&&(h=p),c+=h,{col:i,row:o,x:s,y:l,offsetY:h,cellWidth:e.cellWidth,cellHeight:e.cellHeight,cellMargin:e.cellMargin,cx:u,cy:c}},y.prototype.drawBackground=function(t){m.frame.show&&(h.save(),h.strokeStyle=f.grid.borderColor,h.lineWidth=f.grid.borderWidth,h.strokeRect(0,0,t.canvasWidth,t.canvasHeight),f.grid.backgroundColor&&(h.fillStyle=f.grid.backgroundColor,h.fillRect(0,0,t.canvasWidth,t.canvasHeight)),h.restore())},y.prototype.drawCellBackground=function(t,e){h.save(),t.cell.border&&t.cell.border.show&&t.cell.border.color&&t.cell.border.width&&(h.strokeStyle=t.cell.border.color,h.lineWidth=t.cell.border.width,h.strokeRect(e.x,e.y,e.cellWidth,e.cellHeight)),t.cell.background&&t.cell.background.color&&(h.fillStyle=t.cell.background.color,h.fillRect(e.x,e.y,e.cellWidth,e.cellHeight)),h.restore()},y.prototype.drawGauge=function(t,e,n,r,i){var o=t.gauge.shadow.show?t.gauge.shadow.blur:0;u(n.cx,n.cy,e.radius,e.width,a(t.gauge.startAngle),a(t.gauge.endAngle),t.gauge.border.color,t.gauge.border.width,t.gauge.background.color,o);var c=s(t,i),p=l(t,e,i);u(n.cx,n.cy,e.radius-1,e.width-2,a(t.gauge.startAngle),a(p),c,1,c,o)},y.prototype.drawThreshold=function(t,e,n){for(var r=t.gauge.startAngle,o=0;o<t.threshold.values.length;o++){var s=t.threshold.values[o];c1=s.color,a2=l(t,e,s.value),i(h,n.cx,n.cy,e.radius+e.thresholdWidth,e.thresholdWidth-2,a(r),a(a2),c1,1,c1),r=a2}},y.prototype.drawLable=function(t,e,n,r,a){p(n.cx,n.y+n.cellMargin+e.labelMargin+n.offsetY,"flotGagueLabel"+r,t.label.formatter?t.label.formatter(a.label,a.data[0][1]):text,t.label)},y.prototype.drawValue=function(t,e,n,r,a){p(n.cx,n.cy-t.value.font.size/2,"flotGagueValue"+r,t.value.formatter?t.value.formatter(a.label,a.data[0][1]):text,t.value)},y.prototype.drawThresholdValues=function(t,e,n,r){c(t,e,n,"Min"+r,t.gauge.min,t.gauge.startAngle),c(t,e,n,"Max"+r,t.gauge.max,t.gauge.endAngle);for(var a=0;a<t.threshold.values.length;a++){var i=t.threshold.values[a];if(i.value>t.gauge.min&&i.value<t.gauge.max){var o=l(t,e,i.value);c(t,e,n,r+"_"+a,i.value,o)}}},y}(),l={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(t,e){return t}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(t,e){return parseInt(e)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(t){return t}},values:[{value:50,color:"lightgreen"},{value:80,color:"yellow"},{value:100,color:"red"}]}}}};t.plot.plugins.push({init:o,options:l,name:"gauge",version:"1.1.0"})}(jQuery)},1510:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"GettingStartedPanelCtrl",function(){return o}),n.d(e,"PanelCtrl",function(){return o});var r=n(1305),a=n(465),i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(t){function e(e,n,r,a,i){var o=t.call(this,e,n)||this;return o.backendSrv=r,o.$q=i,o.stepIndex=0,o.steps=[],o.steps.push({title:"Install Grafana",icon:"icon-gf icon-gf-check",href:"http://docs.grafana.org/",target:"_blank",note:"Review the installation docs",check:function(){return i.when(!0)}}),o.steps.push({title:"Create your first data source",cta:"Add data source",icon:"icon-gf icon-gf-datasources",href:"datasources/new?gettingstarted",check:function(){return i.when(a.getMetricSources().filter(function(t){return!0!==t.meta.builtIn}).length>0)}}),o.steps.push({title:"Create your first dashboard",cta:"New dashboard",icon:"icon-gf icon-gf-dashboard",href:"dashboard/new?gettingstarted",check:function(){return o.backendSrv.search({limit:1}).then(function(t){return t.length>0})}}),o.steps.push({title:"Invite your team",cta:"Add Users",icon:"icon-gf icon-gf-users",href:"org/users?gettingstarted",check:function(){return o.backendSrv.get("/api/org/users").then(function(t){return t.length>1})}}),o.steps.push({title:"Install apps & plugins",cta:"Explore plugin repository",icon:"icon-gf icon-gf-apps",href:"https://grafana.com/plugins?utm_source=grafana_getting_started",check:function(){return o.backendSrv.get("/api/plugins",{embedded:0,core:0}).then(function(t){return t.length>0})}}),o}return i(e,t),e.$inject=["$scope","$injector","backendSrv","datasourceSrv","$q"],e.prototype.$onInit=function(){var t=this;return this.stepIndex=-1,this.nextStep().then(function(e){t.checksDone=!0})},e.prototype.nextStep=function(){var t=this;if(this.stepIndex===this.steps.length-1)return this.$q.when();this.stepIndex+=1;var e=this.steps[this.stepIndex];return e.check().then(function(n){return n?(e.cssClass="completed",t.nextStep()):(e.cssClass="active",t.$q.when())})},e.prototype.dismiss=function(){this.row.removePanel(this.panel,!1),this.backendSrv.request({method:"PUT",url:"/api/user/helpflags/1",showSuccessAlert:!1}).then(function(t){a.contextSrv.user.helpFlags1=t.helpFlags1})},e.templateUrl="public/app/plugins/panel/gettingstarted/module.html",e}(r.PanelCtrl)},1511:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ConfigCtrl",function(){return r});var r=function(){function t(t){this.backendSrv=t,this.appEditCtrl.setPreUpdateHook(this.initDatasource.bind(this))}return t.$inject=["backendSrv"],t.prototype.initDatasource=function(){var t=this;return this.backendSrv.get("/api/datasources").then(function(e){for(var n=!1,r=0,a=e;r<a.length;r++){"grafana-testdata-datasource"===a[r].type&&(n=!0)}if(!n){var i={name:"Grafana TestData",type:"grafana-testdata-datasource",access:"direct",jsonData:{}};return t.backendSrv.post("/api/datasources",i)}return Promise.resolve()})},t.template="",t}()},1512:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"AnnotationsQueryCtrl",function(){return i});var r=n(1513),a=n(1514);n.d(e,"TestDataDatasource",function(){return r.a}),n.d(e,"Datasource",function(){return r.a}),n.d(e,"QueryCtrl",function(){return a.a});var i=function(){function t(){}return t.template="<h2>test data</h2>",t}()},1513:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(7),a=n.n(r),i=function(){function t(t,e,n){this.backendSrv=e,this.$q=n,this.id=t.id}return t.$inject=["instanceSettings","backendSrv","$q"],t.prototype.query=function(t){var e=this,n=a.a.filter(t.targets,function(t){return!0!==t.hide}).map(function(n){return{refId:n.refId,scenarioId:n.scenarioId,intervalMs:t.intervalMs,maxDataPoints:t.maxDataPoints,stringInput:n.stringInput,points:n.points,alias:n.alias,datasourceId:e.id}});return 0===n.length?this.$q.when({data:[]}):this.backendSrv.post("/api/tsdb/query",{from:t.range.from.valueOf().toString(),to:t.range.to.valueOf().toString(),queries:n}).then(function(t){var e=[];return t.results&&a.a.forEach(t.results,function(t){for(var n=0,r=t.series;n<r.length;n++){var a=r[n];e.push({target:a.name,datapoints:a.points})}}),{data:e}})},t.prototype.annotationQuery=function(t){return this.backendSrv.get("/api/annotations",{from:t.range.from.valueOf(),to:t.range.to.valueOf(),limit:t.limit,type:t.type})},t}()},1514:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var r=n(7),a=n.n(r),i=n(1305),o=n(1),s=n.n(o),l=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=function(t){function e(e,n,r){var a=t.call(this,e,n)||this;return a.backendSrv=r,a.target.scenarioId=a.target.scenarioId||"random_walk",a.scenarioList=[],a.newPointTime=s()(),a.selectedPoint={text:"Select point",value:null},a}return l(e,t),e.$inject=["$scope","$injector","backendSrv"],e.prototype.getPoints=function(){return a.a.map(this.target.points,function(t,e){return{text:s()(t[1]).format("MMMM Do YYYY, H:mm:ss")+" : "+t[0],value:e}})},e.prototype.pointSelected=function(t){this.selectedPoint=t},e.prototype.deletePoint=function(){this.target.points.splice(this.selectedPoint.value,1),this.selectedPoint={text:"Select point",value:null},this.refresh()},e.prototype.addPoint=function(){this.target.points=this.target.points||[],this.target.points.push([this.newPointValue,this.newPointTime.valueOf()]),this.target.points=a.a.sortBy(this.target.points,function(t){return t[1]}),this.refresh()},e.prototype.$onInit=function(){var t=this;return this.backendSrv.get("/api/tsdb/testdata/scenarios").then(function(e){t.scenarioList=e,t.scenario=a.a.find(t.scenarioList,{id:t.target.scenarioId})})},e.prototype.scenarioChanged=function(){this.scenario=a.a.find(this.scenarioList,{id:this.target.scenarioId}),this.target.stringInput=this.scenario.stringInput,"manual_entry"===this.target.scenarioId?this.target.points=this.target.points||[]:delete this.target.points,this.refresh()},e.templateUrl="partials/query.editor.html",e}(i.QueryCtrl)},1515:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(466),i=n(468),o=n(472),s=n(1516),l=n(1517),u=n(205),c=function(t){function e(e){t.call(this,e),this.destination=e}return r(e,t),e}(i.Subscriber);e.SubjectSubscriber=c;var p=function(t){function e(){t.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return r(e,t),e.prototype[u.rxSubscriber]=function(){return new c(this)},e.prototype.lift=function(t){var e=new h(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),a=0;a<n;a++)r[a].next(t)},e.prototype.error=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),a=0;a<n;a++)r[a].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new s.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new s.ObjectUnsubscribedError;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new s.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),o.Subscription.EMPTY):this.isStopped?(t.complete(),o.Subscription.EMPTY):(this.observers.push(t),new l.SubjectSubscription(this,t))},e.prototype.asObservable=function(){var t=new a.Observable;return t.source=this,t},e.create=function(t,e){return new h(t,e)},e}(a.Observable);e.Subject=p;var h=function(t){function e(e,n){t.call(this),this.destination=e,this.source=n}return r(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):o.Subscription.EMPTY},e}(p);e.AnonymousSubject=h},1516:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(t){function e(){var e=t.call(this,"object unsubscribed");this.name=e.name="ObjectUnsubscribedError",this.stack=e.stack,this.message=e.message}return r(e,t),e}(Error);e.ObjectUnsubscribedError=a},1517:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(472),i=function(t){function e(e,n){t.call(this),this.subject=e,this.subscriber=n,this.closed=!1}return r(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(a.Subscription);e.SubjectSubscription=i},1518:function(t,e,n){"use strict";var r=n(466),a=n(1519);r.Observable.empty=a.empty},1519:function(t,e,n){"use strict";var r=n(1320);e.empty=r.EmptyObservable.create},1520:function(t,e,n){"use strict";var r=n(466),a=n(1521);r.Observable.from=a.from},1521:function(t,e,n){"use strict";var r=n(1522);e.from=r.FromObservable.create},1522:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(473),i=n(1344),o=n(1345),s=n(1523),l=n(1524),u=n(1346),c=n(1526),p=n(1321),h=n(466),d=n(1527),f=n(474),m=function(t){function e(e,n){t.call(this,null),this.ish=e,this.scheduler=n}return r(e,t),e.create=function(t,n){if(null!=t){if("function"==typeof t[f.observable])return t instanceof h.Observable&&!n?t:new e(t,n);if(a.isArray(t))return new u.ArrayObservable(t,n);if(o.isPromise(t))return new s.PromiseObservable(t,n);if("function"==typeof t[p.iterator]||"string"==typeof t)return new l.IteratorObservable(t,n);if(i.isArrayLike(t))return new c.ArrayLikeObservable(t,n)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")},e.prototype._subscribe=function(t){var e=this.ish,n=this.scheduler;return null==n?e[f.observable]().subscribe(t):e[f.observable]().subscribe(new d.ObserveOnSubscriber(t,n,0))},e}(h.Observable);e.FromObservable=m},1523:function(t,e,n){"use strict";function r(t){var e=t.value,n=t.subscriber;n.closed||(n.next(e),n.complete())}function a(t){var e=t.err,n=t.subscriber;n.closed||n.error(e)}var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(127),s=n(466),l=function(t){function e(e,n){t.call(this),this.promise=e,this.scheduler=n}return i(e,t),e.create=function(t,n){return new e(t,n)},e.prototype._subscribe=function(t){var e=this,n=this.promise,i=this.scheduler;if(null==i)this._isScalar?t.closed||(t.next(this.value),t.complete()):n.then(function(n){e.value=n,e._isScalar=!0,t.closed||(t.next(n),t.complete())},function(e){t.closed||t.error(e)}).then(null,function(t){o.root.setTimeout(function(){throw t})});else if(this._isScalar){if(!t.closed)return i.schedule(r,0,{value:this.value,subscriber:t})}else n.then(function(n){e.value=n,e._isScalar=!0,t.closed||t.add(i.schedule(r,0,{value:n,subscriber:t}))},function(e){t.closed||t.add(i.schedule(a,0,{err:e,subscriber:t}))}).then(null,function(t){o.root.setTimeout(function(){throw t})})},e}(s.Observable);e.PromiseObservable=l},1524:function(t,e,n){"use strict";function r(t){var e=t[c.iterator];if(!e&&"string"==typeof t)return new h(t);if(!e&&void 0!==t.length)return new d(t);if(!e)throw new TypeError("object is not iterable");return t[c.iterator]()}function a(t){var e=+t.length;return isNaN(e)?0:0!==e&&i(e)?(e=o(e)*Math.floor(Math.abs(e)),e<=0?0:e>f?f:e):e}function i(t){return"number"==typeof t&&l.root.isFinite(t)}function o(t){var e=+t;return 0===e?e:isNaN(e)?e:e<0?-1:1}var s=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},l=n(127),u=n(466),c=n(1321),p=function(t){function e(e,n){if(t.call(this),this.scheduler=n,null==e)throw new Error("iterator cannot be null.");this.iterator=r(e)}return s(e,t),e.create=function(t,n){return new e(t,n)},e.dispatch=function(t){var e=t.index,n=t.hasError,r=t.iterator,a=t.subscriber;if(n)return void a.error(t.error);var i=r.next();return i.done?void a.complete():(a.next(i.value),t.index=e+1,a.closed?void("function"==typeof r.return&&r.return()):void this.schedule(t))},e.prototype._subscribe=function(t){var n=this,r=n.iterator,a=n.scheduler;if(a)return a.schedule(e.dispatch,0,{index:0,iterator:r,subscriber:t});for(;;){var i=r.next();if(i.done){t.complete();break}if(t.next(i.value),t.closed){"function"==typeof r.return&&r.return();break}}},e}(u.Observable);e.IteratorObservable=p;var h=function(){function t(t,e,n){void 0===e&&(e=0),void 0===n&&(n=t.length),this.str=t,this.idx=e,this.len=n}return t.prototype[c.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}},t}(),d=function(){function t(t,e,n){void 0===e&&(e=0),void 0===n&&(n=a(t)),this.arr=t,this.idx=e,this.len=n}return t.prototype[c.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:void 0}},t}(),f=Math.pow(2,53)-1},1525:function(t,e,n){"use strict";function r(t){return t&&"function"==typeof t.schedule}e.isScheduler=r},1526:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(466),i=n(1347),o=n(1320),s=function(t){function e(e,n){t.call(this),this.arrayLike=e,this.scheduler=n,n||1!==e.length||(this._isScalar=!0,this.value=e[0])}return r(e,t),e.create=function(t,n){var r=t.length;return 0===r?new o.EmptyObservable:1===r?new i.ScalarObservable(t[0],n):new e(t,n)},e.dispatch=function(t){var e=t.arrayLike,n=t.index,r=t.length,a=t.subscriber;if(!a.closed){if(n>=r)return void a.complete();a.next(e[n]),t.index=n+1,this.schedule(t)}},e.prototype._subscribe=function(t){var n=this,r=n.arrayLike,a=n.scheduler,i=r.length;if(a)return a.schedule(e.dispatch,0,{arrayLike:r,index:0,length:i,subscriber:t});for(var o=0;o<i&&!t.closed;o++)t.next(r[o]);t.complete()},e}(a.Observable);e.ArrayLikeObservable=s},1527:function(t,e,n){"use strict";function r(t,e){return void 0===e&&(e=0),function(n){return n.lift(new s(t,e))}}var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(468),o=n(1528);e.observeOn=r;var s=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.scheduler,this.delay))},t}();e.ObserveOnOperator=s;var l=function(t){function e(e,n,r){void 0===r&&(r=0),t.call(this,e),this.scheduler=n,this.delay=r}return a(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.add(this.scheduler.schedule(e.dispatch,this.delay,new u(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(o.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(o.Notification.createError(t))},e.prototype._complete=function(){this.scheduleMessage(o.Notification.createComplete())},e}(i.Subscriber);e.ObserveOnSubscriber=l;var u=function(){function t(t,e){this.notification=t,this.destination=e}return t}();e.ObserveOnMessage=u},1528:function(t,e,n){"use strict";var r=n(466),a=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return r.Observable.of(this.value);case"E":return r.Observable.throw(this.error);case"C":return r.Observable.empty()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}();e.Notification=a},1529:function(t,e,n){"use strict";var r=n(466),a=n(1530);r.Observable.prototype.map=a.map},1530:function(t,e,n){"use strict";function r(t,e){return a.map(t,e)(this)}var a=n(1531);e.map=r},1531:function(t,e,n){"use strict";function r(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new o(t,e))}}var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(468);e.map=r;var o=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new s(t,this.project,this.thisArg))},t}();e.MapOperator=o;var s=function(t){function e(e,n,r){t.call(this,e),this.project=n,this.count=0,this.thisArg=r||this}return a(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(i.Subscriber)},1532:function(t,e,n){"use strict";var r=n(466),a=n(1533);r.Observable.prototype.combineAll=a.combineAll},1533:function(t,e,n){"use strict";function r(t){return a.combineAll(t)(this)}var a=n(1534);e.combineAll=r},1534:function(t,e,n){"use strict";function r(t){return function(e){return e.lift(new a.CombineLatestOperator(t))}}var a=n(1535);e.combineAll=r},1535:function(t,e,n){"use strict";function r(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var n=null;return"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&o.isArray(t[0])&&(t=t[0].slice()),function(e){return e.lift.call(new i.ArrayObservable([e].concat(t)),new c(n))}}var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=n(1346),o=n(473),s=n(1536),l=n(1537),u={};e.combineLatest=r;var c=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.project))},t}();e.CombineLatestOperator=c;var p=function(t){function e(e,n){t.call(this,e),this.project=n,this.active=0,this.values=[],this.observables=[]}return a(e,t),e.prototype._next=function(t){this.values.push(u),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var r=t[n];this.add(l.subscribeToResult(this,r,r,n))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n,r,a){var i=this.values,o=i[n],s=this.toRespond?o===u?--this.toRespond:this.toRespond:0;i[n]=e,0===s&&(this.project?this._tryProject(i):this.destination.next(i.slice()))},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(s.OuterSubscriber);e.CombineLatestSubscriber=p},1536:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(468),i=function(t){function e(){t.apply(this,arguments)}return r(e,t),e.prototype.notifyNext=function(t,e,n,r,a){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(a.Subscriber);e.OuterSubscriber=i},1537:function(t,e,n){"use strict";function r(t,e,n,r){var h=new c.InnerSubscriber(t,n,r);if(h.closed)return null;if(e instanceof l.Observable)return e._isScalar?(h.next(e.value),h.complete(),null):(h.syncErrorThrowable=!0,e.subscribe(h));if(i.isArrayLike(e)){for(var d=0,f=e.length;d<f&&!h.closed;d++)h.next(e[d]);h.closed||h.complete()}else{if(o.isPromise(e))return e.then(function(t){h.closed||(h.next(t),h.complete())},function(t){return h.error(t)}).then(null,function(t){a.root.setTimeout(function(){throw t})}),h;if(e&&"function"==typeof e[u.iterator])for(var m=e[u.iterator]();;){var g=m.next();if(g.done){h.complete();break}if(h.next(g.value),h.closed)break}else if(e&&"function"==typeof e[p.observable]){var v=e[p.observable]();if("function"==typeof v.subscribe)return v.subscribe(new c.InnerSubscriber(t,n,r));h.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var y=s.isObject(e)?"an invalid object":"'"+e+"'",b="You provided "+y+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";h.error(new TypeError(b))}}return null}var a=n(127),i=n(1344),o=n(1345),s=n(476),l=n(466),u=n(1321),c=n(1538),p=n(474);e.subscribeToResult=r},1538:function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=n(468),i=function(t){function e(e,n,r){t.call(this),this.parent=e,this.outerValue=n,this.outerIndex=r,this.index=0}return r(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(a.Subscriber);e.InnerSubscriber=i},1539:function(t,e){!function(t){function e(e){function i(e,n,r){k||(k=!0,y=e.getCanvas(),b=t(y).parent(),a=e.getOptions(),e.setData(o(e.getData())))}function o(e){for(var n=0,r=0,i=0,o=a.series.pie.combine.color,s=[],l=0;l<e.length;++l){var u=e[l].data;t.isArray(u)&&1==u.length&&(u=u[0]),t.isArray(u)?!isNaN(parseFloat(u[1]))&&isFinite(u[1])?u[1]=+u[1]:u[1]=0:u=!isNaN(parseFloat(u))&&isFinite(u)?[1,+u]:[1,0],e[l].data=[u]}for(var l=0;l<e.length;++l)n+=e[l].data[0][1];for(var l=0;l<e.length;++l){var u=e[l].data[0][1];u/n<=a.series.pie.combine.threshold&&(r+=u,i++,o||(o=e[l].color))}for(var l=0;l<e.length;++l){var u=e[l].data[0][1];(i<2||u/n>a.series.pie.combine.threshold)&&s.push({data:[[1,u]],color:e[l].color,label:e[l].label,angle:u*Math.PI*2/n,percent:u/(n/100)})}return i>1&&s.push({data:[[1,r]],color:o,label:a.series.pie.combine.label,angle:r*Math.PI*2/n,percent:r/(n/100)}),s}function s(e,i){function o(){_.clearRect(0,0,s,u),b.children().filter(".pieLabel, .pieLabelBackground").remove()}if(b){var s=e.getPlaceholder().width(),u=e.getPlaceholder().height(),c=b.children().filter(".legend").children().width()||0;_=i,k=!1,x=Math.min(s,u/a.series.pie.tilt)/2,w=u/2+a.series.pie.offset.top,S=s/2,"auto"==a.series.pie.offset.left?a.legend.position.match("w")?S+=c/2:S-=c/2:S+=a.series.pie.offset.left,S<x?S=x:S>s-x&&(S=s-x);var p=e.getData(),h=0;do{h>0&&(x*=r),h+=1,o(),a.series.pie.tilt<=.8&&function(){var t=a.series.pie.shadow.left,e=a.series.pie.shadow.top,n=a.series.pie.shadow.alpha,r=a.series.pie.radius>1?a.series.pie.radius:x*a.series.pie.radius;if(!(r>=s/2-t||r*a.series.pie.tilt>=u/2-e||r<=10)){_.save(),_.translate(t,e),_.globalAlpha=n,_.fillStyle="#000",_.translate(S,w),_.scale(1,a.series.pie.tilt);for(var i=1;i<=10;i++)_.beginPath(),_.arc(0,0,r,0,2*Math.PI,!1),_.fill(),r-=i;_.restore()}}()}while(!function(){function e(t,e,n){t<=0||isNaN(t)||(n?_.fillStyle=e:(_.strokeStyle=e,_.lineJoin="round"),_.beginPath(),Math.abs(t-2*Math.PI)>1e-9&&_.moveTo(0,0),_.arc(0,0,r,i,i+t/2,!1),_.arc(0,0,r,i+t/2,i+t,!1),_.closePath(),i+=t,n?_.fill():_.stroke())}var n=Math.PI*a.series.pie.startAngle,r=a.series.pie.radius>1?a.series.pie.radius:x*a.series.pie.radius;_.save(),_.translate(S,w),_.scale(1,a.series.pie.tilt),_.save();for(var i=n,o=0;o<p.length;++o)p[o].startAngle=i,e(p[o].angle,p[o].color,!0);if(_.restore(),a.series.pie.stroke.width>0){_.save(),_.lineWidth=a.series.pie.stroke.width,i=n;for(var o=0;o<p.length;++o)e(p[o].angle,a.series.pie.stroke.color,!1);_.restore()}return l(_),_.restore(),!a.series.pie.label.show||function(){for(var e=n,r=a.series.pie.label.radius>1?a.series.pie.label.radius:x*a.series.pie.label.radius,i=0;i<p.length;++i){if(p[i].percent>=100*a.series.pie.label.threshold&&!function(e,n,i){if(0==e.data[0][1])return!0;var o,l=a.legend.labelFormatter,c=a.series.pie.label.formatter;o=l?l(e.label,e):e.label,c&&(o=c(o,e));var p=(n+e.angle+n)/2,h=S+Math.round(Math.cos(p)*r),d=w+Math.round(Math.sin(p)*r)*a.series.pie.tilt,f="<span class='pieLabel' id='pieLabel"+i+"' style='position:absolute;top:"+d+"px;left:"+h+"px;'>"+o+"</span>";b.append(f);var m=b.children("#pieLabel"+i),g=d-m.height()/2,v=h-m.width()/2;if(m.css("top",g),m.css("left",v),0-g>0||0-v>0||u-(g+m.height())<0||s-(v+m.width())<0)return!1;if(0!=a.series.pie.label.background.opacity){var y=a.series.pie.label.background.color;null==y&&(y=e.color);var x="top:"+g+"px;left:"+v+"px;";t("<div class='pieLabelBackground' style='position:absolute;width:"+m.width()+"px;height:"+m.height()+"px;"+x+"background-color:"+y+";'></div>").css("opacity",a.series.pie.label.background.opacity).insertBefore(m)}return!0}(p[i],e,i))return!1;e+=p[i].angle}return!0}()}()&&h<n);h>=n&&(o(),b.prepend("<div class='error'>Could not draw pie with labels contained inside canvas</div>")),e.setSeries&&e.insertLegend&&(e.setSeries(p),e.insertLegend())}}function l(t){if(a.series.pie.innerRadius>0){t.save();var e=a.series.pie.innerRadius>1?a.series.pie.innerRadius:x*a.series.pie.innerRadius;t.globalCompositeOperation="destination-out",t.beginPath(),t.fillStyle=a.series.pie.stroke.color,t.arc(0,0,e,0,2*Math.PI,!1),t.fill(),t.closePath(),t.restore(),t.save(),t.beginPath(),t.strokeStyle=a.series.pie.stroke.color,t.arc(0,0,e,0,2*Math.PI,!1),t.stroke(),t.closePath(),t.restore()}}function u(t,e){for(var n=!1,r=-1,a=t.length,i=a-1;++r<a;i=r)(t[r][1]<=e[1]&&e[1]<t[i][1]||t[i][1]<=e[1]&&e[1]<t[r][1])&&e[0]<(t[i][0]-t[r][0])*(e[1]-t[r][1])/(t[i][1]-t[r][1])+t[r][0]&&(n=!n);return n}function c(t,n){for(var r,a,i=e.getData(),o=e.getOptions(),s=o.series.pie.radius>1?o.series.pie.radius:x*o.series.pie.radius,l=0;l<i.length;++l){var c=i[l];if(c.pie.show){if(_.save(),_.beginPath(),_.moveTo(0,0),_.arc(0,0,s,c.startAngle,c.startAngle+c.angle/2,!1),_.arc(0,0,s,c.startAngle+c.angle/2,c.startAngle+c.angle,!1),_.closePath(),r=t-S,a=n-w,_.isPointInPath){if(_.isPointInPath(t-S,n-w))return _.restore(),{datapoint:[c.percent,c.data],dataIndex:0,series:c,seriesIndex:l}}else{if(u([[0,0],[s*Math.cos(c.startAngle),s*Math.sin(c.startAngle)],[s*Math.cos(c.startAngle+c.angle/4),s*Math.sin(c.startAngle+c.angle/4)],[s*Math.cos(c.startAngle+c.angle/2),s*Math.sin(c.startAngle+c.angle/2)],[s*Math.cos(c.startAngle+c.angle/1.5),s*Math.sin(c.startAngle+c.angle/1.5)],[s*Math.cos(c.startAngle+c.angle),s*Math.sin(c.startAngle+c.angle)]],[r,a]))return _.restore(),{datapoint:[c.percent,c.data],dataIndex:0,series:c,seriesIndex:l}}_.restore()}}return null}function p(t){d("plothover",t)}function h(t){d("plotclick",t)}function d(t,n){var r=e.offset(),i=parseInt(n.pageX-r.left),o=parseInt(n.pageY-r.top),s=c(i,o);if(a.grid.autoHighlight)for(var l=0;l<M.length;++l){var u=M[l];u.auto!=t||s&&u.series==s.series||m(u.series)}s&&f(s.series,t);var p={pageX:n.pageX,pageY:n.pageY};b.trigger(t,[p,s])}function f(t,n){var r=g(t);-1==r?(M.push({series:t,auto:n}),e.triggerRedrawOverlay()):n||(M[r].auto=!1)}function m(t){null==t&&(M=[],e.triggerRedrawOverlay());var n=g(t);-1!=n&&(M.splice(n,1),e.triggerRedrawOverlay())}function g(t){for(var e=0;e<M.length;++e){if(M[e].series==t)return e}return-1}function v(t,e){var n=t.getOptions(),r=n.series.pie.radius>1?n.series.pie.radius:x*n.series.pie.radius;e.save(),e.translate(S,w),e.scale(1,n.series.pie.tilt);for(var a=0;a<M.length;++a)!function(t){t.angle<=0||isNaN(t.angle)||(e.fillStyle="rgba(255, 255, 255, "+n.series.pie.highlight.opacity+")",e.beginPath(),Math.abs(t.angle-2*Math.PI)>1e-9&&e.moveTo(0,0),e.arc(0,0,r,t.startAngle,t.startAngle+t.angle/2,!1),e.arc(0,0,r,t.startAngle+t.angle/2,t.startAngle+t.angle,!1),e.closePath(),e.fill())}(M[a].series);l(e),e.restore()}var y=null,b=null,x=null,S=null,w=null,k=!1,_=null,M=[];e.hooks.processOptions.push(function(t,e){e.series.pie.show&&(e.grid.show=!1,"auto"==e.series.pie.label.show&&(e.legend.show?e.series.pie.label.show=!1:e.series.pie.label.show=!0),"auto"==e.series.pie.radius&&(e.series.pie.label.show?e.series.pie.radius=.75:e.series.pie.radius=1),e.series.pie.tilt>1?e.series.pie.tilt=1:e.series.pie.tilt<0&&(e.series.pie.tilt=0))}),e.hooks.bindEvents.push(function(t,e){var n=t.getOptions();n.series.pie.show&&(n.grid.hoverable&&e.unbind("mousemove").mousemove(p),n.grid.clickable&&e.unbind("click").click(h))}),e.hooks.processDatapoints.push(function(t,e,n,r){t.getOptions().series.pie.show&&i(t,e,n)}),e.hooks.drawOverlay.push(function(t,e){t.getOptions().series.pie.show&&v(t,e)}),e.hooks.draw.push(function(t,e){t.getOptions().series.pie.show&&s(t,e)})}var n=10,r=.95,a={series:{pie:{show:!1,radius:"auto",innerRadius:0,startAngle:1.5,tilt:1,shadow:{left:5,top:15,alpha:.02},offset:{top:0,left:"auto"},stroke:{color:"#fff",width:1},label:{show:"auto",formatter:function(t,e){return"<div style='font-size:x-small;text-align:center;padding:2px;color:"+e.color+";'>"+t+"<br/>"+Math.round(e.percent)+"%</div>"},radius:1,background:{color:null,opacity:0},threshold:0},combine:{threshold:-1,color:null,label:"Other"},highlight:{opacity:.5}}}};t.plot.plugins.push({init:e,options:a,name:"pie",version:"1.1"})}(jQuery)},1540:function(t,e,n){"use strict";function r(t,e,n,r,a,o){function h(t){if(t.template)return r.when(t.template);var e=o.get(t.templateUrl);return e?r.when(e):a.get(t.templateUrl).then(function(t){return t.data})}function d(t,e){if(t)return 0===t.indexOf("public")?t:e+"/"+t}function f(t){return t.Component.templateUrl=d(t.Component.templateUrl,t.baseUrl),function(){return{templateUrl:t.Component.templateUrl,template:t.Component.template,restrict:"E",controller:t.Component,controllerAs:"ctrl",bindToController:!0,scope:t.bindings,link:function(t,e,n,r){r.link&&r.link(t,e,n,r),r.init&&r.init()}}}}function m(t,e){var n={name:"panel-plugin-"+t.panel.type,bindings:{dashboard:"=",panel:"=",row:"="},attrs:{dashboard:"ctrl.dashboard",panel:"panel",row:"ctrl.row"}},r=l.default.panels[t.panel.type],a=Promise.resolve(p.a);return r&&(a=Object(c.importPluginModule)(r.module).then(function(t){return t.PanelCtrl})),a.then(function(t){return n.Component=t,!t||t.registered?n:t.templatePromise?t.templatePromise.then(function(t){return n}):(r&&(t.templateUrl=d(t.templateUrl,r.baseUrl)),t.templatePromise=h(t).then(function(e){return t.templateUrl=null,t.template='<grafana-panel ctrl="ctrl">'+e+"</grafana-panel>",n}),t.templatePromise)})}function g(t,n){switch(n.type){case"query-ctrl":var a=t.target.datasource||t.ctrl.panel.datasource;return e.get(a).then(function(e){return t.datasource=e,Object(c.importPluginModule)(e.meta.module).then(function(t){return{baseUrl:e.meta.baseUrl,name:"query-ctrl-"+e.meta.id,bindings:{target:"=",panelCtrl:"=",datasource:"="},attrs:{target:"target","panel-ctrl":"ctrl.panelCtrl",datasource:"datasource"},Component:t.QueryCtrl}})});case"query-options-ctrl":return e.get(t.ctrl.panel.datasource).then(function(t){return Object(c.importPluginModule)(t.meta.module).then(function(e){return e.QueryOptionsCtrl?{baseUrl:t.meta.baseUrl,name:"query-options-ctrl-"+t.meta.id,bindings:{panelCtrl:"="},attrs:{"panel-ctrl":"ctrl.panelCtrl"},Component:e.QueryOptionsCtrl}:{notFound:!0}})});case"annotations-query-ctrl":return Object(c.importPluginModule)(t.ctrl.currentDatasource.meta.module).then(function(e){return{baseUrl:t.ctrl.currentDatasource.meta.baseUrl,name:"annotations-query-ctrl-"+t.ctrl.currentDatasource.meta.id,bindings:{annotation:"=",datasource:"="},attrs:{annotation:"ctrl.currentAnnotation",datasource:"ctrl.currentDatasource"},Component:e.AnnotationsQueryCtrl}});case"datasource-config-ctrl":var i=t.ctrl.datasourceMeta;return Object(c.importPluginModule)(i.module).then(function(t){return t.ConfigCtrl?{baseUrl:i.baseUrl,name:"ds-config-"+i.id,bindings:{meta:"=",current:"="},attrs:{meta:"ctrl.datasourceMeta",current:"ctrl.current"},Component:t.ConfigCtrl}:{notFound:!0}});case"app-config-ctrl":var o=t.ctrl.model;return Object(c.importPluginModule)(o.module).then(function(t){return{baseUrl:o.baseUrl,name:"app-config-"+o.id,bindings:{appModel:"=",appEditCtrl:"="},attrs:{"app-model":"ctrl.model","app-edit-ctrl":"ctrl"},Component:t.ConfigCtrl}});case"app-page":var s=t.ctrl.appModel;return Object(c.importPluginModule)(s.module).then(function(e){return{baseUrl:s.baseUrl,name:"app-page-"+s.id+"-"+t.ctrl.page.slug,bindings:{appModel:"="},attrs:{"app-model":"ctrl.appModel"},Component:e[t.ctrl.page.component]}});case"panel":return m(t,n);default:return r.reject({message:"Could not find component type: "+n.type})}}function v(e,n,r){var a=i.a.element(document.createElement(r.name));s.a.each(r.attrs,function(t,e){a.attr(e,t)}),t(a)(e),n.empty(),setTimeout(function(){n.append(a),e.$applyAsync(function(){e.$broadcast("refresh")})})}function y(t,e,n,r){if(r.notFound)return void e.empty();if(!r.Component)throw{message:"Failed to find exported plugin component for "+r.name};if(!r.Component.registered){var a=n.$normalize(r.name),i=f(r);u.default.directive(a,i),r.Component.registered=!0}v(t,e,r)}return{restrict:"E",link:function(t,e,r){g(t,r).then(function(n){y(t,e,r,n)}).catch(function(t){n.appEvent("alert-error",["Plugin Error",t.message||t]),console.log("Plugin component error",t)})}}}r.$inject=["$compile","datasourceSrv","$rootScope","$q","$http","$templateCache"];var a=n(12),i=n.n(a),o=n(7),s=n.n(o),l=n(27),u=n(2),c=n(1317),p=n(1541);u.default.directive("pluginComponent",r)},1541:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(1313),a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=function(t){function e(e,n){return t.call(this,e,n)||this}return a(e,t),e.$inject=["$scope","$injector"],e.templateUrl="public/app/plugins/panel/unknown/module.html",e}(r.a)},1542:function(t,e,n){(function(t){var r,a;r=[n(12),n(7)],void 0!==(a=function(t,e){"use strict";var n=t.module("grafana.directives"),r={"external link":"fa-external-link",dashboard:"fa-th-large",question:"fa-question",info:"fa-info",bolt:"fa-bolt",doc:"fa-file-text-o",cloud:"fa-cloud"};n.directive("dashLinksEditor",function(){return{restrict:"E",controller:"DashLinkEditorCtrl",templateUrl:"public/app/features/dashlinks/editor.html",link:function(){}}}),n.directive("dashLinksContainer",function(){return{scope:{links:"="},restrict:"E",controller:"DashLinksContainerCtrl",template:'<dash-link ng-repeat="link in generatedLinks" link="link"></dash-link>',link:function(){}}}),n.directive("dashLink",["$compile","linkSrv",function(t,e){return{restrict:"E",link:function(n,r){function a(){var t=e.getAnchorInfo(i);u.text(t.title),s.attr("href",t.href)}var i=n.link,o='<div class="gf-form"><a class="pointer gf-form-label" data-placement="bottom"'+(i.asDropdown?' ng-click="fillDropdown(link)" data-toggle="dropdown"':"")+"><i></i> <span></span></a>";i.asDropdown&&(o+='<ul class="dropdown-menu" role="menu"><li ng-repeat="dash in link.searchHits"><a href="{{dash.url}}">{{dash.title}}</a></li></ul>'),o+="</div>",r.html(o),t(r.contents())(n);var s=r.find("a"),l=r.find("i"),u=r.find("span");r.find("a").tooltip({title:n.link.tooltip,html:!0,container:"body"}),l.attr("class","fa fa-fw "+n.link.icon),s.attr("target",n.link.target),i.asDropdown&&n.$last&&r.find(".dropdown-menu").addClass("pull-right"),a(),n.$on("refresh",a)}}}]),n.controller("DashLinksContainerCtrl",["$scope","$rootScope","$q","backendSrv","dashboardSrv","linkSrv",function(t,n,a,i,o,s){function l(e){return"dashboards"===e.type?e.tags?e.asDropdown?a.when([{title:e.title,tags:e.tags,keepTime:e.keepTime,includeVars:e.includeVars,icon:"fa fa-bars",asDropdown:!0}]):t.searchDashboards(e,7):(console.log("Dashboard link missing tag"),a.when([])):"link"===e.type?a.when([{url:e.url,title:e.title,icon:r[e.icon],tooltip:e.tooltip,target:e.targetBlank?"_blank":"_self",keepTime:e.keepTime,includeVars:e.includeVars}]):a.when([])}function u(){var n=e.map(t.links,l);a.all(n).then(function(n){t.generatedLinks=e.flatten(n)})}var c=o.getCurrent().id;t.searchDashboards=function(t,n){return i.search({tag:t.tags,limit:n}).then(function(n){return e.reduce(n,function(e,n){return n.id!==c&&e.push({title:n.title,url:"dashboard/"+n.uri,icon:"fa fa-th-large",keepTime:t.keepTime,includeVars:t.includeVars}),e},[])})},t.fillDropdown=function(n){t.searchDashboards(n,100).then(function(t){e.each(t,function(t){t.url=s.getLinkUrl(t)}),n.searchHits=t})},u(),n.onAppEvent("dash-links-updated",u,t)}]),n.controller("DashLinkEditorCtrl",["$scope","$rootScope",function(t,n){t.iconMap=r,t.dashboard.links=t.dashboard.links||[],t.addLink=function(){t.dashboard.links.push({type:"dashboards",icon:"external link"}),t.dashboard.updateSubmenuVisibility(),t.updated()},t.moveLink=function(n,r){e.move(t.dashboard.links,n,n+r),t.updated()},t.updated=function(){n.appEvent("dash-links-updated")},t.deleteLink=function(e){t.dashboard.links.splice(e,1),t.dashboard.updateSubmenuVisibility(),t.updated()}}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1543:function(t,e,n){var r,a;r=[n(1544),n(1545),n(1546),n(1547),n(1548)],void 0!==(a=function(){}.apply(e,r))&&(t.exports=a)},1544:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PlaylistsCtrl",function(){return o});var r=n(7),a=n.n(r),i=n(2),o=function(){function t(t,e,n){var r=this;this.$scope=t,this.backendSrv=e,this.navModel=n.getPlaylistsNav(0),e.get("/api/playlists").then(function(t){r.playlists=t})}return t.$inject=["$scope","backendSrv","navModelSrv"],t.prototype.removePlaylistConfirmed=function(t){var e=this;a.a.remove(this.playlists,{id:t.id}),this.backendSrv.delete("/api/playlists/"+t.id).then(function(){e.$scope.appEvent("alert-success",["Playlist deleted",""])},function(){e.$scope.appEvent("alert-error",["Unable to delete playlist",""]),e.playlists.push(t)})},t.prototype.removePlaylist=function(t){var e=this;this.$scope.appEvent("confirm-modal",{title:"Delete",text:"Are you sure you want to delete playlist "+t.name+"?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.removePlaylistConfirmed(t)}})},t}();i.default.controller("PlaylistsCtrl",o)},1545:function(t,e,n){"use strict";function r(){return{restrict:"E",templateUrl:"public/app/features/playlist/partials/playlist_search.html",controller:i,bindToController:!0,controllerAs:"ctrl",scope:{searchStarted:"&"}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PlaylistSearchCtrl",function(){return i}),e.playlistSearchDirective=r;var a=n(2),i=function(){function t(t,e){var n=this;this.backendSrv=e,this.query={query:"",tag:[],starred:!1,limit:30},t(function(){n.query.query="",n.searchDashboards()},100)}return t.$inject=["$timeout","backendSrv"],t.prototype.searchDashboards=function(){this.tagsMode=!1;var t={};t.promise=this.backendSrv.search(this.query).then(function(t){return{dashboardResult:t,tagResult:[]}}),this.searchStarted(t)},t.prototype.showStarred=function(){this.query.starred=!this.query.starred,this.searchDashboards()},t.prototype.queryHasNoFilters=function(){return""===this.query.query&&!1===this.query.starred&&0===this.query.tag.length},t.prototype.filterByTag=function(t,e){this.query.tag.push(t),this.searchDashboards(),e&&(e.stopPropagation(),e.preventDefault())},t.prototype.getTags=function(){var t={};t.promise=this.backendSrv.get("/api/dashboards/tags").then(function(t){return{dashboardResult:[],tagResult:t}}),this.searchStarted(t)},t}();a.default.directive("playlistSearch",r)},1546:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),a=n(464),i=n(53),o=function(){function t(t,e,n,r){this.$location=t,this.$timeout=e,this.backendSrv=n,this.$routeParams=r}return t.$inject=["$location","$timeout","backendSrv","$routeParams"],t.prototype.next=function(){var t=this;if(this.$timeout.cancel(this.cancelPromise),this.index>this.dashboards.length-1)return void(window.location.href=this.getUrlWithKioskMode());var e=this.dashboards[this.index];this.$location.url("dashboard/"+e.uri),this.index++,this.cancelPromise=this.$timeout(function(){return t.next()},this.interval)},t.prototype.getUrlWithKioskMode=function(){var t=document.body.classList.contains("page-kiosk-mode");return t&&-1===this.startUrl.indexOf("kiosk")?this.startUrl+"?kiosk=true":t?this.startUrl:this.startUrl.split("?")[0]},t.prototype.prev=function(){this.index=Math.max(this.index-2,0),this.next()},t.prototype.start=function(t){var e=this;this.stop(),this.startUrl=window.location.href,this.index=0,this.playlistId=t,this.isPlaying=!0,this.$routeParams.kiosk&&i.a.emit("toggle-kiosk-mode"),this.backendSrv.get("/api/playlists/"+t).then(function(n){e.backendSrv.get("/api/playlists/"+t+"/dashboards").then(function(t){e.dashboards=t,e.interval=a.default.interval_to_ms(n.interval),e.next()})})},t.prototype.stop=function(){this.index=0,this.isPlaying=!1,this.playlistId=0,this.cancelPromise&&this.$timeout.cancel(this.cancelPromise)},t}();r.default.service("playlistSrv",o)},1547:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"PlaylistEditCtrl",function(){return o});var r=n(7),a=n.n(r),i=n(2),o=function(){function t(t,e,n,r,a){var i=this;if(this.$scope=t,this.backendSrv=e,this.$location=n,this.filteredDashboards=[],this.filteredTags=[],this.searchQuery="",this.loading=!1,this.playlist={interval:"5m"},this.playlistItems=[],this.dashboardresult=[],this.tagresult=[],this.navModel=a.getPlaylistsNav(0),r.current.params.id){var o=r.current.params.id;e.get("/api/playlists/"+o).then(function(t){i.playlist=t}),e.get("/api/playlists/"+o+"/items").then(function(t){i.playlistItems=t})}}return t.$inject=["$scope","backendSrv","$location","$route","navModelSrv"],t.prototype.filterFoundPlaylistItems=function(){var t=this;this.filteredDashboards=a.a.reject(this.dashboardresult,function(e){return a.a.find(t.playlistItems,function(t){return parseInt(t.value)===e.id})}),this.filteredTags=a.a.reject(this.tagresult,function(e){return a.a.find(t.playlistItems,function(t){return t.value===e.term})})},t.prototype.addPlaylistItem=function(t){t.value=t.id.toString(),t.type="dashboard_by_id",t.order=this.playlistItems.length+1,this.playlistItems.push(t),this.filterFoundPlaylistItems()},t.prototype.addTagPlaylistItem=function(t){var e={value:t.term,type:"dashboard_by_tag",order:this.playlistItems.length+1,title:t.term};this.playlistItems.push(e),this.filterFoundPlaylistItems()},t.prototype.removePlaylistItem=function(t){a.a.remove(this.playlistItems,function(e){return t===e}),this.filterFoundPlaylistItems()},t.prototype.savePlaylist=function(t,e){var n,r=this;t.items=e,n=t.id?this.backendSrv.put("/api/playlists/"+t.id,t):this.backendSrv.post("/api/playlists",t),n.then(function(){r.$scope.appEvent("alert-success",["Playlist saved",""]),r.$location.path("/playlists")},function(){r.$scope.appEvent("alert-error",["Unable to save playlist",""])})},t.prototype.isNew=function(){return!this.playlist.id},t.prototype.isPlaylistEmpty=function(){return!this.playlistItems.length},t.prototype.backToList=function(){this.$location.path("/playlists")},t.prototype.searchStarted=function(t){var e=this;t.then(function(t){e.dashboardresult=t.dashboardResult,e.tagresult=t.tagResult,e.filterFoundPlaylistItems()})},t.prototype.movePlaylistItem=function(t,e){var n=this.playlistItems.indexOf(t),r=n+e;r>=0&&r<this.playlistItems.length&&(this.playlistItems.splice(n,1),this.playlistItems.splice(r,0,t))},t.prototype.movePlaylistItemUp=function(t){this.movePlaylistItem(t,-1)},t.prototype.movePlaylistItemDown=function(t){this.movePlaylistItem(t,1)},t}();i.default.controller("PlaylistEditCtrl",o)},1548:function(t,e,n){(function(t){var r,a;r=[n(12),n(7)],void 0!==(a=function(t){"use strict";t.module("grafana.routes").config(["$routeProvider",function(t){t.when("/playlists",{templateUrl:"public/app/features/playlist/partials/playlists.html",controllerAs:"ctrl",controller:"PlaylistsCtrl"}).when("/playlists/create",{templateUrl:"public/app/features/playlist/partials/playlist.html",controllerAs:"ctrl",controller:"PlaylistEditCtrl"}).when("/playlists/edit/:id",{templateUrl:"public/app/features/playlist/partials/playlist.html",controllerAs:"ctrl",controller:"PlaylistEditCtrl"}).when("/playlists/play/:id",{templateUrl:"public/app/features/playlist/partials/playlists.html",controllerAs:"ctrl",controller:"PlaylistsCtrl",resolve:{init:["playlistSrv","$route",function(t,e){var n=e.current.params.id;t.start(n)}]}})}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1549:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n(1550)},1550:function(t,e,n){"use strict";var r=n(12),a=n.n(r),i=n(7),o=n.n(i),s=function(){function t(t,e){var n=this;this.$rootScope=t,this.backendSrv=e,this.navModel={section:{title:"Snapshots",icon:"icon-gf icon-gf-snapshot",url:"dashboard/snapshots"},menu:[]},this.backendSrv.get("/api/dashboard/snapshots").then(function(t){n.snapshots=t})}return t.$inject=["$rootScope","backendSrv"],t.prototype.removeSnapshotConfirmed=function(t){var e=this;o.a.remove(this.snapshots,{key:t.key}),this.backendSrv.get("/api/snapshots-delete/"+t.deleteKey).then(function(){e.$rootScope.appEvent("alert-success",["Snapshot deleted",""])},function(){e.$rootScope.appEvent("alert-error",["Unable to delete snapshot",""]),e.snapshots.push(t)})},t.prototype.removeSnapshot=function(t){var e=this;this.$rootScope.appEvent("confirm-modal",{title:"Delete",text:"Are you sure you want to delete snapshot "+t.name+"?",yesText:"Delete",icon:"fa-trash",onConfirm:function(){e.removeSnapshotConfirmed(t)}})},t}();a.a.module("grafana.controllers").controller("SnapshotsCtrl",s)},1551:function(t,e,n){var r,a;r=[n(1552),n(1553),n(1554),n(1327),n(1555),n(1556),n(1557)],void 0!==(a=function(){}.apply(e,r))&&(t.exports=a)},1552:function(t,e,n){var r,a;r=[n(12),n(13),n(7),n(204)],void 0!==(a=function(t,e,n,r){"use strict";t.module("grafana.directives").directive("panelMenu",["$compile",function(t){function a(t){var e='<div class="panel-menu small">';return t.dashboard.meta.canEdit&&(e+='<div class="panel-menu-inner">',e+='<div class="panel-menu-row">',t.dashboard.meta.fullscreen||(e+='<a class="panel-menu-icon pull-left" ng-click="ctrl.updateColumnSpan(-1)"><i class="fa fa-minus"></i></a>',e+='<a class="panel-menu-icon pull-left" ng-click="ctrl.updateColumnSpan(1)"><i class="fa fa-plus"></i></a>'),e+='<a class="panel-menu-icon pull-right" ng-click="ctrl.removePanel()"><i class="fa fa-trash"></i></a>',e+='<div class="clearfix"></div>',e+="</div>"),e+='<div class="panel-menu-row">',e+='<a class="panel-menu-link" gf-dropdown="extendedMenu"><i class="fa fa-bars"></i></a>',n.each(t.getMenu(),function(n){("Editor"!==n.role||t.dashboard.meta.canEdit)&&(e+='<a class="panel-menu-link" ',n.click&&(e+=' ng-click="'+n.click+'"'),n.href&&(e+=' href="'+n.href+'"'),e+=">",e+=n.text+"</a>")}),e+="</div>",e+="</div>",e+="</div>"}function i(t){return t.getExtendedMenu()}return{restrict:"A",link:function(n,o){function s(t,e){return clearTimeout(d),d=null,t?void(d=setTimeout(s,t)):!0!==e&&(f.is(":hover")||n.ctrl.dashboard.$$panelDragging)?void s(2200):void(p&&(l.destroy(),f.unbind(),f.remove(),p.$destroy(),p=null,f=null,c.removeClass("panel-highlight")))}var l,u=e('<span class="panel-title drag-handle pointer"><span class="icon-gf panel-alert-icon"></span><span class="panel-title-text drag-handle">{{ctrl.panel.title | interpolateTemplateVars:this}}</span><span class="panel-time-info" ng-show="ctrl.timeInfo"><i class="fa fa-clock-o"></i> {{ctrl.timeInfo}}</span></span>'),c=o.parents(".panel-container"),p=null,h=n.ctrl,d=null,f=null;o.append(u);var m=function(u){if(e.contains(document,u.target)){if(f)return void s();var d;d=a(h),f=e(d),f.mouseleave(function(){s(1e3)}),p=n.$new(),p.extendedMenu=i(h),p.dismiss=function(){s(null,!0)},e(".panel-container").removeClass("panel-highlight"),c.toggleClass("panel-highlight"),e(".panel-menu").remove(),o.append(f),n.$apply(function(){t(f.contents())(p),l=new r({element:f,target:c,attachment:"bottom center",targetAttachment:"top center",constraints:[{to:"window",attachment:"together",pin:!0}]})}),s(2200)}};o.click(m),t(o.contents())(n)}}}])}.apply(e,r))&&(t.exports=a)},1553:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),a=n.n(r),i=n(13),o=n.n(i),s=n(79),l=n.n(s),t=a.a.module("grafana.directives");t.directive("grafanaPanel",["$rootScope","$document",function(t,e){return{restrict:"E",template:'\n  <div class="panel-container">\n    <div class="panel-header">\n      <span class="panel-info-corner">\n        <i class="fa"></i>\n        <span class="panel-info-corner-inner"></span>\n      </span>\n\n      <span class="panel-loading" ng-show="ctrl.loading">\n        <i class="fa fa-spinner fa-spin"></i>\n      </span>\n\n      <div class="panel-title-container drag-handle" panel-menu></div>\n    </div>\n\n    <div class="panel-content">\n      <ng-transclude></ng-transclude>\n    </div>\n    <panel-resizer></panel-resizer>\n  </div>\n\n  <div class="panel-full-edit" ng-if="ctrl.editMode">\n    <div class="tabbed-view tabbed-view--panel-edit">\n      <div class="tabbed-view-header">\n        <h2 class="tabbed-view-title">\n          {{ctrl.pluginName}}\n        </h2>\n\n        <ul class="gf-tabs">\n          <li class="gf-tabs-item" ng-repeat="tab in ::ctrl.editorTabs">\n            <a class="gf-tabs-link" ng-click="ctrl.changeTab($index)" ng-class="{active: ctrl.editorTabIndex === $index}">\n              {{::tab.title}}\n            </a>\n          </li>\n        </ul>\n\n        <button class="tabbed-view-close-btn" ng-click="ctrl.exitFullscreen();">\n          <i class="fa fa-remove"></i>\n        </button>\n      </div>\n\n      <div class="tabbed-view-body">\n        <div ng-repeat="tab in ctrl.editorTabs" ng-if="ctrl.editorTabIndex === $index">\n          <panel-editor-tab editor-tab="tab" ctrl="ctrl" index="$index"></panel-editor-tab>\n        </div>\n      </div>\n    </div>\n  </div>\n',transclude:!0,scope:{ctrl:"="},link:function(e,n){function r(){c.toggleClass("panel-hover-highlight",!0),h.dashboard.setPanelFocus(h.panel.id)}function a(){c.toggleClass("panel-hover-highlight",!1),h.dashboard.setPanelFocus(0)}function i(){var t=h.getInfoMode();p[0].className="panel-info-corner panel-info-corner--"+t,t&&(o&&o.destroy(),o=new l.a({target:p[0],content:function(){return h.getInfoContent({mode:"tooltip"})},classes:h.error?"drop-error":"drop-help",openOn:"hover",hoverOpenDelay:100,tetherOptions:{attachment:"bottom left",targetAttachment:"top left",constraints:[{to:"window",attachment:"together",pin:!0}]}}))}var o,s,u,c=n.find(".panel-container"),p=n.find(".panel-info-corner"),h=e.ctrl,d=!1,f=!1,m=0;h.containerHeight||(h.calculatePanelHeight(),c.css({minHeight:h.containerHeight}),m=h.containerHeight),h.panel.transparent&&(d=!0,c.addClass("panel-transparent",!0)),h.events.on("render",function(){m!==h.containerHeight&&(c.css({minHeight:h.containerHeight}),m=h.containerHeight),d!==h.panel.transparent&&(c.toggleClass("panel-transparent",!0===h.panel.transparent),d=h.panel.transparent),u=void 0!==h.panel.alert,f!==u&&(c.toggleClass("panel-has-alert",u),f=u),h.alertState?(s&&c.removeClass("panel-alert-state--"+s),"ok"!==h.alertState.state&&"alerting"!==h.alertState.state||c.addClass("panel-alert-state--"+h.alertState.state),s=h.alertState.state):s&&(c.removeClass("panel-alert-state--"+s),s=null)});var g;t.onAppEvent("panel-change-view",function(t,e){g!==h.fullscreen&&(n.toggleClass("panel-fullscreen",!!h.fullscreen),g=h.fullscreen)},e),e.$watchGroup(["ctrl.error","ctrl.panel.description"],i),e.$watchCollection("ctrl.panel.links",i),p.on("click",function(){o.close(),e.$apply(h.openInspector.bind(h))}),n.on("mouseenter",r),n.on("mouseleave",a),e.$on("$destroy",function(){n.off(),p.off(),o&&o.destroy()})}}}]),t.directive("panelResizer",["$rootScope",function(t){return{restrict:"E",template:'<span class="resize-panel-handle icon-gf icon-gf-grabber"></span>',link:function(e,n){function r(t){t.preventDefault(),h=!0,l=o()(t.target).offset(),u=parseInt(d.row.height),c=d.panel.span,p=o()(document).width(),s=d.row.panels[d.row.panels.length-1],o()("body").on("mousemove",a),o()("body").on("mouseup",i)}function a(t){d.row.height=Math.round(u+(t.pageY-l.top)),d.panel.span=c+(t.pageX-l.left)/p*12,d.panel.span=Math.min(Math.max(d.panel.span,1),12),d.row.updateRowSpan();var n=d.row.span;Math.floor(n)<14&&(s===d.panel&&n>12?s.span-=n-12:s!==d.panel&&(s.span=s.span-(n-12),s.span=Math.min(Math.max(s.span,1),12))),d.row.panelSpanChanged(!0),e.$apply(function(){d.render()})}function i(){d.panel.span=Math.round(d.panel.span),s&&(s.span=Math.round(s.span)),t.$apply(function(){d.row.panelSpanChanged(),setTimeout(function(){t.$broadcast("render")})}),o()("body").off("mousemove",a),o()("body").off("mouseup",i)}var s,l,u,c,p,h=!1,d=e.ctrl;n.on("mousedown",r);var f=e.$on("$destroy",function(){n.off("mousedown",r),f()})}}}]),t.directive("panelHelpCorner",["$rootScope",function(t){return{restrict:"E",template:'\n      <span class="alert-error panel-error small pointer" ng-if="ctrl.error" ng-click="ctrl.openInspector()">\n        <span data-placement="top" bs-tooltip="ctrl.error">\n          <i class="fa fa-exclamation"></i><span class="panel-error-arrow"></span>\n        </span>\n      </span>\n    ',link:function(t,e){}}}])},1554:function(t,e,n){(function(t){var r,a;r=[n(12),n(13)],void 0!==(a=function(t,e){"use strict";t.module("grafana.routes").controller("SoloPanelCtrl",["$scope","$routeParams","$location","dashboardLoaderSrv","contextSrv",function(t,n,r,a,i){var o;t.init=function(){i.sidemenu=!1;var e=r.search();o=parseInt(e.panelId),t.onAppEvent("dashboard-initialized",t.initPanelScope),a.loadDashboard(n.type,n.slug).then(function(e){e.meta.soloMode=!0,t.initDashboard(e,t)})},t.initPanelScope=function(){var n=t.dashboard.getPanelInfoById(o);if(t.ctrl={row:n.row,dashboard:t.dashboard},t.ctrl.row.height=e(window).height(),t.panel=n.panel,t.$index=0,!t.panel)return void t.appEvent("alert-error",["Panel not found",""]);t.panel.span=12},t.init()}])}.apply(e,r))&&(t.exports=a)}).call(e,n(201)(t))},1555:function(t,e,n){"use strict";function r(t){return t.create({scope:{ctrl:"=",editorTab:"=",index:"="},directive:function(t){var e=t.ctrl.pluginId,n=t.index,r=function(){return t.editorTab.directiveFn()};return Promise.resolve({name:"panel-editor-tab-"+e+n,fn:r})}})}r.$inject=["dynamicDirectiveSrv"],Object.defineProperty(e,"__esModule",{value:!0});var a=n(12);n.n(a).a.module("grafana.directives").directive("panelEditorTab",r)},1556:function(t,e,n){"use strict";function r(){return{restrict:"E",controller:o,bindToController:!0,controllerAs:"ctrl",templateUrl:"public/app/features/panel/partials/query_editor_row.html",transclude:!0,scope:{queryCtrl:"=",canCollapse:"=",hasTextEditMode:"="}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryRowCtrl",function(){return o});var a=n(12),i=n.n(a),t=i.a.module("grafana.directives"),o=function(){function t(){this.panelCtrl=this.queryCtrl.panelCtrl,this.target=this.queryCtrl.target,this.panel=this.panelCtrl.panel,this.target.refId||(this.target.refId=this.panelCtrl.dashboard.getNextQueryLetter(this.panel)),this.toggleCollapse(!0),this.target.isNew&&(delete this.target.isNew,this.toggleCollapse(!1)),this.panel.targets.length<4&&(this.collapsed=!1)}return t.prototype.toggleHideQuery=function(){this.target.hide=!this.target.hide,this.panelCtrl.refresh()},t.prototype.toggleCollapse=function(t){if(this.canCollapse){this.panelCtrl.__collapsedQueryCache||(this.panelCtrl.__collapsedQueryCache={}),t?this.collapsed=!1!==this.panelCtrl.__collapsedQueryCache[this.target.refId]:(this.collapsed=!this.collapsed,this.panelCtrl.__collapsedQueryCache[this.target.refId]=this.collapsed);try{this.collapsedText=this.queryCtrl.getCollapsedText()}catch(t){var e=t.message||t.toString();this.collapsedText="Error: "+e}}},t.prototype.toggleEditorMode=function(){this.canCollapse&&this.collapsed&&(this.collapsed=!1),this.queryCtrl.toggleEditorMode()},t.prototype.removeQuery=function(){this.panelCtrl.__collapsedQueryCache&&delete this.panelCtrl.__collapsedQueryCache[this.target.refId],this.panelCtrl.removeQuery(this.target)},t.prototype.duplicateQuery=function(){var t=i.a.copy(this.target);this.panelCtrl.addQuery(t)},t.prototype.moveQuery=function(t){this.panelCtrl.moveQuery(this.target,t)},t}();t.directive("queryEditorRow",r)},1557:function(t,e,n){"use strict";function r(){return{restrict:"E",template:l,controller:u,bindToController:!0,controllerAs:"ctrl",scope:{panelCtrl:"=",isOpen:"="},link:function(t,e,n,r){r.renderJsonExplorer=function(t){var n=e.find(".query-troubleshooter-json");r.jsonExplorer=new s.JsonExplorer(t,3,{animateOpen:!0});var a=r.jsonExplorer.render(!0);n.html(a)}}}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"QueryTroubleshooterCtrl",function(){return u}),e.queryTroubleshooter=r;var a=n(7),i=n.n(a),o=n(53),s=n(465),l='\n<div class="query-troubleshooter" ng-if="ctrl.isOpen">\n  <div class="query-troubleshooter__header">\n    <a class="pointer" ng-click="ctrl.toggleMocking()">Mock Response</a>\n    <a class="pointer" ng-click="ctrl.toggleExpand()" ng-hide="ctrl.allNodesExpanded">\n      <i class="fa fa-plus-square-o"></i> Expand All\n    </a>\n    <a class="pointer" ng-click="ctrl.toggleExpand()" ng-show="ctrl.allNodesExpanded">\n      <i class="fa fa-minus-square-o"></i> Collapse All\n    </a>\n    <a class="pointer" clipboard-button="ctrl.getClipboardText()"><i class="fa fa-clipboard"></i> Copy to Clipboard</a>\n  </div>\n  <div class="query-troubleshooter__body" ng-hide="ctrl.isMocking">\n    <i class="fa fa-spinner fa-spin" ng-show="ctrl.isLoading"></i>\n    <div class="query-troubleshooter-json"></div>\n  </div>\n  <div class="query-troubleshooter__body" ng-show="ctrl.isMocking">\n    <div class="gf-form p-l-1 gf-form--v-stretch">\n\t\t\t<textarea class="gf-form-input" style="width: 95%" rows="10" ng-model="ctrl.mockedResponse"  placeholder="JSON"></textarea>\n    </div>\n  </div>\n</div>\n',u=function(){function t(t,e){this.$timeout=e,this.onRequestErrorEventListener=this.onRequestError.bind(this),this.onRequestResponseEventListener=this.onRequestResponse.bind(this),o.a.on("ds-request-response",this.onRequestResponseEventListener),o.a.on("ds-request-error",this.onRequestErrorEventListener),t.$on("$destroy",this.removeEventsListeners.bind(this)),t.$watch("ctrl.isOpen",this.stateChanged.bind(this))}return t.$inject=["$scope","$timeout"],t.prototype.removeEventsListeners=function(){o.a.off("ds-request-response",this.onRequestResponseEventListener),o.a.off("ds-request-error",this.onRequestErrorEventListener)},t.prototype.toggleMocking=function(){this.isMocking=!this.isMocking},t.prototype.onRequestError=function(t){this.isOpen&&(this.isOpen=!0,this.hasError=!0,this.onRequestResponse(t))},t.prototype.stateChanged=function(){this.isOpen&&(this.panelCtrl.refresh(),this.isLoading=!0)},t.prototype.getClipboardText=function(){return this.jsonExplorer?JSON.stringify(this.jsonExplorer.json,null,2):""},t.prototype.handleMocking=function(t){var e;try{e=JSON.parse(this.mockedResponse)}catch(t){return void o.a.emit("alert-error",["Failed to parse mocked response"])}t.data=e},t.prototype.onRequestResponse=function(t){if(this.isOpen){if(this.isMocking)return void this.handleMocking(t);this.isLoading=!1,t=i.a.cloneDeep(t),t.headers&&delete t.headers,t.config&&(t.request=t.config,delete t.config,delete t.request.transformRequest,delete t.request.transformResponse,delete t.request.paramSerializer,delete t.request.jsonpCallbackParam,delete t.request.headers,delete t.request.requestId,delete t.request.inspect,delete t.request.retry,delete t.request.timeout),t.data&&(t.response=t.data,200===t.status&&this.hasError&&(this.hasError=!1,this.isOpen=!1),delete t.data,delete t.status,delete t.statusText,delete t.$$config),this.$timeout(i.a.partial(this.renderJsonExplorer,t))}},t.prototype.toggleExpand=function(t){this.jsonExplorer&&(this.allNodesExpanded=!this.allNodesExpanded,this.jsonExplorer.openAtDepth(this.allNodesExpanded?20:1))},t}();s.coreModule.directive("queryTroubleshooter",r)},1558:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),a=n(27),i=n(7),o=n.n(i),s=function(){function t(t,e,n,r){this.$http=t,this.$routeParams=e,this.backendSrv=n,this.colors=[],this.buttonNames=["primary","secondary","inverse","success","warning","danger"],this.buttonSizes=["btn-small","","btn-large"],this.buttonVariants=["-","-outline-"],this.icons=[],this.pages=["colors","buttons","icons","plugins"],this.navModel=r.getAdminNav(),this.theme=a.default.bootData.user.lightTheme?"light":"dark",this.page={},e.page?this.page[e.page]=1:this.page.colors=!0,this.page.colors&&this.loadColors(),this.page.icons&&this.loadIcons()}return t.$inject=["$http","$routeParams","backendSrv","navModelSrv"],t.prototype.loadColors=function(){var t=this;this.$http.get("public/build/styleguide.json").then(function(e){t.colors=o.a.map(e.data[t.theme],function(t,e){return{name:e,value:t}})})},t.prototype.loadIcons=function(){var t=this;this.$http.get("public/sass/icons.json").then(function(e){t.icons=e.data})},t.prototype.switchTheme=function(){this.$routeParams.theme="dark"===this.theme?"light":"dark";var t={theme:this.$routeParams.theme};this.backendSrv.put("/api/user/preferences",t).then(function(){window.location.href=window.location.href})},t}();r.default.controller("StyleGuideCtrl",s)}});
//# sourceMappingURL=0.4587181d1ebb09b05f49.js.map