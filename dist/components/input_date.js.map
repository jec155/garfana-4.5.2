{"version":3,"sources":["../../src/components/input_date.js"],"names":["inputDateDirective","restrict","require","link","$scope","$elem","attrs","ngModel","format","fromUser","text","indexOf","dateMath","isValid","$setValidity","undefined","parsed","ctrl","isUtc","moment","utc","toUser","currentValue","isMoment","$parsers","push","$formatters"],"mappings":";;;;;;AAAA;;AAKO,WAASA,kBAAT,GAA8B;AACnC,WAAO;AACLC,gBAAU,GADL;AAELC,eAAS,SAFJ;AAGLC,YAAM,cAAUC,MAAV,EAAkBC,KAAlB,EAAyBC,KAAzB,EAAgCC,OAAhC,EAAyC;AAC7C,YAAIC,SAAS,qBAAb;AACE;AACF,YAAIC,WAAW,SAAXA,QAAW,CAAUC,IAAV,EAAgB;AAC3B;AACF,cAAIA,KAAKC,OAAL,CAAa,KAAb,MAAwB,CAAC,CAA7B,EAAgC;AAC9B,gBAAI,CAACC,SAASC,OAAT,CAAiBH,IAAjB,CAAL,EAA6B;AAC3BH,sBAAQO,YAAR,CAAqB,OAArB,EAA8B,KAA9B;AACA,qBAAOC,SAAP;AACD;AACDR,oBAAQO,YAAR,CAAqB,OAArB,EAA8B,IAA9B;AACA,mBAAOJ,IAAP;AACD;;AAED,cAAIM,MAAJ;AACA,cAAIZ,OAAOa,IAAP,CAAYC,KAAhB,EAAuB;AACrBF,qBAASG,OAAOC,GAAP,CAAWV,IAAX,EAAiBF,MAAjB,CAAT;AACD,WAFD,MAEO;AACLQ,qBAASG,OAAOT,IAAP,EAAaF,MAAb,CAAT;AACD;;AAED,cAAI,CAACQ,OAAOH,OAAP,EAAL,EAAuB;AACrBN,oBAAQO,YAAR,CAAqB,OAArB,EAA8B,KAA9B;AACA,mBAAOC,SAAP;AACD;;AAEDR,kBAAQO,YAAR,CAAqB,OAArB,EAA8B,IAA9B;AACA,iBAAOE,MAAP;AACD,SAzBD;;AA2BA,YAAIK,SAAS,SAATA,MAAS,CAAUC,YAAV,EAAwB;AACnC,cAAIH,OAAOI,QAAP,CAAgBD,YAAhB,CAAJ,EAAmC;AACjC,mBAAOA,aAAad,MAAb,CAAoBA,MAApB,CAAP;AACD,WAFD,MAEO;AACL,mBAAOc,YAAP;AACD;AACF,SAND;;AAQAf,gBAAQiB,QAAR,CAAiBC,IAAjB,CAAsBhB,QAAtB;AACAF,gBAAQmB,WAAR,CAAoBD,IAApB,CAAyBJ,MAAzB;AACD;AA3CI,KAAP;AA6CD;;gCA9CerB,kB;;;;AAHTmB,Y;;AACKP,c","file":"input_date.js","sourcesContent":["///<reference path=\"../../../headers/common.d.ts\" />\n\nimport moment from 'moment';\nimport * as dateMath from 'app/core/utils/datemath';\n\nexport function inputDateDirective() {\n  return {\n    restrict: 'A',\n    require: 'ngModel',\n    link: function ($scope, $elem, attrs, ngModel) {\n      var format = 'YYYY-MM-DD HH:mm:ss';\n        //console.info(ngModel);\n      var fromUser = function (text) {\n          //console.info('ere');\n        if (text.indexOf('now') !== -1) {\n          if (!dateMath.isValid(text)) {\n            ngModel.$setValidity(\"error\", false);\n            return undefined;\n          }\n          ngModel.$setValidity(\"error\", true);\n          return text;\n        }\n\n        var parsed;\n        if ($scope.ctrl.isUtc) {\n          parsed = moment.utc(text, format);\n        } else {\n          parsed = moment(text, format);\n        }\n\n        if (!parsed.isValid()) {\n          ngModel.$setValidity(\"error\", false);\n          return undefined;\n        }\n\n        ngModel.$setValidity(\"error\", true);\n        return parsed;\n      };\n\n      var toUser = function (currentValue) {\n        if (moment.isMoment(currentValue)) {\n          return currentValue.format(format);\n        } else {\n          return currentValue;\n        }\n      };\n\n      ngModel.$parsers.push(fromUser);\n      ngModel.$formatters.push(toUser);\n    }\n  };\n}\n\n"]}