{"version":3,"sources":["../../src/components/cityList.js"],"names":["StreamPageCtrl","$scope","$http","$location","myPage","currentPage","totalItems","itemsPerPage","pagesLength","perPageOptions","location","http","selall","checkedItems","all","names","console","info","Object","assign","splice","length","event","x","ctrl","item","target","checked","push","scope","elem","attrs","pageNub","getPageNub","setPageNub","n","parseInt","changeCurrentPage","p","getPagination","prevPage","nextPage","numberOfPages","jumpToPage","jumpPageNum","showError","changeItemsPerPage","get","params","then","response","data","Math","ceil","pageList","i","offset","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sCAGaA,c;AAET,wCAAYC,MAAZ,EAAmBC,KAAnB,EAAyBC,SAAzB,EACA;AAAA;;AACI;AACAF,2BAAOG,MAAP,GAAc;AACVC,qCAAY,CADF,EACI;AACdC,oCAAW,CAFD,EAEG;AACbC,sCAAc,EAHJ,EAGO;AACjBC,qCAAa,EAJH;AAKVC,wCAAgB,CAAC,EAAD,EAAI,EAAJ,EAAO,EAAP,CALN,CAKgB;AALhB,qBAAd;AAOA,yBAAKC,QAAL,GAAcP,SAAd;AACA,yBAAKQ,IAAL,GAAUT,KAAV;AACA,yBAAKU,MAAL,GAAY,KAAZ,CAXJ,CAWsB;AAClB,yBAAKC,YAAL,GAAkB,EAAlB;AACH;;;;8CACSC,G,EAAIC,K,EACd;AACIC,gCAAQC,IAAR,CAAaH,GAAb;AACAA,8BAAKI,OAAOC,MAAP,CAAc,KAAKN,YAAnB,EAAiCE,KAAjC,CAAL,GAA6C,KAAKF,YAAL,CAAkBO,MAAlB,CAAyB,CAAzB,EAA2B,KAAKP,YAAL,CAAkBQ,MAA7C,CAA7C;AACA;AACH;;;oDACeC,K,EAAMC,C,EAAEC,I,EACxB;AACI,4BAAIC,OAAKH,MAAMI,MAAf;;AAEAD,6BAAKE,OAAL,GAAaH,KAAKX,YAAL,CAAkBe,IAAlB,CAAuBL,CAAvB,CAAb,GAAuCC,KAAKX,YAAL,CAAkBO,MAAlB,CAAyBG,CAAzB,EAA2B,CAA3B,CAAvC;AAEH;;;yCAsBIM,K,EAAOC,I,EAAMC,K,EAAOP,I,EACzB;AACI,4BAAIpB,SAAO,EAAX;AACAA,+BAAO4B,OAAP,GAAe,CAAf;AACA5B,+BAAO6B,UAAP,GAAkB,YAAY;AAC1B,mCAAO7B,OAAO4B,OAAd;AACH,yBAFD;AAGA5B,+BAAO8B,UAAP,GAAkB,UAAUC,CAAV,EAAa;AAC3B/B,mCAAO4B,OAAP,GAAeG,CAAf;AACH,yBAFD;AAGAN,8BAAMzB,MAAN,CAAaC,WAAb,GAAyBD,OAAO4B,OAAhC;AACA;AACAH,8BAAMzB,MAAN,CAAaI,WAAb,GAA2B4B,SAASP,MAAMzB,MAAN,CAAaI,WAAtB,IAAqC4B,SAASP,MAAMzB,MAAN,CAAaI,WAAtB,CAArC,GAA0E,CAArG;AACA,4BAAGqB,MAAMzB,MAAN,CAAaI,WAAb,GAA2B,CAA3B,KAAiC,CAApC,EAAsC;AAClC;AACAqB,kCAAMzB,MAAN,CAAaI,WAAb,GAA2BqB,MAAMzB,MAAN,CAAaI,WAAb,GAA0B,CAArD;AACH;AACD,4BAAG,CAACqB,MAAMzB,MAAN,CAAaK,cAAjB,EAAgC;AAC5BoB,kCAAMzB,MAAN,CAAaK,cAAb,GAA8B,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,CAA9B;AACH;AACDoB,8BAAMQ,iBAAN,GAA0B,UAASC,CAAT,EAAW;AACjC,gCAAGA,KAAK,KAAR,EAAc;AACV;AACH,6BAFD,MAEK;AACDT,sCAAMzB,MAAN,CAAaC,WAAb,GAA2BiC,CAA3B;AACAlC,uCAAO8B,UAAP,CAAkBL,MAAMzB,MAAN,CAAaC,WAA/B;AACH;AACDkC;AACH,yBARD;AASAV,8BAAMW,QAAN,GAAiB,YAAU;AACvB,gCAAGX,MAAMzB,MAAN,CAAaC,WAAb,GAA2B,CAA9B,EAAgC;AAC5BwB,sCAAMzB,MAAN,CAAaC,WAAb,IAA4B,CAA5B;AACH,6BAFD,MAEM;AACFwB,sCAAMzB,MAAN,CAAaC,WAAb,GAAyB,CAAzB;AACH;AACDD,mCAAO8B,UAAP,CAAkBL,MAAMzB,MAAN,CAAaC,WAA/B;AACAkC;AACH,yBARD;AASA;AACAV,8BAAMY,QAAN,GAAiB,YAAU;AACvB,gCAAGZ,MAAMzB,MAAN,CAAaC,WAAb,GAA2BwB,MAAMzB,MAAN,CAAasC,aAA3C,EAAyD;AACrDb,sCAAMzB,MAAN,CAAaC,WAAb,IAA4B,CAA5B;AACH,6BAFD,MAEM;AACFwB,sCAAMzB,MAAN,CAAaC,WAAb,GAAyBwB,MAAMzB,MAAN,CAAasC,aAAtC;AACH;AACDtC,mCAAO8B,UAAP,CAAkBL,MAAMzB,MAAN,CAAaC,WAA/B;AACAkC;AACH,yBARD;;AAUA;AACAV,8BAAMc,UAAN,GAAmB,YAAU;AACzB,gCAAGd,MAAMzB,MAAN,CAAawC,WAAb,GAAyB,CAAzB,IAA8Bf,MAAMzB,MAAN,CAAawC,WAAb,IAA0Bf,MAAMzB,MAAN,CAAasC,aAAxE,EAAsF;AAClFb,sCAAMzB,MAAN,CAAaC,WAAb,GAAyBwB,MAAMzB,MAAN,CAAawC,WAAtC;AACAxC,uCAAO8B,UAAP,CAAkBL,MAAMzB,MAAN,CAAaC,WAA/B;AACAkC;AACAV,sCAAMzB,MAAN,CAAawC,WAAb,GAAyB,EAAzB;AACH,6BALD,MAKM;AACFf,sCAAMzB,MAAN,CAAayC,SAAb,GAAuB,IAAvB;AACH;AACJ,yBATD;AAUA;AACAhB,8BAAMiB,kBAAN,GAA2B,YAAU;AACjCP;AACH,yBAFD;AAGAA;;AAEA,iCAASA,aAAT,GAAwB;AACpBf,iCAAKb,IAAL,CAAUoC,GAAV,CAAc,6DAAd,EACK,EAACC,QAAO,EAAC,QAAOnB,MAAMzB,MAAN,CAAaC,WAArB,EAAiC,SAAQwB,MAAMzB,MAAN,CAAaG,YAAtD,EAAR,EADL,EACmF0C,IADnF,CAEI,UAAUC,QAAV,EACA;AACIrB,sCAAMd,KAAN,GAAYmC,SAASC,IAAT,CAAcA,IAA1B;AACAtB,sCAAMzB,MAAN,CAAaE,UAAb,GAAwB4C,SAASC,IAAT,CAAc7C,UAAtC,CAFJ,CAEqD;AACjDuB,sCAAMzB,MAAN,CAAaC,WAAb,GAA2B+B,SAAShC,OAAO4B,OAAhB,CAA3B;AACA;AACAH,sCAAMzB,MAAN,CAAaE,UAAb,GAA0B8B,SAASP,MAAMzB,MAAN,CAAaE,UAAtB,CAA1B;;AAEA;AACAuB,sCAAMzB,MAAN,CAAasC,aAAb,GAA6BU,KAAKC,IAAL,CAAUxB,MAAMzB,MAAN,CAAaE,UAAb,GAAwBuB,MAAMzB,MAAN,CAAaG,YAA/C,CAA7B;AACA;AACA;AACA,oCAAGsB,MAAMzB,MAAN,CAAaC,WAAb,GAA2B,CAA9B,EAAgC;AAC5BwB,0CAAMzB,MAAN,CAAaC,WAAb,GAA2B,CAA3B;AACH;;AAED,oCAAGwB,MAAMzB,MAAN,CAAaC,WAAb,GAA2BwB,MAAMzB,MAAN,CAAasC,aAA3C,EAAyD;AACrDb,0CAAMzB,MAAN,CAAaC,WAAb,GAA2BwB,MAAMzB,MAAN,CAAasC,aAAxC;AACH;;AAGDb,sCAAMyB,QAAN,GAAiB,EAAjB;AACA,oCAAIC,CAAJ;AACA,oCAAG1B,MAAMzB,MAAN,CAAasC,aAAb,IAA8Bb,MAAMzB,MAAN,CAAaI,WAA9C,EAA0D;AACtD;AACA,yCAAI+C,IAAG,CAAP,EAAUA,KAAK1B,MAAMzB,MAAN,CAAasC,aAA5B,EAA2Ca,GAA3C,EAA+C;AAC3C1B,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoB2B,CAApB;AACH;AACJ,iCALD,MAKK;AACD;AACA;AACA,wCAAIC,SAAS,CAAC3B,MAAMzB,MAAN,CAAaI,WAAb,GAA2B,CAA5B,IAA+B,CAA5C;AACA,wCAAGqB,MAAMzB,MAAN,CAAaC,WAAb,IAA4BmD,MAA/B,EAAsC;AAClC;AACA,6CAAID,IAAG,CAAP,EAAUA,KAAKC,SAAQ,CAAvB,EAA0BD,GAA1B,EAA8B;AAC1B1B,kDAAMyB,QAAN,CAAe1B,IAAf,CAAoB2B,CAApB;AACH;AACD1B,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoB,KAApB;AACAC,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoBC,MAAMzB,MAAN,CAAasC,aAAjC;AACA;AACH,qCARD,MAQM,IAAGb,MAAMzB,MAAN,CAAaC,WAAb,GAA2BwB,MAAMzB,MAAN,CAAasC,aAAb,GAA6Bc,MAA3D,EAAkE;AACpE3B,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoB,CAApB;AACAC,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoB,KAApB;AACA,6CAAI2B,IAAIC,SAAS,CAAjB,EAAoBD,KAAK,CAAzB,EAA4BA,GAA5B,EAAgC;AAC5B1B,kDAAMyB,QAAN,CAAe1B,IAAf,CAAoBC,MAAMzB,MAAN,CAAasC,aAAb,GAA6Ba,CAAjD;AACH;AACD1B,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoBC,MAAMzB,MAAN,CAAasC,aAAjC;AACH,qCAPK,MAOD;AACD;AACAb,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoB,CAApB;AACAC,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoB,KAApB;;AAEA,6CAAI2B,IAAIH,KAAKC,IAAL,CAAUG,SAAO,CAAjB,CAAR,EAA8BD,KAAK,CAAnC,EAAsCA,GAAtC,EAA0C;AACtC1B,kDAAMyB,QAAN,CAAe1B,IAAf,CAAoBC,MAAMzB,MAAN,CAAaC,WAAb,GAA2BkD,CAA/C;AACH;AACD1B,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoBC,MAAMzB,MAAN,CAAaC,WAAjC;AACA,6CAAIkD,IAAI,CAAR,EAAWA,KAAKC,SAAO,CAAvB,EAA0BD,GAA1B,EAA8B;AAC1B1B,kDAAMyB,QAAN,CAAe1B,IAAf,CAAoBC,MAAMzB,MAAN,CAAaC,WAAb,GAA2BkD,CAA/C;AACH;;AAED1B,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoB,KAApB;AACAC,8CAAMyB,QAAN,CAAe1B,IAAf,CAAoBC,MAAMzB,MAAN,CAAasC,aAAjC;AACH;AACJ;AACJ,6BAlEL;AAqEA;;AAGH;AACJ;;;;;;;;AAEL1C,2BAAeyD,WAAf,GAA6B,0BAA7B","file":"cityList.js","sourcesContent":["\nimport './my-pagination.css!';\nimport './cityList.css!';\nexport class StreamPageCtrl\n{\n    constructor($scope,$http,$location)\n    {\n        //分页\n        $scope.myPage={\n            currentPage:1,//访问第几页数据，从1开始\n            totalItems:0,//数据库中总共有多少条数据\n            itemsPerPage: 10,//默认每页展示多少条数据，可更改\n            pagesLength: 15,\n            perPageOptions: [10,15,25]//可选择的每页展示多少条数据\n        };\n        this.location=$location;\n        this.http=$http;\n        this.selall=false;//全选标志\n        this.checkedItems=[];\n    }\n    selectAll(all,names)\n    {\n        console.info(all);\n        all? Object.assign(this.checkedItems, names):this.checkedItems.splice(0,this.checkedItems.length);\n        //console.info(this.checkedItems);\n    }\n    updateSelection(event,x,ctrl)\n    {\n        var item=event.target;\n\n        item.checked?ctrl.checkedItems.push(x):ctrl.checkedItems.splice(x,1);\n\n    }\n\n    /*jumpPage()\n    {\n        //this.location.path(\"public/plugins/grafana-example-app/components/Log view.html\");\n        //var curUrl = this.location.absUrl();\n        //console.info(curUrl);\n        //window.location=\"public/plugins/grafana-example-app/components/cityAdd.html\";\n    }\n\n    add()\n    {\n\n    }\n\n    deleteAll()\n    {\n        this.p.get(\"deleteCheckedAll\",{params:{this.checkedItems}).then(function () {\n        \n        });\n    }*/\n\n    link(scope, elem, attrs, ctrl)\n    {\n        var myPage={};\n        myPage.pageNub=1;\n        myPage.getPageNub=function () {\n            return myPage.pageNub;\n        };\n        myPage.setPageNub=function (n) {\n            myPage.pageNub=n;\n        };\n        scope.myPage.currentPage=myPage.pageNub;\n        // 定义分页的长度必须为奇数 (default:9)\n        scope.myPage.pagesLength = parseInt(scope.myPage.pagesLength) ? parseInt(scope.myPage.pagesLength) : 9 ;\n        if(scope.myPage.pagesLength % 2 === 0){\n            // 如果不是奇数的时候处理一下\n            scope.myPage.pagesLength = scope.myPage.pagesLength -1;\n        }\n        if(!scope.myPage.perPageOptions){\n            scope.myPage.perPageOptions = [10, 15, 20];\n        }\n        scope.changeCurrentPage = function(p){\n            if(p == '...'){\n                return;\n            }else{\n                scope.myPage.currentPage = p;\n                myPage.setPageNub(scope.myPage.currentPage);\n            }\n            getPagination();\n        };\n        scope.prevPage = function(){\n            if(scope.myPage.currentPage > 1){\n                scope.myPage.currentPage -= 1;\n            }else {\n                scope.myPage.currentPage=1;\n            }\n            myPage.setPageNub(scope.myPage.currentPage);\n            getPagination();\n        };\n        // nextPage\n        scope.nextPage = function(){\n            if(scope.myPage.currentPage < scope.myPage.numberOfPages){\n                scope.myPage.currentPage += 1;\n            }else {\n                scope.myPage.currentPage=scope.myPage.numberOfPages;\n            }\n            myPage.setPageNub(scope.myPage.currentPage);\n            getPagination()\n        };\n\n        // 跳转页\n        scope.jumpToPage = function(){\n            if(scope.myPage.jumpPageNum>0 || scope.myPage.jumpPageNum<=scope.myPage.numberOfPages){\n                scope.myPage.currentPage=scope.myPage.jumpPageNum;\n                myPage.setPageNub(scope.myPage.currentPage);\n                getPagination();\n                scope.myPage.jumpPageNum='';\n            }else {\n                scope.myPage.showError=true;\n            }\n        };\n        // 修改每页显示的条数\n        scope.changeItemsPerPage = function(){\n            getPagination();\n        };\n        getPagination();\n\n        function getPagination(){\n            ctrl.http.get('http://61.164.218.158:8080/AirServer/grafana/cityListByPage'\n                ,{params:{\"page\":scope.myPage.currentPage,\"limit\":scope.myPage.itemsPerPage}}).then(\n                function (response)\n                {\n                    scope.names=response.data.data;\n                    scope.myPage.totalItems=response.data.totalItems;//当获取总数据后，修改默认值\n                    scope.myPage.currentPage = parseInt(myPage.pageNub);\n                    // pg.totalItems\n                    scope.myPage.totalItems = parseInt(scope.myPage.totalItems);\n\n                    // numberOfPages,总共分多少页\n                    scope.myPage.numberOfPages = Math.ceil(scope.myPage.totalItems/scope.myPage.itemsPerPage);\n                    //console.info(scope.myPage.totalItems);\n                    // judge currentPage > scope.numberOfPages\n                    if(scope.myPage.currentPage < 1){\n                        scope.myPage.currentPage = 1;\n                    }\n\n                    if(scope.myPage.currentPage > scope.myPage.numberOfPages){\n                        scope.myPage.currentPage = scope.myPage.numberOfPages;\n                    }\n\n\n                    scope.pageList = [];\n                    var i;\n                    if(scope.myPage.numberOfPages <= scope.myPage.pagesLength){\n                        // 判断总页数如果小于等于分页的长度，若小于则直接显示\n                        for(i =1; i <= scope.myPage.numberOfPages; i++){\n                            scope.pageList.push(i);\n                        }\n                    }else{\n                        // 总页数大于分页长度（此时分为三种情况：1.左边没有...2.右边没有...3.左右都有...）\n                        // 计算中心偏移量\n                        var offset = (scope.myPage.pagesLength - 1)/2;\n                        if(scope.myPage.currentPage <= offset){\n                            // 左边没有...\n                            for(i =1; i <= offset +1; i++){\n                                scope.pageList.push(i);\n                            }\n                            scope.pageList.push('...');\n                            scope.pageList.push(scope.myPage.numberOfPages);\n                            //    >实际总页数-每页的一半\n                        }else if(scope.myPage.currentPage > scope.myPage.numberOfPages - offset){\n                            scope.pageList.push(1);\n                            scope.pageList.push('...');\n                            for(i = offset + 1; i >= 1; i--){\n                                scope.pageList.push(scope.myPage.numberOfPages - i);\n                            }\n                            scope.pageList.push(scope.myPage.numberOfPages);\n                        }else{\n                            // 最后一种情况，两边都有...\n                            scope.pageList.push(1);\n                            scope.pageList.push('...');\n\n                            for(i = Math.ceil(offset/2) ; i >= 1; i--){\n                                scope.pageList.push(scope.myPage.currentPage - i);\n                            }\n                            scope.pageList.push(scope.myPage.currentPage);\n                            for(i = 1; i <= offset/2; i++){\n                                scope.pageList.push(scope.myPage.currentPage + i);\n                            }\n\n                            scope.pageList.push('...');\n                            scope.pageList.push(scope.myPage.numberOfPages);\n                        }\n                    }\n                }\n\n            )\n            // pg.currentPage\n\n\n        }\n    }\n}\nStreamPageCtrl.templateUrl = 'components/cityList.html';\n\n\n"]}