{"version":3,"sources":["../../src/components/siteDeviceManage.js"],"names":["baseURL","SiteDeviceManageCtrl","$scope","$http","$location","$rootScope","root","http","location","deviceID","availableDevices","siteDevices","scope","siteMap","get","then","response","angular","forEach","data","index","array","id","name","monType","cityModel","toAdd","select","document","getElementById","i","length","options","selected","value","text","a","push","$","ajax","type","traditional","url","siteid","ids","dataType","success","da","history","go","alert","error","re","console","info","responseText","elem","attrs","ctrl","templateUrl"],"mappings":"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","file":"siteDeviceManage.js","sourcesContent":["import {baseURL} from \"./common/constVal\";\r\nexport class SiteDeviceManageCtrl\r\n{\r\n  constructor($scope,$http,$location,$rootScope) {\r\n      this.root=$rootScope;\r\n      //console.info($rootScope.cityModel)\r\n      this.http = $http;\r\n\r\n      this.location = $location;\r\n\r\n      $scope.deviceID=[];\r\n      $scope.availableDevices={};\r\n      $scope.siteDevices={};\r\n      this.scope=$scope;\r\n      $scope.siteMap = {\r\n                        'AIR':'空气质量',\r\n                        'WATER':'水环境',\r\n                        'MULTI':'多功能'\r\n                    };\r\n\r\n      $http.get(baseURL+'getAvailableDevices').then(function (response) {\r\n          angular.forEach(response.data.data, function(data,index,array){\r\n              $scope.availableDevices[data.id]=data.name + \"(\" + $scope.siteMap[data .monType] + \")\";\r\n\r\n          });\r\n      });\r\n      $http.get(baseURL+'getDevicesBySiteID?siteid='+$rootScope.cityModel.id).then(function (response) {\r\n          angular.forEach(response.data.data, function(data,index,array){\r\n              $scope.siteDevices[data.id]=data.name + \"(\" + $scope.siteMap[data .monType] + \")\";\r\n          });\r\n      });\r\n  }\r\n\r\n    getSelectedA()\r\n    {\r\n        let toAdd={};\r\n        let select = document.getElementById(\"A\");\r\n        for(let i=0;i<select.length;i++){\r\n            if(select.options[i].selected){\r\n                toAdd[select[i].value]=select[i].text;\r\n            }\r\n        }\r\n\r\n        for(let a in toAdd)//索引ID\r\n        {\r\n            this.scope.siteDevices[a]=toAdd[a];\r\n            delete  this.scope.availableDevices[a];\r\n        }\r\n    }\r\n    getSelectedAll()\r\n    {\r\n        let toAdd={};\r\n        let select = document.getElementById(\"A\");\r\n        for(let i=0;i<select.length;i++){\r\n            toAdd[select[i].value]=select[i].text;\r\n        }\r\n\r\n        for(let a in toAdd)\r\n        {\r\n            this.scope.siteDevices[a]=toAdd[a];\r\n            delete  this.scope.availableDevices[a];\r\n        }\r\n    }\r\n    getSelectedR()\r\n    {\r\n        let toAdd={};\r\n        let select = document.getElementById(\"B\");\r\n        for(let i=0;i<select.length;i++){\r\n            if(select.options[i].selected){\r\n                toAdd[select[i].value]=select[i].text;\r\n            }\r\n        }\r\n\r\n        for(let a in toAdd)\r\n        {\r\n            this.scope.availableDevices[a]=toAdd[a];\r\n            delete  this.scope.siteDevices[a];\r\n        }\r\n    }\r\n    getSelectedRAll()\r\n    {\r\n        let toAdd={};\r\n        let select = document.getElementById(\"B\");\r\n        for(let i=0;i<select.length;i++){\r\n            toAdd[select[i].value]=select[i].text;\r\n        }\r\n\r\n        for(var a in toAdd)\r\n        {\r\n            this.scope.availableDevices[a]=toAdd[a];\r\n            delete  this.scope.siteDevices[a];\r\n        }\r\n    }\r\n\r\n    commit()\r\n    {\r\n        for(let id in this.scope.siteDevices)\r\n        {\r\n            this.scope.deviceID.push(id);\r\n\r\n        }\r\n\r\n        $.ajax({\r\n            type: 'GET',\r\n            traditional:true,\r\n            url: baseURL+'updateSiteDevice',\r\n            //'http://127.0.0.1:8080/grafana/updateCitySites',\r\n            data: {siteid: this.root.cityModel.id,ids:this.scope.deviceID},\r\n            dataType:'json',\r\n            success:function (da)\r\n            {\r\n                history.go(-1);\r\n                alert('更新成功');\r\n            },\r\n            error:function (re) {\r\n                console.info(re.responseText);\r\n            }\r\n        });\r\n    }\r\n    link(scope, elem, attrs, ctrl)\r\n    {\r\n\r\n    }\r\n}\r\nSiteDeviceManageCtrl.templateUrl = 'public/plugins/grafana-management/components/SiteDeviceManage.html';\r\n\r\n\r\n"]}